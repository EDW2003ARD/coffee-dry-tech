[{"id":"e905c172.c2ad3","type":"tab","label":"Menu inicio","disabled":false,"info":""},{"id":"ed569869.819098","type":"tab","label":"Proceso estandar","disabled":false,"info":""},{"id":"c35023aa.5435e","type":"tab","label":"ON Proceso estandar","disabled":false,"info":""},{"id":"3d816303.8389dc","type":"tab","label":"Datos estandar","disabled":false,"info":""},{"id":"25c07f17.d1356","type":"tab","label":"Graficas","disabled":false,"info":""},{"id":"f7b8fc48.f0fef","type":"tab","label":"Configuración","disabled":false,"info":""},{"id":"f60cb17c.592a4","type":"tab","label":"Curvas","disabled":false,"info":""},{"id":"2bda8890.ae1fd8","type":"tab","label":"Datos usuario","disabled":false,"info":""},{"id":"6deb710b.55714","type":"tab","label":"ON Proceso personalizado","disabled":false,"info":""},{"id":"51b720ac.77402","type":"tab","label":"Proceso personalizado","disabled":false,"info":""},{"id":"2d9b01c55fb8a47a","type":"tab","label":"PLC","disabled":false,"info":""},{"id":"flow_nav_start","type":"tab","label":"Nav → calibracion (Start Menu)","disabled":false,"info":""},{"id":"343924631c18c3df","type":"tab","label":"Calibración (XY + ecuación)","disabled":false,"info":""},{"id":"flow_vars_live","type":"tab","label":"variables_live (reponer)","disabled":false,"info":""},{"id":"9e7292e1.f9ca7","type":"ui_base","theme":{"name":"theme-light","lightTheme":{"default":"#0094CE","baseColor":"#0094CE","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"darkTheme":{"default":"#097479","baseColor":"#097479","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":false},"customTheme":{"name":"Untitled Theme 1","default":"#4B7930","baseColor":"#4B7930","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"},"themeState":{"base-color":{"default":"#0094CE","value":"#0094CE","edited":false},"page-titlebar-backgroundColor":{"value":"#0094CE","edited":false},"page-backgroundColor":{"value":"#fafafa","edited":false},"page-sidebar-backgroundColor":{"value":"#ffffff","edited":false},"group-textColor":{"value":"#1bbfff","edited":false},"group-borderColor":{"value":"#ffffff","edited":false},"group-backgroundColor":{"value":"#ffffff","edited":false},"widget-textColor":{"value":"#111111","edited":false},"widget-backgroundColor":{"value":"#0094ce","edited":false},"widget-borderColor":{"value":"#ffffff","edited":false},"base-font":{"value":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"}},"angularTheme":{"primary":"indigo","accents":"blue","warn":"red","background":"grey","palette":"light"}},"site":{"name":"Node-RED Dashboard","hideToolbar":"true","allowSwipe":"false","lockMenu":"false","allowTempTheme":"true","dateFormat":"DD/MM/YYYY","sizes":{"sx":48,"sy":48,"gx":6,"gy":6,"cx":6,"cy":6,"px":0,"py":0}}},{"id":"9d8e083238bd6420","type":"OpcUa-Endpoint","endpoint":"opc.tcp://192.168.1.87:4840/","secpol":"None","secmode":"None","none":true,"login":false,"usercert":false,"usercertificate":"","userprivatekey":""},{"id":"41fbb9758632edd4","type":"ui_tab","name":"Prueba","icon":"dashboard","disabled":false,"hidden":false},{"id":"feb3531e55edf379","type":"ui_group","name":"Prueba","tab":"41fbb9758632edd4","order":1,"disp":true,"width":6,"collapse":false,"className":""},{"id":"63699df.3ecf864","type":"ui_tab","name":"Start_tab","icon":"dashboard","order":1,"disabled":false,"hidden":true},{"id":"94c422bc.34142","type":"ui_group","name":"Start Menu Group","tab":"63699df.3ecf864","order":2,"disp":false,"width":18,"collapse":false,"className":""},{"id":"6925729.bab7c8c","type":"ui_tab","name":"Standard_process_tab","icon":"dashboard","order":2,"disabled":false,"hidden":true},{"id":"1205d101.95d59f","type":"ui_group","name":"Standard Process Menu Group","tab":"6925729.bab7c8c","order":2,"disp":false,"width":18,"collapse":false,"className":""},{"id":"c70e8126.caef3","type":"ui_group","name":"Live_data","tab":"","order":1,"disp":false,"width":18,"collapse":false,"className":""},{"id":"94d7ffb4.13d3f","type":"ui_tab","name":"Data_tab","icon":"dashboard","order":4,"disabled":false,"hidden":true},{"id":"d8d928f2.8366e8","type":"ui_group","name":"Data Group","tab":"94d7ffb4.13d3f","order":1,"disp":false,"width":18,"collapse":false,"className":""},{"id":"4f2472d6.3b84ac","type":"ui_tab","name":"Graphics_tab","icon":"dashboard","order":8,"disabled":false,"hidden":true},{"id":"cabc2e85.6276b","type":"ui_group","name":"Live_graphics_data","tab":"4f2472d6.3b84ac","order":2,"disp":false,"width":18,"collapse":false,"className":""},{"id":"65619ce6.e451f4","type":"ui_tab","name":"Configuration_tab","icon":"dashboard","order":10,"disabled":false,"hidden":true},{"id":"6896531b.8e06bc","type":"ui_group","name":"Configuration Group","tab":"65619ce6.e451f4","order":1,"disp":false,"width":"18","collapse":false,"className":""},{"id":"96c9bdb5.f7cfc","type":"ui_tab","name":"Pruebas","icon":"dashboard","order":11,"disabled":false,"hidden":true},{"id":"808cf39d.b7f6f","type":"ui_group","name":"Pruebas_Group","tab":"96c9bdb5.f7cfc","order":1,"disp":false,"width":18,"collapse":false,"className":""},{"id":"bc369363.c67e6","type":"ui_tab","name":"Waves_tab","icon":"dashboard","order":9,"disabled":false,"hidden":true},{"id":"5c49ed12.764434","type":"ui_group","name":"Waves Group","tab":"bc369363.c67e6","order":1,"disp":false,"width":18,"collapse":false,"className":""},{"id":"c0113989.5e5198","type":"ui_tab","name":"Data_personalized_tab","icon":"dashboard","order":5,"disabled":false,"hidden":true},{"id":"510760cb.f75bc","type":"ui_group","name":"Data Group","tab":"c0113989.5e5198","order":1,"disp":false,"width":"18","collapse":false,"className":""},{"id":"f02c7820.b6c078","type":"ui_tab","name":"ON_personalized_process_tab","icon":"dashboard","order":7,"disabled":false,"hidden":true},{"id":"f4b272b1.bab0a","type":"ui_group","name":"Live_data","tab":"f02c7820.b6c078","order":1,"disp":false,"width":18,"collapse":false,"className":""},{"id":"873fe727.c99698","type":"ui_tab","name":"Personalized_process_tab","icon":"dashboard","order":3,"disabled":false,"hidden":true},{"id":"b6a9e047.708fd","type":"ui_group","name":"User Process Menu Group","tab":"873fe727.c99698","order":1,"disp":false,"width":18,"collapse":false,"className":""},{"id":"29e0268193c02a64","type":"ui_tab","name":"GRAFICAS","icon":"dashboard","order":13,"disabled":false,"hidden":false},{"id":"ui_tab_cal","type":"ui_tab","name":"calibracion","icon":"tune","disabled":false,"hidden":false},{"id":"ui_grp_live","type":"ui_group","name":"variables_live","tab":"ui_tab_cal","order":2,"disp":true,"width":"12","collapse":false},{"id":"68946b218293dbf8","type":"ui_group","name":"calibration_data","tab":"ui_tab_cal","order":2,"disp":true,"width":6,"collapse":false,"className":""},{"id":"e2c2fd71362c4564","type":"ui_spacer","z":"flow_vars_live","name":"spacer","group":"ui_grp_live","order":4,"width":3,"height":1},{"id":"4d5ea01e66476354","type":"ui_spacer","z":"flow_vars_live","name":"spacer","group":"ui_grp_live","order":6,"width":4,"height":1},{"id":"3b5c11457d39a06e","type":"ui_spacer","z":"flow_vars_live","name":"spacer","group":"ui_grp_live","order":7,"width":3,"height":1},{"id":"9e18d687345dfc14","type":"ui_spacer","z":"flow_vars_live","name":"spacer","group":"ui_grp_live","order":8,"width":4,"height":1},{"id":"65c138e2d82daa6d","type":"ui_spacer","z":"flow_vars_live","name":"spacer","group":"ui_grp_live","order":9,"width":3,"height":1},{"id":"e8f139c132b6a04f","type":"ui_spacer","z":"flow_vars_live","name":"spacer","group":"ui_grp_live","order":10,"width":4,"height":1},{"id":"2cfba0ba187b7806","type":"ui_spacer","z":"flow_vars_live","name":"spacer","group":"ui_grp_live","order":11,"width":3,"height":1},{"id":"3492d3499c28e94e","type":"ui_spacer","z":"flow_vars_live","name":"spacer","group":"ui_grp_live","order":12,"width":4,"height":1},{"id":"68f11be9f498d15a","type":"ui_spacer","z":"flow_vars_live","name":"spacer","group":"68946b218293dbf8","order":7,"width":6,"height":1},{"id":"06e0c1e942dda43d","type":"ui_spacer","z":"flow_vars_live","name":"spacer","group":"68946b218293dbf8","order":8,"width":6,"height":1},{"id":"031e819eac6b6fd8","type":"ui_spacer","z":"flow_vars_live","name":"spacer","group":"68946b218293dbf8","order":9,"width":6,"height":1},{"id":"1a95fbafa6ec3099","type":"ui_spacer","z":"flow_vars_live","name":"spacer","group":"68946b218293dbf8","order":10,"width":6,"height":1},{"id":"a5fc5c3537c0c6d7","type":"ui_spacer","z":"flow_vars_live","name":"spacer","group":"68946b218293dbf8","order":11,"width":6,"height":1},{"id":"196f0444dd203f4b","type":"ui_spacer","z":"flow_vars_live","name":"spacer","group":"68946b218293dbf8","order":12,"width":6,"height":1},{"id":"078a3a0591bbc1f7","type":"ui_group","name":"Group 2","tab":"94d7ffb4.13d3f","order":2,"disp":true,"width":6},{"id":"f70b5cdd58f2743e","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"6896531b.8e06bc","order":5,"width":1,"height":1},{"id":"8c27dd58a9667238","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"6896531b.8e06bc","order":8,"width":4,"height":1},{"id":"b49f4cb0ec76d2b1","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"6896531b.8e06bc","order":10,"width":3,"height":1},{"id":"5b1d7d6a842e5d37","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"6896531b.8e06bc","order":12,"width":1,"height":1},{"id":"e2889e7b8766acca","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"6896531b.8e06bc","order":14,"width":5,"height":1},{"id":"7025897ba53cbb6a","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"6896531b.8e06bc","order":16,"width":1,"height":1},{"id":"78493efc5319075b","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"6896531b.8e06bc","order":18,"width":1,"height":1},{"id":"d3547df72e3abac6","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"6896531b.8e06bc","order":20,"width":5,"height":1},{"id":"55b2c9265d486559","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"6896531b.8e06bc","order":22,"width":1,"height":1},{"id":"1cf980c516bcd16d","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"6896531b.8e06bc","order":24,"width":1,"height":1},{"id":"36d23b6121db4d56","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"6896531b.8e06bc","order":26,"width":1,"height":1},{"id":"f7ed4dd88d71c9d9","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"6896531b.8e06bc","order":28,"width":1,"height":1},{"id":"fc88c3b270931b67","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"6896531b.8e06bc","order":31,"width":13,"height":1},{"id":"72c766a62b03b957","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"6896531b.8e06bc","order":33,"width":13,"height":1},{"id":"8fc6f510b4202a45","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"6896531b.8e06bc","order":34,"width":13,"height":1},{"id":"ecd15f1a32046237","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"6896531b.8e06bc","order":36,"width":13,"height":1},{"id":"01e7958859236e77","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"6896531b.8e06bc","order":37,"width":13,"height":1},{"id":"5af432a65776f3d8","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"5c49ed12.764434","order":3,"width":13,"height":1},{"id":"6b6bb5c259812283","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"cabc2e85.6276b","order":6,"width":1,"height":1},{"id":"e6f66d7b5a2a4b81","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"cabc2e85.6276b","order":9,"width":1,"height":1},{"id":"5d1a9d675355731e","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"cabc2e85.6276b","order":11,"width":1,"height":1},{"id":"95c05c889280546d","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"cabc2e85.6276b","order":13,"width":1,"height":1},{"id":"5dbbc0bd9593cbcf","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"cabc2e85.6276b","order":15,"width":1,"height":1},{"id":"6e034fcebf0510d7","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"cabc2e85.6276b","order":17,"width":1,"height":1},{"id":"08edc9ba24430e74","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"cabc2e85.6276b","order":21,"width":1,"height":1},{"id":"5a0a6d325d627568","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"cabc2e85.6276b","order":23,"width":1,"height":1},{"id":"2d79492a5d2b12e4","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"cabc2e85.6276b","order":24,"width":1,"height":1},{"id":"e602c1cbd3fd6d4d","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"cabc2e85.6276b","order":26,"width":1,"height":1},{"id":"6b1d01198ef44a1d","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"cabc2e85.6276b","order":27,"width":1,"height":1},{"id":"7fe5d265c0ca04c8","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"f4b272b1.bab0a","order":5,"width":2,"height":1},{"id":"ed6bdb44a8ff47c4","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"f4b272b1.bab0a","order":7,"width":5,"height":1},{"id":"5a369b50d361833a","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"f4b272b1.bab0a","order":28,"width":13,"height":1},{"id":"dd6346189b07d923","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"510760cb.f75bc","order":56,"width":2,"height":1},{"id":"5be119fae8682482","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"510760cb.f75bc","order":57,"width":13,"height":1},{"id":"75828604459787c0","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"d8d928f2.8366e8","order":5,"width":2,"height":1},{"id":"6e015d6d5013c273","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"d8d928f2.8366e8","order":7,"width":2,"height":1},{"id":"c5847a579da53115","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"d8d928f2.8366e8","order":9,"width":4,"height":1},{"id":"0d5fd4408836793b","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"d8d928f2.8366e8","order":11,"width":1,"height":1},{"id":"82463d66e4607183","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"d8d928f2.8366e8","order":13,"width":1,"height":1},{"id":"7487a15d18d62536","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"d8d928f2.8366e8","order":15,"width":1,"height":1},{"id":"2322ab26331076d0","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"d8d928f2.8366e8","order":17,"width":1,"height":1},{"id":"de110a72fc8d5292","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"d8d928f2.8366e8","order":19,"width":1,"height":1},{"id":"462ab4c122447d6e","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"d8d928f2.8366e8","order":21,"width":1,"height":1},{"id":"386770746e028039","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"d8d928f2.8366e8","order":23,"width":1,"height":1},{"id":"fa72edcc1562e7ec","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"d8d928f2.8366e8","order":25,"width":1,"height":1},{"id":"87ffb6fa3d062b05","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"d8d928f2.8366e8","order":27,"width":1,"height":1},{"id":"d35db7cab39d877e","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"d8d928f2.8366e8","order":29,"width":1,"height":1},{"id":"ed3a7bc9336dbffa","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"d8d928f2.8366e8","order":31,"width":1,"height":1},{"id":"1bd8b8daf147c659","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"d8d928f2.8366e8","order":33,"width":1,"height":1},{"id":"052f93e9828a6aad","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"d8d928f2.8366e8","order":35,"width":1,"height":1},{"id":"acc55ce9aee242af","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"d8d928f2.8366e8","order":37,"width":1,"height":1},{"id":"03abbb10967771c8","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"d8d928f2.8366e8","order":39,"width":1,"height":1},{"id":"bbea8eea87e214eb","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"d8d928f2.8366e8","order":41,"width":1,"height":1},{"id":"d49ddb2aa716e57b","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"d8d928f2.8366e8","order":42,"width":1,"height":1},{"id":"9b40d000371849b8","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"d8d928f2.8366e8","order":44,"width":1,"height":1},{"id":"9938a257482aed88","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"d8d928f2.8366e8","order":46,"width":1,"height":1},{"id":"fe956e4fac843222","type":"ui_spacer","z":"e905c172.c2ad3","name":"spacer","group":"d8d928f2.8366e8","order":48,"width":1,"height":1},{"id":"96c944296072e97c","type":"ui_spacer","z":"51b720ac.77402","name":"spacer","group":"b6a9e047.708fd","order":57,"width":5,"height":1},{"id":"dacdd9f4b4ce8dbc","type":"ui_spacer","z":"ed569869.819098","name":"spacer","group":"1205d101.95d59f","order":8,"width":1,"height":1},{"id":"487c5e7bfbf0d86e","type":"ui_spacer","z":"ed569869.819098","name":"spacer","group":"1205d101.95d59f","order":11,"width":2,"height":1},{"id":"19c18ae5a781e285","type":"ui_spacer","z":"ed569869.819098","name":"spacer","group":"1205d101.95d59f","order":13,"width":1,"height":1},{"id":"51c43e88932205fa","type":"ui_spacer","z":"ed569869.819098","name":"spacer","group":"1205d101.95d59f","order":15,"width":1,"height":1},{"id":"50f8cbee23b46690","type":"ui_spacer","z":"ed569869.819098","name":"spacer","group":"1205d101.95d59f","order":18,"width":2,"height":1},{"id":"debbcf42244d1a5f","type":"ui_spacer","z":"ed569869.819098","name":"spacer","group":"1205d101.95d59f","order":20,"width":1,"height":1},{"id":"c946d54abe25d77f","type":"ui_spacer","z":"ed569869.819098","name":"spacer","group":"1205d101.95d59f","order":22,"width":1,"height":1},{"id":"501103c6a1341317","type":"ui_spacer","z":"ed569869.819098","name":"spacer","group":"1205d101.95d59f","order":25,"width":2,"height":1},{"id":"d6f9f8c31a98e2cf","type":"ui_spacer","z":"ed569869.819098","name":"spacer","group":"1205d101.95d59f","order":27,"width":1,"height":1},{"id":"18ea3eff3e9b9c3e","type":"ui_spacer","z":"ed569869.819098","name":"spacer","group":"1205d101.95d59f","order":29,"width":1,"height":1},{"id":"05e2dd34508ded3f","type":"ui_spacer","z":"ed569869.819098","name":"spacer","group":"1205d101.95d59f","order":32,"width":2,"height":1},{"id":"203fc98cef22cbf9","type":"ui_spacer","z":"ed569869.819098","name":"spacer","group":"1205d101.95d59f","order":34,"width":1,"height":1},{"id":"c4f3521362cc7763","type":"ui_spacer","z":"ed569869.819098","name":"spacer","group":"1205d101.95d59f","order":36,"width":1,"height":1},{"id":"946af66ac1ee99f1","type":"ui_spacer","z":"ed569869.819098","name":"spacer","group":"1205d101.95d59f","order":38,"width":2,"height":1},{"id":"c5e5bd5be7bcd621","type":"ui_spacer","z":"ed569869.819098","name":"spacer","group":"1205d101.95d59f","order":40,"width":1,"height":1},{"id":"563788aa811d45ae","type":"ui_spacer","z":"ed569869.819098","name":"spacer","group":"1205d101.95d59f","order":42,"width":1,"height":1},{"id":"11f885f6b9e8e029","type":"ui_spacer","z":"ed569869.819098","name":"spacer","group":"1205d101.95d59f","order":46,"width":1,"height":1},{"id":"a9c98f7402b4d462","type":"ui_spacer","z":"ed569869.819098","name":"spacer","group":"1205d101.95d59f","order":48,"width":1,"height":1},{"id":"8a30f483.8b1bd8","type":"ui_text","z":"e905c172.c2ad3","group":"94c422bc.34142","order":2,"width":6,"height":1,"name":"","label":"Usuario","format":"{{msg.payload}}","layout":"row-center","className":"text-purple","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#46408a","x":1200,"y":220,"wires":[]},{"id":"d4b3dd6e.0c8cc","type":"ui_text","z":"e905c172.c2ad3","group":"94c422bc.34142","order":3,"width":6,"height":1,"name":"Role","label":"","format":"{{msg.payload}}","layout":"row-center","className":"text-blue","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#00abe5","x":1870,"y":220,"wires":[]},{"id":"93555d9c.1960a","type":"ui_button","z":"e905c172.c2ad3","name":"","group":"94c422bc.34142","order":13,"width":7,"height":2,"passthru":false,"label":"Proceso Estándar","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":1210,"y":460,"wires":[["96804535.134a58","4363b012.aa9d1","9d1f75f5a581de49"]]},{"id":"9f81fbb1.2f2f28","type":"ui_button","z":"e905c172.c2ad3","name":"","group":"94c422bc.34142","order":14,"width":6,"height":2,"passthru":false,"label":"Definido por el usuario","tooltip":"","color":"","bgcolor":"#46408A","className":"left_menu_button_purple","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":1780,"y":480,"wires":[["1858ae0e.c6edd2","1414c176321bd7e7"]]},{"id":"96804535.134a58","type":"change","z":"e905c172.c2ad3","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"Standard_process_tab\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":1200,"y":520,"wires":[["88374702.e5c2f8"]]},{"id":"88374702.e5c2f8","type":"ui_ui_control","z":"e905c172.c2ad3","name":"","events":"all","x":1200,"y":580,"wires":[[]]},{"id":"1858ae0e.c6edd2","type":"change","z":"e905c172.c2ad3","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"Personalized_process_tab\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":1770,"y":540,"wires":[["11faa504.180dcb"]]},{"id":"11faa504.180dcb","type":"ui_ui_control","z":"e905c172.c2ad3","name":"","events":"all","x":1770,"y":600,"wires":[[]]},{"id":"7a30cae7.ab59a4","type":"ui_button","z":"e905c172.c2ad3","name":"","group":"94c422bc.34142","order":6,"width":5,"height":1,"passthru":false,"label":"Principal","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":340,"y":280,"wires":[["8a7cc2e8.d1627"]]},{"id":"bf4345a9.52fc18","type":"ui_button","z":"e905c172.c2ad3","name":"","group":"94c422bc.34142","order":7,"width":5,"height":1,"passthru":false,"label":"Graficas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":340,"y":360,"wires":[["ad7e18e8.73ced8"]]},{"id":"34d1a9e4.0fb6c6","type":"ui_button","z":"e905c172.c2ad3","name":"","group":"94c422bc.34142","order":9,"width":5,"height":1,"passthru":false,"label":"Recetas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":340,"y":480,"wires":[["54d887cc.872308","65ff065c.9d0ec8"]]},{"id":"d28a64b2.5f1008","type":"ui_button","z":"e905c172.c2ad3","name":"","group":"94c422bc.34142","order":10,"width":5,"height":1,"passthru":false,"label":"Configuración","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":360,"y":700,"wires":[["f31ed907.78aeb8"]]},{"id":"bc069dc.2beeb6","type":"ui_button","z":"e905c172.c2ad3","name":"","group":"94c422bc.34142","order":11,"width":5,"height":2,"passthru":false,"label":"Parada de emergencia","tooltip":"","color":"","bgcolor":"","className":"button_emergency","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":380,"y":800,"wires":[["1073878b.735758","43b09494.37e1ec","b5abf65788b39529"]]},{"id":"ad7e18e8.73ced8","type":"change","z":"e905c172.c2ad3","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"Graphics_tab\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":580,"y":360,"wires":[["7524569b.ec4f78"]]},{"id":"7524569b.ec4f78","type":"ui_ui_control","z":"e905c172.c2ad3","name":"","events":"all","x":760,"y":360,"wires":[[]]},{"id":"54d887cc.872308","type":"change","z":"e905c172.c2ad3","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"Data_personalized_tab\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":580,"y":480,"wires":[["6ee2af5.24beb5"]]},{"id":"6ee2af5.24beb5","type":"ui_ui_control","z":"e905c172.c2ad3","name":"","events":"all","x":760,"y":480,"wires":[[]]},{"id":"43b09494.37e1ec","type":"change","z":"e905c172.c2ad3","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"Start_tab\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":680,"y":840,"wires":[["65111773.deb0a8"]]},{"id":"65111773.deb0a8","type":"ui_ui_control","z":"e905c172.c2ad3","name":"","events":"all","x":880,"y":840,"wires":[[]]},{"id":"1073878b.735758","type":"function","z":"e905c172.c2ad3","name":"Stop Cronometer","func":"global.set('running', false);\nmsg.payload = 'stopped';\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":690,"y":800,"wires":[[]]},{"id":"f31ed907.78aeb8","type":"change","z":"e905c172.c2ad3","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"Configuration_tab\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":580,"y":700,"wires":[["d4f8b5b.e77bc48"]]},{"id":"d4f8b5b.e77bc48","type":"ui_ui_control","z":"e905c172.c2ad3","name":"","events":"all","x":760,"y":700,"wires":[[]]},{"id":"8a7cc2e8.d1627","type":"function","z":"e905c172.c2ad3","name":"Consulta global.running","func":"var running = global.get('running') || false;\nvar process = global.get('process') || false;\n\nif (running === true) {\n    if (process === \"Estandar\"){\n        return { payload: { tab: 'ON_standard_process_tab' } };\n    }\n    else if (process === \"Personalizado\"){\n        return { payload: { tab: 'ON_personalized_process_tab' } };    \n    }\n} else {\n    return { payload: { tab: 'Start_tab' } };\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":610,"y":280,"wires":[["83cd9a0a.795268"]]},{"id":"83cd9a0a.795268","type":"ui_ui_control","z":"e905c172.c2ad3","name":"Redirigir a pestaña","events":"all","x":850,"y":280,"wires":[[]]},{"id":"4363b012.aa9d1","type":"link out","z":"e905c172.c2ad3","name":"Proceso estandar is pressed","links":[],"x":1395,"y":460,"wires":[]},{"id":"c2cc0a27.e8edd8","type":"ui_template","z":"e905c172.c2ad3","group":"94c422bc.34142","name":"CSS","order":4,"width":1,"height":1,"format":"<style>\n.button_emergency button {\n    background-color: #00ABE5 !important;\n    color: white !important;\n    font-size: 17px; \n    font-weight: bold;\n    font-family: \"Trebuchet MS\", sans-serif;\n}\n.Label_tipo{\n    padding-top: 0px !important;\n    font-weight: bold !important;\n    font-family: \"Trebuchet MS\", sans-serif  !important; \n    font-size: 20px !important;\n    color: #46408A !important;\n}\n.Label_tipo_up{\n    font-size: 22px !important;\n    font-weight: bold !important;\n}\n.subprocesos{\n    font-family: \"Trebuchet MS\", sans-serif;\n    font-weight: bold;\n    font-size: 22px !important;\n    color: #00ABE5 !important;\n}\n.subprocesos .label{\n    color: #46408A !important;\n    font-size: 18px !important;\n}\n.green_button button {\n    background-color: #8adf9d !important;\n    color: white !important;\n    font-size: 17px; \n    font-weight: bold;\n    font-family: \"Trebuchet MS\", sans-serif;\n}\n.red_button button{\n    background-color: #cd6a6a !important;\n    color: white !important;\n    font-size: 17px; \n    font-weight: bold;\n    font-family: \"Trebuchet MS\", sans-serif;\n}\n.left_menu_button button {\n    background-color: #00ABE5 !important;\n    color: white !important;\n    font-size: 17px; \n    font-weight: bold;\n    font-family: \"Trebuchet MS\", sans-serif;\n}\n.left_menu_button_purple button {\n    background-color: #46408A !important;\n    color: white !important;\n    font-size: 17px; \n    font-weight: bold;\n    font-family: \"Trebuchet MS\", sans-serif;\n}\n.Dropdown{\n    font-family: \"Trebuchet MS\", sans-serif;\n    font-weight: bold;\n    font-size: 22px !important;\n    color: #46408A !important;\n}\nmd-select-value {\n\n}\n.unidades{\n    color: #B0B6BD !important;\n    font-family: \"Trebuchet MS\", sans-serif;\n    font-weight: bold;\n    font-size: 15px !important;\n}\n.unidades .label{\n    margin-top: -28px !important;\n}\n.sensor_value{\n    font-family: \"Trebuchet MS\", sans-serif  !important;\n    font-weight: bold;\n    font-size: 28px !important;\n    color: #00ABE5 !important;\n}\n.sensor_value .label{\n    color: #46408A !important;\n    font-size: 20px !important;\n}\n.Label_proceso_estandar {\n    background-color: #00ABE5 !important;\n    color: white !important;\n}\n.input_text input {\n    background-color: #46408A !important;\n    border-radius: 20px;\n    color: white !important;\n    height: 35px;\n    margin-bottom: 40px;\n}\n.input_text_user input {\n    background-color: #46408A !important;\n    border-radius: 20px;\n    color: white !important;\n    height: 35px;\n}\n.menu_gris{\n    color: #B0B6BD !important;\n    font-size: 25px; \n    font-family: \"Trebuchet MS\", sans-serif;\n}\n.text-purple{\n    color: #46408A !important;\n    font-size: 25px; \n    font-family: \"Trebuchet MS\", sans-serif;\n}\n.text-blue{\n    color: #00ABE5 !important;\n    font-size: 25px; \n    font-family: \"Trebuchet MS\", sans-serif;\n}\n</style>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"global","className":"","x":330,"y":220,"wires":[[]]},{"id":"e7ec69f6.6c4c48","type":"link in","z":"e905c172.c2ad3","name":"Button principal","links":[],"x":295,"y":320,"wires":[["8a7cc2e8.d1627"]]},{"id":"ef89de6e.695c9","type":"link in","z":"e905c172.c2ad3","name":"Button estadisticas","links":[],"x":295,"y":400,"wires":[["ad7e18e8.73ced8","9f01d135.86806"]]},{"id":"abcba878.d3c218","type":"link in","z":"e905c172.c2ad3","name":"Button recetas","links":[],"x":295,"y":520,"wires":[["54d887cc.872308","65ff065c.9d0ec8"]]},{"id":"4d2c6e56.3e18c","type":"link in","z":"e905c172.c2ad3","name":"Button configuracion","links":[],"x":295,"y":740,"wires":[["f31ed907.78aeb8"]]},{"id":"3dd45a68.e00f56","type":"link in","z":"e905c172.c2ad3","name":"Button parada de emergencia","links":[],"x":295,"y":840,"wires":[["1073878b.735758","43b09494.37e1ec"]]},{"id":"e3abab5e.115858","type":"change","z":"e905c172.c2ad3","name":"Pruebas","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"Pruebas\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":660,"y":880,"wires":[["8c35d5b7.30b138"]]},{"id":"8c35d5b7.30b138","type":"ui_ui_control","z":"e905c172.c2ad3","name":"","events":"all","x":880,"y":880,"wires":[[]]},{"id":"9f01d135.86806","type":"link out","z":"e905c172.c2ad3","name":"Boton estadisicas is pressed","links":[],"x":515,"y":400,"wires":[]},{"id":"d3fc97ea.757808","type":"comment","z":"e905c172.c2ad3","name":"Seleccionar torre 1 por defecto","info":"","x":1510,"y":420,"wires":[]},{"id":"5e7dc0f9.86edc","type":"ui_button","z":"e905c172.c2ad3","name":"","group":"94c422bc.34142","order":8,"width":5,"height":1,"passthru":false,"label":"Curvas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":340,"y":600,"wires":[["1c814aef.8e2465","e218a0ca.3194"]]},{"id":"1c814aef.8e2465","type":"change","z":"e905c172.c2ad3","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"Waves_tab\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":580,"y":600,"wires":[["33e37ee3.0bc792"]]},{"id":"33e37ee3.0bc792","type":"ui_ui_control","z":"e905c172.c2ad3","name":"","events":"all","x":760,"y":600,"wires":[[]]},{"id":"9fc5e761.afc3b8","type":"link in","z":"e905c172.c2ad3","name":"Button curvas","links":[],"x":295,"y":640,"wires":[["1c814aef.8e2465","e218a0ca.3194"]]},{"id":"2ccc533.e6931ac","type":"function","z":"e905c172.c2ad3","name":"Check userRole","func":"let role = global.get(\"userRole\");\n\nif (role === \"admin\") {\n    msg.payload = \"Administrador\"\n    return msg;  // Allow access for admin\n} else {\n    msg.payload = \"Operador\"\n    return msg;  // Allow access for admin\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1680,"y":220,"wires":[["d4b3dd6e.0c8cc"]]},{"id":"eec9ac75.db985","type":"inject","z":"e905c172.c2ad3","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1490,"y":220,"wires":[["2ccc533.e6931ac"]]},{"id":"2d506b83.7d9984","type":"link in","z":"e905c172.c2ad3","name":"Validar role","links":[],"x":1535,"y":260,"wires":[["2ccc533.e6931ac"]]},{"id":"65ff065c.9d0ec8","type":"link out","z":"e905c172.c2ad3","name":"Boton datos personalizados is pressed","links":[],"x":515,"y":520,"wires":[]},{"id":"e218a0ca.3194","type":"link out","z":"e905c172.c2ad3","name":"Boton curvas personalizados is pressed","links":[],"x":515,"y":640,"wires":[]},{"id":"e36dabfd3f730863","type":"ui_media","z":"e905c172.c2ad3","group":"94c422bc.34142","name":"","width":13,"height":8,"order":5,"category":"foto","file":"cafe 1.png","layout":"adjust","showcontrols":true,"loop":true,"onstart":false,"scope":"local","tooltip":"","x":330,"y":140,"wires":[[]]},{"id":"e474546b42327979","type":"ui_media","z":"e905c172.c2ad3","group":"94c422bc.34142","name":"","width":5,"height":2,"order":1,"category":"foto","file":"logo-2.png","layout":"adjust","showcontrols":true,"loop":true,"onstart":false,"scope":"local","tooltip":"","x":330,"y":180,"wires":[[]]},{"id":"996b87df9a6c90c3","type":"ui_media","z":"e905c172.c2ad3","group":"94c422bc.34142","name":"","width":5,"height":2,"order":12,"category":"foto","file":"4.png","layout":"adjust","showcontrols":true,"loop":true,"onstart":false,"scope":"local","tooltip":"","x":330,"y":100,"wires":[[]]},{"id":"1663f3d4abcae1a9","type":"ui_media","z":"e905c172.c2ad3","group":"6896531b.8e06bc","name":"ACIV","width":5,"height":2,"order":35,"category":"foto","file":"4.png","layout":"adjust","showcontrols":true,"loop":true,"onstart":false,"scope":"local","tooltip":"","x":490,"y":100,"wires":[[]]},{"id":"d71ab07aad0caa38","type":"ui_media","z":"e905c172.c2ad3","group":"6896531b.8e06bc","name":"PENAGOS","width":5,"height":3,"order":1,"category":"foto","file":"logo-2.png","layout":"adjust","showcontrols":true,"loop":true,"onstart":false,"scope":"local","tooltip":"","x":510,"y":140,"wires":[[]]},{"id":"19b88c3e54c7741e","type":"ui_media","z":"e905c172.c2ad3","group":"510760cb.f75bc","name":"ACIV","width":5,"height":2,"order":54,"category":"foto","file":"4.png","layout":"adjust","showcontrols":true,"loop":true,"onstart":false,"scope":"local","tooltip":"","x":490,"y":180,"wires":[[]]},{"id":"afc2da2f6519e037","type":"ui_media","z":"e905c172.c2ad3","group":"510760cb.f75bc","name":"PENAGOS","width":5,"height":3,"order":1,"category":"foto","file":"logo-2.png","layout":"adjust","showcontrols":true,"loop":true,"onstart":false,"scope":"local","tooltip":"","x":510,"y":220,"wires":[[]]},{"id":"93ba3c3a6b7b2fd0","type":"ui_media","z":"e905c172.c2ad3","group":"1205d101.95d59f","name":"ACIV","width":5,"height":2,"order":44,"category":"foto","file":"4.png","layout":"adjust","showcontrols":true,"loop":true,"onstart":false,"scope":"local","tooltip":"","x":690,"y":100,"wires":[[]]},{"id":"9d1f75f5a581de49","type":"function","z":"e905c172.c2ad3","name":"Inicio estandar logs","func":"let ahora = new Date();\nlet fecha = ahora.toISOString().replace(/:/g, \"-\").slice(0, 19);\n// Ejemplo: 2025-11-12T19-25-01\n\nlet ruta = \"/home/aciv/cafe_logs/estandar_\" + fecha + \".csv\";\n\nflow.set(\"grabando\", true);        // empezamos a grabar\nflow.set(\"tipo_proceso\", \"E\");     // E = Estándar\nflow.set(\"filename_actual\", ruta); // archivo donde se guardará\n\nnode.status({fill:\"green\", shape:\"dot\", text:\"Grabando estándar\"});\nreturn msg;  // por si quieres que el mensaje siga viajando (si no, puedes usar return null;)\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1450,"y":520,"wires":[[]]},{"id":"1414c176321bd7e7","type":"function","z":"e905c172.c2ad3","name":"Inicio definido por el ususario","func":"let ahora = new Date();\nlet fecha = ahora.toISOString().replace(/:/g, \"-\").slice(0, 19);\n\nlet ruta = \"/home/aciv/cafe_logs/personalizado_\" + fecha + \".csv\";\n\nflow.set(\"grabando\", true);\nflow.set(\"tipo_proceso\", \"P\");     // P = Personalizado\nflow.set(\"filename_actual\", ruta);\n\nnode.status({fill:\"green\", shape:\"dot\", text:\"Grabando personalizado\"});\nreturn msg;\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2060,"y":520,"wires":[[]]},{"id":"b5abf65788b39529","type":"function","z":"e905c172.c2ad3","name":"fin del proceso log","func":"flow.set(\"grabando\", false);\nnode.status({fill:\"red\", shape:\"ring\", text:\"Grabación detenida\"});\nreturn null;\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":570,"y":940,"wires":[[]]},{"id":"bafeb0a8.e4222","type":"ui_text","z":"ed569869.819098","group":"1205d101.95d59f","order":2,"width":7,"height":1,"name":"","label":"Usuario:","format":"{{msg.payload}}","layout":"row-center","className":"text-purple","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#46408a","x":980,"y":40,"wires":[]},{"id":"f3a8d7d1.027378","type":"ui_text","z":"ed569869.819098","group":"1205d101.95d59f","order":3,"width":6,"height":1,"name":"Role","label":"","format":"{{msg.payload}}","layout":"row-center","className":"text-blue","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#00abe5","x":1690,"y":40,"wires":[]},{"id":"16b1fcc0.b8cca3","type":"ui_button","z":"ed569869.819098","name":"","group":"1205d101.95d59f","order":47,"width":6,"height":2,"passthru":false,"label":"Cancelar proceso","tooltip":"","color":"","bgcolor":"#cd6a6a","className":"red_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":270,"y":960,"wires":[["77de8188.a5b66"]]},{"id":"a561ee81.4c0cd","type":"ui_button","z":"ed569869.819098","name":"","group":"1205d101.95d59f","order":45,"width":6,"height":2,"passthru":false,"label":"Siguiente","tooltip":"","color":"","bgcolor":"#8adf9d","className":"green_button","icon":"","payload":"Estandar","payloadType":"str","topic":"","topicType":"str","x":240,"y":680,"wires":[["a592496c.24c5d8","e3a2318a.23a01","da1d6240.fa45c","63ffacd8.33db04"]]},{"id":"77de8188.a5b66","type":"change","z":"ed569869.819098","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"Start_tab\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":460,"y":960,"wires":[["343679cd.dec886"]]},{"id":"343679cd.dec886","type":"ui_ui_control","z":"ed569869.819098","name":"","events":"all","x":620,"y":960,"wires":[[]]},{"id":"7421cc70.1e09d4","type":"ui_ui_control","z":"ed569869.819098","name":"","events":"all","x":720,"y":820,"wires":[[]]},{"id":"febb6b7d.5b4228","type":"ui_text","z":"ed569869.819098","group":"1205d101.95d59f","order":4,"width":13,"height":2,"name":"","label":"Proceso estándar","format":"Configuración del proceso","layout":"col-center","className":"Label_proceso_estandar","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"30","color":"#b0b6bd","x":1110,"y":100,"wires":[]},{"id":"82b13c10.d50ba","type":"ui_text","z":"ed569869.819098","group":"1205d101.95d59f","order":12,"width":3,"height":1,"name":"","label":"Pre Secado","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"22","color":"#464080","x":910,"y":160,"wires":[]},{"id":"573d3c57.176cf4","type":"ui_text","z":"ed569869.819098","group":"1205d101.95d59f","order":14,"width":3,"height":1,"name":"","label":"Oreado","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"22","color":"#464080","x":1100,"y":160,"wires":[]},{"id":"5534a302.1c5e7c","type":"ui_text","z":"ed569869.819098","group":"1205d101.95d59f","order":16,"width":3,"height":1,"name":"","label":"Punto Final","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"22","color":"#464080","x":1330,"y":160,"wires":[]},{"id":"87d3070c.2d5f88","type":"ui_text","z":"ed569869.819098","group":"1205d101.95d59f","order":19,"width":3,"height":1,"name":"","label":"Temperatura","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#46408a","x":910,"y":200,"wires":[]},{"id":"78232b56.11a8e4","type":"ui_text","z":"ed569869.819098","group":"1205d101.95d59f","order":21,"width":3,"height":1,"name":"","label":"Temperatura","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#46408a","x":1110,"y":200,"wires":[]},{"id":"3520a796.6cc7a8","type":"ui_text","z":"ed569869.819098","group":"1205d101.95d59f","order":23,"width":3,"height":1,"name":"","label":"Temperatura","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#46408a","x":1330,"y":200,"wires":[]},{"id":"41b1d572.46c11c","type":"ui_text_input","z":"ed569869.819098","name":"text1","label":"","tooltip":"Ingresar en °C","group":"1205d101.95d59f","order":26,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"val1","sendOnBlur":true,"className":"input_text","topicType":"str","x":890,"y":240,"wires":[["37593acc.5a6b86","af21244640c57eff"]]},{"id":"ad8feeec.89049","type":"ui_text_input","z":"ed569869.819098","name":"text3","label":"","tooltip":"Ingresar en °C","group":"1205d101.95d59f","order":30,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"val3","sendOnBlur":true,"className":"input_text","topicType":"msg","x":1090,"y":240,"wires":[["e612c242.1073c","df186f9fdd89c3ba"]]},{"id":"77d3a938.63f588","type":"ui_text_input","z":"ed569869.819098","name":"text5","label":"","tooltip":"Ingresar en °C","group":"1205d101.95d59f","order":41,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"val5","sendOnBlur":true,"className":"input_text","topicType":"msg","x":1310,"y":240,"wires":[["cb628822.f4d1a8","11e44d6b516dbfae"]]},{"id":"5132cb17.8c9124","type":"ui_text","z":"ed569869.819098","group":"1205d101.95d59f","order":33,"width":3,"height":1,"name":"","label":"Tiempo","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#46408a","x":900,"y":300,"wires":[]},{"id":"3b4e7c3c.22cc74","type":"ui_text","z":"ed569869.819098","group":"1205d101.95d59f","order":35,"width":3,"height":1,"name":"","label":"Tiempo","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#46408a","x":1100,"y":300,"wires":[]},{"id":"4556665f.107218","type":"ui_text","z":"ed569869.819098","group":"1205d101.95d59f","order":37,"width":3,"height":1,"name":"","label":"Peso","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#46408a","x":1310,"y":300,"wires":[]},{"id":"30b19e9e.22c622","type":"ui_text_input","z":"ed569869.819098","name":"text4","label":"","tooltip":"Ingresar en minutos","group":"1205d101.95d59f","order":39,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"val4","sendOnBlur":true,"className":"input_text","topicType":"msg","x":1090,"y":340,"wires":[["a9200a85.ca8eb8","666119b1883554bd"]]},{"id":"c802617c.03442","type":"ui_text_input","z":"ed569869.819098","name":"text6","label":"","tooltip":"Ingresar en kilogramos","group":"1205d101.95d59f","order":43,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"val6","sendOnBlur":true,"className":"input_text","topicType":"msg","x":1310,"y":340,"wires":[["d8b6a58.56ddb58","1661553cac17cacc"]]},{"id":"d381f456.916db8","type":"ui_text_input","z":"ed569869.819098","name":"text2","label":"","tooltip":"Ingresar en minutos","group":"1205d101.95d59f","order":28,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"val2","sendOnBlur":true,"className":"input_text","topicType":"msg","x":890,"y":340,"wires":[["ed5bc5c8.cfc148","b17ece37825a62db"]]},{"id":"6ccd84ef.2f6adc","type":"ui_button","z":"ed569869.819098","name":"","group":"1205d101.95d59f","order":7,"width":6,"height":1,"passthru":false,"label":"Torre 1","tooltip":"","color":"{{msg.color}}","bgcolor":"{{msg.bgcolor}}","className":"button1","icon":"","payload":"true","payloadType":"bool","topic":"topic","topicType":"msg","x":980,"y":500,"wires":[["b95767ed.11b9c8","c9c6a79c.870138"]]},{"id":"3e5c7502.e2578a","type":"ui_button","z":"ed569869.819098","name":"","group":"1205d101.95d59f","order":9,"width":6,"height":1,"passthru":false,"label":"Torre 2","tooltip":"","color":"{{msg.bgcolor}}","bgcolor":"{{msg.color}}","className":"button2","icon":"","payload":"false","payloadType":"bool","topic":"topic","topicType":"msg","x":980,"y":540,"wires":[["858ae289.94a33","c9c6a79c.870138"]]},{"id":"37593acc.5a6b86","type":"change","z":"ed569869.819098","name":"","rules":[{"t":"set","p":"temp_pre_secado","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1620,"y":140,"wires":[[]]},{"id":"ed5bc5c8.cfc148","type":"change","z":"ed569869.819098","name":"","rules":[{"t":"set","p":"time_pre_secado","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1620,"y":180,"wires":[[]]},{"id":"cb628822.f4d1a8","type":"change","z":"ed569869.819098","name":"","rules":[{"t":"set","p":"temp_final","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1600,"y":300,"wires":[[]]},{"id":"d8b6a58.56ddb58","type":"change","z":"ed569869.819098","name":"","rules":[{"t":"set","p":"time_final","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1600,"y":340,"wires":[[]]},{"id":"e612c242.1073c","type":"change","z":"ed569869.819098","name":"","rules":[{"t":"set","p":"temp_oreado","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":220,"wires":[[]]},{"id":"a9200a85.ca8eb8","type":"change","z":"ed569869.819098","name":"","rules":[{"t":"set","p":"time_oreado","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1600,"y":260,"wires":[[]]},{"id":"b95767ed.11b9c8","type":"change","z":"ed569869.819098","name":"","rules":[{"t":"set","p":"torre","pt":"global","to":"1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1200,"y":500,"wires":[[]]},{"id":"a592496c.24c5d8","type":"change","z":"ed569869.819098","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"ON_standard_process_tab\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":560,"y":820,"wires":[["7421cc70.1e09d4"]]},{"id":"34c6fe50.d2f632","type":"ui_button","z":"ed569869.819098","name":"","group":"1205d101.95d59f","order":5,"width":5,"height":1,"passthru":false,"label":"Principal","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":220,"y":220,"wires":[["aab4de89.e8e79"]]},{"id":"6fd435fd.91c08c","type":"ui_button","z":"ed569869.819098","name":"","group":"1205d101.95d59f","order":6,"width":5,"height":1,"passthru":false,"label":"Graficas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":220,"y":280,"wires":[["d9f151a8.7a6a5"]]},{"id":"95bdbb9d.c8fd88","type":"ui_button","z":"ed569869.819098","name":"","group":"1205d101.95d59f","order":17,"width":5,"height":1,"passthru":false,"label":"Recetas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":220,"y":340,"wires":[["b9bb3c02.428d5"]]},{"id":"23c98fb4.1d2ff","type":"ui_button","z":"ed569869.819098","name":"","group":"1205d101.95d59f","order":24,"width":5,"height":1,"passthru":false,"label":"Configuración","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":240,"y":460,"wires":[["538a5000.05764"]]},{"id":"e873b8bc.273b88","type":"ui_button","z":"ed569869.819098","name":"","group":"1205d101.95d59f","order":31,"width":5,"height":2,"passthru":false,"label":"Parada de emergencia","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":260,"y":580,"wires":[["73d1ea74.2335f4"]]},{"id":"63ffacd8.33db04","type":"function","z":"ed569869.819098","name":"Formato del CSV y nombre del archivo","func":"// OBTENER VARIABLES GLOBALES DE LA RECETA Y COLOCARLOS EN \n// UN FORMATO DE UNA LINEA PARA CSV\nvar timestamp = new Date().toISOString();\nvar process = global.get('process') || 'No value';\nvar temp_pre_secado = global.get('temp_pre_secado') || 'No value';\nvar time_pre_secado = global.get('time_pre_secado') || 'No value';\nvar temp_oreado = global.get('temp_oreado') || 'No value';\nvar time_oreado = global.get('time_oreado') || 'No value';\nvar temp_final = global.get('temp_final') || 'No value';\nvar time_final = global.get('time_final') || 'No value';\nvar torre = global.get('torre') || 'No value';\n\nvar csvLine = process + \", \" + timestamp + \",\" + temp_pre_secado + \",\" + time_pre_secado + \",\" + temp_oreado + \",\" + time_oreado + \",\" + temp_final + \",\" + time_final + \",\" + torre + \"\\n\";\nmsg.payload = csvLine;\n\n//----------------------------------------------------\n\n// DAR FORMATO AL NOMBRE DEL ARCHIVO HORA DE BOGOTA\nlet date = new Date();\n// Convertir a la zona horaria de Bogotá (UTC-5)\nlet options = { timeZone: 'America/Bogota', year: 'numeric', month: '2-digit', day: '2-digit', \n                hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false };\nlet formatter = new Intl.DateTimeFormat('en-GB', options);\nlet parts = formatter.formatToParts(date);\nlet year = parts.find(p => p.type === 'year').value;\nlet month = parts.find(p => p.type === 'month').value;\nlet day = parts.find(p => p.type === 'day').value;\nlet hours = parts.find(p => p.type === 'hour').value;\nlet minutes = parts.find(p => p.type === 'minute').value;\nlet seconds = parts.find(p => p.type === 'second').value;\n// Formato: YYYYMMDD_HHMMSS\nlet formattedDate = `${year}${month}${day}_${hours}${minutes}${seconds}`;\n\n//----------------------------------------------------\n\n//CAMBIAR RUTA DE ALMACENAMIENTO DE LOS CSV\nvar ruta_sd = global.get('ruta_sd') || '';\nlet filename = `${ruta_sd}Estandar_${formattedDate}.csv`;\nglobal.set('filename', filename); // Guardar en flow.filename\nflow.set('csvline', csvLine);\n\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":630,"y":860,"wires":[["2263a521.5f528a","58680540.298f2c","a1f2115c.16ab5"]]},{"id":"2263a521.5f528a","type":"function","z":"ed569869.819098","name":"Obtener nombre del archivo","func":"msg.filename = global.get('filename'); // Obtener el nombre del archivo de flow\nmsg.payload = flow.get('csvline');\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":940,"y":860,"wires":[["991667b1.7b8698"]]},{"id":"991667b1.7b8698","type":"file","z":"ed569869.819098","name":"Guardar datos en CSV","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"false","encoding":"none","x":1260,"y":860,"wires":[[]]},{"id":"28234527.85910a","type":"file","z":"ed569869.819098","name":"Guardar proceso en historial","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"false","encoding":"none","x":1280,"y":920,"wires":[[]]},{"id":"e3a2318a.23a01","type":"change","z":"ed569869.819098","name":"","rules":[{"t":"set","p":"process","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":570,"y":740,"wires":[[]]},{"id":"da1d6240.fa45c","type":"link out","z":"ed569869.819098","name":"Inicio proceso estandar (siguiente is pressed)","links":["1cc0fc98.2b8b03"],"x":495,"y":780,"wires":[]},{"id":"82642537.738178","type":"link in","z":"ed569869.819098","name":"","links":["4363b012.aa9d1"],"x":1475,"y":540,"wires":[["e83ac349.0505d"]]},{"id":"858ae289.94a33","type":"change","z":"ed569869.819098","name":"","rules":[{"t":"set","p":"torre","pt":"global","to":"2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1200,"y":540,"wires":[[]]},{"id":"c9c6a79c.870138","type":"function","z":"ed569869.819098","name":"Intercambiar botones","func":"if (msg.payload === true) {\n    context.set('color', '#46408A');\n    msg.bgcolor = '#46408A';\n    msg.color = 'white';\n    \n} else {\n    context.set('color', 'white');\n    msg.bgcolor = 'white';\n    msg.color = '#46408A';\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1100,"y":440,"wires":[["3e5c7502.e2578a","6ccd84ef.2f6adc"]]},{"id":"e83ac349.0505d","type":"function","z":"ed569869.819098","name":"Activar torre 1 por defecto","func":"let torre = global.get('torre') || 'Error';\n\n\nif (torre === \"2\"){\n    msg.payload = null;\n}\nelse {\n    msg.payload = true\n}\n\nreturn msg","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1550,"y":460,"wires":[["b95767ed.11b9c8","c9c6a79c.870138"]]},{"id":"58680540.298f2c","type":"function","z":"ed569869.819098","name":"Formatear para el historial","func":"let filename_proceso_a_guardar = global.get('filename'); // Obtener el nombre del archivo de flow\nmsg.payload = filename_proceso_a_guardar\n\nlet ruta_sd = global.get('ruta_sd');\nruta_sd = `${ruta_sd}historial_procesos.csv`;\nmsg.filename = ruta_sd\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":930,"y":920,"wires":[["28234527.85910a"]]},{"id":"aab4de89.e8e79","type":"link out","z":"ed569869.819098","name":"Button principal","links":["e7ec69f6.6c4c48"],"x":415,"y":220,"wires":[]},{"id":"d9f151a8.7a6a5","type":"link out","z":"ed569869.819098","name":"Button estadisticas","links":["ef89de6e.695c9"],"x":415,"y":280,"wires":[]},{"id":"b9bb3c02.428d5","type":"link out","z":"ed569869.819098","name":"Button datos","links":["abcba878.d3c218"],"x":415,"y":340,"wires":[]},{"id":"73d1ea74.2335f4","type":"link out","z":"ed569869.819098","name":"Button parada de emergencia","links":["3dd45a68.e00f56","a6986a2a.897e78"],"x":415,"y":580,"wires":[]},{"id":"978dbb43.ee8208","type":"comment","z":"ed569869.819098","name":"Iniciar cronometro","info":"","x":270,"y":780,"wires":[]},{"id":"6e638772.9303c8","type":"comment","z":"ed569869.819098","name":"Cambiar tab","info":"","x":250,"y":820,"wires":[]},{"id":"5f699a6b.cc5854","type":"comment","z":"ed569869.819098","name":"Guardado de historial y de receta","info":"","x":310,"y":860,"wires":[]},{"id":"863c476e.e64978","type":"comment","z":"ed569869.819098","name":"Global.process = Estandar","info":"","x":290,"y":740,"wires":[]},{"id":"ef1f45e5.864e88","type":"file","z":"ed569869.819098","name":"Guardar proceso en historial","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"false","encoding":"none","x":1280,"y":980,"wires":[[]]},{"id":"a1f2115c.16ab5","type":"function","z":"ed569869.819098","name":"Formatear para el historial de estandar","func":"let filename_proceso_a_guardar = global.get('filename'); // Obtener el nombre del archivo de flow\nmsg.payload = filename_proceso_a_guardar\n\nlet ruta_sd = global.get('ruta_sd');\nruta_sd = `${ruta_sd}historial_procesos_estandar.csv`;\nmsg.filename = ruta_sd\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":970,"y":980,"wires":[["ef1f45e5.864e88"]]},{"id":"538a5000.05764","type":"link out","z":"ed569869.819098","name":"Button configuracion","links":["4d2c6e56.3e18c"],"x":415,"y":460,"wires":[]},{"id":"8b1c688f.1c2fd8","type":"link out","z":"ed569869.819098","name":"Button curvas","links":["9fc5e761.afc3b8"],"x":415,"y":400,"wires":[]},{"id":"ae09739f.45927","type":"ui_button","z":"ed569869.819098","name":"","group":"1205d101.95d59f","order":10,"width":5,"height":1,"passthru":false,"label":"Curvas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":220,"y":400,"wires":[["8b1c688f.1c2fd8"]]},{"id":"4f872040.119da","type":"link in","z":"ed569869.819098","name":"","links":[],"x":655,"y":140,"wires":[["41b1d572.46c11c"]]},{"id":"d0c751a1.74caf","type":"link in","z":"ed569869.819098","name":"","links":[],"x":655,"y":180,"wires":[["d381f456.916db8"]]},{"id":"61050dfd.2962d4","type":"link in","z":"ed569869.819098","name":"","links":[],"x":655,"y":220,"wires":[["ad8feeec.89049"]]},{"id":"c4bff6eb.372498","type":"link in","z":"ed569869.819098","name":"","links":[],"x":655,"y":260,"wires":[["30b19e9e.22c622"]]},{"id":"ab3ba81d.56c818","type":"link in","z":"ed569869.819098","name":"","links":[],"x":655,"y":300,"wires":[["77d3a938.63f588"]]},{"id":"551a2875.e768a8","type":"link in","z":"ed569869.819098","name":"","links":[],"x":655,"y":340,"wires":[["c802617c.03442"]]},{"id":"829ee282.8bea8","type":"function","z":"ed569869.819098","name":"Check userRole","func":"let role = global.get(\"userRole\");\n\nif (role === \"admin\") {\n    msg.payload = \"Administrador\"\n    return msg;  // Allow access for admin\n} else {\n    msg.payload = \"Operador\"\n    return msg;  // Allow access for admin\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1520,"y":40,"wires":[["f3a8d7d1.027378"]]},{"id":"2ee18303.2fd9fc","type":"inject","z":"ed569869.819098","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1330,"y":40,"wires":[["829ee282.8bea8"]]},{"id":"73ffb3bf.8d085c","type":"link in","z":"ed569869.819098","name":"Validar role","links":[],"x":1375,"y":80,"wires":[["829ee282.8bea8"]]},{"id":"16c8d5d7.242eda","type":"comment","z":"ed569869.819098","name":"Variables proceso estandar exportadas al plc","info":"","x":2050,"y":40,"wires":[]},{"id":"f203d14c.124d4","type":"function","z":"ed569869.819098","name":"exportar torre 1","func":"var torre = global.get('torre') || \"1\";\n\n// Enviar true inmediatamente\nif (torre === \"1\") {\n    msg.payload = true;\n    node.send(msg); // Enviar el primer mensaje con true\n} else {\n    msg.payload = false;\n    node.send(msg); // Enviar el primer mensaje con false\n}\n\n// Configurar un temporizador para enviar false después de 1 segundo si torre es \"1\"\nsetTimeout(() => {\n    msg.payload = false; // Enviar false\n    node.send(msg);\n}, 1000);\n\n// Retornar null para evitar el retorno inmediato del mensaje\nreturn null;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2060,"y":460,"wires":[["45cef42ffb6aab99"]]},{"id":"1cc0fc98.2b8b03","type":"link in","z":"ed569869.819098","name":"exportar torre seleccionada proceso estandar","links":["da1d6240.fa45c"],"x":1875,"y":540,"wires":[["f203d14c.124d4","847ce4d5.faffe8","a06d7b0f.9906c8"]]},{"id":"847ce4d5.faffe8","type":"function","z":"ed569869.819098","name":"exportar torre 2","func":"var torre = global.get('torre') || \"1\";\n\n// Enviar true inmediatamente\nif (torre === \"2\") {\n    msg.payload = true;\n    node.send(msg); // Enviar el primer mensaje con true\n} else {\n    msg.payload = false;\n    node.send(msg); // Enviar el primer mensaje con false\n}\n\n// Configurar un temporizador para enviar false después de 1 segundo si torre es \"1\"\nsetTimeout(() => {\n    msg.payload = false; // Enviar false\n    node.send(msg);\n}, 1000);\n\n// Retornar null para evitar el retorno inmediato del mensaje\nreturn null;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":2060,"y":520,"wires":[["fb073eec1a892ca7"]]},{"id":"a06d7b0f.9906c8","type":"function","z":"ed569869.819098","name":"Enviar true","func":"// Enviar true inmediatamente\nmsg.payload = true;\nnode.send(msg);\n\n// Configurar un temporizador para enviar false después de 1 segundo\nsetTimeout(() => {\n    msg.payload = false;\n    node.send(msg);\n}, 1000);\n\n// Retornar null para que no envíe el mensaje inmediatamente\nreturn null;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":2050,"y":580,"wires":[["e8f0713c86f20887","8fcc7361954af274","3609ef8b66bfc84c"]]},{"id":"f0d3a2c5.587b9","type":"link in","z":"ed569869.819098","name":"","links":[],"x":2655,"y":520,"wires":[[]]},{"id":"a6986a2a.897e78","type":"link in","z":"ed569869.819098","name":"Button parada de emergencia PROCESO ESTANDAR","links":["73d1ea74.2335f4"],"x":2655,"y":460,"wires":[["15ea3a88.2dc885","bba69811.ed7b68"]]},{"id":"15ea3a88.2dc885","type":"function","z":"ed569869.819098","name":"Enviar true","func":"// Enviar true inmediatamente\nmsg.payload = true;\nnode.send(msg);\n\n// Configurar un temporizador para enviar false después de 1 segundo\nsetTimeout(() => {\n    msg.payload = false;\n    node.send(msg);\n}, 1000);\n\n// Retornar null para que no envíe el mensaje inmediatamente\nreturn null;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2830,"y":460,"wires":[[]]},{"id":"bba69811.ed7b68","type":"link out","z":"ed569869.819098","name":"","links":["3dd45a68.e00f56"],"x":2875,"y":340,"wires":[]},{"id":"1d314967.de48a7","type":"comment","z":"ed569869.819098","name":"siguiente PROCESO ESTANDAR","info":"","x":1930,"y":640,"wires":[]},{"id":"aae60819.382e38","type":"comment","z":"ed569869.819098","name":"boton emergencia MENU INICIO","info":"","x":2990,"y":300,"wires":[]},{"id":"e18602ac.c0aa2","type":"comment","z":"ed569869.819098","name":"Proceso finalizado PLC X2 y todos los botones de parada de emergencia","info":"","x":2900,"y":420,"wires":[]},{"id":"e894025f36a24642","type":"OpcUa-Client","z":"ed569869.819098","endpoint":"9d8e083238bd6420","action":"write","deadbandtype":"a","deadbandvalue":1,"time":10,"timeUnit":"s","certificate":"n","localfile":"","localkeyfile":"","securitymode":"None","securitypolicy":"None","useTransport":false,"maxChunkCount":1,"maxMessageSize":8192,"receiveBufferSize":8192,"sendBufferSize":8192,"setstatusandtime":false,"keepsessionalive":false,"name":"","x":2620,"y":220,"wires":[[],[],[]]},{"id":"af21244640c57eff","type":"OpcUa-Item","z":"ed569869.819098","item":"ns=3;s=TEMPERATURAPRESECADO","datatype":"Float","value":"","name":"","x":1940,"y":80,"wires":[["e894025f36a24642"]]},{"id":"df186f9fdd89c3ba","type":"OpcUa-Item","z":"ed569869.819098","item":"ns=3;s=TEMPERATURAOREADO","datatype":"Float","value":"","name":"","x":1940,"y":140,"wires":[["e894025f36a24642"]]},{"id":"11e44d6b516dbfae","type":"OpcUa-Item","z":"ed569869.819098","item":"ns=3;s=TEMPERATURAPUNTOFINAL","datatype":"Float","value":"","name":"","x":1940,"y":200,"wires":[["e894025f36a24642"]]},{"id":"b17ece37825a62db","type":"OpcUa-Item","z":"ed569869.819098","item":"ns=3;s=TIEMPOPRESECADO","datatype":"Float","value":"","name":"","x":1940,"y":280,"wires":[["e894025f36a24642"]]},{"id":"666119b1883554bd","type":"OpcUa-Item","z":"ed569869.819098","item":"ns=3;s=TIEMPOOREADO","datatype":"Float","value":"","name":"","x":1940,"y":340,"wires":[["e894025f36a24642"]]},{"id":"1661553cac17cacc","type":"OpcUa-Item","z":"ed569869.819098","item":"ns=3;s=STR_PESO","datatype":"Float","value":"","name":"","x":1940,"y":400,"wires":[["e894025f36a24642"]]},{"id":"45cef42ffb6aab99","type":"OpcUa-Item","z":"ed569869.819098","item":"ns=3;s=SELEC_TOLVA_1","datatype":"Boolean","value":"","name":"","x":2260,"y":460,"wires":[["e894025f36a24642"]]},{"id":"fb073eec1a892ca7","type":"OpcUa-Item","z":"ed569869.819098","item":"ns=3;s=SELEC_TOLVA_2","datatype":"Boolean","value":"","name":"","x":2260,"y":520,"wires":[["e894025f36a24642"]]},{"id":"e8f0713c86f20887","type":"OpcUa-Item","z":"ed569869.819098","item":"ns=3;s=P_ESTANDAR","datatype":"Boolean","value":"","name":"","x":2260,"y":680,"wires":[["e894025f36a24642"]]},{"id":"8fcc7361954af274","type":"debug","z":"ed569869.819098","name":"debug 3","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":2020,"y":740,"wires":[]},{"id":"3609ef8b66bfc84c","type":"OpcUa-Item","z":"ed569869.819098","item":"ns=3;s=STR_I00","datatype":"Boolean","value":"","name":"","x":2260,"y":600,"wires":[["e894025f36a24642"]]},{"id":"afcc80a9947b35fa","type":"ui_media","z":"ed569869.819098","group":"","name":"","width":1,"height":1,"order":46,"category":"foto","file":"4.png","layout":"adjust","showcontrols":true,"loop":true,"onstart":false,"scope":"local","tooltip":"","x":230,"y":140,"wires":[[]]},{"id":"87e0584af7b2d661","type":"ui_media","z":"ed569869.819098","group":"1205d101.95d59f","name":"","width":5,"height":2,"order":1,"category":"foto","file":"logo-2.png","layout":"adjust","showcontrols":true,"loop":true,"onstart":false,"scope":"local","tooltip":"","x":230,"y":180,"wires":[[]]},{"id":"2cdf05eb.fde93a","type":"ui_button","z":"c35023aa.5435e","name":"","group":"c70e8126.caef3","order":8,"width":5,"height":1,"passthru":false,"label":"Principal","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":280,"y":360,"wires":[["58bcb42c.6f8ecc"]]},{"id":"ea21419a.925b1","type":"ui_button","z":"c35023aa.5435e","name":"","group":"c70e8126.caef3","order":9,"width":5,"height":1,"passthru":false,"label":"Graficas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":280,"y":420,"wires":[["b808131d.29079"]]},{"id":"d912183f.ff6bf8","type":"ui_button","z":"c35023aa.5435e","name":"","group":"c70e8126.caef3","order":11,"width":5,"height":1,"passthru":false,"label":"Recetas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":280,"y":480,"wires":[["c5c443af.a3f94"]]},{"id":"6f0080b8.f880e","type":"ui_button","z":"c35023aa.5435e","name":"","group":"c70e8126.caef3","order":15,"width":5,"height":1,"passthru":false,"label":"Configuración","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":300,"y":600,"wires":[["e414464.50374b8"]]},{"id":"840097d.9d55c68","type":"ui_button","z":"c35023aa.5435e","name":"","group":"c70e8126.caef3","order":18,"width":5,"height":2,"passthru":false,"label":"Parada de emergencia","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":320,"y":720,"wires":[["c837590c.9d64b8"]]},{"id":"3fe7a8b2.0e3df8","type":"ui_text","z":"c35023aa.5435e","group":"c70e8126.caef3","order":7,"width":13,"height":2,"name":"","label":"Proceso estándar","format":"Ventana de operación","layout":"col-center","className":"Label_proceso_estandar","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"30","color":"#b0b6bd","x":1250,"y":240,"wires":[]},{"id":"9283d34a.b64ee","type":"ui_text","z":"c35023aa.5435e","group":"c70e8126.caef3","order":5,"width":7,"height":1,"name":"","label":"Sub-proceso actual: ","format":"{{msg.payload}}","layout":"row-left","className":"subprocesos","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#00abe5","x":1980,"y":80,"wires":[]},{"id":"5f2d37e5.3307d8","type":"ui_text","z":"c35023aa.5435e","group":"c70e8126.caef3","order":24,"width":6,"height":1,"name":"","label":"Peso","format":"{{msg.payload}}","layout":"col-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#00abe5","x":1090,"y":640,"wires":[]},{"id":"a78eccd4.990ea","type":"ui_text","z":"c35023aa.5435e","group":"c70e8126.caef3","order":13,"width":6,"height":1,"name":"","label":"Temperatura de la masa","format":"{{msg.payload}}","layout":"col-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#00abe5","x":1110,"y":360,"wires":[]},{"id":"965058de.516ec8","type":"ui_text","z":"c35023aa.5435e","group":"c70e8126.caef3","order":14,"width":7,"height":1,"name":"","label":"Temperatura de la resistencia","format":"{{msg.payload}}","layout":"col-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#00abe5","x":1650,"y":360,"wires":[]},{"id":"2492662b.75436a","type":"ui_text","z":"c35023aa.5435e","group":"c70e8126.caef3","order":19,"width":6,"height":1,"name":"","label":"Humedad del cafe","format":"{{msg.payload}}","layout":"col-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#00abe5","x":1110,"y":500,"wires":[]},{"id":"4c8439fd.403888","type":"ui_text","z":"c35023aa.5435e","group":"c70e8126.caef3","order":25,"width":7,"height":1,"name":"","label":"Humedad exterior","format":"{{msg.payload}}","layout":"col-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#00abe5","x":1610,"y":640,"wires":[]},{"id":"95eaebfc.631578","type":"ui_text","z":"c35023aa.5435e","group":"c70e8126.caef3","order":20,"width":7,"height":1,"name":"","label":"Humedad de la resistencia","format":"{{msg.payload}}","layout":"col-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#00abe5","x":1640,"y":500,"wires":[]},{"id":"b16c8470.0e5758","type":"link in","z":"c35023aa.5435e","name":"","links":[],"x":715,"y":640,"wires":[["691f9cc8.1ca764"]]},{"id":"fcd4675c.392378","type":"link in","z":"c35023aa.5435e","name":"","links":[],"x":1475,"y":360,"wires":[["965058de.516ec8"]]},{"id":"c9316709.4a1448","type":"link in","z":"c35023aa.5435e","name":"","links":[],"x":1475,"y":640,"wires":[["4c8439fd.403888"]]},{"id":"26d88a27.5448d6","type":"link in","z":"c35023aa.5435e","name":"","links":[],"x":715,"y":360,"wires":[["ed00f358.6a12d"]]},{"id":"53cb4d78.f1e404","type":"link in","z":"c35023aa.5435e","name":"","links":[],"x":715,"y":500,"wires":[["f9a12ccc.386f"]]},{"id":"a9bc63b9.b5809","type":"link in","z":"c35023aa.5435e","name":"","links":[],"x":1475,"y":500,"wires":[["95eaebfc.631578"]]},{"id":"5f57bc5a.8db0c4","type":"link in","z":"c35023aa.5435e","name":"Inicio cronometro","links":["da1d6240.fa45c"],"x":715,"y":240,"wires":[["8a65b41e.d3eba8"]]},{"id":"8a65b41e.d3eba8","type":"function","z":"c35023aa.5435e","name":"Global Start Cronometer","func":"global.set('current_time', 0);\nglobal.set('running', true);\nmsg.payload = 'start';\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":890,"y":240,"wires":[[]]},{"id":"5a7d6b6b.2d7d94","type":"link in","z":"c35023aa.5435e","name":"","links":["da1d6240.fa45c"],"x":715,"y":60,"wires":[["429b8352.03ed4c","6e109507.4f87fc"]]},{"id":"d23debe7.b101f8","type":"ui_text","z":"c35023aa.5435e","group":"c70e8126.caef3","order":6,"width":1,"height":1,"name":"","label":"","format":"","layout":"col-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#00abe5","x":270,"y":40,"wires":[]},{"id":"984d1144.fbfca","type":"function","z":"c35023aa.5435e","name":"Obtener subproceso actual","func":"// Inicializar la variable global si no existe\nvar sub1 = global.get('subproceso_estandar1'); // Cambiado a \"0\"\nvar sub2 = global.get('subproceso_estandar2'); // Cambiado a \"0\"\nvar sub3 = global.get('subproceso_estandar3'); // Cambiado a \"0\"\n\nvar subproceso = \"Pre Secado\";\n\n// Si el contador supera 3, reiniciarlo a 1\nif (sub1 === 0 && sub2 === 0 && sub3 === 0) {\n    subproceso = \"nada\";\n}\nelse if (sub1 === 1 && sub2 === 0 && sub3 === 0){\n    subproceso = \"Pre secado\";\n}\nelse if (sub1 === 1 && sub2 === 1 && sub3 === 0) {\n    subproceso = \"Oreado\";\n}\nelse if (sub1 === 1 && sub2 === 1 && sub3 === 1) {\n    subproceso = \"Punto final\";\n}\n\n\n// Establecer el valor del contador en msg.payload para enviarlo\nmsg.payload = subproceso;\n\n// Devolver el mensaje modificado\nreturn msg;\n\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":1700,"y":80,"wires":[["9283d34a.b64ee","6674faad84764c0d"]]},{"id":"473cd58b.d3e8dc","type":"link in","z":"c35023aa.5435e","name":"","links":[],"x":1475,"y":80,"wires":[["984d1144.fbfca","5eb852623f95d840"]]},{"id":"ed00f358.6a12d","type":"function","z":"c35023aa.5435e","name":"Torre 1 ON","func":"let torre = global.get('torre') || 'Error';\n\nif (torre === \"1\") {\n    return msg;\n}\nelse {\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":890,"y":360,"wires":[["a78eccd4.990ea"]]},{"id":"3f40cb2b.ba30e4","type":"link in","z":"c35023aa.5435e","name":"","links":[],"x":715,"y":400,"wires":[["fb8c6e53.9cf1a"]]},{"id":"fb8c6e53.9cf1a","type":"function","z":"c35023aa.5435e","name":"Torre 2 ON","func":"let torre = global.get('torre') || 'Error';\n\nif (torre === \"2\") {\n    return msg;\n}\nelse {\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":890,"y":400,"wires":[["a78eccd4.990ea"]]},{"id":"f9a12ccc.386f","type":"function","z":"c35023aa.5435e","name":"Torre 1 ON","func":"let torre = global.get('torre') || 'Error';\n\nif (torre === \"1\") {\n    return msg;\n}\nelse {\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":890,"y":500,"wires":[["2492662b.75436a"]]},{"id":"f37c56dd.dee6e8","type":"function","z":"c35023aa.5435e","name":"Torre 2 ON","func":"let torre = global.get('torre') || 'Error';\n\nif (torre === \"2\") {\n    return msg;\n}\nelse {\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":890,"y":540,"wires":[["2492662b.75436a"]]},{"id":"691f9cc8.1ca764","type":"function","z":"c35023aa.5435e","name":"Torre 1 ON","func":"let torre = global.get('torre') || 'Error';\n\nif (torre === \"1\") {\n    return msg;\n}\nelse {\n    return null;\n}","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":890,"y":640,"wires":[["5f2d37e5.3307d8"]]},{"id":"e4eeeafd.35eca8","type":"function","z":"c35023aa.5435e","name":"Torre 2 ON","func":"let torre = global.get('torre') || 'Error';\n\nif (torre === \"2\") {\n    return msg;\n}\nelse {\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":890,"y":680,"wires":[["5f2d37e5.3307d8"]]},{"id":"1c439d24.491813","type":"link in","z":"c35023aa.5435e","name":"","links":[],"x":715,"y":540,"wires":[["f37c56dd.dee6e8"]]},{"id":"1a725bc6.a42e34","type":"link in","z":"c35023aa.5435e","name":"","links":[],"x":715,"y":680,"wires":[["e4eeeafd.35eca8"]]},{"id":"2e8ed5bc.9bae3a","type":"ui_text","z":"c35023aa.5435e","group":"c70e8126.caef3","order":16,"width":6,"height":1,"name":"","label":"[ °C ]","format":"","layout":"col-center","className":"unidades","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":16,"color":"#000000","x":1090,"y":400,"wires":[]},{"id":"80271cd9.4b43b","type":"ui_text","z":"c35023aa.5435e","group":"c70e8126.caef3","order":17,"width":7,"height":1,"name":"","label":"[ °C ]","format":"","layout":"row-center","className":"unidades","style":true,"font":"","fontSize":16,"color":"#000000","x":1570,"y":400,"wires":[]},{"id":"70ae9e54.f49ea","type":"ui_text","z":"c35023aa.5435e","group":"c70e8126.caef3","order":21,"width":6,"height":1,"name":"","label":"[ % ]","format":"","layout":"row-center","className":"unidades","style":true,"font":"","fontSize":16,"color":"#000000","x":1090,"y":540,"wires":[]},{"id":"11bd015b.069bcf","type":"ui_text","z":"c35023aa.5435e","group":"c70e8126.caef3","order":22,"width":7,"height":1,"name":"","label":"[ % ]","format":"","layout":"row-center","className":"unidades","style":true,"font":"","fontSize":16,"color":"#000000","x":1570,"y":540,"wires":[]},{"id":"a98e2591.9185f8","type":"ui_text","z":"c35023aa.5435e","group":"c70e8126.caef3","order":26,"width":6,"height":1,"name":"","label":"[ Kg ]","format":"","layout":"row-center","className":"unidades","style":true,"font":"","fontSize":16,"color":"#000000","x":1090,"y":680,"wires":[]},{"id":"be9e640d.9b9b78","type":"ui_text","z":"c35023aa.5435e","group":"c70e8126.caef3","order":27,"width":7,"height":1,"name":"","label":"[ % ]","format":"","layout":"row-center","className":"unidades","style":true,"font":"","fontSize":16,"color":"#000000","x":1570,"y":680,"wires":[]},{"id":"45ed1ea6.b4bc1","type":"ui_template","z":"c35023aa.5435e","group":"c70e8126.caef3","name":"","order":2,"width":2,"height":1,"format":"<div style=\"{{msg.payload.style}};\">\n    <h3 style=\"{{msg.payload.style}}\">Torre 1</h3>\n    <p style=\"{{msg.payload.style}}\">{{msg.payload.value}}</p>\n</div>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","className":"","x":1060,"y":60,"wires":[[]]},{"id":"afd5aca9.9d81a","type":"ui_template","z":"c35023aa.5435e","group":"c70e8126.caef3","name":"","order":3,"width":2,"height":1,"format":"<div style=\"{{msg.payload.style}};\">\n    <h3 style=\"{{msg.payload.style}}\">Torre 2</h3>\n    <p style=\"{{msg.payload.style}}\">{{msg.payload.value}}</p>\n</div>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","className":"","x":1060,"y":100,"wires":[[]]},{"id":"429b8352.03ed4c","type":"function","z":"c35023aa.5435e","name":"Evaluar torre 1","func":"let torre = global.get('torre') || 'Error';\n\nif (torre === \"1\") {\n    msg.payload = {\n        style: 'background-color: #00ABE5 !important; font-size: 14px;text-align: center;color: white !important',\n        value: 'ON'\n    };\n} else {\n    msg.payload = {\n        style: 'background-color: #B0B6BD !important;font-size: 14px;text-align: center;color: white !important;',\n        value: 'OFF'\n    };\n}\nreturn msg;\n\n\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":860,"y":60,"wires":[["45ed1ea6.b4bc1"]]},{"id":"6e109507.4f87fc","type":"function","z":"c35023aa.5435e","name":"Evaluar torre 2","func":"let torre = global.get('torre') || 'Error';\n\nif (torre === \"2\") {\n    msg.payload = {\n        style: 'background-color: #00ABE5 !important; font-size: 14px;text-align: center;color: white !important;',\n        value: 'ON'\n    };\n} else {\n    msg.payload = {\n        style: 'background-color: #B0B6BD !important;font-size: 14px;text-align: center;color: white !important;',\n        value: 'OFF'\n    };\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":860,"y":100,"wires":[["afd5aca9.9d81a"]]},{"id":"58bcb42c.6f8ecc","type":"link out","z":"c35023aa.5435e","name":"Button principal","mode":"link","links":["e7ec69f6.6c4c48"],"x":475,"y":360,"wires":[]},{"id":"b808131d.29079","type":"link out","z":"c35023aa.5435e","name":"Button estadisticas","links":["ef89de6e.695c9"],"x":475,"y":420,"wires":[]},{"id":"c5c443af.a3f94","type":"link out","z":"c35023aa.5435e","name":"Button datos","links":["abcba878.d3c218"],"x":475,"y":480,"wires":[]},{"id":"e414464.50374b8","type":"link out","z":"c35023aa.5435e","name":"Button configuracion","links":["4d2c6e56.3e18c"],"x":475,"y":600,"wires":[]},{"id":"c837590c.9d64b8","type":"link out","z":"c35023aa.5435e","name":"Button parada de emergencia","links":["3dd45a68.e00f56","a6986a2a.897e78"],"x":475,"y":720,"wires":[]},{"id":"afd2561d.d7dc58","type":"comment","z":"c35023aa.5435e","name":"Obtener subproceso actual PLC","info":"","x":1710,"y":120,"wires":[]},{"id":"63665c52.63d4b4","type":"ui_text","z":"c35023aa.5435e","group":"c70e8126.caef3","order":10,"width":13,"height":2,"name":"","label":"Tiempo transcurrido: ","format":"{{msg.payload}}","layout":"col-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#00abe5","x":1300,"y":300,"wires":[]},{"id":"47484065.e76dd","type":"link in","z":"c35023aa.5435e","name":"Actualizar cronometro","links":[],"x":1135,"y":300,"wires":[["63665c52.63d4b4"]]},{"id":"a086f2c9.15978","type":"ui_button","z":"c35023aa.5435e","name":"","group":"c70e8126.caef3","order":12,"width":5,"height":1,"passthru":false,"label":"Curvas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":280,"y":540,"wires":[["1f8e6b08.fa6cc5"]]},{"id":"1f8e6b08.fa6cc5","type":"link out","z":"c35023aa.5435e","name":"Button curvas","links":["9fc5e761.afc3b8"],"x":475,"y":540,"wires":[]},{"id":"5eb852623f95d840","type":"debug","z":"c35023aa.5435e","name":"debug 2","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":1700,"y":200,"wires":[]},{"id":"6674faad84764c0d","type":"debug","z":"c35023aa.5435e","name":"debug 4","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":2020,"y":240,"wires":[]},{"id":"b8df2c115ea0946e","type":"ui_media","z":"c35023aa.5435e","group":"5c49ed12.764434","name":"ACIV","width":5,"height":2,"order":12,"category":"foto","file":"4.png","layout":"adjust","showcontrols":true,"loop":true,"onstart":false,"scope":"local","tooltip":"","x":290,"y":240,"wires":[[]]},{"id":"8d5a8eeed6fa2570","type":"ui_media","z":"c35023aa.5435e","group":"5c49ed12.764434","name":"PENAGOS","width":5,"height":3,"order":1,"category":"foto","file":"logo-2.png","layout":"adjust","showcontrols":true,"loop":true,"onstart":false,"scope":"local","tooltip":"","x":310,"y":280,"wires":[[]]},{"id":"90686385.2d66e","type":"inject","z":"3d816303.8389dc","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":770,"y":100,"wires":[["b672a56c.7452c8"]]},{"id":"bcb5ba54.aabac8","type":"file in","z":"3d816303.8389dc","name":"Leer historial_procesos.csv","filename":"","format":"utf8","chunk":false,"sendError":true,"encoding":"none","x":880,"y":260,"wires":[["9cdac3e6.ec3b"]]},{"id":"923f837e.325a5","type":"ui_dropdown","z":"3d816303.8389dc","name":"Dropdown seleccionar archivo","label":"Seleccionar","tooltip":"","place":"Proceso...","group":"d8d928f2.8366e8","order":4,"width":11,"height":1,"passthru":true,"multiple":false,"options":[],"payload":"","topic":"","topicType":"str","className":"Dropdown","x":890,"y":400,"wires":[["89c43f32.cc7e2","ce12deec.4ccad"]]},{"id":"6db13887.087c58","type":"file in","z":"3d816303.8389dc","name":"Leer archivo seleccionado","filename":"","format":"utf8","chunk":false,"sendError":true,"encoding":"none","x":870,"y":540,"wires":[["82e630fb.4f038"]]},{"id":"82e630fb.4f038","type":"function","z":"3d816303.8389dc","name":"Cargar valores en inputs","func":"let data = msg.payload.split(',');\n\n// Asignamos los valores a cada input (valores después de la fecha)\nmsg.payload1 = data[2] || '';\nmsg.payload2 = data[3] || '';\nmsg.payload3 = data[4] || '';\nmsg.payload4 = data[5] || '';\nmsg.payload5 = data[6] || '';\nmsg.payload6 = data[7] || '';\nmsg.payload7 = data[8] || '';\n\nreturn [\n    { payload: msg.payload1 },\n    { payload: msg.payload2 },\n    { payload: msg.payload3 },\n    { payload: msg.payload4 },\n    { payload: msg.payload5 },\n    { payload: msg.payload6 },\n    { payload: msg.payload7 },\n];","outputs":7,"noerr":0,"initialize":"","finalize":"","x":870,"y":660,"wires":[["176c810f.4da6cf","cc18a51c.cb3e18"],["8a4d4a8f.df1568","23b7b230.c8c2de"],["15df84ad.5f580b","a627c899.cef028"],["4a0e3431.808dfc","d0810f69.68ef7"],["d82619b5.521478","28a77b8e.e78f44"],["f04c4460.2e6988","c23a4d92.92c91"],["cc750a8b.4fce18","f6db8b01.041398"]]},{"id":"e68ce613.d0a6d8","type":"ui_button","z":"3d816303.8389dc","name":"","group":"d8d928f2.8366e8","order":3,"width":5,"height":1,"passthru":false,"label":"Principal","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":240,"y":280,"wires":[["bad0fb3b.f50118"]]},{"id":"5dc5ac74.00cb74","type":"ui_button","z":"3d816303.8389dc","name":"","group":"d8d928f2.8366e8","order":6,"width":5,"height":1,"passthru":false,"label":"Graficas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":240,"y":340,"wires":[["857ac9df.877698"]]},{"id":"4eee87ec.0031e8","type":"ui_button","z":"3d816303.8389dc","name":"","group":"d8d928f2.8366e8","order":18,"width":5,"height":1,"passthru":false,"label":"Recetas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":240,"y":400,"wires":[["ab88b926.a4b338","b672a56c.7452c8"]]},{"id":"f2bb2dc3.2d648","type":"ui_button","z":"3d816303.8389dc","name":"","group":"d8d928f2.8366e8","order":26,"width":5,"height":1,"passthru":false,"label":"Configuración","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":260,"y":520,"wires":[["7e14b9ac.1777b8"]]},{"id":"4aa4c1ee.97c6e","type":"ui_button","z":"3d816303.8389dc","name":"","group":"d8d928f2.8366e8","order":34,"width":5,"height":2,"passthru":false,"label":"Parada de emergencia","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":280,"y":640,"wires":[["f9912931.20a518"]]},{"id":"ce12deec.4ccad","type":"ui_text","z":"3d816303.8389dc","group":"d8d928f2.8366e8","order":2,"width":13,"height":2,"name":"","label":"Historial del proceso","format":"{{msg.payload}}","layout":"col-center","className":"Label_proceso_estandar","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"30","color":"#b0b6bd","x":1580,"y":200,"wires":[]},{"id":"72b007ec.9a04f8","type":"ui_text","z":"3d816303.8389dc","group":"d8d928f2.8366e8","order":12,"width":3,"height":1,"name":"","label":"Pre Secado","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo_up","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#464080","x":1370,"y":320,"wires":[]},{"id":"f6dca095.05731","type":"ui_text","z":"3d816303.8389dc","group":"d8d928f2.8366e8","order":14,"width":3,"height":1,"name":"","label":"Oreado","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo_up","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#464080","x":1560,"y":320,"wires":[]},{"id":"fc3910f0.afb1f","type":"ui_text","z":"3d816303.8389dc","group":"d8d928f2.8366e8","order":16,"width":3,"height":1,"name":"","label":"Punto Final","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo_up","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#464080","x":1790,"y":320,"wires":[]},{"id":"8c0d8f0e.4466b","type":"ui_text","z":"3d816303.8389dc","group":"d8d928f2.8366e8","order":24,"width":3,"height":1,"name":"","label":"Temperatura","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#46408a","x":1370,"y":360,"wires":[]},{"id":"34792889.66a568","type":"ui_text","z":"3d816303.8389dc","group":"d8d928f2.8366e8","order":22,"width":3,"height":1,"name":"","label":"Temperatura","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#46408a","x":1570,"y":360,"wires":[]},{"id":"18878742.ce7259","type":"ui_text","z":"3d816303.8389dc","group":"d8d928f2.8366e8","order":20,"width":3,"height":1,"name":"","label":"Temperatura","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#46408a","x":1790,"y":360,"wires":[]},{"id":"5f4456e8.169a48","type":"ui_text","z":"3d816303.8389dc","group":"d8d928f2.8366e8","order":36,"width":3,"height":1,"name":"","label":"Tiempo","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#46408a","x":1360,"y":460,"wires":[]},{"id":"c4d7ff06.6342a","type":"ui_text","z":"3d816303.8389dc","group":"d8d928f2.8366e8","order":38,"width":3,"height":1,"name":"","label":"Tiempo","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#46408a","x":1560,"y":460,"wires":[]},{"id":"5489bf9e.e02d4","type":"ui_text","z":"3d816303.8389dc","group":"d8d928f2.8366e8","order":40,"width":3,"height":1,"name":"","label":"Peso","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#46408a","x":1770,"y":460,"wires":[]},{"id":"176c810f.4da6cf","type":"ui_text","z":"3d816303.8389dc","group":"d8d928f2.8366e8","order":28,"width":3,"height":1,"name":"text1","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"22","color":"#464080","x":1350,"y":400,"wires":[]},{"id":"15df84ad.5f580b","type":"ui_text","z":"3d816303.8389dc","group":"d8d928f2.8366e8","order":32,"width":3,"height":1,"name":"text3","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"22","color":"#464080","x":1550,"y":400,"wires":[]},{"id":"d82619b5.521478","type":"ui_text","z":"3d816303.8389dc","group":"d8d928f2.8366e8","order":45,"width":3,"height":1,"name":"text5","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"22","color":"#464080","x":1770,"y":400,"wires":[]},{"id":"8a4d4a8f.df1568","type":"ui_text","z":"3d816303.8389dc","group":"d8d928f2.8366e8","order":30,"width":3,"height":1,"name":"text2","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"22","color":"#464080","x":1350,"y":500,"wires":[]},{"id":"4a0e3431.808dfc","type":"ui_text","z":"3d816303.8389dc","group":"d8d928f2.8366e8","order":43,"width":3,"height":1,"name":"text4","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"22","color":"#464080","x":1550,"y":500,"wires":[]},{"id":"f04c4460.2e6988","type":"ui_text","z":"3d816303.8389dc","group":"d8d928f2.8366e8","order":47,"width":3,"height":1,"name":"text6","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"22","color":"#464080","x":1770,"y":500,"wires":[]},{"id":"9813e245.0b8a3","type":"ui_button","z":"3d816303.8389dc","name":"","group":"d8d928f2.8366e8","order":50,"width":7,"height":2,"passthru":false,"label":"Recetas personalizadas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":1330,"y":720,"wires":[["e71e48f2.cb8c48","8289efa3.75134"]]},{"id":"654b0dd.0ff12f4","type":"ui_button","z":"3d816303.8389dc","name":"","group":"d8d928f2.8366e8","order":51,"width":6,"height":2,"passthru":false,"label":"Usar receta","tooltip":"","color":"","bgcolor":"#46408A","className":"left_menu_button_purple","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":1750,"y":720,"wires":[["950d55ba.dc3a68","1f1f281b.ef1ca8","95a9b2b1.f6bf2"]]},{"id":"e71e48f2.cb8c48","type":"change","z":"3d816303.8389dc","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"Data_personalized_tab\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":1300,"y":780,"wires":[["af2b9a9d.12f8b8"]]},{"id":"af2b9a9d.12f8b8","type":"ui_ui_control","z":"3d816303.8389dc","name":"","events":"all","x":1300,"y":840,"wires":[[]]},{"id":"950d55ba.dc3a68","type":"change","z":"3d816303.8389dc","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"Standard_process_tab\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":1760,"y":780,"wires":[["9f000d4a.aebea"]]},{"id":"9f000d4a.aebea","type":"ui_ui_control","z":"3d816303.8389dc","name":"","events":"all","x":1760,"y":840,"wires":[[]]},{"id":"11e9fec1.24b021","type":"comment","z":"3d816303.8389dc","name":"Actualización del historial en datos","info":"Para que cuando se presione el botón datos se actulice la lista del historial","x":900,"y":40,"wires":[]},{"id":"580fc2cf.5b18cc","type":"comment","z":"3d816303.8389dc","name":"MODIFICADO PENAGOS","info":"","x":870,"y":160,"wires":[]},{"id":"b672a56c.7452c8","type":"function","z":"3d816303.8389dc","name":"Formatear para el historial","func":"let ruta_sd = global.get('ruta_sd');\nruta_sd = `${ruta_sd}historial_procesos_estandar.csv`;\nmsg.filename = ruta_sd\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":870,"y":200,"wires":[["bcb5ba54.aabac8"]]},{"id":"bad0fb3b.f50118","type":"link out","z":"3d816303.8389dc","name":"Button principal","links":["e7ec69f6.6c4c48"],"x":455,"y":280,"wires":[]},{"id":"857ac9df.877698","type":"link out","z":"3d816303.8389dc","name":"Button estadisticas","links":["ef89de6e.695c9"],"x":455,"y":340,"wires":[]},{"id":"ab88b926.a4b338","type":"link out","z":"3d816303.8389dc","name":"Button datos","links":["abcba878.d3c218"],"x":455,"y":400,"wires":[]},{"id":"72c20999.4f7098","type":"link in","z":"3d816303.8389dc","name":"Button datos","links":["b9bb3c02.428d5","c5c443af.a3f94"],"x":655,"y":200,"wires":[["b672a56c.7452c8"]]},{"id":"7e14b9ac.1777b8","type":"link out","z":"3d816303.8389dc","name":"Button configuracion","links":["4d2c6e56.3e18c"],"x":455,"y":520,"wires":[]},{"id":"f9912931.20a518","type":"link out","z":"3d816303.8389dc","name":"Button parada de emergencia","links":["3dd45a68.e00f56","a6986a2a.897e78"],"x":455,"y":640,"wires":[]},{"id":"9cdac3e6.ec3b","type":"function","z":"3d816303.8389dc","name":"Global Obtener nombres de archivos","func":"//formato correcto\nlet lines = msg.payload.split('\\n');\nlet filenamesMap = {};\nlet filenames = lines.map(line => {\n    let trimmedName = line.trim();\n    \n// Extraer la parte del nombre que contiene \"Estandar_\"\nlet index = trimmedName.indexOf('/Estandar_');\nif (index !== -1) {\n    let filename = trimmedName.substring(index + 1);  // Solo toma desde \"/Estandar_\" en adelante\n    \n    // Remover la extensión .csv\n    let filenameWithoutExt = filename.replace('.csv', '');\n    \n    // Separar el nombre para darle el formato adecuado\n    let parts = filenameWithoutExt.split('_');  // Separar en \"Estandar\", fecha y hora\n    \n    if (parts.length === 3) {\n        let date = parts[1];  // Fecha en formato AAAAMMDD\n        let time = parts[2];  // Hora en formato HHMMSS\n        \n        // Formatear hora y fecha\n        let formattedTime = `${time.slice(0, 2)}:${time.slice(2, 4)}:${time.slice(4, 6)}`; // HH:MM:SS\n        let formattedDate = `${date.slice(6, 8)}/${date.slice(4, 6)}/${date.slice(0, 4)}`; // DD/MM/YYYY\n        \n        let formattedName = `${formattedTime} - ${formattedDate} - ${parts[0]}`;  // Ejemplo: \"12:25:36 09/10/2024 Estandar\"\n        \n        filenamesMap[formattedName] = filename;  // Mapear el nombre formateado con el nombre original\n        return formattedName;\n    }\n}\nreturn '';  // Si no contiene \"Estandar_\", retorna una cadena vacía\n}).filter(name => name !== '');  // Filtrar nombres vacíos\n\n// Invertir el orden de los nombres\nfilenames.reverse();\n\n// Guardar el mapeo en el contexto global\nglobal.set('filenamesMap', filenamesMap);\n\nmsg.options = filenames;  // Solo un arreglo de strings\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":890,"y":340,"wires":[["923f837e.325a5"]]},{"id":"89c43f32.cc7e2","type":"function","z":"3d816303.8389dc","name":"Recuperar nombre original","func":"let filenamesMap = global.get('filenamesMap');\nlet selectedFormattedName = msg.payload;  // El nombre formateado seleccionado\n\n// Recuperar el nombre original del archivo\nlet originalFilename = filenamesMap[selectedFormattedName];\nif (originalFilename) {\n    let ruta_sd = global.get('ruta_sd');  // Obtener la ruta base\n    msg.filename = `${ruta_sd}${originalFilename}`;  // Construir la ruta completa\n    return msg;\n} else {\n    node.error('No se encontró el archivo original para la selección: ' + selectedFormattedName);\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":860,"y":480,"wires":[["6db13887.087c58"]]},{"id":"cc750a8b.4fce18","type":"ui_text","z":"3d816303.8389dc","group":"d8d928f2.8366e8","order":8,"width":7,"height":1,"name":"","label":"Proceso realizado en torre: ","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"","fontSize":"26","color":"#464080","x":1580,"y":260,"wires":[]},{"id":"8289efa3.75134","type":"link out","z":"3d816303.8389dc","name":"Recetas personalizadas is pressed","links":[],"x":1515,"y":720,"wires":[]},{"id":"f3f4d9e2.303ec8","type":"ui_button","z":"3d816303.8389dc","name":"","group":"d8d928f2.8366e8","order":10,"width":5,"height":1,"passthru":false,"label":"Curvas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":240,"y":460,"wires":[["1e82e6a7.1e0709"]]},{"id":"1e82e6a7.1e0709","type":"link out","z":"3d816303.8389dc","name":"Button curvas","links":["9fc5e761.afc3b8"],"x":455,"y":460,"wires":[]},{"id":"cc18a51c.cb3e18","type":"change","z":"3d816303.8389dc","name":"","rules":[{"t":"set","p":"temp_pre_secado","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2160,"y":260,"wires":[[]]},{"id":"23b7b230.c8c2de","type":"change","z":"3d816303.8389dc","name":"","rules":[{"t":"set","p":"time_pre_secado","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2160,"y":300,"wires":[[]]},{"id":"28a77b8e.e78f44","type":"change","z":"3d816303.8389dc","name":"","rules":[{"t":"set","p":"temp_final","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2140,"y":420,"wires":[[]]},{"id":"c23a4d92.92c91","type":"change","z":"3d816303.8389dc","name":"","rules":[{"t":"set","p":"time_final","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2140,"y":460,"wires":[[]]},{"id":"a627c899.cef028","type":"change","z":"3d816303.8389dc","name":"","rules":[{"t":"set","p":"temp_oreado","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2150,"y":340,"wires":[[]]},{"id":"d0810f69.68ef7","type":"change","z":"3d816303.8389dc","name":"","rules":[{"t":"set","p":"time_oreado","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2140,"y":380,"wires":[[]]},{"id":"f6db8b01.041398","type":"change","z":"3d816303.8389dc","name":"","rules":[{"t":"set","p":"torre","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2120,"y":500,"wires":[[]]},{"id":"e443b784.4dfe38","type":"comment","z":"3d816303.8389dc","name":"Actualizar variables globales para usar la receta","info":"","x":2220,"y":220,"wires":[]},{"id":"1f1f281b.ef1ca8","type":"function","z":"3d816303.8389dc","name":"Obtener Variables Globales","func":"// Lista de nombres de variables globales\nlet globalVariables = [\n    \"temp_pre_secado\",\n    \"time_pre_secado\",\n    \"temp_oreado\",\n    \"time_oreado\",\n    \"temp_final\",\n    \"time_final\",\n    \"torre\"\n];\n\n// Crear un mensaje para cada variable en su propia salida\nlet messages = globalVariables.map(varName => {\n    let value = global.get(varName);\n    return { payload: value };  // Asignar solo el valor\n});\n\n// Enviar cada mensaje en una salida específica\nreturn messages;\n","outputs":7,"noerr":0,"initialize":"","finalize":"","x":2140,"y":720,"wires":[["3b1c3781.468f28"],["21c5260c.6a920a"],["e7647dfb.935da"],["26529bc2.c0f414"],["62d7d8f.31c8c28"],["cb429dd6.af94a"],[]]},{"id":"3b1c3781.468f28","type":"link out","z":"3d816303.8389dc","name":"temp_pre_secado","links":["4f872040.119da"],"x":2355,"y":680,"wires":[]},{"id":"21c5260c.6a920a","type":"link out","z":"3d816303.8389dc","name":"time_pre_secado","links":["d0c751a1.74caf"],"x":2355,"y":720,"wires":[]},{"id":"e7647dfb.935da","type":"link out","z":"3d816303.8389dc","name":"temp_oreado","links":["61050dfd.2962d4"],"x":2355,"y":760,"wires":[]},{"id":"26529bc2.c0f414","type":"link out","z":"3d816303.8389dc","name":"time_oreado","links":["c4bff6eb.372498"],"x":2355,"y":800,"wires":[]},{"id":"62d7d8f.31c8c28","type":"link out","z":"3d816303.8389dc","name":"temp_final","links":["ab3ba81d.56c818"],"x":2355,"y":840,"wires":[]},{"id":"cb429dd6.af94a","type":"link out","z":"3d816303.8389dc","name":"time_final","links":["551a2875.e768a8"],"x":2355,"y":880,"wires":[]},{"id":"95a9b2b1.f6bf2","type":"link out","z":"3d816303.8389dc","name":"torre","links":["82642537.738178"],"x":2355,"y":920,"wires":[]},{"id":"3d2ba686a05e4250","type":"ui_media","z":"3d816303.8389dc","group":"d8d928f2.8366e8","name":"","width":5,"height":2,"order":1,"category":"foto","file":"4.png","layout":"adjust","showcontrols":true,"loop":true,"onstart":false,"scope":"local","tooltip":"","x":250,"y":180,"wires":[[]]},{"id":"2d57e1a3aca2f898","type":"ui_media","z":"3d816303.8389dc","group":"d8d928f2.8366e8","name":"","width":5,"height":2,"order":49,"category":"foto","file":"logo-2.png","layout":"adjust","showcontrols":true,"loop":true,"onstart":false,"scope":"local","tooltip":"","x":250,"y":220,"wires":[[]]},{"id":"391167c3.5d7998","type":"ui_button","z":"25c07f17.d1356","name":"","group":"cabc2e85.6276b","order":10,"width":5,"height":1,"passthru":false,"label":"Principal","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":240,"y":320,"wires":[["7fbbb582.56b40c"]]},{"id":"58f5494.6ef85b8","type":"ui_button","z":"25c07f17.d1356","name":"","group":"cabc2e85.6276b","order":12,"width":5,"height":1,"passthru":false,"label":"Graficas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":240,"y":380,"wires":[["a0ccc382.ca97"]]},{"id":"27690638.c6ed4a","type":"ui_button","z":"25c07f17.d1356","name":"","group":"cabc2e85.6276b","order":16,"width":5,"height":1,"passthru":false,"label":"Recetas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":240,"y":440,"wires":[["db729b4e.404338"]]},{"id":"199d3c77.dd6214","type":"ui_button","z":"25c07f17.d1356","name":"","group":"cabc2e85.6276b","order":18,"width":5,"height":1,"passthru":false,"label":"Configuración","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":260,"y":560,"wires":[["d6639d2a.46c9b"]]},{"id":"8af59968.788308","type":"ui_button","z":"25c07f17.d1356","name":"","group":"cabc2e85.6276b","order":22,"width":5,"height":2,"passthru":false,"label":"Parada de emergencia","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":280,"y":680,"wires":[["590c27c6.7c86c8"]]},{"id":"b8dffe57.b545b","type":"file","z":"25c07f17.d1356","name":"CSV sensor_temp1","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"false","encoding":"none","x":1050,"y":1120,"wires":[[]]},{"id":"1cc52e5e.c1db82","type":"link in","z":"25c07f17.d1356","name":"","links":[],"x":215,"y":1120,"wires":[["1acb257e.8883cb"]]},{"id":"1acb257e.8883cb","type":"function","z":"25c07f17.d1356","name":"Formato de CSV y de filename","func":"var filename = global.get('filename') || 'No value';\nfilename = filename.slice(0, -4) + \"_temp1.csv\";\nlet value =  msg.payload;\nlet timestamp = new Date().toISOString();\n\nvar csvLine = value + \", \" + timestamp + \"\\n\";\n\nmsg.filename = filename\n// msg.payload = csvLine;\n\nmsg.payload = {\n    value: msg.payload,\n    timestamp: new Date().toISOString(),\n};\n\n\n//Que solo guarde cuando este running en true\nvar running = global.get('running') || false;\n\nif (running === true) {\n    return msg;\n} else {\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":490,"y":1120,"wires":[["a0812fca.4a53","cd2a0b24.7e7098"]]},{"id":"10be29c1.8c1016","type":"inject","z":"25c07f17.d1356","name":"Delete","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":250,"y":1240,"wires":[["69c4e927.199808"]]},{"id":"69c4e927.199808","type":"file","z":"25c07f17.d1356","name":"Borrar ingresando el nombre","filename":"Estandar_20241001_101134_temp1.csv","appendNewline":true,"createDir":true,"overwriteFile":"delete","encoding":"none","x":480,"y":1240,"wires":[[]]},{"id":"4609787f.a0fef8","type":"link in","z":"25c07f17.d1356","name":"","links":[],"x":215,"y":1560,"wires":[["e986a447.b9f738"]]},{"id":"cc0538fb.d96f68","type":"link in","z":"25c07f17.d1356","name":"","links":[],"x":1415,"y":1540,"wires":[["49b7c684.7dda18"]]},{"id":"2728b2ef.2a0abe","type":"link in","z":"25c07f17.d1356","name":"","links":[],"x":215,"y":1840,"wires":[["7e688689.89d9f8"]]},{"id":"8f866775.75c488","type":"ui_dropdown","z":"25c07f17.d1356","name":"","label":"","tooltip":"","place":"Gráfica 1","group":"cabc2e85.6276b","order":2,"width":3,"height":1,"passthru":true,"multiple":false,"options":[{"label":"Temperatura torre 1","value":"temp1","type":"str"},{"label":"Temperatura torre 2","value":"temp2","type":"str"},{"label":"Temperatura resistencia","value":"tempr","type":"str"},{"label":"Humedad torre 1","value":"hum1","type":"str"},{"label":"Humedad torre 2","value":"hum2","type":"str"},{"label":"Humedad resistencia","value":"humr","type":"str"},{"label":"Humedad exterior","value":"humext","type":"str"},{"label":"Peso torre 1","value":"weight1","type":"str"},{"label":"Peso torre 2","value":"weight2","type":"str"}],"payload":"","topic":"","topicType":"str","className":"","x":1440,"y":60,"wires":[["9e4043a.ec007c"]]},{"id":"86ec0522.5e46a8","type":"file in","z":"25c07f17.d1356","name":"Read CSV","filename":"","format":"utf8","chunk":false,"sendError":true,"encoding":"none","x":1410,"y":320,"wires":[["9683f8ab.cfe358"]]},{"id":"25542a59.574506","type":"change","z":"25c07f17.d1356","name":"Set filename","rules":[{"t":"set","p":"filename","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1430,"y":200,"wires":[["cad4ae96.1ed66"]]},{"id":"2c39051f.d6be5a","type":"csv","z":"25c07f17.d1356","name":"Convertir a CSV","sep":",","hdrin":false,"hdrout":"none","multi":"one","ret":"\\n","temp":"value,timestamp","skip":"0","strings":true,"include_empty_strings":false,"include_null_values":false,"x":2000,"y":1140,"wires":[["efd6943e.bca588"]]},{"id":"6ca742cc.282b1c","type":"link in","z":"25c07f17.d1356","name":"","links":[],"x":1415,"y":1140,"wires":[["3daad941.ca9b06"]]},{"id":"fca7bd78.770e3","type":"link in","z":"25c07f17.d1356","name":"","links":[],"x":835,"y":2500,"wires":[["1fd00687.5ffa69"]]},{"id":"f7a390cf.4eaaf","type":"link in","z":"25c07f17.d1356","name":"","links":[],"x":835,"y":2760,"wires":[["1bac8cad.951b63"]]},{"id":"c721e598.847938","type":"link in","z":"25c07f17.d1356","name":"","links":[],"x":1415,"y":1840,"wires":[["ee019c0f.45ebd"]]},{"id":"e5df218d.2ee2e","type":"link in","z":"25c07f17.d1356","name":"","links":[],"x":835,"y":2240,"wires":[["b7d5ab04.55b808"]]},{"id":"f22b623f.ad054","type":"ui_chart","z":"25c07f17.d1356","name":"Dropdown1","group":"cabc2e85.6276b","order":7,"width":6,"height":5,"label":"{{msg.label}}","chartType":"line","legend":"false","xformat":"HH:mm","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"86400","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd"],"outputs":1,"useDifferentColor":false,"className":"","x":1410,"y":460,"wires":[[]]},{"id":"a955db2.f3b5928","type":"comment","z":"25c07f17.d1356","name":"Temp1","info":"","x":250,"y":1080,"wires":[]},{"id":"238f21b7.3f359e","type":"comment","z":"25c07f17.d1356","name":"Hum1","info":"","x":250,"y":1520,"wires":[]},{"id":"b788eb3d.6d7e88","type":"comment","z":"25c07f17.d1356","name":"Hum2","info":"","x":1450,"y":1500,"wires":[]},{"id":"34a6d542.0e04ea","type":"comment","z":"25c07f17.d1356","name":"Weight1","info":"","x":260,"y":1800,"wires":[]},{"id":"c79b4a89.a2cf88","type":"function","z":"25c07f17.d1356","name":"Procesar CSV","func":"let lines = msg.payload.split('\\n');\nlet data = [];\n\nlines.forEach(line => {\n    let parts = line.split(',');\n    if(parts.length === 2) {\n        let value = parseFloat(parts[0]);\n        let timestamp = new Date(parts[1]).getTime();\n        data.push({x: timestamp, y: value});\n    }\n});\n\nmsg.payload = [{\n    \"series\": [\"Sensor\"],\n    \"data\": [data],\n    \"labels\": data.map(d => new Date(d.x).toLocaleTimeString())\n}];\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1420,"y":880,"wires":[["3666c8a8.d5e648"]]},{"id":"ca0fb672.9a9068","type":"ui_dropdown","z":"25c07f17.d1356","name":"","label":"","tooltip":"","place":"Gráfica 3","group":"cabc2e85.6276b","order":3,"width":3,"height":1,"passthru":true,"multiple":false,"options":[{"label":"Temperatura torre 1","value":"temp1","type":"str"},{"label":"Temperatura torre 2","value":"temp2","type":"str"},{"label":"Temperatura resistencia","value":"tempr","type":"str"},{"label":"Humedad torre 1","value":"hum1","type":"str"},{"label":"Humedad torre 2","value":"hum2","type":"str"},{"label":"Humedad resistencia","value":"humr","type":"str"},{"label":"Humedad exterior","value":"humext","type":"str"},{"label":"Peso torre 1","value":"weight1","type":"str"},{"label":"Peso torre 2","value":"weight2","type":"str"}],"payload":"","topic":"","topicType":"str","className":"","x":1400,"y":580,"wires":[["75bf74a9.14010c"]]},{"id":"a86f694c.4eb728","type":"file in","z":"25c07f17.d1356","name":"Read CSV","filename":"","format":"utf8","chunk":false,"sendError":true,"encoding":"none","x":1510,"y":820,"wires":[["c79b4a89.a2cf88"]]},{"id":"3666c8a8.d5e648","type":"ui_chart","z":"25c07f17.d1356","name":"Dropdown3","group":"cabc2e85.6276b","order":19,"width":6,"height":5,"label":"{{msg.label}}","chartType":"line","legend":"false","xformat":"HH:mm","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"86400","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd"],"outputs":1,"useDifferentColor":false,"className":"","x":1410,"y":940,"wires":[[]]},{"id":"d28c7899.38a068","type":"function","z":"25c07f17.d1356","name":"Nombre grafica","func":"sensor = msg.filename\n\n// Remover \"sensor_\" del inicio\nsensor = sensor.replace(\"sensor_\", \"\");\n\n// Remover \".csv\" del final\nsensor = sensor.replace(\".csv\", \"\");\n\n// Agregar \" vs tiempo\"\nsensor += \" vs tiempo\";\n\nmsg.sensor = sensor\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1280,"y":820,"wires":[["a86f694c.4eb728"]]},{"id":"3186e1ab.a6c0ce","type":"inject","z":"25c07f17.d1356","name":"","props":[{"p":"payload"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":1240,"y":580,"wires":[["ca0fb672.9a9068"]]},{"id":"28d42f98.94ba2","type":"function","z":"25c07f17.d1356","name":"Procesar CSV","func":"let lines = msg.payload.split('\\n');\nlet data = [];\n\nlines.forEach(line => {\n    let parts = line.split(',');\n    if(parts.length === 2) {\n        let value = parseFloat(parts[0]);\n        let timestamp = new Date(parts[1]).getTime();\n        data.push({x: timestamp, y: value});\n    }\n});\n\nmsg.payload = [{\n    \"series\": [\"Sensor\"],\n    \"data\": [data],\n    \"labels\": data.map(d => new Date(d.x).toLocaleTimeString())\n}];\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2240,"y":860,"wires":[["7188a9ea.5f1f88"]]},{"id":"12b34418.b059cc","type":"ui_dropdown","z":"25c07f17.d1356","name":"","label":"","tooltip":"","place":"Gráfica 4","group":"cabc2e85.6276b","order":5,"width":3,"height":1,"passthru":true,"multiple":false,"options":[{"label":"Temperatura torre 1","value":"temp1","type":"str"},{"label":"Temperatura torre 2","value":"temp2","type":"str"},{"label":"Temperatura resistencia","value":"tempr","type":"str"},{"label":"Humedad torre 1","value":"hum1","type":"str"},{"label":"Humedad torre 2","value":"hum2","type":"str"},{"label":"Humedad resistencia","value":"humr","type":"str"},{"label":"Humedad exterior","value":"humext","type":"str"},{"label":"Peso torre 1","value":"weight1","type":"str"},{"label":"Peso torre 2","value":"weight2","type":"str"}],"payload":"","topic":"","topicType":"str","className":"","x":2220,"y":560,"wires":[["1cef0558.753c2b"]]},{"id":"1fca324c.3abfbe","type":"file in","z":"25c07f17.d1356","name":"Read CSV","filename":"","format":"utf8","chunk":false,"sendError":true,"encoding":"none","x":2330,"y":800,"wires":[["28d42f98.94ba2"]]},{"id":"9aaa8d30.0d51","type":"change","z":"25c07f17.d1356","name":"Set filename","rules":[{"t":"set","p":"filename","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2230,"y":680,"wires":[["95146a97.2f6a08"]]},{"id":"7188a9ea.5f1f88","type":"ui_chart","z":"25c07f17.d1356","name":"Dropdown4","group":"cabc2e85.6276b","order":20,"width":6,"height":5,"label":"{{msg.label}}","chartType":"line","legend":"false","xformat":"HH:mm","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"86400","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd"],"outputs":1,"useDifferentColor":false,"className":"","x":2230,"y":920,"wires":[[]]},{"id":"5e5cbf6b.9f7f8","type":"function","z":"25c07f17.d1356","name":"Nombre grafica","func":"sensor = msg.filename\n\n// Remover \"sensor_\" del inicio\nsensor = sensor.replace(\"sensor_\", \"\");\n\n// Remover \".csv\" del final\nsensor = sensor.replace(\".csv\", \"\");\n\n// Agregar \" vs tiempo\"\nsensor += \" vs tiempo\";\n\nmsg.sensor = sensor\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2100,"y":800,"wires":[["1fca324c.3abfbe"]]},{"id":"ac66f307.b97e","type":"inject","z":"25c07f17.d1356","name":"","props":[{"p":"payload"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":2070,"y":560,"wires":[["12b34418.b059cc"]]},{"id":"30eb6186.71be4e","type":"comment","z":"25c07f17.d1356","name":"Temp2","info":"","x":1450,"y":1080,"wires":[]},{"id":"b153645c.0c1db8","type":"comment","z":"25c07f17.d1356","name":"Tempr","info":"","x":870,"y":2180,"wires":[]},{"id":"b8ce0e73.33c8a","type":"comment","z":"25c07f17.d1356","name":"Humr","info":"","x":870,"y":2460,"wires":[]},{"id":"576ceebe.8b93f","type":"comment","z":"25c07f17.d1356","name":"Humext","info":"","x":870,"y":2720,"wires":[]},{"id":"660f8313.f418ac","type":"comment","z":"25c07f17.d1356","name":"Weight2","info":"","x":1460,"y":1780,"wires":[]},{"id":"3d867fd8.5faa2","type":"function","z":"25c07f17.d1356","name":"Leer global.filename","func":"var filename = global.get('filename') || 'No value';\n\nmsg.payload = filename\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":480,"y":940,"wires":[["940d348d.4e14a8"]]},{"id":"79f21824.689868","type":"inject","z":"25c07f17.d1356","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":270,"y":940,"wires":[["3d867fd8.5faa2"]]},{"id":"a0812fca.4a53","type":"debug","z":"25c07f17.d1356","name":"Nombre y datos del archivo guardado","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":850,"y":1080,"wires":[]},{"id":"45138f39.7c94f","type":"inject","z":"25c07f17.d1356","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":260,"y":1200,"wires":[["f0b57d6.240098"]]},{"id":"f0b57d6.240098","type":"file in","z":"25c07f17.d1356","name":"Cargar archivo del historial con el nombre","filename":"Estandar_20240930_111940_temp1.csv","format":"utf8","chunk":false,"sendError":false,"encoding":"none","x":540,"y":1200,"wires":[["5004be34.e882e"]]},{"id":"5004be34.e882e","type":"debug","z":"25c07f17.d1356","name":"cargar archivo donde se guarda temp1 para validar datos","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":950,"y":1200,"wires":[]},{"id":"cd2a0b24.7e7098","type":"csv","z":"25c07f17.d1356","name":"Convertir a CSV","sep":",","hdrin":false,"hdrout":"none","multi":"one","ret":"\\n","temp":"value,timestamp","skip":"0","strings":true,"include_empty_strings":false,"include_null_values":false,"x":780,"y":1120,"wires":[["b8dffe57.b545b"]]},{"id":"3daad941.ca9b06","type":"function","z":"25c07f17.d1356","name":"Formato de CSV y de filename","func":"var filename = global.get('filename') || 'No value';\nfilename = filename.slice(0, -4) + \"_temp2.csv\";\nlet value =  msg.payload;\nlet timestamp = new Date().toISOString();\n\nvar csvLine = value + \", \" + timestamp + \"\\n\";\n\nmsg.filename = filename\n// msg.payload = csvLine;\n\nmsg.payload = {\n    value: msg.payload,\n    timestamp: new Date().toISOString(),\n};\n\n\nreturn msg","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1690,"y":1140,"wires":[["2c39051f.d6be5a"]]},{"id":"efd6943e.bca588","type":"file","z":"25c07f17.d1356","name":"CSV sensor_temp2","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"false","encoding":"none","x":2250,"y":1140,"wires":[[]]},{"id":"940d348d.4e14a8","type":"debug","z":"25c07f17.d1356","name":"global.filename","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":700,"y":940,"wires":[]},{"id":"af190ba9.d61498","type":"debug","z":"25c07f17.d1356","name":"cargar archivo donde se guarda temp1 para validar datos","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2190,"y":1200,"wires":[]},{"id":"470664f8.dd868c","type":"file in","z":"25c07f17.d1356","name":"Cargar archivo del historial con el nombre","filename":"Estandar_20240930_111940_temp1.csv","format":"utf8","chunk":false,"sendError":false,"encoding":"none","x":1740,"y":1200,"wires":[["af190ba9.d61498"]]},{"id":"aa115484.728e38","type":"inject","z":"25c07f17.d1356","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1460,"y":1200,"wires":[["470664f8.dd868c"]]},{"id":"b38ed2bd.7f99f","type":"file","z":"25c07f17.d1356","name":"Borrar ingresando el nombre","filename":"nombre.csv","appendNewline":true,"createDir":true,"overwriteFile":"delete","encoding":"none","x":1680,"y":1240,"wires":[[]]},{"id":"cb8b7da4.5e637","type":"inject","z":"25c07f17.d1356","name":"Delete","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1450,"y":1240,"wires":[["b38ed2bd.7f99f"]]},{"id":"9fe815d0.3b25a8","type":"function","z":"25c07f17.d1356","name":"Procesar CSV","func":"let lines = msg.payload.split('\\n');\nlet data = [];\n\nlines.forEach(line => {\n    let parts = line.split(',');\n    if(parts.length === 2) {\n        let value = parseFloat(parts[0]);\n        let timestamp = new Date(parts[1]).getTime();\n        data.push({x: timestamp, y: value});\n    }\n});\n\nmsg.payload = [{\n    \"series\": [\"Sensor\"],\n    \"data\": [data],\n    \"labels\": data.map(d => new Date(d.x).toLocaleTimeString())\n}];\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2220,"y":380,"wires":[["a9ab6dd6.a3af4"]]},{"id":"4f142e37.9fc46","type":"ui_dropdown","z":"25c07f17.d1356","name":"","label":"","tooltip":"","place":"Gráfica 2","group":"cabc2e85.6276b","order":4,"width":3,"height":1,"passthru":true,"multiple":false,"options":[{"label":"Temperatura torre 1","value":"temp1","type":"str"},{"label":"Temperatura torre 2","value":"temp2","type":"str"},{"label":"Temperatura resistencia","value":"tempr","type":"str"},{"label":"Humedad torre 1","value":"hum1","type":"str"},{"label":"Humedad torre 2","value":"hum2","type":"str"},{"label":"Humedad resistencia","value":"humr","type":"str"},{"label":"Humedad exterior","value":"humext","type":"str"},{"label":"Peso torre 1","value":"weight1","type":"str"},{"label":"Peso torre 2","value":"weight2","type":"str"}],"payload":"","topic":"","topicType":"str","className":"","x":2220,"y":80,"wires":[["cc1fed20.c50a3"]]},{"id":"340a59ca.b80a56","type":"file in","z":"25c07f17.d1356","name":"Read CSV","filename":"","format":"utf8","chunk":false,"sendError":true,"encoding":"none","x":2310,"y":320,"wires":[["9fe815d0.3b25a8"]]},{"id":"7687b81b.bd5d08","type":"change","z":"25c07f17.d1356","name":"Set filename","rules":[{"t":"set","p":"filename","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2210,"y":200,"wires":[["57a2bad4.67c5e4"]]},{"id":"a9ab6dd6.a3af4","type":"ui_chart","z":"25c07f17.d1356","name":"Dropdown2","group":"cabc2e85.6276b","order":8,"width":6,"height":5,"label":"{{msg.label}}","chartType":"line","legend":"false","xformat":"HH:mm","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"86400","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd"],"outputs":1,"useDifferentColor":false,"className":"","x":2210,"y":440,"wires":[[]]},{"id":"8f2594a0.833808","type":"function","z":"25c07f17.d1356","name":"Nombre grafica","func":"sensor = msg.filename\n\n// Remover \"sensor_\" del inicio\nsensor = sensor.replace(\"sensor_\", \"\");\n\n// Remover \".csv\" del final\nsensor = sensor.replace(\".csv\", \"\");\n\n// Agregar \" vs tiempo\"\nsensor += \" vs tiempo\";\n\nmsg.sensor = sensor\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2080,"y":320,"wires":[["340a59ca.b80a56"]]},{"id":"fed71fb0.b5142","type":"inject","z":"25c07f17.d1356","name":"","props":[{"p":"payload"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":2060,"y":80,"wires":[["4f142e37.9fc46"]]},{"id":"b80329e5.2fe988","type":"comment","z":"25c07f17.d1356","name":"Faltan editar de aqui para abajo","info":"","x":1270,"y":1380,"wires":[]},{"id":"565498f6.68dd58","type":"change","z":"25c07f17.d1356","name":"Set filename","rules":[{"t":"set","p":"filename","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1410,"y":700,"wires":[["c2993fc1.47281"]]},{"id":"9c03e748.f3e928","type":"file","z":"25c07f17.d1356","name":"CSV sensor_hum1","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"false","encoding":"none","x":1050,"y":1560,"wires":[[]]},{"id":"e986a447.b9f738","type":"function","z":"25c07f17.d1356","name":"Formato de CSV y de filename","func":"var filename = global.get('filename') || 'No value';\nfilename = filename.slice(0, -4) + \"_hum1.csv\";\nlet value =  msg.payload;\nlet timestamp = new Date().toISOString();\n\nvar csvLine = value + \", \" + timestamp + \"\\n\";\n\nmsg.filename = filename\n// msg.payload = csvLine;\n\nmsg.payload = {\n    value: msg.payload,\n    timestamp: new Date().toISOString(),\n};\n\n\n//Que solo guarde cuando este running en true\nvar running = global.get('running') || false;\n\nif (running === true) {\n    return msg;\n} else {\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":490,"y":1560,"wires":[["94a6b8e8.9d4158","9f5a27f7.29e5d8"]]},{"id":"93898fa.728977","type":"file","z":"25c07f17.d1356","name":"Borrar ingresando el nombre","filename":"Estandar_20241001_101134_temp1.csv","appendNewline":true,"createDir":true,"overwriteFile":"delete","encoding":"none","x":480,"y":1680,"wires":[[]]},{"id":"94a6b8e8.9d4158","type":"debug","z":"25c07f17.d1356","name":"Nombre y datos del archivo guardado","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":850,"y":1520,"wires":[]},{"id":"86ad9236.e14c","type":"file in","z":"25c07f17.d1356","name":"Cargar archivo del historial con el nombre","filename":"Estandar_20240930_111940_temp1.csv","format":"utf8","chunk":false,"sendError":false,"encoding":"none","x":540,"y":1640,"wires":[["e29327e1.4d7508"]]},{"id":"e29327e1.4d7508","type":"debug","z":"25c07f17.d1356","name":"cargar archivo donde se guarda temp1 para validar datos","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":950,"y":1640,"wires":[]},{"id":"9f5a27f7.29e5d8","type":"csv","z":"25c07f17.d1356","name":"Convertir a CSV","sep":",","hdrin":false,"hdrout":"none","multi":"one","ret":"\\n","temp":"value,timestamp","skip":"0","strings":true,"include_empty_strings":false,"include_null_values":false,"x":780,"y":1560,"wires":[["9c03e748.f3e928"]]},{"id":"f07a2b1b.75b168","type":"inject","z":"25c07f17.d1356","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":260,"y":1640,"wires":[["86ad9236.e14c"]]},{"id":"af1fdb80.d0a1a8","type":"inject","z":"25c07f17.d1356","name":"Delete","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":250,"y":1680,"wires":[["93898fa.728977"]]},{"id":"a74bd1f0.b4d21","type":"file","z":"25c07f17.d1356","name":"CSV sensor_hum2","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"false","encoding":"none","x":2250,"y":1540,"wires":[[]]},{"id":"49b7c684.7dda18","type":"function","z":"25c07f17.d1356","name":"Formato de CSV y de filename","func":"var filename = global.get('filename') || 'No value';\nfilename = filename.slice(0, -4) + \"_hum2.csv\";\nlet value =  msg.payload;\nlet timestamp = new Date().toISOString();\n\nvar csvLine = value + \", \" + timestamp + \"\\n\";\n\nmsg.filename = filename\n// msg.payload = csvLine;\n\nmsg.payload = {\n    value: msg.payload,\n    timestamp: new Date().toISOString(),\n};\n\n\n//Que solo guarde cuando este running en true\nvar running = global.get('running') || false;\n\nif (running === true) {\n    return msg;\n} else {\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1690,"y":1540,"wires":[["f684df9f.ea342","de9434b5.567178"]]},{"id":"70c3593d.0daee8","type":"file","z":"25c07f17.d1356","name":"Borrar ingresando el nombre","filename":"Estandar_20241001_101134_temp1.csv","appendNewline":true,"createDir":true,"overwriteFile":"delete","encoding":"none","x":1680,"y":1660,"wires":[[]]},{"id":"f684df9f.ea342","type":"debug","z":"25c07f17.d1356","name":"Nombre y datos del archivo guardado","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2050,"y":1500,"wires":[]},{"id":"c83b149d.316728","type":"file in","z":"25c07f17.d1356","name":"Cargar archivo del historial con el nombre","filename":"Estandar_20240930_111940_temp1.csv","format":"utf8","chunk":false,"sendError":false,"encoding":"none","x":1740,"y":1620,"wires":[["4c35e0e5.c8333"]]},{"id":"4c35e0e5.c8333","type":"debug","z":"25c07f17.d1356","name":"cargar archivo donde se guarda temp1 para validar datos","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2150,"y":1620,"wires":[]},{"id":"de9434b5.567178","type":"csv","z":"25c07f17.d1356","name":"Convertir a CSV","sep":",","hdrin":false,"hdrout":"none","multi":"one","ret":"\\n","temp":"value,timestamp","skip":"0","strings":true,"include_empty_strings":false,"include_null_values":false,"x":1980,"y":1540,"wires":[["a74bd1f0.b4d21"]]},{"id":"82bb6020.b33ec","type":"inject","z":"25c07f17.d1356","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1460,"y":1620,"wires":[["c83b149d.316728"]]},{"id":"aab381ed.8f431","type":"inject","z":"25c07f17.d1356","name":"Delete","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1450,"y":1660,"wires":[["70c3593d.0daee8"]]},{"id":"905f3b71.1f3de8","type":"file","z":"25c07f17.d1356","name":"CSV sensor_weight1","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"false","encoding":"none","x":1080,"y":1840,"wires":[[]]},{"id":"7e688689.89d9f8","type":"function","z":"25c07f17.d1356","name":"Formato de CSV y de filename","func":"var filename = global.get('filename') || 'No value';\nfilename = filename.slice(0, -4) + \"_weight1.csv\";\nlet value =  msg.payload;\nlet timestamp = new Date().toISOString();\n\nvar csvLine = value + \", \" + timestamp + \"\\n\";\n\nmsg.filename = filename\n// msg.payload = csvLine;\n\nmsg.payload = {\n    value: msg.payload,\n    timestamp: new Date().toISOString(),\n};\n\n\n//Que solo guarde cuando este running en true\nvar running = global.get('running') || false;\n\nif (running === true) {\n    return msg;\n} else {\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":510,"y":1840,"wires":[["cbfda838.672218","f39acc21.b2445"]]},{"id":"a98cca8f.cc7418","type":"file","z":"25c07f17.d1356","name":"Borrar ingresando el nombre","filename":"Estandar_20241001_101134_temp1.csv","appendNewline":true,"createDir":true,"overwriteFile":"delete","encoding":"none","x":500,"y":1960,"wires":[[]]},{"id":"cbfda838.672218","type":"debug","z":"25c07f17.d1356","name":"Nombre y datos del archivo guardado","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":870,"y":1800,"wires":[]},{"id":"5747466b.14e458","type":"file in","z":"25c07f17.d1356","name":"Cargar archivo del historial con el nombre","filename":"Estandar_20240930_111940_temp1.csv","format":"utf8","chunk":false,"sendError":false,"encoding":"none","x":560,"y":1920,"wires":[["b40f1451.b75978"]]},{"id":"b40f1451.b75978","type":"debug","z":"25c07f17.d1356","name":"cargar archivo donde se guarda temp1 para validar datos","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":970,"y":1920,"wires":[]},{"id":"f39acc21.b2445","type":"csv","z":"25c07f17.d1356","name":"Convertir a CSV","sep":",","hdrin":false,"hdrout":"none","multi":"one","ret":"\\n","temp":"value,timestamp","skip":"0","strings":true,"include_empty_strings":false,"include_null_values":false,"x":800,"y":1840,"wires":[["905f3b71.1f3de8"]]},{"id":"705f1870.2568b8","type":"inject","z":"25c07f17.d1356","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":280,"y":1920,"wires":[["5747466b.14e458"]]},{"id":"fd92d6fc.b0f3b8","type":"inject","z":"25c07f17.d1356","name":"Delete","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":270,"y":1960,"wires":[["a98cca8f.cc7418"]]},{"id":"c6b16097.33205","type":"file","z":"25c07f17.d1356","name":"Borrar ingresando el nombre","filename":"Estandar_20241001_101134_temp1.csv","appendNewline":true,"createDir":true,"overwriteFile":"delete","encoding":"none","x":1680,"y":1960,"wires":[[]]},{"id":"5a96dec4.10533","type":"file in","z":"25c07f17.d1356","name":"Cargar archivo del historial con el nombre","filename":"Estandar_20240930_111940_temp1.csv","format":"utf8","chunk":false,"sendError":false,"encoding":"none","x":1740,"y":1920,"wires":[["ab31a26e.8172d"]]},{"id":"ab31a26e.8172d","type":"debug","z":"25c07f17.d1356","name":"cargar archivo donde se guarda temp1 para validar datos","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2150,"y":1920,"wires":[]},{"id":"e793422c.80f9b","type":"inject","z":"25c07f17.d1356","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1460,"y":1920,"wires":[["5a96dec4.10533"]]},{"id":"39709a.3733ef66","type":"inject","z":"25c07f17.d1356","name":"Delete","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1450,"y":1960,"wires":[["c6b16097.33205"]]},{"id":"35ea07a5.4aa378","type":"file","z":"25c07f17.d1356","name":"CSV sensor_tempr","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"false","encoding":"none","x":1670,"y":2240,"wires":[[]]},{"id":"b7d5ab04.55b808","type":"function","z":"25c07f17.d1356","name":"Formato de CSV y de filename","func":"var filename = global.get('filename') || 'No value';\nfilename = filename.slice(0, -4) + \"_tempr.csv\";\nlet value =  msg.payload;\nlet timestamp = new Date().toISOString();\n\nvar csvLine = value + \", \" + timestamp + \"\\n\";\n\nmsg.filename = filename\n// msg.payload = csvLine;\n\nmsg.payload = {\n    value: msg.payload,\n    timestamp: new Date().toISOString(),\n};\n\n\n//Que solo guarde cuando este running en true\nvar running = global.get('running') || false;\n\nif (running === true) {\n    return msg;\n} else {\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1110,"y":2240,"wires":[["8be35134.a63a","e2a1837b.99a9b"]]},{"id":"a62ffc48.79f3b","type":"file","z":"25c07f17.d1356","name":"Borrar ingresando el nombre","filename":"Estandar_20241001_101134_temp1.csv","appendNewline":true,"createDir":true,"overwriteFile":"delete","encoding":"none","x":1100,"y":2360,"wires":[[]]},{"id":"8be35134.a63a","type":"debug","z":"25c07f17.d1356","name":"Nombre y datos del archivo guardado","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1470,"y":2200,"wires":[]},{"id":"4f3860c6.9a7e9","type":"file in","z":"25c07f17.d1356","name":"Cargar archivo del historial con el nombre","filename":"Estandar_20240930_111940_temp1.csv","format":"utf8","chunk":false,"sendError":false,"encoding":"none","x":1160,"y":2320,"wires":[["1027e9aa.e94c56"]]},{"id":"1027e9aa.e94c56","type":"debug","z":"25c07f17.d1356","name":"cargar archivo donde se guarda temp1 para validar datos","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1570,"y":2320,"wires":[]},{"id":"e2a1837b.99a9b","type":"csv","z":"25c07f17.d1356","name":"Convertir a CSV","sep":",","hdrin":false,"hdrout":"none","multi":"one","ret":"\\n","temp":"value,timestamp","skip":"0","strings":true,"include_empty_strings":false,"include_null_values":false,"x":1400,"y":2240,"wires":[["35ea07a5.4aa378"]]},{"id":"e84b5635.b23fd8","type":"inject","z":"25c07f17.d1356","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":880,"y":2320,"wires":[["4f3860c6.9a7e9"]]},{"id":"5afbdaa0.c71964","type":"inject","z":"25c07f17.d1356","name":"Delete","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":870,"y":2360,"wires":[["a62ffc48.79f3b"]]},{"id":"614176a.4371488","type":"file","z":"25c07f17.d1356","name":"CSV sensor_humr","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"false","encoding":"none","x":1690,"y":2500,"wires":[[]]},{"id":"1fd00687.5ffa69","type":"function","z":"25c07f17.d1356","name":"Formato de CSV y de filename","func":"var filename = global.get('filename') || 'No value';\nfilename = filename.slice(0, -4) + \"_humr.csv\";\nlet value =  msg.payload;\nlet timestamp = new Date().toISOString();\n\nvar csvLine = value + \", \" + timestamp + \"\\n\";\n\nmsg.filename = filename\n// msg.payload = csvLine;\n\nmsg.payload = {\n    value: msg.payload,\n    timestamp: new Date().toISOString(),\n};\n\n\n//Que solo guarde cuando este running en true\nvar running = global.get('running') || false;\n\nif (running === true) {\n    return msg;\n} else {\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1130,"y":2500,"wires":[["43a17869.db5988","88bff17e.91f28"]]},{"id":"68fe38e3.0b4d98","type":"file","z":"25c07f17.d1356","name":"Borrar ingresando el nombre","filename":"Estandar_20241001_101134_temp1.csv","appendNewline":true,"createDir":true,"overwriteFile":"delete","encoding":"none","x":1120,"y":2620,"wires":[[]]},{"id":"43a17869.db5988","type":"debug","z":"25c07f17.d1356","name":"Nombre y datos del archivo guardado","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1490,"y":2460,"wires":[]},{"id":"869c6f5b.ffd86","type":"file in","z":"25c07f17.d1356","name":"Cargar archivo del historial con el nombre","filename":"Estandar_20240930_111940_temp1.csv","format":"utf8","chunk":false,"sendError":false,"encoding":"none","x":1180,"y":2580,"wires":[["b12edce8.7623e"]]},{"id":"b12edce8.7623e","type":"debug","z":"25c07f17.d1356","name":"cargar archivo donde se guarda temp1 para validar datos","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1590,"y":2580,"wires":[]},{"id":"88bff17e.91f28","type":"csv","z":"25c07f17.d1356","name":"Convertir a CSV","sep":",","hdrin":false,"hdrout":"none","multi":"one","ret":"\\n","temp":"value,timestamp","skip":"0","strings":true,"include_empty_strings":false,"include_null_values":false,"x":1420,"y":2500,"wires":[["614176a.4371488"]]},{"id":"2fe2a02d.b74","type":"inject","z":"25c07f17.d1356","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":900,"y":2580,"wires":[["869c6f5b.ffd86"]]},{"id":"1abde37c.a7052d","type":"inject","z":"25c07f17.d1356","name":"Delete","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":890,"y":2620,"wires":[["68fe38e3.0b4d98"]]},{"id":"57492ac4.d59d44","type":"file","z":"25c07f17.d1356","name":"CSV sensor_humext","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"false","encoding":"none","x":1700,"y":2760,"wires":[[]]},{"id":"1bac8cad.951b63","type":"function","z":"25c07f17.d1356","name":"Formato de CSV y de filename","func":"var filename = global.get('filename') || 'No value';\nfilename = filename.slice(0, -4) + \"_humext.csv\";\nlet value =  msg.payload;\nlet timestamp = new Date().toISOString();\n\nvar csvLine = value + \", \" + timestamp + \"\\n\";\n\nmsg.filename = filename\n// msg.payload = csvLine;\n\nmsg.payload = {\n    value: msg.payload,\n    timestamp: new Date().toISOString(),\n};\n\n\n//Que solo guarde cuando este running en true\nvar running = global.get('running') || false;\n\nif (running === true) {\n    return msg;\n} else {\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1130,"y":2760,"wires":[["d09a8d7.859897","f6ffcd31.4ad41"]]},{"id":"7dec4662.95a0a8","type":"file","z":"25c07f17.d1356","name":"Borrar ingresando el nombre","filename":"Estandar_20241001_101134_temp1.csv","appendNewline":true,"createDir":true,"overwriteFile":"delete","encoding":"none","x":1120,"y":2880,"wires":[[]]},{"id":"d09a8d7.859897","type":"debug","z":"25c07f17.d1356","name":"Nombre y datos del archivo guardado","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1490,"y":2720,"wires":[]},{"id":"96d545cc.ca50c8","type":"file in","z":"25c07f17.d1356","name":"Cargar archivo del historial con el nombre","filename":"Estandar_20240930_111940_temp1.csv","format":"utf8","chunk":false,"sendError":false,"encoding":"none","x":1180,"y":2840,"wires":[["18544f8a.c53e8"]]},{"id":"18544f8a.c53e8","type":"debug","z":"25c07f17.d1356","name":"cargar archivo donde se guarda temp1 para validar datos","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1590,"y":2840,"wires":[]},{"id":"f6ffcd31.4ad41","type":"csv","z":"25c07f17.d1356","name":"Convertir a CSV","sep":",","hdrin":false,"hdrout":"none","multi":"one","ret":"\\n","temp":"value,timestamp","skip":"0","strings":true,"include_empty_strings":false,"include_null_values":false,"x":1420,"y":2760,"wires":[["57492ac4.d59d44"]]},{"id":"82a718d8.9732f8","type":"inject","z":"25c07f17.d1356","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":900,"y":2840,"wires":[["96d545cc.ca50c8"]]},{"id":"c793b167.cf295","type":"inject","z":"25c07f17.d1356","name":"Delete","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":890,"y":2880,"wires":[["7dec4662.95a0a8"]]},{"id":"7fbbb582.56b40c","type":"link out","z":"25c07f17.d1356","name":"Button principal","links":["e7ec69f6.6c4c48"],"x":435,"y":320,"wires":[]},{"id":"a0ccc382.ca97","type":"link out","z":"25c07f17.d1356","name":"Button estadisticas","links":["ef89de6e.695c9"],"x":435,"y":380,"wires":[]},{"id":"db729b4e.404338","type":"link out","z":"25c07f17.d1356","name":"Button datos","links":["abcba878.d3c218","72c20999.4f7098"],"x":435,"y":440,"wires":[]},{"id":"d6639d2a.46c9b","type":"link out","z":"25c07f17.d1356","name":"Button configuracion","links":["4d2c6e56.3e18c"],"x":435,"y":560,"wires":[]},{"id":"590c27c6.7c86c8","type":"link out","z":"25c07f17.d1356","name":"Button parada de emergencia","links":["3dd45a68.e00f56","a6986a2a.897e78"],"x":435,"y":680,"wires":[]},{"id":"9e4043a.ec007c","type":"function","z":"25c07f17.d1356","name":"Agregar _variable.csv","func":"let dropdownValue = msg.payload; // El valor que proviene del dropdown\nlet label = \"\"; // Para almacenar el label\n\n// Mapear el valor seleccionado a su correspondiente label\nswitch (dropdownValue) {\n    case \"temp1\":\n        label = \"Temperatura torre 1\";\n        break;\n    case \"temp2\":\n        label = \"Temperatura torre 2\";\n        break;\n    case \"tempr\":\n        label = \"Temperatura resistencia\";\n        break;\n    case \"hum1\":\n        label = \"Humedad torre 1\";\n        break;\n    case \"hum2\":\n        label = \"Humedad torre 2\";\n        break;\n    case \"humr\":\n        label = \"Humedad resistencia\";\n        break;\n    case \"humext\":\n        label = \"Humedad exterior\";\n        break;\n    case \"weight1\":\n        label = \"Peso torre 1\";\n        break;\n    case \"weight2\":\n        label = \"Peso torre 2\";\n        break;\n    default:\n        label = \"Dato desconocido\";\n}\n\nlet filename = global.get('filename') || 'No value';\nmsg.payload = filename.slice(0, -4) + \"_\" + msg.payload + \".csv\";\n\n// Formatear el label como \"label seleccionado vs tiempo\"\nmsg.label = label + \" vs tiempo\";\n\n// Devolver el mensaje con el label agregado\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1440,"y":140,"wires":[["25542a59.574506"]]},{"id":"cad4ae96.1ed66","type":"function","z":"25c07f17.d1356","name":"Temporizador 10 segundos","func":"let interval = context.get('interval');\nlet filename = msg.filename;\nlet label = msg.label; // Agregar label al mensaje\n\n// Si ya existe un intervalo, lo limpiamos\nif (interval) {\n    clearInterval(interval);\n}\n\n// Iniciamos un nuevo intervalo para leer el archivo cada 10 segundos\ninterval = setInterval(() => {\n    node.send({ filename: filename, label: label }); // Enviar el label junto con el filename\n}, 10000); // 10 segundos\n\n// Guardamos el nuevo intervalo en el contexto\ncontext.set('interval', interval);\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1420,"y":260,"wires":[["86ec0522.5e46a8"]]},{"id":"9683f8ab.cfe358","type":"function","z":"25c07f17.d1356","name":"Procesar CSV","func":"let lines = msg.payload.split('\\n');\nlet data = [];\nlet label = msg.label; // Obtener el label actual\n\nlines.forEach(line => {\n    let parts = line.split(',');\n    if(parts.length === 2) {\n        let value = parseFloat(parts[0]);\n        let timestamp = new Date(parts[1]).getTime();\n        data.push({x: timestamp, y: value});\n    }\n});\n\nmsg.payload = [{\n    \"series\": [\"Sensor\"],\n    \"data\": [data],\n    \"labels\": data.map(d => new Date(d.x).toLocaleTimeString())\n}];\n\nmsg.label = label; // Asegurarse de devolver el label\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1400,"y":400,"wires":[["f22b623f.ad054"]]},{"id":"cc1fed20.c50a3","type":"function","z":"25c07f17.d1356","name":"Agregar _variable.csv","func":"let dropdownValue = msg.payload; // El valor que proviene del dropdown\nlet label = \"\"; // Para almacenar el label\n\n// Mapear el valor seleccionado a su correspondiente label\nswitch (dropdownValue) {\n    case \"temp1\":\n        label = \"Temperatura torre 1\";\n        break;\n    case \"temp2\":\n        label = \"Temperatura torre 2\";\n        break;\n    case \"tempr\":\n        label = \"Temperatura resistencia\";\n        break;\n    case \"hum1\":\n        label = \"Humedad torre 1\";\n        break;\n    case \"hum2\":\n        label = \"Humedad torre 2\";\n        break;\n    case \"humr\":\n        label = \"Humedad resistencia\";\n        break;\n    case \"humext\":\n        label = \"Humedad exterior\";\n        break;\n    case \"weight1\":\n        label = \"Peso torre 1\";\n        break;\n    case \"weight2\":\n        label = \"Peso torre 2\";\n        break;\n    default:\n        label = \"Dato desconocido\";\n}\n\nlet filename = global.get('filename') || 'No value';\nmsg.payload = filename.slice(0, -4) + \"_\" + msg.payload + \".csv\";\n\n// Formatear el label como \"label seleccionado vs tiempo\"\nmsg.label = label + \" vs tiempo\";\n\n// Devolver el mensaje con el label agregado\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2220,"y":140,"wires":[["7687b81b.bd5d08"]]},{"id":"57a2bad4.67c5e4","type":"function","z":"25c07f17.d1356","name":"Temporizador 10 segundos","func":"let interval = context.get('interval');\nlet filename = msg.filename;\nlet label = msg.label; // Agregar label al mensaje\n\n// Si ya existe un intervalo, lo limpiamos\nif (interval) {\n    clearInterval(interval);\n}\n\n// Iniciamos un nuevo intervalo para leer el archivo cada 10 segundos\ninterval = setInterval(() => {\n    node.send({ filename: filename, label: label }); // Enviar el label junto con el filename\n}, 10000); // 10 segundos\n\n// Guardamos el nuevo intervalo en el contexto\ncontext.set('interval', interval);\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2200,"y":260,"wires":[["8f2594a0.833808"]]},{"id":"75bf74a9.14010c","type":"function","z":"25c07f17.d1356","name":"Agregar _variable.csv","func":"let dropdownValue = msg.payload; // El valor que proviene del dropdown\nlet label = \"\"; // Para almacenar el label\n\n// Mapear el valor seleccionado a su correspondiente label\nswitch (dropdownValue) {\n    case \"temp1\":\n        label = \"Temperatura torre 1\";\n        break;\n    case \"temp2\":\n        label = \"Temperatura torre 2\";\n        break;\n    case \"tempr\":\n        label = \"Temperatura resistencia\";\n        break;\n    case \"hum1\":\n        label = \"Humedad torre 1\";\n        break;\n    case \"hum2\":\n        label = \"Humedad torre 2\";\n        break;\n    case \"humr\":\n        label = \"Humedad resistencia\";\n        break;\n    case \"humext\":\n        label = \"Humedad exterior\";\n        break;\n    case \"weight1\":\n        label = \"Peso torre 1\";\n        break;\n    case \"weight2\":\n        label = \"Peso torre 2\";\n        break;\n    default:\n        label = \"Dato desconocido\";\n}\n\nlet filename = global.get('filename') || 'No value';\nmsg.payload = filename.slice(0, -4) + \"_\" + msg.payload + \".csv\";\n\n// Formatear el label como \"label seleccionado vs tiempo\"\nmsg.label = label + \" vs tiempo\";\n\n// Devolver el mensaje con el label agregado\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1420,"y":640,"wires":[["565498f6.68dd58"]]},{"id":"c2993fc1.47281","type":"function","z":"25c07f17.d1356","name":"Temporizador 10 segundos","func":"let interval = context.get('interval');\nlet filename = msg.filename;\nlet label = msg.label; // Agregar label al mensaje\n\n// Si ya existe un intervalo, lo limpiamos\nif (interval) {\n    clearInterval(interval);\n}\n\n// Iniciamos un nuevo intervalo para leer el archivo cada 10 segundos\ninterval = setInterval(() => {\n    node.send({ filename: filename, label: label }); // Enviar el label junto con el filename\n}, 10000); // 10 segundos\n\n// Guardamos el nuevo intervalo en el contexto\ncontext.set('interval', interval);\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1400,"y":760,"wires":[["d28c7899.38a068"]]},{"id":"1cef0558.753c2b","type":"function","z":"25c07f17.d1356","name":"Agregar _variable.csv","func":"let dropdownValue = msg.payload; // El valor que proviene del dropdown\nlet label = \"\"; // Para almacenar el label\n\n// Mapear el valor seleccionado a su correspondiente label\nswitch (dropdownValue) {\n    case \"temp1\":\n        label = \"Temperatura torre 1\";\n        break;\n    case \"temp2\":\n        label = \"Temperatura torre 2\";\n        break;\n    case \"tempr\":\n        label = \"Temperatura resistencia\";\n        break;\n    case \"hum1\":\n        label = \"Humedad torre 1\";\n        break;\n    case \"hum2\":\n        label = \"Humedad torre 2\";\n        break;\n    case \"humr\":\n        label = \"Humedad resistencia\";\n        break;\n    case \"humext\":\n        label = \"Humedad exterior\";\n        break;\n    case \"weight1\":\n        label = \"Peso torre 1\";\n        break;\n    case \"weight2\":\n        label = \"Peso torre 2\";\n        break;\n    default:\n        label = \"Dato desconocido\";\n}\n\nlet filename = global.get('filename') || 'No value';\nmsg.payload = filename.slice(0, -4) + \"_\" + msg.payload + \".csv\";\n\n// Formatear el label como \"label seleccionado vs tiempo\"\nmsg.label = label + \" vs tiempo\";\n\n// Devolver el mensaje con el label agregado\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2240,"y":620,"wires":[["9aaa8d30.0d51"]]},{"id":"95146a97.2f6a08","type":"function","z":"25c07f17.d1356","name":"Temporizador 10 segundos","func":"let interval = context.get('interval');\nlet filename = msg.filename;\nlet label = msg.label; // Agregar label al mensaje\n\n// Si ya existe un intervalo, lo limpiamos\nif (interval) {\n    clearInterval(interval);\n}\n\n// Iniciamos un nuevo intervalo para leer el archivo cada 10 segundos\ninterval = setInterval(() => {\n    node.send({ filename: filename, label: label }); // Enviar el label junto con el filename\n}, 10000); // 10 segundos\n\n// Guardamos el nuevo intervalo en el contexto\ncontext.set('interval', interval);\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2220,"y":740,"wires":[["5e5cbf6b.9f7f8"]]},{"id":"25ed14f9.f2c3ac","type":"file","z":"25c07f17.d1356","name":"CSV sensor_weight2","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"false","encoding":"none","x":2260,"y":1840,"wires":[[]]},{"id":"ee019c0f.45ebd","type":"function","z":"25c07f17.d1356","name":"Formato de CSV y de filename","func":"var filename = global.get('filename') || 'No value';\nfilename = filename.slice(0, -4) + \"_weight2.csv\";\nlet value =  msg.payload;\nlet timestamp = new Date().toISOString();\n\nvar csvLine = value + \", \" + timestamp + \"\\n\";\n\nmsg.filename = filename\n// msg.payload = csvLine;\n\nmsg.payload = {\n    value: msg.payload,\n    timestamp: new Date().toISOString(),\n};\n\n\n//Que solo guarde cuando este running en true\nvar running = global.get('running') || false;\n\nif (running === true) {\n    return msg;\n} else {\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1690,"y":1840,"wires":[["82c4be92.cde29","89b751cb.5ad2d"]]},{"id":"82c4be92.cde29","type":"debug","z":"25c07f17.d1356","name":"Nombre y datos del archivo guardado","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2050,"y":1800,"wires":[]},{"id":"89b751cb.5ad2d","type":"csv","z":"25c07f17.d1356","name":"Convertir a CSV","sep":",","hdrin":false,"hdrout":"none","multi":"one","ret":"\\n","temp":"value,timestamp","skip":"0","strings":true,"include_empty_strings":false,"include_null_values":false,"x":1980,"y":1840,"wires":[["25ed14f9.f2c3ac"]]},{"id":"6683eaad.3a67a4","type":"inject","z":"25c07f17.d1356","name":"","props":[{"p":"payload"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":1250,"y":60,"wires":[["8f866775.75c488"]]},{"id":"441ebecd.1e1f","type":"ui_button","z":"25c07f17.d1356","name":"","group":"cabc2e85.6276b","order":14,"width":5,"height":1,"passthru":false,"label":"Curvas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":240,"y":500,"wires":[["df0e9941.a6f168"]]},{"id":"df0e9941.a6f168","type":"link out","z":"25c07f17.d1356","name":"Button curvas","links":["9fc5e761.afc3b8"],"x":435,"y":500,"wires":[]},{"id":"d1e07c86958fa3bf","type":"ui_media","z":"25c07f17.d1356","group":"cabc2e85.6276b","name":"","width":5,"height":2,"order":25,"category":"foto","file":"4.png","layout":"adjust","showcontrols":true,"loop":true,"onstart":false,"scope":"local","tooltip":"","x":250,"y":220,"wires":[[]]},{"id":"f146c709c86fd0ca","type":"ui_media","z":"25c07f17.d1356","group":"cabc2e85.6276b","name":"","width":5,"height":2,"order":1,"category":"foto","file":"logo-2.png","layout":"adjust","showcontrols":true,"loop":true,"onstart":false,"scope":"local","tooltip":"","x":250,"y":260,"wires":[[]]},{"id":"3135a557.1681ea","type":"ui_button","z":"f7b8fc48.f0fef","name":"","group":"6896531b.8e06bc","order":19,"width":3,"height":1,"passthru":false,"label":"Shaker 1","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":680,"y":280,"wires":[["627f6487.102e7c"]]},{"id":"627f6487.102e7c","type":"debug","z":"f7b8fc48.f0fef","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":890,"y":280,"wires":[]},{"id":"a3192b3.ecc41d8","type":"ui_button","z":"f7b8fc48.f0fef","name":"","group":"6896531b.8e06bc","order":21,"width":3,"height":1,"passthru":false,"label":"Shaker 2","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":680,"y":360,"wires":[["9a79fe03.b043a"]]},{"id":"7396d838.3c9d68","type":"ui_button","z":"f7b8fc48.f0fef","name":"","group":"6896531b.8e06bc","order":25,"width":3,"height":1,"passthru":false,"label":"Ventilador","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":680,"y":440,"wires":[["2380605f.363b6"]]},{"id":"e0229f33.2bb05","type":"ui_button","z":"f7b8fc48.f0fef","name":"","group":"6896531b.8e06bc","order":27,"width":3,"height":1,"passthru":false,"label":"Posicionador","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":690,"y":480,"wires":[["532b67d6.521f88"]]},{"id":"9a79fe03.b043a","type":"debug","z":"f7b8fc48.f0fef","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":910,"y":360,"wires":[]},{"id":"2380605f.363b6","type":"debug","z":"f7b8fc48.f0fef","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":930,"y":440,"wires":[]},{"id":"532b67d6.521f88","type":"debug","z":"f7b8fc48.f0fef","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":970,"y":480,"wires":[]},{"id":"99f2cbb9.f28e88","type":"ui_button","z":"f7b8fc48.f0fef","name":"","group":"6896531b.8e06bc","order":7,"width":5,"height":1,"passthru":false,"label":"Principal","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":140,"y":260,"wires":[["3af765ff.fd9c4a"]]},{"id":"fcbe0a4.459eef8","type":"ui_button","z":"f7b8fc48.f0fef","name":"","group":"6896531b.8e06bc","order":11,"width":5,"height":1,"passthru":false,"label":"Graficas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":140,"y":320,"wires":[["128eecbc.75fb93"]]},{"id":"cebe68b1.3f52f8","type":"ui_button","z":"f7b8fc48.f0fef","name":"","group":"6896531b.8e06bc","order":23,"width":5,"height":1,"passthru":false,"label":"Recetas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":140,"y":380,"wires":[["152bf6bb.cd64c9"]]},{"id":"8876fe92.7db51","type":"ui_button","z":"f7b8fc48.f0fef","name":"","group":"6896531b.8e06bc","order":30,"width":5,"height":1,"passthru":false,"label":"Configuración","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":160,"y":500,"wires":[["77ce16e9.566568"]]},{"id":"ea60ad59.65cfc","type":"ui_button","z":"f7b8fc48.f0fef","name":"","group":"6896531b.8e06bc","order":32,"width":5,"height":2,"passthru":false,"label":"Parada de emergencia","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":180,"y":620,"wires":[["b4c026ea.cdd4b8"]]},{"id":"8f9947db.8eb0f8","type":"ui_text_input","z":"f7b8fc48.f0fef","name":"Tiempo de prueba 2","label":"Tiempo de prueba","tooltip":"ingresar en segundos","group":"6896531b.8e06bc","order":13,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"topic","sendOnBlur":true,"className":"","topicType":"msg","x":720,"y":400,"wires":[[]]},{"id":"10959aeb.c7efc5","type":"ui_text_input","z":"f7b8fc48.f0fef","name":"Tiempo de prueba 1","label":"Tiempo de prueba","tooltip":"ingresar en segundos","group":"6896531b.8e06bc","order":15,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"topic","sendOnBlur":true,"className":"","topicType":"msg","x":720,"y":320,"wires":[[]]},{"id":"3af765ff.fd9c4a","type":"link out","z":"f7b8fc48.f0fef","name":"Button principal","links":["e7ec69f6.6c4c48"],"x":375,"y":260,"wires":[]},{"id":"128eecbc.75fb93","type":"link out","z":"f7b8fc48.f0fef","name":"Button estadisticas","links":["ef89de6e.695c9"],"x":375,"y":320,"wires":[]},{"id":"152bf6bb.cd64c9","type":"link out","z":"f7b8fc48.f0fef","name":"Button datos","links":["abcba878.d3c218","72c20999.4f7098"],"x":375,"y":380,"wires":[]},{"id":"77ce16e9.566568","type":"link out","z":"f7b8fc48.f0fef","name":"Button configuracion","links":["4d2c6e56.3e18c"],"x":375,"y":500,"wires":[]},{"id":"b4c026ea.cdd4b8","type":"link out","z":"f7b8fc48.f0fef","name":"Button parada de emergencia","links":["3dd45a68.e00f56","a6986a2a.897e78"],"x":375,"y":620,"wires":[]},{"id":"dc397e6a.906e6","type":"file in","z":"f7b8fc48.f0fef","name":"Leer historial_procesos","filename":"run/media/mmcblk0p1/historial_procesos.csv","format":"utf8","chunk":false,"sendError":false,"encoding":"none","x":1470,"y":360,"wires":[["d394e8c0.45ba98"]]},{"id":"d394e8c0.45ba98","type":"debug","z":"f7b8fc48.f0fef","name":"Historial","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1760,"y":360,"wires":[]},{"id":"376aaa72.570bc6","type":"inject","z":"f7b8fc48.f0fef","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1260,"y":360,"wires":[["dc397e6a.906e6"]]},{"id":"344a09a2.3428b6","type":"inject","z":"f7b8fc48.f0fef","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1260,"y":520,"wires":[["26a5324b.e47ace"]]},{"id":"26a5324b.e47ace","type":"file","z":"f7b8fc48.f0fef","name":"Eliminar proceso en historial","filename":"run/media/mmcblk0p1/historial_procesos.csv","appendNewline":true,"createDir":false,"overwriteFile":"delete","encoding":"none","x":1480,"y":520,"wires":[[]]},{"id":"445518ae.2fff58","type":"inject","z":"f7b8fc48.f0fef","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1260,"y":240,"wires":[["dcaee17c.e147"]]},{"id":"dcaee17c.e147","type":"file in","z":"f7b8fc48.f0fef","name":"Cargar grafica del historial","filename":"run/media/mmcblk0p1/Estandar_20241028_200809_temp1.csv","format":"utf8","chunk":false,"sendError":false,"encoding":"none","x":1470,"y":240,"wires":[["40c81fb1.268c3"]]},{"id":"40c81fb1.268c3","type":"debug","z":"f7b8fc48.f0fef","name":"Cargado del historial","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1760,"y":240,"wires":[]},{"id":"8ae0582d.82f128","type":"file","z":"f7b8fc48.f0fef","name":"Eliminar proceso en historial estandar","filename":"run/media/mmcblk0p1/historial_procesos_estandar.csv","appendNewline":true,"createDir":false,"overwriteFile":"delete","encoding":"none","x":1510,"y":560,"wires":[[]]},{"id":"119081b8.5fb5ae","type":"inject","z":"f7b8fc48.f0fef","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1260,"y":560,"wires":[["8ae0582d.82f128"]]},{"id":"b67d865a.63a768","type":"file in","z":"f7b8fc48.f0fef","name":"Leer historial_procesos_estandar","filename":"run/media/mmcblk0p1/historial_procesos_estandar.csv","format":"utf8","chunk":false,"sendError":false,"encoding":"none","x":1500,"y":400,"wires":[["a2ddd80a.be3a98"]]},{"id":"a2ddd80a.be3a98","type":"debug","z":"f7b8fc48.f0fef","name":"Estandar","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1760,"y":400,"wires":[]},{"id":"bc857b50.8dd978","type":"inject","z":"f7b8fc48.f0fef","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1260,"y":400,"wires":[["b67d865a.63a768"]]},{"id":"e3d3621.bcf7ba","type":"file","z":"f7b8fc48.f0fef","name":"Eliminar proceso en historial personalizado","filename":"run/media/mmcblk0p1/historial_procesos_personalizado.csv","appendNewline":true,"createDir":false,"overwriteFile":"delete","encoding":"none","x":1530,"y":600,"wires":[[]]},{"id":"a72d0c2b.8302f","type":"inject","z":"f7b8fc48.f0fef","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1260,"y":600,"wires":[["e3d3621.bcf7ba"]]},{"id":"43d2a7d6.41c048","type":"file in","z":"f7b8fc48.f0fef","name":"Leer historial_procesos_personalizado","filename":"run/media/mmcblk0p1/historial_procesos_personalizado.csv","format":"utf8","chunk":false,"sendError":false,"encoding":"none","x":1510,"y":440,"wires":[["da5f787d.66e458"]]},{"id":"da5f787d.66e458","type":"debug","z":"f7b8fc48.f0fef","name":"Personalizado","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1780,"y":440,"wires":[]},{"id":"e8f782e3.0b2bf","type":"inject","z":"f7b8fc48.f0fef","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1260,"y":440,"wires":[["43d2a7d6.41c048"]]},{"id":"2511ab7c.de70e4","type":"ui_button","z":"f7b8fc48.f0fef","name":"","group":"6896531b.8e06bc","order":17,"width":5,"height":1,"passthru":false,"label":"Curvas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":140,"y":440,"wires":[["1b1c35c2.ebd9ba"]]},{"id":"1b1c35c2.ebd9ba","type":"link out","z":"f7b8fc48.f0fef","name":"Button curvas","links":["9fc5e761.afc3b8"],"x":375,"y":440,"wires":[]},{"id":"28960129.d390ee","type":"inject","z":"f7b8fc48.f0fef","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1260,"y":200,"wires":[["b5c5b7d2.315a18"]]},{"id":"b5c5b7d2.315a18","type":"file in","z":"f7b8fc48.f0fef","name":"Cargar archivo del historial","filename":"run/media/mmcblk0p1/Estandar_20241028_200809.csv","format":"utf8","chunk":false,"sendError":false,"encoding":"none","x":1480,"y":200,"wires":[["24e7cd74.438242"]]},{"id":"24e7cd74.438242","type":"debug","z":"f7b8fc48.f0fef","name":"Cargado del historial","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1760,"y":200,"wires":[]},{"id":"7cd37fdc.65c84","type":"ui_text","z":"f7b8fc48.f0fef","group":"6896531b.8e06bc","order":6,"width":13,"height":2,"name":"","label":"Panel de control","format":"Configuración","layout":"col-center","className":"Label_proceso_estandar","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"30","color":"#b0b6bd","x":840,"y":120,"wires":[]},{"id":"3a84a2c6.25f42e","type":"function","z":"f7b8fc48.f0fef","name":"Check userRole","func":"let role = global.get(\"userRole\");\n\nif (role === \"admin\") {\n    msg.payload = \"funciona\"\n    return msg;  // Allow access for admin\n} else {\n    return null; // Block access for others\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1080,"y":900,"wires":[["d6e03256.5dd58"]]},{"id":"c89b551d.d0bae8","type":"ui_button","z":"f7b8fc48.f0fef","name":"Admin Only Button","group":"6896531b.8e06bc","order":2,"width":4,"height":1,"passthru":false,"label":"{{msg.Label}}","tooltip":"Solo usuario admin","color":"{{msg.color}}","bgcolor":"{{msg.bgcolor}}","className":"","icon":"{{msg.icon}}","payload":"","payloadType":"str","topic":"","topicType":"str","x":810,"y":900,"wires":[["3a84a2c6.25f42e"]]},{"id":"d5310a4e.87d848","type":"inject","z":"f7b8fc48.f0fef","name":"Set userRole to Operador","props":[],"repeat":"60","crontab":"","once":true,"onceDelay":0.1,"topic":"","x":220,"y":920,"wires":[["d207739f.883ce"]]},{"id":"d207739f.883ce","type":"function","z":"f7b8fc48.f0fef","name":"Role operador","func":"global.set('userRole', \"operador\");\ncontext.set('color', 'white');\nmsg.bgcolor = '#cd6a6a';\nmsg.color = 'white';\nmsg.icon = 'fa-lock';\nmsg.Label = 'Exportar'\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":920,"wires":[["c89b551d.d0bae8"]]},{"id":"95346d24.6efa4","type":"ui_text_input","z":"f7b8fc48.f0fef","name":"","label":"Contraseña","tooltip":"","group":"6896531b.8e06bc","order":4,"width":4,"height":1,"passthru":true,"mode":"password","delay":300,"topic":"topic","sendOnBlur":true,"className":"","topicType":"msg","x":150,"y":760,"wires":[["9ba6982.448da68"]]},{"id":"5c294436.d8c91c","type":"ui_button","z":"f7b8fc48.f0fef","name":"","group":"6896531b.8e06bc","order":29,"width":4,"height":1,"passthru":false,"label":"Desbloquear","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":150,"y":880,"wires":[["7c8a4852.b61408"]]},{"id":"9ba6982.448da68","type":"function","z":"f7b8fc48.f0fef","name":"Global.contrasena","func":"global.set('contrasena', msg.payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":490,"y":760,"wires":[[]]},{"id":"7c8a4852.b61408","type":"function","z":"f7b8fc48.f0fef","name":"Role admin","func":"let contrasena = global.get(\"contrasena\");\n\nif (contrasena === \"penagosadmin24\"){\n    \n    global.set('userRole', \"admin\");\n    \n    //Efectos del botón\n    context.set('color', 'white');\n    msg.bgcolor = '#8adf9d';\n    msg.color = 'white';\n    msg.icon = 'fa-unlock'\n    msg.Label = 'Exportar'\n    \n    return msg;\n}\nelse {\n    return null;\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":490,"y":880,"wires":[["c89b551d.d0bae8"]]},{"id":"427cac6f.56f1c4","type":"comment","z":"f7b8fc48.f0fef","name":"Cambio de rol y validación","info":"","x":190,"y":840,"wires":[]},{"id":"b0a2031c.f94e9","type":"comment","z":"f7b8fc48.f0fef","name":"Exportar datos","info":"","x":800,"y":860,"wires":[]},{"id":"4d58157f.c02e7c","type":"debug","z":"f7b8fc48.f0fef","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1650,"y":900,"wires":[]},{"id":"d6e03256.5dd58","type":"function","z":"f7b8fc48.f0fef","name":"Función para exportar archivos","func":"//función para exportar archivos ordenados\n\n\n//Efectos del botón\ncontext.set('color', 'white');\nmsg.bgcolor = '#8adf9d';\nmsg.color = 'white';\nmsg.icon = 'fa-thumbs-up'\nmsg.Label = \"Exportado\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1370,"y":900,"wires":[["4d58157f.c02e7c","c89b551d.d0bae8"]]},{"id":"4370fa3d.9a5724","type":"ui_text","z":"f7b8fc48.f0fef","group":"6896531b.8e06bc","order":9,"width":6,"height":1,"name":"","label":"Prueba de actuadores","format":"","layout":"row-center","className":"text-blue","style":false,"font":"","fontSize":16,"color":"#000000","x":720,"y":240,"wires":[]},{"id":"e0941ba0.5600c8","type":"ui_text","z":"f7b8fc48.f0fef","group":"6896531b.8e06bc","order":3,"width":4,"height":1,"name":"","label":"Usuarios","format":"","layout":"row-center","className":"text-blue","style":false,"font":"","fontSize":16,"color":"#000000","x":140,"y":720,"wires":[]},{"id":"42279f6c.8e744","type":"ui_button","z":"f60cb17c.592a4","name":"","group":"5c49ed12.764434","order":5,"width":5,"height":1,"passthru":false,"label":"Principal","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":200,"y":260,"wires":[["7f5a5c85.193c24"]]},{"id":"77ef5702.307bc8","type":"ui_button","z":"f60cb17c.592a4","name":"","group":"5c49ed12.764434","order":7,"width":5,"height":1,"passthru":false,"label":"Graficas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":200,"y":320,"wires":[["2259c40a.a25b8c"]]},{"id":"43d0a4ec.ed1c4c","type":"ui_button","z":"f60cb17c.592a4","name":"","group":"5c49ed12.764434","order":9,"width":5,"height":1,"passthru":false,"label":"Recetas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":200,"y":380,"wires":[["6b8a1e6d.a7c6b"]]},{"id":"2cc34632.cc9c5a","type":"ui_button","z":"f60cb17c.592a4","name":"","group":"5c49ed12.764434","order":10,"width":5,"height":1,"passthru":false,"label":"Configuración","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":220,"y":500,"wires":[["ba0a1f06.20072"]]},{"id":"97a1f3f1.ccab6","type":"ui_button","z":"f60cb17c.592a4","name":"","group":"5c49ed12.764434","order":11,"width":5,"height":2,"passthru":false,"label":"Parada de emergencia","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":240,"y":620,"wires":[["7e302a70.4979c4"]]},{"id":"90d7ca57.d96c38","type":"inject","z":"f60cb17c.592a4","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":830,"y":160,"wires":[["59e1d162.08853"]]},{"id":"ccc14997.a22608","type":"file in","z":"f60cb17c.592a4","name":"Leer historial_procesos.csv","filename":"","format":"utf8","chunk":false,"sendError":true,"encoding":"none","x":880,"y":300,"wires":[["4d9059fd.b3d578"]]},{"id":"e3816b7f.4c0b98","type":"debug","z":"f60cb17c.592a4","name":"Mostrar en debug","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1190,"y":520,"wires":[]},{"id":"a31cf119.166be","type":"ui_dropdown","z":"f60cb17c.592a4","name":"Dropdown seleccionar archivo","label":"Seleccionar proceso","tooltip":"","place":"Seleccione...","group":"5c49ed12.764434","order":2,"width":13,"height":1,"passthru":true,"multiple":false,"options":[],"payload":"","topic":"","topicType":"str","className":"Dropdown","x":890,"y":420,"wires":[["2000859b.21dc0a"]]},{"id":"17f0e6af.c2c869","type":"function","z":"f60cb17c.592a4","name":"Procesar CSV","func":"let lines = msg.payload.split('\\n');\nlet data = [];\n\nlines.forEach(line => {\n    let parts = line.split(',');\n    if(parts.length === 2) {\n        let value = parseFloat(parts[0]);\n        let timestamp = new Date(parts[1]).getTime();\n        data.push({x: timestamp, y: value});\n    }\n});\n\nmsg.payload = [{\n    \"series\": [\"Sensor\"],\n    \"data\": [data],\n    \"labels\": data.map(d => new Date(d.x).toLocaleTimeString())\n}];\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":940,"y":860,"wires":[["2b3a0379.974cdc"]]},{"id":"e84a38b9.64a0b8","type":"file in","z":"f60cb17c.592a4","name":"Read CSV","filename":"","format":"utf8","chunk":false,"sendError":true,"encoding":"none","x":1050,"y":780,"wires":[["17f0e6af.c2c869"]]},{"id":"7f113301.d814ac","type":"change","z":"f60cb17c.592a4","name":"Set filename","rules":[{"t":"set","p":"filename","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":970,"y":700,"wires":[["4b911240.287f9c"]]},{"id":"2b3a0379.974cdc","type":"ui_chart","z":"f60cb17c.592a4","name":"Dropdown1","group":"5c49ed12.764434","order":6,"width":13,"height":9,"label":"{{msg.label}}","chartType":"line","legend":"false","xformat":"HH:mm","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"86400","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd"],"outputs":1,"useDifferentColor":false,"className":"","x":950,"y":920,"wires":[[]]},{"id":"4b911240.287f9c","type":"function","z":"f60cb17c.592a4","name":"Nombre grafica","func":"sensor = msg.filename\n\n// Remover \"sensor_\" del inicio\nsensor = sensor.replace(\"sensor_\", \"\");\n\n// Remover \".csv\" del final\nsensor = sensor.replace(\".csv\", \"\");\n\n// Agregar \" vs tiempo\"\nsensor += \" vs tiempo\";\n\nmsg.sensor = sensor\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":860,"y":780,"wires":[["e84a38b9.64a0b8"]]},{"id":"4ef8885d.585a28","type":"inject","z":"f60cb17c.592a4","name":"","props":[{"p":"payload"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":810,"y":580,"wires":[["64f7d83b.5b6ed8"]]},{"id":"f43099e2.bdd1a8","type":"function","z":"f60cb17c.592a4","name":"Global Set variables global.filename_historial","func":"global.set('filename_historial', msg.filename);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1250,"y":480,"wires":[[]]},{"id":"8da74e6f.505dc","type":"link in","z":"f60cb17c.592a4","name":"Actualizar historial en curvas","links":["1e82e6a7.1e0709","df0e9941.a6f168","1f8e6b08.fa6cc5","1b1c35c2.ebd9ba","8b1c688f.1c2fd8","f859306e.4fdc6"],"x":635,"y":180,"wires":[["59e1d162.08853"]]},{"id":"64f7d83b.5b6ed8","type":"ui_dropdown","z":"f60cb17c.592a4","name":"","label":"Seleccionar variable","tooltip":"","place":"Gráfica 1","group":"5c49ed12.764434","order":4,"width":13,"height":1,"passthru":true,"multiple":false,"options":[{"label":"Temperatura torre 1","value":"temp1","type":"str"},{"label":"Temperatura torre 2","value":"temp2","type":"str"},{"label":"Temperatura resistencia","value":"tempr","type":"str"},{"label":"Humedad torre 1","value":"hum1","type":"str"},{"label":"Humedad torre 2","value":"hum2","type":"str"},{"label":"Humedad resistencia","value":"humr","type":"str"},{"label":"Humedad exterior","value":"humext","type":"str"},{"label":"Peso torre 1","value":"weight1","type":"str"},{"label":"Peso torre 2","value":"weight2","type":"str"}],"payload":"","topic":"","topicType":"str","className":"Dropdown","x":1000,"y":580,"wires":[["9310370d.c10358"]]},{"id":"59e1d162.08853","type":"function","z":"f60cb17c.592a4","name":"Formatear para el historial","func":"let ruta_sd = global.get('ruta_sd');\nruta_sd = `${ruta_sd}historial_procesos.csv`;\nmsg.filename = ruta_sd\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":870,"y":240,"wires":[["ccc14997.a22608"]]},{"id":"7f5a5c85.193c24","type":"link out","z":"f60cb17c.592a4","name":"Button principal","links":["e7ec69f6.6c4c48"],"x":415,"y":260,"wires":[]},{"id":"2259c40a.a25b8c","type":"link out","z":"f60cb17c.592a4","name":"Button estadisticas","links":["ef89de6e.695c9"],"x":415,"y":320,"wires":[]},{"id":"6b8a1e6d.a7c6b","type":"link out","z":"f60cb17c.592a4","name":"Button datos","links":["abcba878.d3c218","72c20999.4f7098"],"x":415,"y":380,"wires":[]},{"id":"7e302a70.4979c4","type":"link out","z":"f60cb17c.592a4","name":"Button parada de emergencia","links":["3dd45a68.e00f56","a6986a2a.897e78"],"x":415,"y":620,"wires":[]},{"id":"9310370d.c10358","type":"function","z":"f60cb17c.592a4","name":"Agregar _variable.csv","func":"let dropdownValue = msg.payload; // El valor que proviene del dropdown\nlet label = \"\"; // Para almacenar el label\n\n// Mapear el valor seleccionado a su correspondiente label\nswitch (dropdownValue) {\n    case \"temp1\":\n        label = \"Temperatura torre 1\";\n        break;\n    case \"temp2\":\n        label = \"Temperatura torre 2\";\n        break;\n    case \"tempr\":\n        label = \"Temperatura resistencia\";\n        break;\n    case \"hum1\":\n        label = \"Humedad torre 1\";\n        break;\n    case \"hum2\":\n        label = \"Humedad torre 2\";\n        break;\n    case \"humr\":\n        label = \"Humedad resistencia\";\n        break;\n    case \"humext\":\n        label = \"Humedad exterior\";\n        break;\n    case \"weight1\":\n        label = \"Peso torre 1\";\n        break;\n    case \"weight2\":\n        label = \"Peso torre 2\";\n        break;\n    default:\n        label = \"Dato desconocido\";\n}\n\nlet filename = global.get('filename_historial') || 'No value';\nmsg.payload = filename.slice(0, -4) + \"_\" + msg.payload + \".csv\";\n\n// Formatear el label como \"label seleccionado vs tiempo\"\nmsg.label = label + \" vs tiempo\";\n\n// Devolver el mensaje con el label agregado\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":980,"y":640,"wires":[["7f113301.d814ac"]]},{"id":"2000859b.21dc0a","type":"function","z":"f60cb17c.592a4","name":"Recuperar nombre original","func":"let filenamesMap = global.get('filenamesMap');\nlet selectedFormattedName = msg.payload;  // El nombre formateado seleccionado\n\n// Recuperar el nombre original del archivo\nlet originalFilename = filenamesMap[selectedFormattedName];\nif (originalFilename) {\n    let ruta_sd = global.get('ruta_sd');  // Obtener la ruta base\n    msg.filename = `${ruta_sd}${originalFilename}`;  // Construir la ruta completa\n    return msg;\n} else {\n    node.error('No se encontró el archivo original para la selección: ' + selectedFormattedName);\n    return null;\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":880,"y":480,"wires":[["e3816b7f.4c0b98","f43099e2.bdd1a8"]]},{"id":"4d9059fd.b3d578","type":"function","z":"f60cb17c.592a4","name":"Global Obtener nombres de archivos","func":"// Procesar cada línea del historial de archivos\nlet lines = msg.payload.split('\\n');\nlet filenamesMap = {};\nlet filenames = lines.map(line => {\n    let trimmedName = line.trim();\n    \n    // Verificar si el nombre contiene \"Estandar_\" o \"Personalizado_\"\n    let indexEstandar = trimmedName.indexOf('/Estandar_');\n    let indexPersonalizado = trimmedName.indexOf('/Personalizado_');\n    \n    // Determinar el prefijo (Estandar o Personalizado)\n    let prefix = '';\n    let filename = '';\n    if (indexEstandar !== -1) {\n        prefix = 'Estandar';\n        filename = trimmedName.substring(indexEstandar + 1);  // Solo toma desde \"/Estandar_\" en adelante\n    } else if (indexPersonalizado !== -1) {\n        prefix = 'Personalizado';\n        filename = trimmedName.substring(indexPersonalizado + 1);  // Solo toma desde \"/Personalizado_\" en adelante\n    }\n\n    if (filename) {\n        // Remover la extensión .csv\n        let filenameWithoutExt = filename.replace('.csv', '');\n        \n        // Separar el nombre para darle el formato adecuado\n        let parts = filenameWithoutExt.split('_');  // Separar en prefijo, fecha y hora\n        \n        if (parts.length === 3) {\n            let date = parts[1];  // Fecha en formato AAAAMMDD\n            let time = parts[2];  // Hora en formato HHMMSS\n            \n            // Formatear hora y fecha\n            let formattedTime = `${time.slice(0, 2)}:${time.slice(2, 4)}:${time.slice(4, 6)}`; // HH:MM:SS\n            let formattedDate = `${date.slice(6, 8)}/${date.slice(4, 6)}/${date.slice(0, 4)}`; // DD/MM/YYYY\n            \n            let formattedName = `${formattedTime} - ${formattedDate} - ${prefix}`;  // Ejemplo: \"12:25:36 09/10/2024 Estandar\"\n            \n            filenamesMap[formattedName] = filename;  // Mapear el nombre formateado con el nombre original\n            return formattedName;\n        }\n    }\n    return '';  // Si no contiene \"Estandar_\" o \"Personalizado_\", retorna una cadena vacía\n}).filter(name => name !== '');  // Filtrar nombres vacíos\n\n// Invertir el orden de los nombres\nfilenames.reverse();\n\n// Guardar el mapeo en el contexto global\nglobal.set('filenamesMap', filenamesMap);\n\nmsg.options = filenames;  // Solo un arreglo de strings\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":910,"y":360,"wires":[["a31cf119.166be"]]},{"id":"75775232.59f9bc","type":"ui_button","z":"f60cb17c.592a4","name":"","group":"5c49ed12.764434","order":8,"width":5,"height":1,"passthru":false,"label":"Curvas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":200,"y":440,"wires":[["f859306e.4fdc6","59e1d162.08853"]]},{"id":"ba0a1f06.20072","type":"link out","z":"f60cb17c.592a4","name":"Button configuracion","links":["4d2c6e56.3e18c"],"x":415,"y":500,"wires":[]},{"id":"f859306e.4fdc6","type":"link out","z":"f60cb17c.592a4","name":"Button curvas","links":["9fc5e761.afc3b8","8da74e6f.505dc"],"x":415,"y":440,"wires":[]},{"id":"8093bc85.fb6ff","type":"ui_button","z":"2bda8890.ae1fd8","name":"","group":"510760cb.f75bc","order":17,"width":5,"height":1,"passthru":false,"label":"Principal","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":100,"y":160,"wires":[["cf05fa07.af7908"]]},{"id":"8f132a44.4a3eb8","type":"ui_button","z":"2bda8890.ae1fd8","name":"","group":"510760cb.f75bc","order":23,"width":5,"height":1,"passthru":false,"label":"Graficas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":100,"y":220,"wires":[["ac5adc1d.2aba9"]]},{"id":"928d40e.47617c","type":"ui_button","z":"2bda8890.ae1fd8","name":"","group":"510760cb.f75bc","order":34,"width":5,"height":1,"passthru":false,"label":"Recetas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":100,"y":280,"wires":[["14f69ef0.3e1c41"]]},{"id":"a18e5e4f.ca37d","type":"ui_button","z":"2bda8890.ae1fd8","name":"","group":"510760cb.f75bc","order":39,"width":5,"height":1,"passthru":false,"label":"Configuración","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":120,"y":400,"wires":[["f51c669b.6bd408"]]},{"id":"6d34fd8b.b71264","type":"ui_button","z":"2bda8890.ae1fd8","name":"","group":"510760cb.f75bc","order":45,"width":5,"height":2,"passthru":false,"label":"Parada de emergencia","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":140,"y":520,"wires":[["f588da28.cf1c48"]]},{"id":"cf05fa07.af7908","type":"link out","z":"2bda8890.ae1fd8","name":"Button principal","links":["e7ec69f6.6c4c48"],"x":315,"y":160,"wires":[]},{"id":"ac5adc1d.2aba9","type":"link out","z":"2bda8890.ae1fd8","name":"Button estadisticas","links":["ef89de6e.695c9"],"x":315,"y":220,"wires":[]},{"id":"14f69ef0.3e1c41","type":"link out","z":"2bda8890.ae1fd8","name":"Button datos","links":["abcba878.d3c218","72c20999.4f7098","b5b1033a.95896"],"x":315,"y":280,"wires":[]},{"id":"f51c669b.6bd408","type":"link out","z":"2bda8890.ae1fd8","name":"Button configuracion","links":["4d2c6e56.3e18c"],"x":315,"y":400,"wires":[]},{"id":"f588da28.cf1c48","type":"link out","z":"2bda8890.ae1fd8","name":"Button parada de emergencia","links":["3dd45a68.e00f56","a6986a2a.897e78"],"x":315,"y":520,"wires":[]},{"id":"4c5fc09.9dbb94","type":"ui_dropdown","z":"2bda8890.ae1fd8","name":"Dropdown seleccionar archivo","label":"Seleccionar","tooltip":"","place":"Proceso...","group":"510760cb.f75bc","order":55,"width":11,"height":1,"passthru":true,"multiple":false,"options":[],"payload":"","topic":"","topicType":"str","className":"Dropdown","x":810,"y":340,"wires":[["56e089cd.2fc6e8"]]},{"id":"a15f12a0.83393","type":"comment","z":"2bda8890.ae1fd8","name":"Actualización del historial en datos","info":"Para que cuando se presione el botón datos se actulice la lista del historial","x":800,"y":60,"wires":[]},{"id":"6d534192.26a87","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":2,"width":1,"height":1,"name":"","label":"#","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1130,"y":280,"wires":[]},{"id":"21ad67dc.20f878","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":7,"width":1,"height":1,"name":"","label":"1","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1130,"y":320,"wires":[]},{"id":"d07cc84.e691a38","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":12,"width":1,"height":1,"name":"","label":"2","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1130,"y":360,"wires":[]},{"id":"92f2997d.1d5648","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":18,"width":1,"height":1,"name":"","label":"3","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1130,"y":400,"wires":[]},{"id":"50e0299e.d98748","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":24,"width":1,"height":1,"name":"","label":"4","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1130,"y":440,"wires":[]},{"id":"bbed7cf4.436c9","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":30,"width":1,"height":1,"name":"","label":"5","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1130,"y":480,"wires":[]},{"id":"a89b2087.83656","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":35,"width":1,"height":1,"name":"","label":"6","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1130,"y":520,"wires":[]},{"id":"f554e5cc.500b68","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":40,"width":1,"height":1,"name":"","label":"7","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1130,"y":560,"wires":[]},{"id":"c5596331.67b7e","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":46,"width":1,"height":1,"name":"","label":"8","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1130,"y":600,"wires":[]},{"id":"7cf1389a.7c5b68","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":50,"width":1,"height":1,"name":"","label":"9","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1130,"y":640,"wires":[]},{"id":"8540567a.4b61d8","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":3,"width":3,"height":1,"name":"","label":"Temperatura","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1350,"y":280,"wires":[]},{"id":"85329e4.bc24c6","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":4,"width":3,"height":1,"name":"","label":"Tiempo","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1340,"y":680,"wires":[]},{"id":"d87432aa.f5a34","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":5,"width":3,"height":1,"name":"","label":"Shaker","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1340,"y":1080,"wires":[]},{"id":"f9b49e53.2e25d","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":6,"width":3,"height":1,"name":"","label":"Ciclos","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":710,"y":1040,"wires":[]},{"id":"6e2d40a0.6dcc3","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":16,"width":3,"height":1,"name":"","label":"Flujo","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":710,"y":1140,"wires":[]},{"id":"a7c12a61.09bdc8","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":8,"width":3,"height":1,"name":"1temp","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":320,"wires":[]},{"id":"8d94a089.63c8b","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":13,"width":3,"height":1,"name":"2temp","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":360,"wires":[]},{"id":"6c0a25a.23bacdc","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":19,"width":3,"height":1,"name":"3temp","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":400,"wires":[]},{"id":"d2a2deb4.1a90b","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":25,"width":3,"height":1,"name":"4temp","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":440,"wires":[]},{"id":"9ccd1291.c13be","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":31,"width":3,"height":1,"name":"5temp","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":480,"wires":[]},{"id":"6b33984b.4db358","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":36,"width":3,"height":1,"name":"6temp","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":520,"wires":[]},{"id":"a5553aa5.b241f8","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":41,"width":3,"height":1,"name":"7temp","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":560,"wires":[]},{"id":"54236735.372218","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":47,"width":3,"height":1,"name":"8temp","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":600,"wires":[]},{"id":"48242f73.5bf06","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":51,"width":3,"height":1,"name":"9temp","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":640,"wires":[]},{"id":"76593ed5.4697c","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":9,"width":3,"height":1,"name":"1time","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":720,"wires":[]},{"id":"6860e46d.af67cc","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":14,"width":3,"height":1,"name":"2time","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":760,"wires":[]},{"id":"f38e6c1c.9afa","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":20,"width":3,"height":1,"name":"3time","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":800,"wires":[]},{"id":"f663c6db.23a2f8","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":26,"width":3,"height":1,"name":"4time","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":840,"wires":[]},{"id":"5af294be.e386cc","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":32,"width":3,"height":1,"name":"5time","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":880,"wires":[]},{"id":"705567ba.187198","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":37,"width":3,"height":1,"name":"6time","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":920,"wires":[]},{"id":"e735479b.3e0e58","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":42,"width":3,"height":1,"name":"7time","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":960,"wires":[]},{"id":"792b6bdd.1cd574","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":48,"width":3,"height":1,"name":"8time","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":1000,"wires":[]},{"id":"83ee3a3c.5cc498","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":52,"width":3,"height":1,"name":"9time","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":1040,"wires":[]},{"id":"25ee9bbf.317f94","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":10,"width":3,"height":1,"name":"1shak","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":1120,"wires":[]},{"id":"f62aeca0.5e116","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":15,"width":3,"height":1,"name":"2shak","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":1160,"wires":[]},{"id":"d2059a03.b103e8","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":21,"width":3,"height":1,"name":"3shak","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":1200,"wires":[]},{"id":"af956d17.c47db","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":27,"width":3,"height":1,"name":"4shak","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":1240,"wires":[]},{"id":"134154de.8ff8fb","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":33,"width":3,"height":1,"name":"5shak","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":1280,"wires":[]},{"id":"fb23308f.f38b2","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":38,"width":3,"height":1,"name":"6shak","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":1320,"wires":[]},{"id":"7f736b2e.a38374","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":43,"width":3,"height":1,"name":"7shak","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":1360,"wires":[]},{"id":"120ffd2d.adb973","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":49,"width":3,"height":1,"name":"8shak","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":1400,"wires":[]},{"id":"ec5aec8.635741","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":53,"width":3,"height":1,"name":"9shak","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":1440,"wires":[]},{"id":"fe94e1c4.bee3b","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":11,"width":3,"height":1,"name":"ciclos_text","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":730,"y":1080,"wires":[]},{"id":"e3311c26.dd254","type":"ui_text","z":"2bda8890.ae1fd8","group":"510760cb.f75bc","order":22,"width":3,"height":1,"name":"flujo_text","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":720,"y":1180,"wires":[]},{"id":"f0181f85.71e0c","type":"file in","z":"2bda8890.ae1fd8","name":"Leer historial procesos personalizado","filename":"","format":"utf8","chunk":false,"sendError":true,"encoding":"none","x":790,"y":200,"wires":[["5128120.77f50f"]]},{"id":"1a867405.b943dc","type":"file in","z":"2bda8890.ae1fd8","name":"Leer archivo seleccionado","filename":"","format":"utf8","chunk":false,"sendError":true,"encoding":"none","x":790,"y":480,"wires":[["634c3b14.40ff74"]]},{"id":"634c3b14.40ff74","type":"function","z":"2bda8890.ae1fd8","name":"Cargar valores en inputs","func":"let data = msg.payload.split(',');\n\n// Asignamos los valores a cada input (valores después de la fecha)\nmsg.payload1 = data[2] || '';\nmsg.payload2 = data[3] || '';\nmsg.payload3 = data[4] || '';\nmsg.payload4 = data[5] || '';\nmsg.payload5 = data[6] || '';\nmsg.payload6 = data[7] || '';\nmsg.payload7 = data[8] || '';\nmsg.payload8 = data[9] || '';\nmsg.payload9 = data[10] || '';\nmsg.payload10 = data[11] || '';\nmsg.payload11 = data[12] || '';\nmsg.payload12 = data[13] || '';\nmsg.payload13 = data[14] || '';\nmsg.payload14 = data[15] || '';\nmsg.payload15 = data[16] || '';\nmsg.payload16 = data[17] || '';\nmsg.payload17 = data[18] || '';\nmsg.payload18 = data[19] || '';\nmsg.payload19 = data[20] || '';\nmsg.payload20 = data[21] || '';\nmsg.payload21 = data[22] || '';\nmsg.payload22 = data[23] || '';\nmsg.payload23 = data[24] || '';\nmsg.payload24 = data[25] || '';\nmsg.payload25 = data[26] || '';\nmsg.payload26 = data[27] || '';\nmsg.payload27 = data[28] || '';\nmsg.payload28 = data[29] || '';\nmsg.payload29 = data[30] || '';\n\nreturn [\n    { payload: msg.payload1 },\n    { payload: msg.payload2 },\n    { payload: msg.payload3 },\n    { payload: msg.payload4 },\n    { payload: msg.payload5 },\n    { payload: msg.payload6 },\n    { payload: msg.payload7 },\n    { payload: msg.payload8 },\n    { payload: msg.payload9 },\n    { payload: msg.payload10 },\n    { payload: msg.payload11 },\n    { payload: msg.payload12 },\n    { payload: msg.payload13 },\n    { payload: msg.payload14 },\n    { payload: msg.payload15 },\n    { payload: msg.payload16 },\n    { payload: msg.payload17 },\n    { payload: msg.payload18 },\n    { payload: msg.payload19 },\n    { payload: msg.payload20 },\n    { payload: msg.payload21 },\n    { payload: msg.payload22 },\n    { payload: msg.payload23 },\n    { payload: msg.payload24 },\n    { payload: msg.payload25 },\n    { payload: msg.payload26 },\n    { payload: msg.payload27 },\n    { payload: msg.payload28 },\n    { payload: msg.payload29 },\n];\n","outputs":29,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":790,"y":780,"wires":[["a7c12a61.09bdc8","39dda190.bee01e"],["8d94a089.63c8b","963df1f6.5e5ed"],["6c0a25a.23bacdc","d71dc2f2.246cf"],["d2a2deb4.1a90b","189808b4.579e17"],["9ccd1291.c13be","6e85d342.9277ac"],["6b33984b.4db358","5f718653.795bd8"],["a5553aa5.b241f8","375c1a0e.1953c6"],["54236735.372218","d8904b61.a335f8"],["48242f73.5bf06","ee907402.ca14f8"],["76593ed5.4697c","99114d5e.89c0b"],["6860e46d.af67cc","68da3e3f.4d9ec"],["f38e6c1c.9afa","f811be13.bd595"],["f663c6db.23a2f8","12d42b05.2cf2b5"],["5af294be.e386cc","24b52f9d.bceaa"],["705567ba.187198","7f707e92.a351e"],["e735479b.3e0e58","d028a118.0b932"],["792b6bdd.1cd574","6d872786.51d808"],["83ee3a3c.5cc498","9999969.62e8c68"],["25ee9bbf.317f94","cbde295f.b56d48"],["f62aeca0.5e116","5e673938.e368f8"],["d2059a03.b103e8","1e27db18.1edb95"],["af956d17.c47db","354012ea.cc61ae"],["134154de.8ff8fb","f8f81fa7.468fa"],["fb23308f.f38b2","85fbd091.017aa"],["7f736b2e.a38374","35cad692.5c832a"],["120ffd2d.adb973","56d3ddce.6e33d4"],["ec5aec8.635741","1d7114fd.b2eb5b"],["fe94e1c4.bee3b","604c5a58.7d2104"],["e3311c26.dd254","3ef3e888.5e3d68"]]},{"id":"1789cedd.6ff091","type":"comment","z":"2bda8890.ae1fd8","name":"MODIFICADO PENAGOS","info":"","x":790,"y":100,"wires":[]},{"id":"3f1d4498.71f92c","type":"function","z":"2bda8890.ae1fd8","name":"Formatear para el historial","func":"let ruta_sd = global.get('ruta_sd');\nruta_sd = `${ruta_sd}historial_procesos_personalizado.csv`;\nmsg.filename = ruta_sd\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":790,"y":140,"wires":[["f0181f85.71e0c"]]},{"id":"b5b1033a.95896","type":"link in","z":"2bda8890.ae1fd8","name":"Recetas personalizadas is pressed","links":["14f69ef0.3e1c41","152bf6bb.cd64c9","65ff065c.9d0ec8","6b8a1e6d.a7c6b","8289efa3.75134","ab88b926.a4b338","b9bb3c02.428d5","c5c443af.a3f94","db729b4e.404338","e218a0ca.3194"],"x":575,"y":140,"wires":[["3f1d4498.71f92c"]]},{"id":"5128120.77f50f","type":"function","z":"2bda8890.ae1fd8","name":"Global Obtener nombres de archivos","func":"//formato correcto\nlet lines = msg.payload.split('\\n');\nlet filenamesMap = {};\nlet filenames = lines.map(line => {\n    let trimmedName = line.trim();\n    \n// Extraer la parte del nombre que contiene \"Estandar_\"\nlet index = trimmedName.indexOf('/Personalizado_');\nif (index !== -1) {\n    let filename = trimmedName.substring(index + 1);  // Solo toma desde \"/Estandar_\" en adelante\n    \n    // Remover la extensión .csv\n    let filenameWithoutExt = filename.replace('.csv', '');\n    \n    // Separar el nombre para darle el formato adecuado\n    let parts = filenameWithoutExt.split('_');  // Separar en \"Estandar\", fecha y hora\n    \n    if (parts.length === 3) {\n        let date = parts[1];  // Fecha en formato AAAAMMDD\n        let time = parts[2];  // Hora en formato HHMMSS\n        \n        // Formatear hora y fecha\n        let formattedTime = `${time.slice(0, 2)}:${time.slice(2, 4)}:${time.slice(4, 6)}`; // HH:MM:SS\n        let formattedDate = `${date.slice(6, 8)}/${date.slice(4, 6)}/${date.slice(0, 4)}`; // DD/MM/YYYY\n        \n        let formattedName = `${formattedTime} - ${formattedDate} - ${parts[0]}`;  // Ejemplo: \"12:25:36 09/10/2024 Estandar\"\n        \n        filenamesMap[formattedName] = filename;  // Mapear el nombre formateado con el nombre original\n        return formattedName;\n    }\n}\nreturn '';  // Si no contiene \"Estandar_\", retorna una cadena vacía\n}).filter(name => name !== '');  // Filtrar nombres vacíos\n\n// Invertir el orden de los nombres\nfilenames.reverse();\n\n// Guardar el mapeo en el contexto global\nglobal.set('filenamesMap', filenamesMap);\n\nmsg.options = filenames;  // Solo un arreglo de strings\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":810,"y":280,"wires":[["4c5fc09.9dbb94"]]},{"id":"56e089cd.2fc6e8","type":"function","z":"2bda8890.ae1fd8","name":"Recuperar nombre original","func":"let filenamesMap = global.get('filenamesMap');\nlet selectedFormattedName = msg.payload;  // El nombre formateado seleccionado\n\n// Recuperar el nombre original del archivo\nlet originalFilename = filenamesMap[selectedFormattedName];\nif (originalFilename) {\n    let ruta_sd = global.get('ruta_sd');  // Obtener la ruta base\n    msg.filename = `${ruta_sd}${originalFilename}`;  // Construir la ruta completa\n    return msg;\n} else {\n    node.error('No se encontró el archivo original para la selección: ' + selectedFormattedName);\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":800,"y":400,"wires":[["1a867405.b943dc"]]},{"id":"ffd9b625.6025f8","type":"link out","z":"2bda8890.ae1fd8","name":"Button curvas","links":["9fc5e761.afc3b8","8da74e6f.505dc"],"x":315,"y":340,"wires":[]},{"id":"3b0429b5.830f16","type":"ui_button","z":"2bda8890.ae1fd8","name":"","group":"510760cb.f75bc","order":29,"width":5,"height":1,"passthru":false,"label":"Curvas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":100,"y":340,"wires":[["ffd9b625.6025f8"]]},{"id":"a6c0d331.f3e44","type":"ui_button","z":"2bda8890.ae1fd8","name":"","group":"510760cb.f75bc","order":28,"width":3,"height":3,"passthru":false,"label":"Estandar","tooltip":"Recetas","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":1740,"y":100,"wires":[["218e8739.82ef88","b51c8670.b53fc8"]]},{"id":"218e8739.82ef88","type":"change","z":"2bda8890.ae1fd8","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"Data_tab\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":1760,"y":140,"wires":[["2c9c0358.778ddc"]]},{"id":"2c9c0358.778ddc","type":"ui_ui_control","z":"2bda8890.ae1fd8","name":"","events":"all","x":1760,"y":180,"wires":[[]]},{"id":"1c8c9224.1f94fe","type":"ui_button","z":"2bda8890.ae1fd8","name":"","group":"510760cb.f75bc","order":44,"width":3,"height":3,"passthru":false,"label":"Usar receta","tooltip":"","color":"","bgcolor":"","className":"left_menu_button_purple","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":1750,"y":240,"wires":[["cffac200.04964","1dff2e87.6366d1"]]},{"id":"cffac200.04964","type":"change","z":"2bda8890.ae1fd8","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"Personalized_process_tab\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":1760,"y":280,"wires":[["42d32f24.0757b"]]},{"id":"42d32f24.0757b","type":"ui_ui_control","z":"2bda8890.ae1fd8","name":"","events":"all","x":1760,"y":320,"wires":[[]]},{"id":"b51c8670.b53fc8","type":"link out","z":"2bda8890.ae1fd8","name":"Button datos","links":["72c20999.4f7098"],"x":1885,"y":100,"wires":[]},{"id":"39dda190.bee01e","type":"change","z":"2bda8890.ae1fd8","name":"Set 1temp","rules":[{"t":"set","p":"1temp","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1490,"y":320,"wires":[[]]},{"id":"963df1f6.5e5ed","type":"change","z":"2bda8890.ae1fd8","name":"Set 2temp","rules":[{"t":"set","p":"2temp","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1490,"y":360,"wires":[[]]},{"id":"d71dc2f2.246cf","type":"change","z":"2bda8890.ae1fd8","name":"Set 3temp","rules":[{"t":"set","p":"3temp","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1490,"y":400,"wires":[[]]},{"id":"189808b4.579e17","type":"change","z":"2bda8890.ae1fd8","name":"Set 4temp","rules":[{"t":"set","p":"4temp","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1490,"y":440,"wires":[[]]},{"id":"6e85d342.9277ac","type":"change","z":"2bda8890.ae1fd8","name":"Set 5temp","rules":[{"t":"set","p":"5temp","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1490,"y":480,"wires":[[]]},{"id":"5f718653.795bd8","type":"change","z":"2bda8890.ae1fd8","name":"Set 6temp","rules":[{"t":"set","p":"6temp","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1490,"y":520,"wires":[[]]},{"id":"375c1a0e.1953c6","type":"change","z":"2bda8890.ae1fd8","name":"Set 7temp","rules":[{"t":"set","p":"7temp","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1490,"y":560,"wires":[[]]},{"id":"d8904b61.a335f8","type":"change","z":"2bda8890.ae1fd8","name":"Set 8temp","rules":[{"t":"set","p":"8temp","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1490,"y":600,"wires":[[]]},{"id":"ee907402.ca14f8","type":"change","z":"2bda8890.ae1fd8","name":"Set 9temp","rules":[{"t":"set","p":"9temp","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1490,"y":640,"wires":[[]]},{"id":"99114d5e.89c0b","type":"change","z":"2bda8890.ae1fd8","name":"Set 1time","rules":[{"t":"set","p":"1time","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1480,"y":720,"wires":[[]]},{"id":"68da3e3f.4d9ec","type":"change","z":"2bda8890.ae1fd8","name":"Set 2time","rules":[{"t":"set","p":"2time","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1480,"y":760,"wires":[[]]},{"id":"f811be13.bd595","type":"change","z":"2bda8890.ae1fd8","name":"Set 3time","rules":[{"t":"set","p":"3time","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1480,"y":800,"wires":[[]]},{"id":"12d42b05.2cf2b5","type":"change","z":"2bda8890.ae1fd8","name":"Set 4time","rules":[{"t":"set","p":"4time","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1480,"y":840,"wires":[[]]},{"id":"24b52f9d.bceaa","type":"change","z":"2bda8890.ae1fd8","name":"Set 5time","rules":[{"t":"set","p":"5time","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1480,"y":880,"wires":[[]]},{"id":"7f707e92.a351e","type":"change","z":"2bda8890.ae1fd8","name":"Set 6time","rules":[{"t":"set","p":"6time","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1480,"y":920,"wires":[[]]},{"id":"d028a118.0b932","type":"change","z":"2bda8890.ae1fd8","name":"Set 7time","rules":[{"t":"set","p":"7time","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1480,"y":960,"wires":[[]]},{"id":"6d872786.51d808","type":"change","z":"2bda8890.ae1fd8","name":"Set 8time","rules":[{"t":"set","p":"8time","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1480,"y":1000,"wires":[[]]},{"id":"9999969.62e8c68","type":"change","z":"2bda8890.ae1fd8","name":"Set 9time","rules":[{"t":"set","p":"9time","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1480,"y":1040,"wires":[[]]},{"id":"cbde295f.b56d48","type":"change","z":"2bda8890.ae1fd8","name":"Set 1shak","rules":[{"t":"set","p":"1shak","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1480,"y":1120,"wires":[[]]},{"id":"5e673938.e368f8","type":"change","z":"2bda8890.ae1fd8","name":"Set 2shak","rules":[{"t":"set","p":"2shak","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1480,"y":1160,"wires":[[]]},{"id":"1e27db18.1edb95","type":"change","z":"2bda8890.ae1fd8","name":"Set 3shak","rules":[{"t":"set","p":"3shak","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1480,"y":1200,"wires":[[]]},{"id":"354012ea.cc61ae","type":"change","z":"2bda8890.ae1fd8","name":"Set 4shak","rules":[{"t":"set","p":"4shak","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1480,"y":1240,"wires":[[]]},{"id":"f8f81fa7.468fa","type":"change","z":"2bda8890.ae1fd8","name":"Set 5shak","rules":[{"t":"set","p":"5shak","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1480,"y":1280,"wires":[[]]},{"id":"85fbd091.017aa","type":"change","z":"2bda8890.ae1fd8","name":"Set 6shak","rules":[{"t":"set","p":"6shak","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1480,"y":1320,"wires":[[]]},{"id":"35cad692.5c832a","type":"change","z":"2bda8890.ae1fd8","name":"Set 7shak","rules":[{"t":"set","p":"7shak","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1480,"y":1360,"wires":[[]]},{"id":"56d3ddce.6e33d4","type":"change","z":"2bda8890.ae1fd8","name":"Set 8shak","rules":[{"t":"set","p":"8shak","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1480,"y":1400,"wires":[[]]},{"id":"1d7114fd.b2eb5b","type":"change","z":"2bda8890.ae1fd8","name":"Set 9shak","rules":[{"t":"set","p":"9shak","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1480,"y":1440,"wires":[[]]},{"id":"604c5a58.7d2104","type":"change","z":"2bda8890.ae1fd8","name":"Set ciclos","rules":[{"t":"set","p":"ciclos","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":900,"y":1080,"wires":[[]]},{"id":"3ef3e888.5e3d68","type":"change","z":"2bda8890.ae1fd8","name":"Set flujo","rules":[{"t":"set","p":"flujo","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":900,"y":1180,"wires":[[]]},{"id":"1dff2e87.6366d1","type":"function","z":"2bda8890.ae1fd8","name":"Obtener Variables Globales","func":"// Lista de nombres de variables globales en el orden especificado\nlet globalVariables = [\n    \"1temp\", \"2temp\", \"3temp\", \"4temp\", \"5temp\", \"6temp\", \"7temp\", \"8temp\", \"9temp\",\n    \"1time\", \"2time\", \"3time\", \"4time\", \"5time\", \"6time\", \"7time\", \"8time\", \"9time\",\n    \"1shak\", \"2shak\", \"3shak\", \"4shak\", \"5shak\", \"6shak\", \"7shak\", \"8shak\", \"9shak\",\n    \"ciclos\", \"flujo\"\n];\n\n// Crear un mensaje para cada variable\nlet messages = globalVariables.map(varName => {\n    let value = global.get(varName);\n    return { payload: `${value}` };\n});\n\n// Enviar cada mensaje a su propia salida\nreturn messages;\n","outputs":29,"noerr":0,"initialize":"","finalize":"","x":1800,"y":640,"wires":[["dc2f79fe.6b2d78"],["cb67ac15.a3cfb"],["bd7d8154.ad40d"],["7569fa07.726ec4"],["d7a0423f.911ab"],["a88d4a14.e0b9a8"],["fdb0c505.3e3458"],["2bdd40fe.95ed5"],["cb58e03a.9ec51"],["93f1cae7.5442d8"],["68ee4061.259f5"],["4e97676b.c28988"],["8cf6c755.92f018"],["1f21f1bb.613f2e"],["87f20228.c3085"],["d4658499.9810f8"],["74ef8a4f.7b5a74"],["93fcd267.591d"],["590c797c.e59978"],["f1ad8276.c8ea8"],["8649985e.4a24d8"],["8f9257f1.5d59b8"],["39091862.6c9ce8"],["8ca32674.e3c218"],["8d1197b.ee2a168"],["a7771c46.634bc"],["bc8e9c26.950f2"],["be685d4b.65399"],["5262be21.d4adb"]]},{"id":"dc2f79fe.6b2d78","type":"link out","z":"2bda8890.ae1fd8","name":"1temp","links":[],"x":2075,"y":120,"wires":[]},{"id":"cb67ac15.a3cfb","type":"link out","z":"2bda8890.ae1fd8","name":"2temp","links":[],"x":2075,"y":160,"wires":[]},{"id":"bd7d8154.ad40d","type":"link out","z":"2bda8890.ae1fd8","name":"3temp","links":[],"x":2075,"y":200,"wires":[]},{"id":"7569fa07.726ec4","type":"link out","z":"2bda8890.ae1fd8","name":"4temp","links":[],"x":2075,"y":240,"wires":[]},{"id":"d7a0423f.911ab","type":"link out","z":"2bda8890.ae1fd8","name":"5temp","links":[],"x":2075,"y":280,"wires":[]},{"id":"a88d4a14.e0b9a8","type":"link out","z":"2bda8890.ae1fd8","name":"6temp","links":[],"x":2075,"y":320,"wires":[]},{"id":"fdb0c505.3e3458","type":"link out","z":"2bda8890.ae1fd8","name":"7temp","links":[],"x":2075,"y":360,"wires":[]},{"id":"2bdd40fe.95ed5","type":"link out","z":"2bda8890.ae1fd8","name":"8temp","links":[],"x":2075,"y":400,"wires":[]},{"id":"cb58e03a.9ec51","type":"link out","z":"2bda8890.ae1fd8","name":"9temp","links":[],"x":2075,"y":440,"wires":[]},{"id":"93f1cae7.5442d8","type":"link out","z":"2bda8890.ae1fd8","name":"1time","links":[],"x":2095,"y":480,"wires":[]},{"id":"68ee4061.259f5","type":"link out","z":"2bda8890.ae1fd8","name":"2time","links":[],"x":2095,"y":520,"wires":[]},{"id":"4e97676b.c28988","type":"link out","z":"2bda8890.ae1fd8","name":"3time","links":[],"x":2095,"y":560,"wires":[]},{"id":"8cf6c755.92f018","type":"link out","z":"2bda8890.ae1fd8","name":"4time","links":[],"x":2095,"y":600,"wires":[]},{"id":"1f21f1bb.613f2e","type":"link out","z":"2bda8890.ae1fd8","name":"5time","links":[],"x":2095,"y":640,"wires":[]},{"id":"87f20228.c3085","type":"link out","z":"2bda8890.ae1fd8","name":"6time","links":[],"x":2095,"y":680,"wires":[]},{"id":"d4658499.9810f8","type":"link out","z":"2bda8890.ae1fd8","name":"7time","links":[],"x":2095,"y":720,"wires":[]},{"id":"74ef8a4f.7b5a74","type":"link out","z":"2bda8890.ae1fd8","name":"8time","links":[],"x":2095,"y":760,"wires":[]},{"id":"93fcd267.591d","type":"link out","z":"2bda8890.ae1fd8","name":"9time","links":[],"x":2095,"y":800,"wires":[]},{"id":"590c797c.e59978","type":"link out","z":"2bda8890.ae1fd8","name":"1shak","links":[],"x":2075,"y":840,"wires":[]},{"id":"f1ad8276.c8ea8","type":"link out","z":"2bda8890.ae1fd8","name":"2shak","links":[],"x":2075,"y":880,"wires":[]},{"id":"8649985e.4a24d8","type":"link out","z":"2bda8890.ae1fd8","name":"3shak","links":[],"x":2075,"y":920,"wires":[]},{"id":"8f9257f1.5d59b8","type":"link out","z":"2bda8890.ae1fd8","name":"4shak","links":[],"x":2075,"y":960,"wires":[]},{"id":"39091862.6c9ce8","type":"link out","z":"2bda8890.ae1fd8","name":"5shak","links":[],"x":2075,"y":1000,"wires":[]},{"id":"8ca32674.e3c218","type":"link out","z":"2bda8890.ae1fd8","name":"6shak","links":[],"x":2075,"y":1040,"wires":[]},{"id":"8d1197b.ee2a168","type":"link out","z":"2bda8890.ae1fd8","name":"7shak","links":[],"x":2075,"y":1080,"wires":[]},{"id":"a7771c46.634bc","type":"link out","z":"2bda8890.ae1fd8","name":"8shak","links":[],"x":2075,"y":1120,"wires":[]},{"id":"bc8e9c26.950f2","type":"link out","z":"2bda8890.ae1fd8","name":"9shak","links":[],"x":2075,"y":1160,"wires":[]},{"id":"be685d4b.65399","type":"link out","z":"2bda8890.ae1fd8","name":"ciclos","links":[],"x":2095,"y":1200,"wires":[]},{"id":"5262be21.d4adb","type":"link out","z":"2bda8890.ae1fd8","name":"flujo","links":[],"x":2095,"y":1240,"wires":[]},{"id":"b99b1e80.79186","type":"function","z":"6deb710b.55714","name":"Global Start Cronometer","func":"global.set('current_time', 0);\nglobal.set('running', true);\nmsg.payload = 'start';\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":790,"y":240,"wires":[[]]},{"id":"22f0f7fc.ade7e8","type":"link in","z":"6deb710b.55714","name":"Inicio cronometro","links":[],"x":635,"y":240,"wires":[["b99b1e80.79186"]]},{"id":"8c38be2f.19fd1","type":"ui_button","z":"6deb710b.55714","name":"","group":"f4b272b1.bab0a","order":8,"width":5,"height":1,"passthru":false,"label":"Principal","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":200,"y":340,"wires":[["68775bb1.a91334"]]},{"id":"5491b57.fcc264c","type":"ui_button","z":"6deb710b.55714","name":"","group":"f4b272b1.bab0a","order":10,"width":5,"height":1,"passthru":false,"label":"Graficas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":200,"y":400,"wires":[["65d5e286.73089c"]]},{"id":"4a7e6d86.d49a14","type":"ui_button","z":"6deb710b.55714","name":"","group":"f4b272b1.bab0a","order":14,"width":5,"height":1,"passthru":false,"label":"Recetas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":200,"y":460,"wires":[["40fd569b.7ed568"]]},{"id":"ffb10361.0cf37","type":"ui_button","z":"6deb710b.55714","name":"","group":"f4b272b1.bab0a","order":17,"width":5,"height":1,"passthru":false,"label":"Configuración","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":220,"y":580,"wires":[["70c2acac.6351b4"]]},{"id":"4f4ec5f5.b494cc","type":"ui_button","z":"6deb710b.55714","name":"","group":"f4b272b1.bab0a","order":20,"width":5,"height":2,"passthru":false,"label":"Parada de emergencia","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":240,"y":700,"wires":[["1dd8985c.b11c38"]]},{"id":"68775bb1.a91334","type":"link out","z":"6deb710b.55714","name":"Button principal","links":["e7ec69f6.6c4c48"],"x":395,"y":340,"wires":[]},{"id":"65d5e286.73089c","type":"link out","z":"6deb710b.55714","name":"Button estadisticas","links":["ef89de6e.695c9"],"x":395,"y":400,"wires":[]},{"id":"40fd569b.7ed568","type":"link out","z":"6deb710b.55714","name":"Button datos","links":["abcba878.d3c218","72c20999.4f7098","b5b1033a.95896"],"x":395,"y":460,"wires":[]},{"id":"70c2acac.6351b4","type":"link out","z":"6deb710b.55714","name":"Button configuracion","links":["4d2c6e56.3e18c"],"x":395,"y":580,"wires":[]},{"id":"1dd8985c.b11c38","type":"link out","z":"6deb710b.55714","name":"Button parada de emergencia","links":["3dd45a68.e00f56","a6986a2a.897e78"],"x":395,"y":700,"wires":[]},{"id":"b4f2bfb4.1c88d","type":"ui_text","z":"6deb710b.55714","group":"f4b272b1.bab0a","order":6,"width":13,"height":2,"name":"","label":"Proceso definido por el usuario","format":"Ventana de operación","layout":"col-center","className":"Label_proceso_estandar","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"30","color":"#b0b6bd","x":1170,"y":240,"wires":[]},{"id":"29273700.f16168","type":"ui_template","z":"6deb710b.55714","group":"f4b272b1.bab0a","name":"","order":2,"width":2,"height":1,"format":"<div style=\"{{msg.payload.style}};\">\n    <h3 style=\"{{msg.payload.style}}\">Torre 1</h3>\n    <p style=\"{{msg.payload.style}}\">{{msg.payload.value}}</p>\n</div>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","className":"","x":860,"y":80,"wires":[[]]},{"id":"64984df3.367ef4","type":"ui_template","z":"6deb710b.55714","group":"f4b272b1.bab0a","name":"","order":3,"width":2,"height":1,"format":"<div style=\"{{msg.payload.style}};\">\n    <h3 style=\"{{msg.payload.style}}\">Torre 2</h3>\n    <p style=\"{{msg.payload.style}}\">{{msg.payload.value}}</p>\n</div>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","className":"","x":860,"y":120,"wires":[[]]},{"id":"f15dd779.d3b8b8","type":"function","z":"6deb710b.55714","name":"Evaluar torre 1","func":"let torre = global.get('torre') || 'Error';\n\nif (torre === \"1\") {\n    msg.payload = {\n        style: 'background-color: #00ABE5 !important; font-size: 14px;text-align: center;color: white !important',\n        value: 'ON'\n    };\n} else {\n    msg.payload = {\n        style: 'background-color: #B0B6BD !important;font-size: 14px;text-align: center;color: white !important;',\n        value: 'OFF'\n    };\n}\nreturn msg;\n\n\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":660,"y":80,"wires":[["29273700.f16168"]]},{"id":"299bf2f.b64530e","type":"function","z":"6deb710b.55714","name":"Evaluar torre 2","func":"let torre = global.get('torre') || 'Error';\n\nif (torre === \"2\") {\n    msg.payload = {\n        style: 'background-color: #00ABE5 !important; font-size: 14px;text-align: center;color: white !important;',\n        value: 'ON'\n    };\n} else {\n    msg.payload = {\n        style: 'background-color: #B0B6BD !important;font-size: 14px;text-align: center;color: white !important;',\n        value: 'OFF'\n    };\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":660,"y":120,"wires":[["64984df3.367ef4"]]},{"id":"7ae32f12.d39a1","type":"ui_text","z":"6deb710b.55714","group":"f4b272b1.bab0a","order":4,"width":7,"height":1,"name":"","label":"Ciclo actual: ","format":"{{msg.payload}}","layout":"row-left","className":"subprocesos","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#00abe5","x":1570,"y":80,"wires":[]},{"id":"37a2d5fe.9ba96a","type":"ui_text","z":"6deb710b.55714","group":"f4b272b1.bab0a","order":23,"width":6,"height":1,"name":"","label":"Peso","format":"{{msg.payload}}","layout":"col-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#00abe5","x":1010,"y":660,"wires":[]},{"id":"db0051bb.68b6c","type":"ui_text","z":"6deb710b.55714","group":"f4b272b1.bab0a","order":12,"width":6,"height":1,"name":"","label":"Temperatura de la masa","format":"{{msg.payload}}","layout":"col-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#00abe5","x":1030,"y":380,"wires":[]},{"id":"17678df8.739812","type":"ui_text","z":"6deb710b.55714","group":"f4b272b1.bab0a","order":13,"width":7,"height":1,"name":"","label":"Temperatura de la resistencia","format":"{{msg.payload}}","layout":"col-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#00abe5","x":1570,"y":380,"wires":[]},{"id":"59ea712b.c1ac3","type":"ui_text","z":"6deb710b.55714","group":"f4b272b1.bab0a","order":18,"width":6,"height":1,"name":"","label":"Humedad del cafe","format":"{{msg.payload}}","layout":"col-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#00abe5","x":1030,"y":520,"wires":[]},{"id":"59438230.436fbc","type":"ui_text","z":"6deb710b.55714","group":"f4b272b1.bab0a","order":24,"width":7,"height":1,"name":"","label":"Humedad exterior","format":"{{msg.payload}}","layout":"col-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#00abe5","x":1530,"y":660,"wires":[]},{"id":"3dad807a.cb38f","type":"ui_text","z":"6deb710b.55714","group":"f4b272b1.bab0a","order":19,"width":7,"height":1,"name":"","label":"Humedad de la resistencia","format":"{{msg.payload}}","layout":"col-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#00abe5","x":1560,"y":520,"wires":[]},{"id":"868761c5.4c1c7","type":"link in","z":"6deb710b.55714","name":"","links":[],"x":635,"y":660,"wires":[["8bfbe808.98eb68"]]},{"id":"8c4ff06f.3e48d","type":"link in","z":"6deb710b.55714","name":"","links":[],"x":1395,"y":380,"wires":[["17678df8.739812"]]},{"id":"145f8c3e.19d214","type":"link in","z":"6deb710b.55714","name":"","links":[],"x":1395,"y":660,"wires":[["59438230.436fbc"]]},{"id":"f39b82d7.23c99","type":"link in","z":"6deb710b.55714","name":"","links":[],"x":635,"y":380,"wires":[["296c200b.625b1"]]},{"id":"e029aa0f.fb84c8","type":"link in","z":"6deb710b.55714","name":"","links":[],"x":635,"y":520,"wires":[["6310eb50.665034"]]},{"id":"cc007fbf.98bc8","type":"link in","z":"6deb710b.55714","name":"","links":[],"x":1395,"y":520,"wires":[["3dad807a.cb38f"]]},{"id":"296c200b.625b1","type":"function","z":"6deb710b.55714","name":"Torre 1 ON","func":"let torre = global.get('torre') || 'Error';\n\nif (torre === \"1\") {\n    return msg;\n}\nelse {\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":810,"y":380,"wires":[["db0051bb.68b6c"]]},{"id":"d8f8d67b.50fe08","type":"link in","z":"6deb710b.55714","name":"","links":[],"x":635,"y":420,"wires":[["1c0cefdc.14b5b"]]},{"id":"1c0cefdc.14b5b","type":"function","z":"6deb710b.55714","name":"Torre 2 ON","func":"let torre = global.get('torre') || 'Error';\n\nif (torre === \"2\") {\n    return msg;\n}\nelse {\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":810,"y":420,"wires":[["db0051bb.68b6c"]]},{"id":"6310eb50.665034","type":"function","z":"6deb710b.55714","name":"Torre 1 ON","func":"let torre = global.get('torre') || 'Error';\n\nif (torre === \"1\") {\n    return msg;\n}\nelse {\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":810,"y":520,"wires":[["59ea712b.c1ac3"]]},{"id":"ecf93727.dd1f08","type":"function","z":"6deb710b.55714","name":"Torre 2 ON","func":"let torre = global.get('torre') || 'Error';\n\nif (torre === \"2\") {\n    return msg;\n}\nelse {\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":810,"y":560,"wires":[["59ea712b.c1ac3"]]},{"id":"8bfbe808.98eb68","type":"function","z":"6deb710b.55714","name":"Torre 1 ON","func":"let torre = global.get('torre') || 'Error';\n\nif (torre === \"1\") {\n    return msg;\n}\nelse {\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":810,"y":660,"wires":[["37a2d5fe.9ba96a"]]},{"id":"e864cd1e.e3de5","type":"function","z":"6deb710b.55714","name":"Torre 2 ON","func":"let torre = global.get('torre') || 'Error';\n\nif (torre === \"2\") {\n    return msg;\n}\nelse {\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":810,"y":700,"wires":[["37a2d5fe.9ba96a"]]},{"id":"b20de7a3.73d898","type":"link in","z":"6deb710b.55714","name":"","links":[],"x":635,"y":560,"wires":[["ecf93727.dd1f08"]]},{"id":"26f400fa.131ab","type":"link in","z":"6deb710b.55714","name":"","links":[],"x":635,"y":700,"wires":[["e864cd1e.e3de5"]]},{"id":"ec1952f1.d5e66","type":"ui_text","z":"6deb710b.55714","group":"f4b272b1.bab0a","order":15,"width":6,"height":1,"name":"","label":"[ °C ]","format":"","layout":"col-center","className":"unidades","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":16,"color":"#000000","x":1010,"y":420,"wires":[]},{"id":"aab1b4c1.0e5548","type":"ui_text","z":"6deb710b.55714","group":"f4b272b1.bab0a","order":16,"width":7,"height":1,"name":"","label":"[ °C ]","format":"","layout":"row-center","className":"unidades","style":true,"font":"","fontSize":16,"color":"#000000","x":1490,"y":420,"wires":[]},{"id":"760b5c61.d126f4","type":"ui_text","z":"6deb710b.55714","group":"f4b272b1.bab0a","order":21,"width":6,"height":1,"name":"","label":"[ % ]","format":"","layout":"row-center","className":"unidades","style":true,"font":"","fontSize":16,"color":"#000000","x":1010,"y":560,"wires":[]},{"id":"ca1f03cc.67b0f","type":"ui_text","z":"6deb710b.55714","group":"f4b272b1.bab0a","order":27,"width":7,"height":1,"name":"","label":"[ % ]","format":"","layout":"row-center","className":"unidades","style":true,"font":"","fontSize":16,"color":"#000000","x":1490,"y":560,"wires":[]},{"id":"d616893c.3847f8","type":"ui_text","z":"6deb710b.55714","group":"f4b272b1.bab0a","order":26,"width":6,"height":1,"name":"","label":"[ Kg ]","format":"","layout":"row-center","className":"unidades","style":true,"font":"","fontSize":16,"color":"#000000","x":1010,"y":700,"wires":[]},{"id":"9d936d03.98401","type":"ui_text","z":"6deb710b.55714","group":"f4b272b1.bab0a","order":22,"width":7,"height":1,"name":"","label":"[ % ]","format":"","layout":"row-center","className":"unidades","style":true,"font":"","fontSize":16,"color":"#000000","x":1490,"y":700,"wires":[]},{"id":"133a2286.83358d","type":"ui_text","z":"6deb710b.55714","group":"f4b272b1.bab0a","order":9,"width":13,"height":2,"name":"","label":"Tiempo transcurrido: ","format":"{{msg.payload}}","layout":"col-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#00abe5","x":1180,"y":300,"wires":[]},{"id":"d350d70e.71eec8","type":"link in","z":"6deb710b.55714","name":"Actualizar cronometro","links":[],"x":1015,"y":300,"wires":[["133a2286.83358d"]]},{"id":"b15585b7.68f578","type":"link in","z":"6deb710b.55714","name":"","links":[],"x":495,"y":80,"wires":[["f15dd779.d3b8b8","299bf2f.b64530e"]]},{"id":"19fca94e.cee167","type":"ui_button","z":"6deb710b.55714","name":"","group":"f4b272b1.bab0a","order":11,"width":5,"height":1,"passthru":false,"label":"Curvas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":200,"y":520,"wires":[["3bd3187c.07dee8"]]},{"id":"3bd3187c.07dee8","type":"link out","z":"6deb710b.55714","name":"Button curvas","links":["9fc5e761.afc3b8","8da74e6f.505dc"],"x":395,"y":520,"wires":[]},{"id":"51cd60fc.7db1d","type":"link in","z":"6deb710b.55714","name":"Obtener ciclo actual","links":[],"x":1095,"y":80,"wires":[["a0590505.596e48"]]},{"id":"a0590505.596e48","type":"function","z":"6deb710b.55714","name":"Obtener ciclo actual","func":"let valor = parseInt(msg.payload, 10) +1;\n\nmsg.payload = Math.ceil(valor / 2);\n\nreturn msg;\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1270,"y":80,"wires":[["7ae32f12.d39a1","57403b0.b6349c4"]]},{"id":"c1e175ad.dcf268","type":"comment","z":"6deb710b.55714","name":"v1.0.6 Variables personalizado","info":"","x":1300,"y":120,"wires":[]},{"id":"57403b0.b6349c4","type":"debug","z":"6deb710b.55714","name":"funcion","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1560,"y":160,"wires":[]},{"id":"e485f57084c22e86","type":"ui_media","z":"6deb710b.55714","group":"f4b272b1.bab0a","name":"ACIV","width":5,"height":2,"order":25,"category":"foto","file":"4.png","layout":"adjust","showcontrols":true,"loop":true,"onstart":false,"scope":"local","tooltip":"","x":210,"y":220,"wires":[[]]},{"id":"bb1c2e247814adce","type":"ui_media","z":"6deb710b.55714","group":"f4b272b1.bab0a","name":"penagos","width":5,"height":2,"order":1,"category":"foto","file":"logo-2.png","layout":"adjust","showcontrols":true,"loop":true,"onstart":false,"scope":"local","tooltip":"","x":220,"y":280,"wires":[[]]},{"id":"656610a8.a5654","type":"ui_button","z":"51b720ac.77402","name":"","group":"b6a9e047.708fd","order":12,"width":5,"height":1,"passthru":false,"label":"Principal","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":80,"y":160,"wires":[["ef875dc4.03a4a"]]},{"id":"1a36406.9448bc","type":"ui_button","z":"51b720ac.77402","name":"","group":"b6a9e047.708fd","order":18,"width":5,"height":1,"passthru":false,"label":"Graficas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":80,"y":220,"wires":[["ca3047a6.1f0698"]]},{"id":"774aca27.a7cf04","type":"ui_button","z":"51b720ac.77402","name":"","group":"b6a9e047.708fd","order":30,"width":5,"height":1,"passthru":false,"label":"Recetas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":80,"y":280,"wires":[["e3d223fa.e616c"]]},{"id":"7e826411.59604c","type":"ui_button","z":"51b720ac.77402","name":"","group":"b6a9e047.708fd","order":35,"width":5,"height":1,"passthru":false,"label":"Configuración","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":100,"y":420,"wires":[["7dbdb74b.c04688"]]},{"id":"70fca8f2.f707c8","type":"ui_button","z":"51b720ac.77402","name":"","group":"b6a9e047.708fd","order":40,"width":5,"height":2,"passthru":false,"label":"Parada de emergencia","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":120,"y":540,"wires":[["38102553.1e15fa"]]},{"id":"ef875dc4.03a4a","type":"change","z":"51b720ac.77402","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"Start_tab\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":160,"wires":[["f24268da.816268"]]},{"id":"f24268da.816268","type":"ui_ui_control","z":"51b720ac.77402","name":"","events":"all","x":260,"y":120,"wires":[[]]},{"id":"b5fbc350.c7f56","type":"ui_text","z":"51b720ac.77402","group":"b6a9e047.708fd","order":2,"width":1,"height":1,"name":"","label":"#","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":510,"y":60,"wires":[]},{"id":"44e50407.7433ec","type":"ui_button","z":"51b720ac.77402","name":"","group":"b6a9e047.708fd","order":29,"width":3,"height":3,"passthru":false,"label":"Recetas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":2960,"y":280,"wires":[["17a68908.9b8437","2821f81d.ef87d8"]]},{"id":"3413598a.e7b926","type":"ui_text","z":"51b720ac.77402","group":"b6a9e047.708fd","order":7,"width":1,"height":1,"name":"","label":"1","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":510,"y":100,"wires":[]},{"id":"58585a52.0426f4","type":"ui_text","z":"51b720ac.77402","group":"b6a9e047.708fd","order":13,"width":1,"height":1,"name":"","label":"2","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":510,"y":140,"wires":[]},{"id":"d0e9dd79.74e74","type":"ui_text","z":"51b720ac.77402","group":"b6a9e047.708fd","order":19,"width":1,"height":1,"name":"","label":"3","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":510,"y":180,"wires":[]},{"id":"f828fee1.3a524","type":"ui_text","z":"51b720ac.77402","group":"b6a9e047.708fd","order":25,"width":1,"height":1,"name":"","label":"4","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":510,"y":220,"wires":[]},{"id":"63508c97.c02614","type":"ui_text","z":"51b720ac.77402","group":"b6a9e047.708fd","order":31,"width":1,"height":1,"name":"","label":"5","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":510,"y":260,"wires":[]},{"id":"9a251c03.20228","type":"ui_text","z":"51b720ac.77402","group":"b6a9e047.708fd","order":36,"width":1,"height":1,"name":"","label":"6","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":510,"y":300,"wires":[]},{"id":"6abd97f2.a87488","type":"ui_text","z":"51b720ac.77402","group":"b6a9e047.708fd","order":41,"width":1,"height":1,"name":"","label":"7","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":510,"y":340,"wires":[]},{"id":"8b456a04.2909b8","type":"ui_text","z":"51b720ac.77402","group":"b6a9e047.708fd","order":46,"width":1,"height":1,"name":"","label":"8","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":510,"y":380,"wires":[]},{"id":"71cc9520.f6637c","type":"ui_text","z":"51b720ac.77402","group":"b6a9e047.708fd","order":51,"width":1,"height":1,"name":"","label":"9","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":510,"y":420,"wires":[]},{"id":"348a319c.d2dd8e","type":"ui_text","z":"51b720ac.77402","group":"b6a9e047.708fd","order":3,"width":3,"height":1,"name":"","label":"Temperatura","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":910,"y":60,"wires":[]},{"id":"e0432f4a.2b0f8","type":"ui_text_input","z":"51b720ac.77402","name":"1temp","label":"","tooltip":"Ingresar en °C","group":"b6a9e047.708fd","order":8,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"1temp","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":890,"y":100,"wires":[["4e6a1bad.eb89b4","decac606a3021dba"]]},{"id":"6e5ba975.b76048","type":"ui_text_input","z":"51b720ac.77402","name":"2temp","label":"","tooltip":"Ingresar en °C","group":"b6a9e047.708fd","order":14,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"2temp","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":890,"y":140,"wires":[["bdc1ed77.17a8a","4571e344f06c6e57"]]},{"id":"c5f74a98.192028","type":"ui_text_input","z":"51b720ac.77402","name":"3temp","label":"","tooltip":"Ingresar en °C","group":"b6a9e047.708fd","order":20,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"3temp","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":890,"y":180,"wires":[["cc20b67f.4a51f8","be50b4ef3b4d3224"]]},{"id":"9bf28861.208a38","type":"ui_text_input","z":"51b720ac.77402","name":"4temp","label":"","tooltip":"Ingresar en °C","group":"b6a9e047.708fd","order":26,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"4temp","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":890,"y":220,"wires":[["b7f28b8c.6fddf8","75fa4ad986897f8f"]]},{"id":"b1ad7ddf.9f729","type":"ui_text_input","z":"51b720ac.77402","name":"5temp","label":"","tooltip":"Ingresar en °C","group":"b6a9e047.708fd","order":32,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"5temp","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":890,"y":260,"wires":[["ad5d8dad.71bda","77c82ab355fe87dd"]]},{"id":"13f64e74.3f6742","type":"ui_text_input","z":"51b720ac.77402","name":"6temp","label":"","tooltip":"Ingresar en °C","group":"b6a9e047.708fd","order":37,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"6temp","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":890,"y":300,"wires":[["3d8c884f.097998","8e4bc4e8f627ba4d"]]},{"id":"cf9234db.c31a78","type":"ui_text_input","z":"51b720ac.77402","name":"7temp","label":"","tooltip":"Ingresar en °C","group":"b6a9e047.708fd","order":42,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"7temp","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":890,"y":340,"wires":[["17bf324.54014ce","657f295461c518af"]]},{"id":"a85300e8.c5d58","type":"ui_text_input","z":"51b720ac.77402","name":"8temp","label":"","tooltip":"Ingresar en °C","group":"b6a9e047.708fd","order":47,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"8temp","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":890,"y":380,"wires":[["804e6379.f1be7","50995b5d7f26e467"]]},{"id":"b74b9ba1.5ded18","type":"ui_text_input","z":"51b720ac.77402","name":"9temp","label":"","tooltip":"Ingresar en °C","group":"b6a9e047.708fd","order":53,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"9temp","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":890,"y":420,"wires":[["b97ddc70.d69b4","21cc54bb74fd837a"]]},{"id":"c19795bd.5c6b08","type":"ui_text","z":"51b720ac.77402","group":"b6a9e047.708fd","order":4,"width":3,"height":1,"name":"","label":"Tiempo","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1620,"y":60,"wires":[]},{"id":"44798a66.0704b4","type":"ui_text","z":"51b720ac.77402","group":"b6a9e047.708fd","order":5,"width":3,"height":1,"name":"","label":"Shaker","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":2340,"y":60,"wires":[]},{"id":"49595d9a.24a7e4","type":"ui_text_input","z":"51b720ac.77402","name":"1time","label":"","tooltip":"Ingresar en minutos","group":"b6a9e047.708fd","order":9,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"1time","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":1610,"y":100,"wires":[["937b3d54.fdc29","b5a60636bf0c1bb4"]]},{"id":"68d35acc.7e4404","type":"ui_text_input","z":"51b720ac.77402","name":"2time","label":"","tooltip":"Ingresar en minutos","group":"b6a9e047.708fd","order":15,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"2time","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":1610,"y":140,"wires":[["b778c13b.44f1b","cda2ece6f2736dc5"]]},{"id":"745414ac.47b22c","type":"ui_text_input","z":"51b720ac.77402","name":"3time","label":"","tooltip":"Ingresar en minutos","group":"b6a9e047.708fd","order":21,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"3time","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":1610,"y":180,"wires":[["b7d4cd27.f671f","968bd0b404a5e6ab"]]},{"id":"dd718584.1019e8","type":"ui_text_input","z":"51b720ac.77402","name":"4time","label":"","tooltip":"Ingresar en minutos","group":"b6a9e047.708fd","order":27,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"4time","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":1610,"y":220,"wires":[["1bfa1a37.903286","0220e2d8b7c64d61"]]},{"id":"c78d10dd.8a1d9","type":"ui_text_input","z":"51b720ac.77402","name":"5time","label":"","tooltip":"Ingresar en minutos","group":"b6a9e047.708fd","order":33,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"5time","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":1610,"y":260,"wires":[["264775d.938838a","b285b90286005b1c"]]},{"id":"4b132ea4.945a3","type":"ui_text_input","z":"51b720ac.77402","name":"6time","label":"","tooltip":"Ingresar en minutos","group":"b6a9e047.708fd","order":38,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"6time","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":1610,"y":300,"wires":[["a8ca627.1b025a","e52e111079cefa66"]]},{"id":"e8e276c9.0f3b58","type":"ui_text_input","z":"51b720ac.77402","name":"7time","label":"","tooltip":"Ingresar en minutos","group":"b6a9e047.708fd","order":43,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"7time","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":1610,"y":340,"wires":[["8c41f309.c60a1","e4a60332971088ef"]]},{"id":"4751550.03c4aac","type":"ui_text_input","z":"51b720ac.77402","name":"8time","label":"","tooltip":"Ingresar en minutos","group":"b6a9e047.708fd","order":48,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"8time","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":1610,"y":380,"wires":[["1df01337.5c1a9d","23276b9a51e4aabd"]]},{"id":"f4aa1630.855dd8","type":"ui_text_input","z":"51b720ac.77402","name":"9time","label":"","tooltip":"Ingresar en minutos","group":"b6a9e047.708fd","order":52,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"9time","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":1610,"y":420,"wires":[["6e4ef200.90634","5049d00d250da2f7"]]},{"id":"3448ad89.fb6492","type":"ui_text_input","z":"51b720ac.77402","name":"1shak","label":"","tooltip":"Ingresar en segundos","group":"b6a9e047.708fd","order":10,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"1shak","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":2330,"y":100,"wires":[["64581a30.692a24","246757ca9429d6cc"]]},{"id":"f342ea67.4d2058","type":"ui_text_input","z":"51b720ac.77402","name":"2shak","label":"","tooltip":"Ingresar en segundos","group":"b6a9e047.708fd","order":16,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"2shak","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":2330,"y":140,"wires":[["9d6d052f.5a6ac8","0c28191f55024340"]]},{"id":"3c530bf7.760c34","type":"ui_text_input","z":"51b720ac.77402","name":"3shak","label":"","tooltip":"Ingresar en segundos","group":"b6a9e047.708fd","order":22,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"3shak","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":2330,"y":180,"wires":[["88a246e3.a5a868","2b6d9577013a4a36"]]},{"id":"be6c7ce3.3d896","type":"ui_text_input","z":"51b720ac.77402","name":"4shak","label":"","tooltip":"Ingresar en segundos","group":"b6a9e047.708fd","order":28,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"4shak","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":2330,"y":220,"wires":[["accbcd72.5c3d2","977a74777d19551f"]]},{"id":"7de02600.40478c","type":"ui_text_input","z":"51b720ac.77402","name":"5shak","label":"","tooltip":"Ingresar en segundos","group":"b6a9e047.708fd","order":34,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"5shak","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":2330,"y":260,"wires":[["7dda62b3.ea1c0c","8f0256c69c385c10"]]},{"id":"edc4e45c.a3f448","type":"ui_text_input","z":"51b720ac.77402","name":"6shak","label":"","tooltip":"Ingresar en segundos","group":"b6a9e047.708fd","order":39,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"6shak","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":2330,"y":300,"wires":[["2dd2e1fa.587a6e","01bf923909ae888e"]]},{"id":"f20f38c4.655358","type":"ui_text_input","z":"51b720ac.77402","name":"7shak","label":"","tooltip":"Ingresar en segundos","group":"b6a9e047.708fd","order":44,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"7shak","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":2330,"y":340,"wires":[["9c053b98.7f1c78","68343e115b075993"]]},{"id":"edb0c9e5.088478","type":"ui_text_input","z":"51b720ac.77402","name":"8shak","label":"","tooltip":"Ingresar en segundos","group":"b6a9e047.708fd","order":49,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"8shak","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":2330,"y":380,"wires":[["611553a0.1885bc","fc100d38cfee8072"]]},{"id":"9022bd1f.aa64f","type":"ui_text_input","z":"51b720ac.77402","name":"9shak","label":"","tooltip":"Ingresar en segundos","group":"b6a9e047.708fd","order":54,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"9shak","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":2330,"y":420,"wires":[["95c89cea.5f7db","4d1ea3ea63e3d83b"]]},{"id":"c41a8173.4d7c4","type":"ui_button","z":"51b720ac.77402","name":"","group":"b6a9e047.708fd","order":56,"width":7,"height":2,"passthru":false,"label":"Cancelar","tooltip":"","color":"","bgcolor":"#cd6a6a","className":"red_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":2940,"y":680,"wires":[["18345e99.005d51"]]},{"id":"18345e99.005d51","type":"change","z":"51b720ac.77402","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"Start_tab\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2960,"y":740,"wires":[["5d7b8703.4cf268"]]},{"id":"5d7b8703.4cf268","type":"ui_ui_control","z":"51b720ac.77402","name":"","events":"all","x":2960,"y":800,"wires":[[]]},{"id":"f2b8ff6f.fb4f8","type":"ui_button","z":"51b720ac.77402","name":"","group":"b6a9e047.708fd","order":55,"width":6,"height":2,"passthru":false,"label":"Siguiente","tooltip":"","color":"","bgcolor":"#8adf9d","className":"green_button","icon":"","payload":"Personalizado","payloadType":"str","topic":"","topicType":"str","x":100,"y":1340,"wires":[["d037ef00.194aa","392b85f3.48f56a","64f36b1d.aba634","49fc882.d8ec778","20ee7e59.ad8932"]]},{"id":"d037ef00.194aa","type":"change","z":"51b720ac.77402","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"ON_personalized_process_tab\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":480,"y":1460,"wires":[["48c140d5.53bf2"]]},{"id":"48c140d5.53bf2","type":"ui_ui_control","z":"51b720ac.77402","name":"","events":"all","x":660,"y":1460,"wires":[[]]},{"id":"4e6a1bad.eb89b4","type":"change","z":"51b720ac.77402","name":"Set 1temp","rules":[{"t":"set","p":"1temp","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1050,"y":100,"wires":[[]]},{"id":"bdc1ed77.17a8a","type":"change","z":"51b720ac.77402","name":"Set 2temp","rules":[{"t":"set","p":"2temp","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1050,"y":140,"wires":[[]]},{"id":"cc20b67f.4a51f8","type":"change","z":"51b720ac.77402","name":"Set 3temp","rules":[{"t":"set","p":"3temp","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1050,"y":180,"wires":[[]]},{"id":"b7f28b8c.6fddf8","type":"change","z":"51b720ac.77402","name":"Set 4temp","rules":[{"t":"set","p":"4temp","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1050,"y":220,"wires":[[]]},{"id":"ad5d8dad.71bda","type":"change","z":"51b720ac.77402","name":"Set 5temp","rules":[{"t":"set","p":"5temp","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1050,"y":260,"wires":[[]]},{"id":"3d8c884f.097998","type":"change","z":"51b720ac.77402","name":"Set 6temp","rules":[{"t":"set","p":"6temp","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1050,"y":300,"wires":[[]]},{"id":"17bf324.54014ce","type":"change","z":"51b720ac.77402","name":"Set 7temp","rules":[{"t":"set","p":"7temp","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1050,"y":340,"wires":[[]]},{"id":"804e6379.f1be7","type":"change","z":"51b720ac.77402","name":"Set 8temp","rules":[{"t":"set","p":"8temp","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1050,"y":380,"wires":[[]]},{"id":"b97ddc70.d69b4","type":"change","z":"51b720ac.77402","name":"Set 9temp","rules":[{"t":"set","p":"9temp","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1050,"y":420,"wires":[[]]},{"id":"937b3d54.fdc29","type":"change","z":"51b720ac.77402","name":"Set 1time","rules":[{"t":"set","p":"1time","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1760,"y":100,"wires":[[]]},{"id":"b778c13b.44f1b","type":"change","z":"51b720ac.77402","name":"Set 2time","rules":[{"t":"set","p":"2time","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1760,"y":140,"wires":[[]]},{"id":"b7d4cd27.f671f","type":"change","z":"51b720ac.77402","name":"Set 3time","rules":[{"t":"set","p":"3time","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1760,"y":180,"wires":[[]]},{"id":"1bfa1a37.903286","type":"change","z":"51b720ac.77402","name":"Set 4time","rules":[{"t":"set","p":"4time","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1760,"y":220,"wires":[[]]},{"id":"264775d.938838a","type":"change","z":"51b720ac.77402","name":"Set 5time","rules":[{"t":"set","p":"5time","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1760,"y":260,"wires":[[]]},{"id":"a8ca627.1b025a","type":"change","z":"51b720ac.77402","name":"Set 6time","rules":[{"t":"set","p":"6time","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1760,"y":300,"wires":[[]]},{"id":"8c41f309.c60a1","type":"change","z":"51b720ac.77402","name":"Set 7time","rules":[{"t":"set","p":"7time","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1760,"y":340,"wires":[[]]},{"id":"1df01337.5c1a9d","type":"change","z":"51b720ac.77402","name":"Set 8time","rules":[{"t":"set","p":"8time","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1760,"y":380,"wires":[[]]},{"id":"6e4ef200.90634","type":"change","z":"51b720ac.77402","name":"Set 9time","rules":[{"t":"set","p":"9time","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1760,"y":420,"wires":[[]]},{"id":"64581a30.692a24","type":"change","z":"51b720ac.77402","name":"Set 1shak","rules":[{"t":"set","p":"1shak","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2500,"y":100,"wires":[[]]},{"id":"9d6d052f.5a6ac8","type":"change","z":"51b720ac.77402","name":"Set 2shak","rules":[{"t":"set","p":"2shak","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2500,"y":140,"wires":[[]]},{"id":"88a246e3.a5a868","type":"change","z":"51b720ac.77402","name":"Set 3shak","rules":[{"t":"set","p":"3shak","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2500,"y":180,"wires":[[]]},{"id":"accbcd72.5c3d2","type":"change","z":"51b720ac.77402","name":"Set 4shak","rules":[{"t":"set","p":"4shak","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2500,"y":220,"wires":[[]]},{"id":"7dda62b3.ea1c0c","type":"change","z":"51b720ac.77402","name":"Set 5shak","rules":[{"t":"set","p":"5shak","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2500,"y":260,"wires":[[]]},{"id":"2dd2e1fa.587a6e","type":"change","z":"51b720ac.77402","name":"Set 6shak","rules":[{"t":"set","p":"6shak","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2500,"y":300,"wires":[[]]},{"id":"9c053b98.7f1c78","type":"change","z":"51b720ac.77402","name":"Set 7shak","rules":[{"t":"set","p":"7shak","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2500,"y":340,"wires":[[]]},{"id":"611553a0.1885bc","type":"change","z":"51b720ac.77402","name":"Set 8shak","rules":[{"t":"set","p":"8shak","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2500,"y":380,"wires":[[]]},{"id":"95c89cea.5f7db","type":"change","z":"51b720ac.77402","name":"Set 9shak","rules":[{"t":"set","p":"9shak","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2500,"y":420,"wires":[[]]},{"id":"538dc74f.4d5718","type":"ui_text","z":"51b720ac.77402","group":"b6a9e047.708fd","order":6,"width":3,"height":1,"name":"","label":"Ciclos","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":2950,"y":40,"wires":[]},{"id":"7125f56f.5075fc","type":"ui_text_input","z":"51b720ac.77402","name":"ciclos","label":"","tooltip":"Ingresar el número de ciclos","group":"b6a9e047.708fd","order":11,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"ciclos","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":2950,"y":80,"wires":[["159f848.e25c57c","9b4af30d008d1f34"]]},{"id":"159f848.e25c57c","type":"change","z":"51b720ac.77402","name":"Set ciclos","rules":[{"t":"set","p":"ciclos","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":3140,"y":40,"wires":[[]]},{"id":"fa76d914.1b6128","type":"ui_text","z":"51b720ac.77402","group":"b6a9e047.708fd","order":17,"width":3,"height":1,"name":"","label":"Flujo","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":2950,"y":140,"wires":[]},{"id":"d9e8ce45.b53ca","type":"ui_text_input","z":"51b720ac.77402","name":"Flujo","label":"","tooltip":"Ingresar en cual ciclo se reduce el flujo de aire","group":"b6a9e047.708fd","order":23,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"flujo","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":2950,"y":180,"wires":[["d1dc8be4.b33e08","d2554937d01755db"]]},{"id":"d1dc8be4.b33e08","type":"change","z":"51b720ac.77402","name":"Set flujo","rules":[{"t":"set","p":"flujo","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":3140,"y":140,"wires":[[]]},{"id":"ca3047a6.1f0698","type":"link out","z":"51b720ac.77402","name":"Button estadisticas","links":["ef89de6e.695c9"],"x":275,"y":220,"wires":[]},{"id":"e3d223fa.e616c","type":"link out","z":"51b720ac.77402","name":"Button datos","links":["abcba878.d3c218","72c20999.4f7098","b5b1033a.95896"],"x":275,"y":280,"wires":[]},{"id":"7dbdb74b.c04688","type":"link out","z":"51b720ac.77402","name":"Button configuracion","links":["4d2c6e56.3e18c"],"x":275,"y":420,"wires":[]},{"id":"38102553.1e15fa","type":"link out","z":"51b720ac.77402","name":"Button parada de emergencia","links":["3dd45a68.e00f56","a6986a2a.897e78","2ade2ba.f45b3d4"],"x":275,"y":540,"wires":[]},{"id":"392b85f3.48f56a","type":"change","z":"51b720ac.77402","name":"","rules":[{"t":"set","p":"torre","pt":"global","to":"1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":480,"y":1500,"wires":[[]]},{"id":"64f36b1d.aba634","type":"link out","z":"51b720ac.77402","name":"Inicio proceso usuario (siguiente is pressed)","links":["b15585b7.68f578","22f0f7fc.ade7e8","16fd7126.19322f"],"x":415,"y":1420,"wires":[]},{"id":"edc3b760.492b38","type":"comment","z":"51b720ac.77402","name":"Iniciar cronometro","info":"","x":130,"y":1420,"wires":[]},{"id":"871b221c.d05a6","type":"comment","z":"51b720ac.77402","name":"Configurar torre 1 al inicio del proceso","info":"","x":190,"y":1500,"wires":[]},{"id":"49fc882.d8ec778","type":"change","z":"51b720ac.77402","name":"","rules":[{"t":"set","p":"process","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":490,"y":1380,"wires":[[]]},{"id":"a6cf78ff.8ec368","type":"comment","z":"51b720ac.77402","name":"Global.process = Personalizado","info":"","x":170,"y":1380,"wires":[]},{"id":"aa463b15.bfe368","type":"comment","z":"51b720ac.77402","name":"Cambiar tab","info":"","x":110,"y":1460,"wires":[]},{"id":"20ee7e59.ad8932","type":"function","z":"51b720ac.77402","name":"Formato del CSV y nombre del archivo","func":"// OBTENER VARIABLES GLOBALES DE LA RECETA Y COLOCARLOS EN \n// UN FORMATO DE UNA LINEA PARA CSV\n\nvar timestamp = new Date().toISOString();\nvar process = global.get('process') || 'No value';\n// Obtener las variables globales o asignar valor por defecto 0\nvar temp1 = global.get('1temp') || 0;\nvar temp2 = global.get('2temp') || 0;\nvar temp3 = global.get('3temp') || 0;\nvar temp4 = global.get('4temp') || 0;\nvar temp5 = global.get('5temp') || 0;\nvar temp6 = global.get('6temp') || 0;\nvar temp7 = global.get('7temp') || 0;\nvar temp8 = global.get('8temp') || 0;\nvar temp9 = global.get('9temp') || 0;\n\nvar time1 = global.get('1time') || 0;\nvar time2 = global.get('2time') || 0;\nvar time3 = global.get('3time') || 0;\nvar time4 = global.get('4time') || 0;\nvar time5 = global.get('5time') || 0;\nvar time6 = global.get('6time') || 0;\nvar time7 = global.get('7time') || 0;\nvar time8 = global.get('8time') || 0;\nvar time9 = global.get('9time') || 0;\n\nvar shak1 = global.get('1shak') || 0;\nvar shak2 = global.get('2shak') || 0;\nvar shak3 = global.get('3shak') || 0;\nvar shak4 = global.get('4shak') || 0;\nvar shak5 = global.get('5shak') || 0;\nvar shak6 = global.get('6shak') || 0;\nvar shak7 = global.get('7shak') || 0;\nvar shak8 = global.get('8shak') || 0;\nvar shak9 = global.get('9shak') || 0;\n\nvar ciclos = global.get('ciclos') || 0;\nvar flujo = global.get('flujo') || 0;\n\n// Crear línea CSV con los valores obtenidos\nvar csvLine = process + \",\" + timestamp + \",\" + temp1 + \",\" + temp2 + \",\" + temp3 + \",\" + temp4 + \",\" + temp5 + \",\" +\n              temp6 + \",\" + temp7 + \",\" + temp8 + \",\" + temp9 + \",\" +\n              time1 + \",\" + time2 + \",\" + time3 + \",\" + time4 + \",\" + time5 + \",\" +\n              time6 + \",\" + time7 + \",\" + time8 + \",\" + time9 + \",\" +\n              shak1 + \",\" + shak2 + \",\" + shak3 + \",\" + shak4 + \",\" + shak5 + \",\" +\n              shak6 + \",\" + shak7 + \",\" + shak8 + \",\" + shak9 + \",\" + ciclos + \",\" + flujo + \"\\n\";\n\nmsg.payload = csvLine;\n\n//----------------------------------------------------\n\n// DAR FORMATO AL NOMBRE DEL ARCHIVO HORA DE BOGOTA\nlet date = new Date();\n// Convertir a la zona horaria de Bogotá (UTC-5)\nlet options = { timeZone: 'America/Bogota', year: 'numeric', month: '2-digit', day: '2-digit', \n                hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false };\nlet formatter = new Intl.DateTimeFormat('en-GB', options);\nlet parts = formatter.formatToParts(date);\nlet year = parts.find(p => p.type === 'year').value;\nlet month = parts.find(p => p.type === 'month').value;\nlet day = parts.find(p => p.type === 'day').value;\nlet hours = parts.find(p => p.type === 'hour').value;\nlet minutes = parts.find(p => p.type === 'minute').value;\nlet seconds = parts.find(p => p.type === 'second').value;\n// Formato: YYYYMMDD_HHMMSS\nlet formattedDate = `${year}${month}${day}_${hours}${minutes}${seconds}`;\n\n//----------------------------------------------------\n\n//CAMBIAR RUTA DE ALMACENAMIENTO DE LOS CSV\nvar ruta_sd = global.get('ruta_sd') || '';\nlet filename = `${ruta_sd}Personalizado_${formattedDate}.csv`;\nglobal.set('filename', filename); // Guardar en flow.filename\nflow.set('csvline', csvLine);\n\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":550,"y":1540,"wires":[["d048e4b5.f18058","f2a8400.09985c","86ae3190.ffd6b"]]},{"id":"d048e4b5.f18058","type":"function","z":"51b720ac.77402","name":"Obtener nombre del archivo","func":"msg.filename = global.get('filename'); // Obtener el nombre del archivo de flow\nmsg.payload = flow.get('csvline');\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":920,"y":1340,"wires":[["76f7a353.b45fac"]]},{"id":"f2a8400.09985c","type":"function","z":"51b720ac.77402","name":"Formatear para el historial","func":"let filename_proceso_a_guardar = global.get('filename'); // Obtener el nombre del archivo de flow\nmsg.payload = filename_proceso_a_guardar\n\nlet ruta_sd = global.get('ruta_sd');\nruta_sd = `${ruta_sd}historial_procesos.csv`;\nmsg.filename = ruta_sd\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":910,"y":1420,"wires":[["ec41b52b.4d1128"]]},{"id":"76f7a353.b45fac","type":"file","z":"51b720ac.77402","name":"Guardar datos en CSV","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"false","encoding":"none","x":1300,"y":1340,"wires":[[]]},{"id":"ec41b52b.4d1128","type":"file","z":"51b720ac.77402","name":"Guardar proceso en historial","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"false","encoding":"none","x":1320,"y":1420,"wires":[[]]},{"id":"2e6c696a.85f876","type":"comment","z":"51b720ac.77402","name":"Guardado de historial y de receta","info":"","x":170,"y":1540,"wires":[]},{"id":"86ae3190.ffd6b","type":"function","z":"51b720ac.77402","name":"Formatear para el historial de personalizado","func":"let filename_proceso_a_guardar = global.get('filename'); // Obtener el nombre del archivo de flow\nmsg.payload = filename_proceso_a_guardar\n\nlet ruta_sd = global.get('ruta_sd');\nruta_sd = `${ruta_sd}historial_procesos_personalizado.csv`;\nmsg.filename = ruta_sd\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":970,"y":1500,"wires":[["6fa16892.8b1638"]]},{"id":"6fa16892.8b1638","type":"file","z":"51b720ac.77402","name":"Guardar proceso en historial personalizado","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"false","encoding":"none","x":1370,"y":1500,"wires":[[]]},{"id":"cb9db240.1dded","type":"ui_button","z":"51b720ac.77402","name":"","group":"b6a9e047.708fd","order":45,"width":3,"height":3,"passthru":false,"label":"Curvas","tooltip":"","color":"","bgcolor":"#8adf9d","className":"left_menu_button_purple","icon":"","payload":"","payloadType":"str","topic":"","topicType":"str","x":2960,"y":480,"wires":[["2ca7f6cc.3a77da","9035580a.c337e8"]]},{"id":"2ca7f6cc.3a77da","type":"change","z":"51b720ac.77402","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"Waves_tab\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2960,"y":540,"wires":[["b8d8a0c0.0c571"]]},{"id":"b8d8a0c0.0c571","type":"ui_ui_control","z":"51b720ac.77402","name":"","events":"all","x":2960,"y":600,"wires":[[]]},{"id":"17a68908.9b8437","type":"change","z":"51b720ac.77402","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"Data_personalized_tab\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2980,"y":340,"wires":[["35a9ed36.797c72"]]},{"id":"35a9ed36.797c72","type":"ui_ui_control","z":"51b720ac.77402","name":"","events":"all","x":2960,"y":400,"wires":[[]]},{"id":"ea6ce666.0aee08","type":"link out","z":"51b720ac.77402","name":"Button curvas","links":["9fc5e761.afc3b8","8da74e6f.505dc"],"x":275,"y":340,"wires":[]},{"id":"820e818d.545e5","type":"ui_button","z":"51b720ac.77402","name":"","group":"b6a9e047.708fd","order":24,"width":5,"height":1,"passthru":false,"label":"Curvas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":80,"y":340,"wires":[["ea6ce666.0aee08"]]},{"id":"3fc53524.4fe2da","type":"link in","z":"51b720ac.77402","name":"","links":["dc2f79fe.6b2d78"],"x":725,"y":100,"wires":[["e0432f4a.2b0f8"]]},{"id":"1b4df0ee.b94c6f","type":"link in","z":"51b720ac.77402","name":"","links":["cb67ac15.a3cfb"],"x":725,"y":140,"wires":[["6e5ba975.b76048"]]},{"id":"eef7d395.0f106","type":"link in","z":"51b720ac.77402","name":"","links":["bd7d8154.ad40d"],"x":725,"y":180,"wires":[["c5f74a98.192028"]]},{"id":"61fa4d29.1e2f14","type":"link in","z":"51b720ac.77402","name":"","links":["7569fa07.726ec4"],"x":725,"y":220,"wires":[["9bf28861.208a38"]]},{"id":"c6e48894.0bbed8","type":"link in","z":"51b720ac.77402","name":"","links":["d7a0423f.911ab"],"x":725,"y":260,"wires":[["b1ad7ddf.9f729"]]},{"id":"1be4037a.d946ed","type":"link in","z":"51b720ac.77402","name":"","links":["a88d4a14.e0b9a8"],"x":725,"y":300,"wires":[["13f64e74.3f6742"]]},{"id":"affbfae6.464318","type":"link in","z":"51b720ac.77402","name":"","links":["fdb0c505.3e3458"],"x":725,"y":340,"wires":[["cf9234db.c31a78"]]},{"id":"b957f81a.d75f48","type":"link in","z":"51b720ac.77402","name":"","links":["2bdd40fe.95ed5"],"x":725,"y":380,"wires":[["a85300e8.c5d58"]]},{"id":"a79b1362.c69ab","type":"link in","z":"51b720ac.77402","name":"","links":["cb58e03a.9ec51"],"x":725,"y":420,"wires":[["b74b9ba1.5ded18"]]},{"id":"7de60ac6.d7f7d4","type":"link in","z":"51b720ac.77402","name":"","links":["93f1cae7.5442d8"],"x":1435,"y":100,"wires":[["49595d9a.24a7e4"]]},{"id":"81d220b7.dcd64","type":"link in","z":"51b720ac.77402","name":"","links":["68ee4061.259f5"],"x":1435,"y":140,"wires":[["68d35acc.7e4404"]]},{"id":"d99cf84b.77bb08","type":"link in","z":"51b720ac.77402","name":"","links":["4e97676b.c28988"],"x":1435,"y":180,"wires":[["745414ac.47b22c"]]},{"id":"1174a893.634447","type":"link in","z":"51b720ac.77402","name":"","links":["8cf6c755.92f018"],"x":1435,"y":220,"wires":[["dd718584.1019e8"]]},{"id":"69cbb9d.e281a48","type":"link in","z":"51b720ac.77402","name":"","links":["1f21f1bb.613f2e"],"x":1435,"y":260,"wires":[["c78d10dd.8a1d9"]]},{"id":"1015a210.eb603e","type":"link in","z":"51b720ac.77402","name":"","links":["87f20228.c3085"],"x":1435,"y":300,"wires":[["4b132ea4.945a3"]]},{"id":"ccd7e7b4.f112d8","type":"link in","z":"51b720ac.77402","name":"","links":["d4658499.9810f8"],"x":1435,"y":340,"wires":[["e8e276c9.0f3b58"]]},{"id":"b61fe2d6.05729","type":"link in","z":"51b720ac.77402","name":"","links":["74ef8a4f.7b5a74"],"x":1435,"y":380,"wires":[["4751550.03c4aac"]]},{"id":"7d90b20f.33838c","type":"link in","z":"51b720ac.77402","name":"","links":["93fcd267.591d"],"x":1435,"y":420,"wires":[["f4aa1630.855dd8"]]},{"id":"9963a0a6.3fc7a","type":"link in","z":"51b720ac.77402","name":"","links":["590c797c.e59978"],"x":2175,"y":100,"wires":[["3448ad89.fb6492"]]},{"id":"c4fbf640.4c3168","type":"link in","z":"51b720ac.77402","name":"","links":["f1ad8276.c8ea8"],"x":2175,"y":140,"wires":[["f342ea67.4d2058"]]},{"id":"a5fc83f1.23fb5","type":"link in","z":"51b720ac.77402","name":"","links":["8649985e.4a24d8"],"x":2175,"y":180,"wires":[["3c530bf7.760c34"]]},{"id":"3deefeba.958842","type":"link in","z":"51b720ac.77402","name":"","links":["8f9257f1.5d59b8"],"x":2175,"y":220,"wires":[["be6c7ce3.3d896"]]},{"id":"1eea7d0e.d1ae03","type":"link in","z":"51b720ac.77402","name":"","links":["39091862.6c9ce8"],"x":2175,"y":260,"wires":[["7de02600.40478c"]]},{"id":"21912606.09d73a","type":"link in","z":"51b720ac.77402","name":"","links":["8ca32674.e3c218"],"x":2175,"y":300,"wires":[["edc4e45c.a3f448"]]},{"id":"9922f74d.1a44e8","type":"link in","z":"51b720ac.77402","name":"","links":["8d1197b.ee2a168"],"x":2175,"y":340,"wires":[["f20f38c4.655358"]]},{"id":"771c599f.e88cf8","type":"link in","z":"51b720ac.77402","name":"","links":["a7771c46.634bc"],"x":2175,"y":380,"wires":[["edb0c9e5.088478"]]},{"id":"1bfd01ec.6bb36e","type":"link in","z":"51b720ac.77402","name":"","links":["bc8e9c26.950f2"],"x":2175,"y":420,"wires":[["9022bd1f.aa64f"]]},{"id":"68de8209.16f98c","type":"link in","z":"51b720ac.77402","name":"","links":["be685d4b.65399"],"x":2815,"y":80,"wires":[["7125f56f.5075fc"]]},{"id":"7de5041e.0f97dc","type":"link in","z":"51b720ac.77402","name":"","links":["5262be21.d4adb"],"x":2815,"y":180,"wires":[["d9e8ce45.b53ca"]]},{"id":"1128ceb8.07f2e1","type":"comment","z":"51b720ac.77402","name":"v1.0.6 Variables personalizado","info":"","x":760,"y":1300,"wires":[]},{"id":"16fd7126.19322f","type":"link in","z":"51b720ac.77402","name":"Inicio proceso personalizado","links":["64f36b1d.aba634"],"x":2875,"y":900,"wires":[["2aa1ff6f.67be1"]]},{"id":"2aa1ff6f.67be1","type":"function","z":"51b720ac.77402","name":"Enviar true","func":"// Enviar true inmediatamente\nmsg.payload = true;\nnode.send(msg);\n\n// Configurar un temporizador para enviar false después de 1 segundo\nsetTimeout(() => {\n    msg.payload = false;\n    node.send(msg);\n}, 1000);\n\n// Retornar null para que no envíe el mensaje inmediatamente\nreturn null;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3050,"y":900,"wires":[["c3afdd71fa630c33","c7718728b21a3b61"]]},{"id":"81c3ac3c.8f47a","type":"comment","z":"51b720ac.77402","name":"siguiente PROCESO PERSONALIZADO","info":"","x":3020,"y":860,"wires":[]},{"id":"8a08319c.10dab","type":"link in","z":"51b720ac.77402","name":"","links":[],"x":2915,"y":1280,"wires":[["ec4f7f81b08930de"]]},{"id":"2ade2ba.f45b3d4","type":"link in","z":"51b720ac.77402","name":"Button parada de emergencia PROCESO ESTANDAR","links":["1dd8985c.b11c38","38102553.1e15fa","590c27c6.7c86c8","73d1ea74.2335f4","7e302a70.4979c4","b4c026ea.cdd4b8","c837590c.9d64b8","f588da28.cf1c48","f9912931.20a518"],"x":2915,"y":1220,"wires":[["eadd42c5.06ce2","939a32f8.4232e"]]},{"id":"eadd42c5.06ce2","type":"function","z":"51b720ac.77402","name":"Enviar true","func":"// Enviar true inmediatamente\nmsg.payload = true;\nnode.send(msg);\n\n// Configurar un temporizador para enviar false después de 1 segundo\nsetTimeout(() => {\n    msg.payload = false;\n    node.send(msg);\n}, 1000);\n\n// Retornar null para que no envíe el mensaje inmediatamente\nreturn null;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3090,"y":1220,"wires":[["6a0d5d60435205a0"]]},{"id":"939a32f8.4232e","type":"link out","z":"51b720ac.77402","name":"","links":["3dd45a68.e00f56"],"x":3135,"y":1100,"wires":[]},{"id":"1ee714d0.21c9db","type":"comment","z":"51b720ac.77402","name":"boton emergencia MENU INICIO","info":"","x":3250,"y":1060,"wires":[]},{"id":"cb4d1c8c.95aaf","type":"comment","z":"51b720ac.77402","name":"Proceso finalizado PLC X2 y todos los botones de parada de emergencia","info":"","x":3160,"y":1180,"wires":[]},{"id":"9035580a.c337e8","type":"link out","z":"51b720ac.77402","name":"","links":["9fc5e761.afc3b8"],"x":3115,"y":480,"wires":[]},{"id":"2821f81d.ef87d8","type":"link out","z":"51b720ac.77402","name":"","links":["abcba878.d3c218"],"x":3125,"y":280,"wires":[]},{"id":"decac606a3021dba","type":"OpcUa-Item","z":"51b720ac.77402","item":"ns=3;s=USR_TEMP1","datatype":"Float","value":"","name":"","x":920,"y":480,"wires":[["c81b243db9dca6b5"]]},{"id":"c81b243db9dca6b5","type":"OpcUa-Client","z":"51b720ac.77402","endpoint":"9d8e083238bd6420","action":"write","deadbandtype":"a","deadbandvalue":1,"time":10,"timeUnit":"s","certificate":"n","localfile":"","localkeyfile":"","securitymode":"None","securitypolicy":"None","useTransport":false,"maxChunkCount":1,"maxMessageSize":8192,"receiveBufferSize":8192,"sendBufferSize":8192,"setstatusandtime":false,"keepsessionalive":false,"name":"","x":1640,"y":1100,"wires":[[],[],[]]},{"id":"4571e344f06c6e57","type":"OpcUa-Item","z":"51b720ac.77402","item":"ns=3;s=USR_TEMP2","datatype":"Float","value":"","name":"","x":920,"y":540,"wires":[["c81b243db9dca6b5"]]},{"id":"be50b4ef3b4d3224","type":"OpcUa-Item","z":"51b720ac.77402","item":"ns=3;s=USR_TEMP3","datatype":"Float","value":"","name":"","x":920,"y":600,"wires":[["c81b243db9dca6b5"]]},{"id":"75fa4ad986897f8f","type":"OpcUa-Item","z":"51b720ac.77402","item":"ns=3;s=USR_TEMP4","datatype":"Float","value":"","name":"","x":920,"y":660,"wires":[["c81b243db9dca6b5"]]},{"id":"77c82ab355fe87dd","type":"OpcUa-Item","z":"51b720ac.77402","item":"ns=3;s=USR_TEMP5","datatype":"Float","value":"","name":"","x":920,"y":720,"wires":[["c81b243db9dca6b5"]]},{"id":"8e4bc4e8f627ba4d","type":"OpcUa-Item","z":"51b720ac.77402","item":"ns=3;s=USR_TEMP6","datatype":"Float","value":"","name":"","x":920,"y":780,"wires":[["c81b243db9dca6b5"]]},{"id":"657f295461c518af","type":"OpcUa-Item","z":"51b720ac.77402","item":"ns=3;s=USR_TEMP7","datatype":"Float","value":"","name":"","x":920,"y":840,"wires":[["c81b243db9dca6b5"]]},{"id":"50995b5d7f26e467","type":"OpcUa-Item","z":"51b720ac.77402","item":"ns=3;s=USR_TEMP8","datatype":"Float","value":"","name":"","x":920,"y":900,"wires":[["c81b243db9dca6b5"]]},{"id":"21cc54bb74fd837a","type":"OpcUa-Item","z":"51b720ac.77402","item":"ns=3;s=USR_TEMP9","datatype":"Float","value":"","name":"","x":920,"y":960,"wires":[["c81b243db9dca6b5"]]},{"id":"b5a60636bf0c1bb4","type":"OpcUa-Item","z":"51b720ac.77402","item":"ns=3;s=USR_TIME1","datatype":"Float","value":"","name":"","x":1640,"y":480,"wires":[["c81b243db9dca6b5"]]},{"id":"cda2ece6f2736dc5","type":"OpcUa-Item","z":"51b720ac.77402","item":"ns=3;s=USR_TIME2","datatype":"Float","value":"","name":"","x":1640,"y":540,"wires":[["c81b243db9dca6b5"]]},{"id":"968bd0b404a5e6ab","type":"OpcUa-Item","z":"51b720ac.77402","item":"ns=3;s=USR_TIME3","datatype":"Float","value":"","name":"","x":1640,"y":600,"wires":[["c81b243db9dca6b5"]]},{"id":"0220e2d8b7c64d61","type":"OpcUa-Item","z":"51b720ac.77402","item":"ns=3;s=USR_TIME4","datatype":"Float","value":"","name":"","x":1640,"y":660,"wires":[["c81b243db9dca6b5"]]},{"id":"b285b90286005b1c","type":"OpcUa-Item","z":"51b720ac.77402","item":"ns=3;s=USR_TIME5","datatype":"Float","value":"","name":"","x":1640,"y":720,"wires":[["c81b243db9dca6b5"]]},{"id":"e52e111079cefa66","type":"OpcUa-Item","z":"51b720ac.77402","item":"ns=3;s=USR_TIME6","datatype":"Float","value":"","name":"","x":1640,"y":780,"wires":[["c81b243db9dca6b5"]]},{"id":"e4a60332971088ef","type":"OpcUa-Item","z":"51b720ac.77402","item":"ns=3;s=USR_TIME7","datatype":"Float","value":"","name":"","x":1640,"y":840,"wires":[["c81b243db9dca6b5"]]},{"id":"23276b9a51e4aabd","type":"OpcUa-Item","z":"51b720ac.77402","item":"ns=3;s=USR_TIME8","datatype":"Float","value":"","name":"","x":1640,"y":900,"wires":[["c81b243db9dca6b5"]]},{"id":"5049d00d250da2f7","type":"OpcUa-Item","z":"51b720ac.77402","item":"ns=3;s=USR_TIME9","datatype":"Float","value":"","name":"","x":1640,"y":960,"wires":[["c81b243db9dca6b5"]]},{"id":"246757ca9429d6cc","type":"OpcUa-Item","z":"51b720ac.77402","item":"ns=3;s=USR_SHAKER1","datatype":"Float","value":"","name":"","x":2360,"y":480,"wires":[["c81b243db9dca6b5"]]},{"id":"0c28191f55024340","type":"OpcUa-Item","z":"51b720ac.77402","item":"ns=3;s=USR_SHAKER2","datatype":"Float","value":"","name":"","x":2360,"y":540,"wires":[["c81b243db9dca6b5"]]},{"id":"2b6d9577013a4a36","type":"OpcUa-Item","z":"51b720ac.77402","item":"ns=3;s=USR_SHAKER3","datatype":"Float","value":"","name":"","x":2360,"y":600,"wires":[["c81b243db9dca6b5"]]},{"id":"977a74777d19551f","type":"OpcUa-Item","z":"51b720ac.77402","item":"ns=3;s=USR_SHAKER4","datatype":"Float","value":"","name":"","x":2360,"y":660,"wires":[["c81b243db9dca6b5"]]},{"id":"8f0256c69c385c10","type":"OpcUa-Item","z":"51b720ac.77402","item":"ns=3;s=USR_SHAKER5","datatype":"Float","value":"","name":"","x":2360,"y":720,"wires":[["c81b243db9dca6b5"]]},{"id":"01bf923909ae888e","type":"OpcUa-Item","z":"51b720ac.77402","item":"ns=3;s=USR_SHAKER6","datatype":"Float","value":"","name":"","x":2360,"y":780,"wires":[["c81b243db9dca6b5"]]},{"id":"68343e115b075993","type":"OpcUa-Item","z":"51b720ac.77402","item":"ns=3;s=USR_SHAKER7","datatype":"Float","value":"","name":"","x":2360,"y":840,"wires":[["c81b243db9dca6b5"]]},{"id":"fc100d38cfee8072","type":"OpcUa-Item","z":"51b720ac.77402","item":"ns=3;s=USR_SHAKER8","datatype":"Float","value":"","name":"","x":2360,"y":900,"wires":[["c81b243db9dca6b5"]]},{"id":"4d1ea3ea63e3d83b","type":"OpcUa-Item","z":"51b720ac.77402","item":"ns=3;s=USR_SHAKER9","datatype":"Float","value":"","name":"","x":2360,"y":960,"wires":[["c81b243db9dca6b5"]]},{"id":"d2554937d01755db","type":"OpcUa-Item","z":"51b720ac.77402","item":"ns=3;s=CAUDAL","datatype":"Int16","value":"","name":"","x":3160,"y":180,"wires":[["bc815873977453e2"]]},{"id":"9b4af30d008d1f34","type":"OpcUa-Item","z":"51b720ac.77402","item":"ns=3;s=USR_CICLOS","datatype":"Int16","value":"","name":"","x":3160,"y":80,"wires":[["bc815873977453e2"]]},{"id":"bc815873977453e2","type":"OpcUa-Client","z":"51b720ac.77402","endpoint":"9d8e083238bd6420","action":"write","deadbandtype":"a","deadbandvalue":1,"time":10,"timeUnit":"s","certificate":"n","localfile":"","localkeyfile":"","securitymode":"None","securitypolicy":"None","useTransport":false,"maxChunkCount":1,"maxMessageSize":8192,"receiveBufferSize":8192,"sendBufferSize":8192,"setstatusandtime":false,"keepsessionalive":false,"name":"","x":3760,"y":720,"wires":[[],[],[]]},{"id":"c3afdd71fa630c33","type":"OpcUa-Item","z":"51b720ac.77402","item":"ns=3;s=START_USUARIO","datatype":"Boolean","value":"","name":"","x":3340,"y":900,"wires":[["bc815873977453e2"]]},{"id":"c7718728b21a3b61","type":"OpcUa-Item","z":"51b720ac.77402","item":"ns=3;s=P_DEF_USUARIO","datatype":"Boolean","value":"","name":"","x":3340,"y":960,"wires":[["bc815873977453e2"]]},{"id":"6a0d5d60435205a0","type":"OpcUa-Item","z":"51b720ac.77402","item":"ns=3;s=USR_STOP_SISTEMA","datatype":"Boolean","value":"","name":"","x":3280,"y":1220,"wires":[["bc815873977453e2"]]},{"id":"ec4f7f81b08930de","type":"OpcUa-Item","z":"51b720ac.77402","item":"ns=3;s=USR_PAUSA","datatype":"Boolean","value":"","name":"","x":3280,"y":1280,"wires":[["bc815873977453e2"]]},{"id":"fc03a3e6b0f2e9e8","type":"ui_media","z":"51b720ac.77402","group":"b6a9e047.708fd","name":"ACIV","width":5,"height":2,"order":50,"category":"foto","file":"4.png","layout":"adjust","showcontrols":true,"loop":true,"onstart":false,"scope":"local","tooltip":"","x":70,"y":40,"wires":[[]]},{"id":"ba90fc9573fe7399","type":"ui_media","z":"51b720ac.77402","group":"b6a9e047.708fd","name":"penagos","width":5,"height":2,"order":1,"category":"foto","file":"logo-2.png","layout":"adjust","showcontrols":true,"loop":true,"onstart":false,"scope":"local","tooltip":"","x":80,"y":100,"wires":[[]]},{"id":"79d209114cd9baab","type":"inject","z":"2d9b01c55fb8a47a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"15","crontab":"","once":true,"onceDelay":"1","topic":"","payload":"","payloadType":"date","x":750,"y":320,"wires":[["57e0cb2cfd09e2e4"]]},{"id":"57e0cb2cfd09e2e4","type":"function","z":"2d9b01c55fb8a47a","name":"hum1","func":"let t = context.get('time') || 0;\nlet initialHumidity = 63;\nlet rate = 0.5;\n\n// Calcular la humedad base restando el tiempo multiplicado por la tasa\nlet baseHumidity = initialHumidity - t * rate;\n\n// Añadir una pequeña variación aleatoria a la humedad base\n// Usamos Math.random() para generar un valor entre -1 y 1, lo que introduce fluctuaciones leves.\nlet randomVariation = (Math.random() * 2) - 1; \n\n// Sumar la variación aleatoria a la humedad base\nlet humidity = baseHumidity + randomVariation;\n\n// Asegurarse de que la humedad no sea menor que 0\nif (humidity < 0) humidity = 0;\n\nmsg.payload = humidity.toFixed(2);\ncontext.set('time', t + 1);\nreturn msg;\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":930,"y":320,"wires":[["192dc6ece29548b8"]]},{"id":"b40128c8b48ccfb6","type":"inject","z":"2d9b01c55fb8a47a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"15","crontab":"","once":true,"onceDelay":"1","topic":"","payload":"","payloadType":"date","x":750,"y":500,"wires":[["13411d1765501c2c"]]},{"id":"13411d1765501c2c","type":"function","z":"2d9b01c55fb8a47a","name":"weight1","func":"let t = context.get('time') || 0;\nlet initialLoad = 33;\nlet rate = 0.003;\n\n// Calcular la carga base restando el tiempo multiplicado por la tasa\nlet baseLoad = initialLoad - t * rate;\n\n// Añadir una pequeña variación aleatoria a la carga base\n// Genera un valor aleatorio entre -0.5 y 0.5 para mantener la variación suave\nlet randomVariation = (Math.random() * 1) - 0.5;\n\n// Sumar la variación aleatoria a la carga base\nlet load = baseLoad + randomVariation;\n\n// Asegurarse de que la carga no sea menor que 0\nif (load < 0) load = 0;\n\nmsg.payload = load.toFixed(2);\ncontext.set('time', t + 1);\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":940,"y":500,"wires":[["a20451d44e9c8a06"]]},{"id":"2bda3e8ea2f144cb","type":"inject","z":"2d9b01c55fb8a47a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"15","crontab":"","once":true,"onceDelay":"1","topic":"","payload":"","payloadType":"date","x":1910,"y":315,"wires":[["552dba36d71d80d7"]]},{"id":"552dba36d71d80d7","type":"function","z":"2d9b01c55fb8a47a","name":"hum2","func":"let t = context.get('time') || 0;\nlet initialHumidity = 67;\nlet rate = 0.5;\n\n// Calcular la humedad base restando el tiempo multiplicado por la tasa\nlet baseHumidity = initialHumidity - t * rate;\n\n// Añadir una pequeña variación aleatoria a la humedad base\n// Usamos Math.random() para generar un valor entre -1 y 1, lo que introduce fluctuaciones leves.\nlet randomVariation = (Math.random() * 2) - 1; \n\n// Sumar la variación aleatoria a la humedad base\nlet humidity = baseHumidity + randomVariation;\n\n// Asegurarse de que la humedad no sea menor que 0\nif (humidity < 0) humidity = 0;\n\nmsg.payload = humidity.toFixed(2);\ncontext.set('time', t + 1);\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2090,"y":315,"wires":[["8f9e0948255e323c"]]},{"id":"d4002832eb65904d","type":"inject","z":"2d9b01c55fb8a47a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"15","crontab":"","once":true,"onceDelay":"1","topic":"","payload":"","payloadType":"date","x":1130,"y":980,"wires":[["cbe03b3f7546751f"]]},{"id":"cbe03b3f7546751f","type":"function","z":"2d9b01c55fb8a47a","name":"humr","func":"let t = context.get('time') || 0;\nlet initialHumidity = 53;\nlet rate = 2;\n\n// Calcular la humedad base restando el tiempo multiplicado por la tasa\nlet baseHumidity = initialHumidity - t * rate;\n\n// Añadir una pequeña variación aleatoria a la humedad base\n// Usamos Math.random() para generar un valor entre -1 y 1, lo que introduce fluctuaciones leves.\nlet randomVariation = (Math.random() * 2) - 1; \n\n// Sumar la variación aleatoria a la humedad base\nlet humidity = baseHumidity + randomVariation;\n\n// Asegurarse de que la humedad no sea menor que 0\nif (humidity < 0) humidity = 0;\n\nmsg.payload = humidity.toFixed(2);\ncontext.set('time', t + 1);\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1310,"y":980,"wires":[["28d51753f66520d3"]]},{"id":"28d51753f66520d3","type":"debug","z":"2d9b01c55fb8a47a","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1510,"y":980,"wires":[]},{"id":"bb4fb9aa646b3db6","type":"inject","z":"2d9b01c55fb8a47a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"15","crontab":"","once":true,"onceDelay":"1","topic":"","payload":"","payloadType":"date","x":1130,"y":1200,"wires":[["bdd9ded0610b4806"]]},{"id":"bdd9ded0610b4806","type":"function","z":"2d9b01c55fb8a47a","name":"humext","func":"let t = context.get('time') || 0;\nlet initialHumidity = 72;\nlet rate = 0.05;  // Reducimos la tasa de disminución para hacerla más lenta y constante\n\n// Calcular la humedad base restando el tiempo multiplicado por la tasa\nlet baseHumidity = initialHumidity - t * rate;\n\n// Añadir una variación aleatoria más pequeña para mantener mayor constancia\nlet randomVariation = (Math.random() * 0.2) - 0.1;  // Variación aleatoria entre -0.1 y 0.1\n\n// Sumar la variación aleatoria a la humedad base\nlet humidity = baseHumidity + randomVariation;\n\n// Asegurarse de que la humedad no sea menor que 0\nif (humidity < 0) humidity = 0;\n\nmsg.payload = humidity.toFixed(2);\ncontext.set('time', t + 1);\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1320,"y":1200,"wires":[["91bd1bd3e20b2b7c"]]},{"id":"91bd1bd3e20b2b7c","type":"debug","z":"2d9b01c55fb8a47a","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1510,"y":1200,"wires":[]},{"id":"b15e846f4defab03","type":"inject","z":"2d9b01c55fb8a47a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"15","crontab":"","once":true,"onceDelay":"1","topic":"","payload":"","payloadType":"date","x":1910,"y":155,"wires":[["a2af6c6c2d6d269f"]]},{"id":"a2af6c6c2d6d269f","type":"function","z":"2d9b01c55fb8a47a","name":"temp2","func":"let t = context.get('time') || 0;\nlet maxTemperature = 90;\nlet baseTemperature = 31 + (maxTemperature - 20) * Math.sin(t / 100 * Math.PI);\n\n// Agregar una variación aleatoria pequeña\nlet randomVariation = (Math.random() * 4) - 2;  // Variación aleatoria entre -2 y 2 grados\nlet temperature = baseTemperature + randomVariation;\n\n// Limitar la temperatura a un máximo de 90\nif (temperature > maxTemperature) {\n    temperature = maxTemperature;\n}\n\nmsg.payload = temperature.toFixed(2);\ncontext.set('time', t + 1);\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2090,"y":155,"wires":[["dcd232297dc9b454"]]},{"id":"830f141aa27733d7","type":"inject","z":"2d9b01c55fb8a47a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":740,"y":280,"wires":[["57e0cb2cfd09e2e4"]]},{"id":"7cc2c4c0d0a4f148","type":"inject","z":"2d9b01c55fb8a47a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1900,"y":275,"wires":[["552dba36d71d80d7"]]},{"id":"9472a225ce1e2a11","type":"inject","z":"2d9b01c55fb8a47a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":740,"y":460,"wires":[["13411d1765501c2c"]]},{"id":"f1a1f39eab0bf4e9","type":"inject","z":"2d9b01c55fb8a47a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1900,"y":115,"wires":[["a2af6c6c2d6d269f"]]},{"id":"125e7b29672cf590","type":"inject","z":"2d9b01c55fb8a47a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1120,"y":940,"wires":[["cbe03b3f7546751f"]]},{"id":"e56a8299010e3bdf","type":"inject","z":"2d9b01c55fb8a47a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1120,"y":1160,"wires":[["bdd9ded0610b4806"]]},{"id":"e99d2036d6bc758a","type":"link out","z":"2d9b01c55fb8a47a","name":"sensor_hum1","links":["53cb4d78.f1e404","4609787f.a0fef8","e029aa0f.fb84c8"],"x":1075,"y":360,"wires":[]},{"id":"e73187c0754b5f0d","type":"link out","z":"2d9b01c55fb8a47a","name":"sensor_hum2","links":["cc0538fb.d96f68","1c439d24.491813","b20de7a3.73d898"],"x":2235,"y":355,"wires":[]},{"id":"96e4f005f78431e0","type":"link out","z":"2d9b01c55fb8a47a","name":"sensor_weight1","links":["2728b2ef.2a0abe","b16c8470.0e5758","868761c5.4c1c7"],"x":1075,"y":540,"wires":[]},{"id":"467bae76b92bc852","type":"link out","z":"2d9b01c55fb8a47a","name":"sensor_temp2","links":["6ca742cc.282b1c","3f40cb2b.ba30e4","d8f8d67b.50fe08"],"x":2235,"y":195,"wires":[]},{"id":"632338845b89205c","type":"link out","z":"2d9b01c55fb8a47a","name":"sensor_humr","links":["fca7bd78.770e3","a9bc63b9.b5809","cc007fbf.98bc8"],"x":1455,"y":1040,"wires":[]},{"id":"033e1ff597d1bd40","type":"link out","z":"2d9b01c55fb8a47a","name":"sensor_humext","links":["c9316709.4a1448","f7a390cf.4eaaf","145f8c3e.19d214"],"x":1455,"y":1280,"wires":[]},{"id":"687ff1881adc1f4c","type":"inject","z":"2d9b01c55fb8a47a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"15","crontab":"","once":true,"onceDelay":"1","topic":"","payload":"","payloadType":"date","x":1150,"y":740,"wires":[["2852f1350d69213d"]]},{"id":"2852f1350d69213d","type":"function","z":"2d9b01c55fb8a47a","name":"tempr","func":"let t = context.get('time') || 0;\nlet maxTemperature = 90;\nlet baseTemperature = 28 + (maxTemperature - 20) * Math.sin(t / 100 * Math.PI);\n\n// Agregar una variación aleatoria pequeña\nlet randomVariation = (Math.random() * 20) - 2;  // Variación aleatoria entre -2 y 2 grados\nlet temperature = baseTemperature + randomVariation;\n\n// Limitar la temperatura a un máximo de 90\nif (temperature > maxTemperature) {\n    temperature = maxTemperature;\n}\n\nmsg.payload = temperature.toFixed(2);\ncontext.set('time', t + 1);\nreturn msg;\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1330,"y":740,"wires":[["06c8f187a873ac2b"]]},{"id":"06c8f187a873ac2b","type":"debug","z":"2d9b01c55fb8a47a","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1530,"y":740,"wires":[]},{"id":"43b51031731a358e","type":"inject","z":"2d9b01c55fb8a47a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1140,"y":700,"wires":[["2852f1350d69213d"]]},{"id":"de9b7ba850d7daa1","type":"link out","z":"2d9b01c55fb8a47a","name":"sensor_tempr","links":["fcd4675c.392378","e5df218d.2ee2e","8c4ff06f.3e48d"],"x":1475,"y":820,"wires":[]},{"id":"6d3ff13b67edc82b","type":"inject","z":"2d9b01c55fb8a47a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"15","crontab":"","once":true,"onceDelay":"1","topic":"","payload":"","payloadType":"date","x":750,"y":160,"wires":[["055671d53dc69042"]]},{"id":"055671d53dc69042","type":"function","z":"2d9b01c55fb8a47a","name":"temp1","func":"let t = context.get('time') || 0;\nlet maxTemperature = 90;\nlet baseTemperature = 28 + (maxTemperature - 20) * Math.sin(t / 100 * Math.PI);\n\n// Agregar una variación aleatoria pequeña\nlet randomVariation = (Math.random() * 4) - 2;  // Variación aleatoria entre -2 y 2 grados\nlet temperature = baseTemperature + randomVariation;\n\n// Limitar la temperatura a un máximo de 90\nif (temperature > maxTemperature) {\n    temperature = maxTemperature;\n}\n\nmsg.payload = temperature.toFixed(2);\ncontext.set('time', t + 1);\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":930,"y":160,"wires":[["0e54369d6232010f"]]},{"id":"0e54369d6232010f","type":"debug","z":"2d9b01c55fb8a47a","name":"temp1_sim","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1130,"y":160,"wires":[]},{"id":"694c97d36c03d82d","type":"inject","z":"2d9b01c55fb8a47a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":740,"y":100,"wires":[["055671d53dc69042"]]},{"id":"140113891b2f377f","type":"link out","z":"2d9b01c55fb8a47a","name":"sensor_temp1","links":["26d88a27.5448d6","1cc52e5e.c1db82","f39b82d7.23c99"],"x":1075,"y":200,"wires":[]},{"id":"291976c9acfe9594","type":"comment","z":"2d9b01c55fb8a47a","name":"Sensores","info":"","x":740,"y":60,"wires":[]},{"id":"dcd232297dc9b454","type":"debug","z":"2d9b01c55fb8a47a","name":"temp2_sim","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":2290,"y":155,"wires":[]},{"id":"192dc6ece29548b8","type":"debug","z":"2d9b01c55fb8a47a","name":"hum1_sim","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1090,"y":320,"wires":[]},{"id":"8f9e0948255e323c","type":"debug","z":"2d9b01c55fb8a47a","name":"hum2_sim","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":2290,"y":315,"wires":[]},{"id":"a20451d44e9c8a06","type":"debug","z":"2d9b01c55fb8a47a","name":"weight1_sim","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1130,"y":500,"wires":[]},{"id":"680b616b7f3ebf10","type":"inject","z":"2d9b01c55fb8a47a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"15","crontab":"","once":true,"onceDelay":"1","topic":"","payload":"","payloadType":"date","x":1910,"y":475,"wires":[["f93351892894300d"]]},{"id":"f93351892894300d","type":"function","z":"2d9b01c55fb8a47a","name":"weight2","func":"let t = context.get('time') || 0;\nlet initialLoad = 30;\nlet rate = 0.003;\n\n// Calcular la carga base restando el tiempo multiplicado por la tasa\nlet baseLoad = initialLoad - t * rate;\n\n// Añadir una pequeña variación aleatoria a la carga base\n// Genera un valor aleatorio entre -0.5 y 0.5 para mantener la variación suave\nlet randomVariation = (Math.random() * 1) - 0.5;\n\n// Sumar la variación aleatoria a la carga base\nlet load = baseLoad + randomVariation;\n\n// Asegurarse de que la carga no sea menor que 0\nif (load < 0) load = 0;\n\nmsg.payload = load.toFixed(2);\ncontext.set('time', t + 1);\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2100,"y":475,"wires":[["7b6a849cd333bd34"]]},{"id":"4a1fdf117019da9d","type":"inject","z":"2d9b01c55fb8a47a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1900,"y":435,"wires":[["f93351892894300d"]]},{"id":"0b31159682d3d09a","type":"link out","z":"2d9b01c55fb8a47a","name":"sensor_weight2","links":["1a725bc6.a42e34","c721e598.847938","26f400fa.131ab"],"x":2235,"y":515,"wires":[]},{"id":"7b6a849cd333bd34","type":"debug","z":"2d9b01c55fb8a47a","name":"weight1_sim","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":2290,"y":475,"wires":[]},{"id":"8990e1108ca3b498","type":"comment","z":"2d9b01c55fb8a47a","name":"Variables de proceso","info":"","x":890,"y":1400,"wires":[]},{"id":"b93c4eaf69be1b5e","type":"function","z":"2d9b01c55fb8a47a","name":"Simulador variable de subproceso","func":"// Inicializar la variable global si no existe\nvar contador = context.get('contador') || 0;\n\n// Incrementar el valor del contador\ncontador += 1;\n\n// Si el contador supera 3, reiniciarlo a 1\nif (contador > 3) {\n    contador = 1;\n}\n\n// Guardar el valor actualizado en el contexto\ncontext.set('contador', contador);\n\n// Establecer el valor del contador en msg.payload para enviarlo\nmsg.payload = contador;\n\n// Devolver el mensaje modificado\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1140,"y":1460,"wires":[["66a03ca0d4677fab"]]},{"id":"60e468f2c082c9d2","type":"inject","z":"2d9b01c55fb8a47a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":890,"y":1460,"wires":[["b93c4eaf69be1b5e"]]},{"id":"66a03ca0d4677fab","type":"debug","z":"2d9b01c55fb8a47a","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1410,"y":1460,"wires":[]},{"id":"28e74d49d08fa5a7","type":"link out","z":"2d9b01c55fb8a47a","name":"process_subproceso","links":["473cd58b.d3e8dc"],"x":1305,"y":1660,"wires":[]},{"id":"5040410a4b5cb3d9","type":"comment","z":"2d9b01c55fb8a47a","name":"Ruta SD","info":"","x":770,"y":2160,"wires":[]},{"id":"c4acc0ffdcce1f47","type":"function","z":"2d9b01c55fb8a47a","name":"Actualizaar a ruta de la SD del plc","func":"ruta_sd_ok = \"/run/media/mmcblk0p1/\"\nglobal.set('ruta_sd', ruta_sd_ok);\nreturn null;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1020,"y":2200,"wires":[[]]},{"id":"a3e9ca2e03de2a75","type":"inject","z":"2d9b01c55fb8a47a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":790,"y":2200,"wires":[["c4acc0ffdcce1f47"]]},{"id":"dd39ccb238506a3a","type":"function","z":"2d9b01c55fb8a47a","name":"Obtener variable global","func":"let torre1 = global.get('torre') || 'Error';\nmsg.payload = torre1\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1000,"y":2240,"wires":[["a1d595debce2445a"]]},{"id":"a1d595debce2445a","type":"debug","z":"2d9b01c55fb8a47a","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1220,"y":2240,"wires":[]},{"id":"d7139d2a06e99dbf","type":"inject","z":"2d9b01c55fb8a47a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":790,"y":2240,"wires":[["dd39ccb238506a3a"]]},{"id":"f79fb8e94350ba61","type":"function","z":"2d9b01c55fb8a47a","name":"","func":"var V = msg.payload;\nglobal.set('subproceso_estandar3', V);\nmsg.payload = String(V);  // Convertir a string\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":1180,"y":1820,"wires":[["5aca09802c6f2a6d"]]},{"id":"f4135717f61f148d","type":"function","z":"2d9b01c55fb8a47a","name":"Proceso estandard finalizdo","func":"global.set('subproceso_estandar1', \"0\");\nglobal.set('subproceso_estandar2', \"0\");\nglobal.set('subproceso_estandar3', \"0\");\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":1320,"y":1880,"wires":[[]]},{"id":"64e187beb475b8df","type":"function","z":"2d9b01c55fb8a47a","name":"","func":"var V = msg.payload;\nglobal.set('subproceso_estandar2', V);\nmsg.payload = String(V);  // Convertir a string\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":1180,"y":1760,"wires":[["d51b534f7b455e1b"]]},{"id":"30c2500077f6d882","type":"function","z":"2d9b01c55fb8a47a","name":"","func":"var V = msg.payload;\nglobal.set('subproceso_estandar1', V);\nmsg.payload = String(V);  // Convertir a string\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":1180,"y":1700,"wires":[["0ff7d504a47665c5","28e74d49d08fa5a7"]]},{"id":"723b106b66353356","type":"comment","z":"2d9b01c55fb8a47a","name":"Proceso estandar","info":"","x":820,"y":1640,"wires":[]},{"id":"d0578fd7fcd3c4ec","type":"comment","z":"2d9b01c55fb8a47a","name":"MODIFICADO PENAGOS","info":"","x":850,"y":1600,"wires":[]},{"id":"6167374fe5576e27","type":"comment","z":"2d9b01c55fb8a47a","name":"Variables de proceso","info":"","x":840,"y":1560,"wires":[]},{"id":"0ff7d504a47665c5","type":"debug","z":"2d9b01c55fb8a47a","name":"Pre","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1370,"y":1700,"wires":[]},{"id":"d51b534f7b455e1b","type":"debug","z":"2d9b01c55fb8a47a","name":"Or","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1370,"y":1760,"wires":[]},{"id":"5aca09802c6f2a6d","type":"debug","z":"2d9b01c55fb8a47a","name":"final","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1370,"y":1820,"wires":[]},{"id":"21d570f2e183c243","type":"link out","z":"2d9b01c55fb8a47a","name":"Proceso estandar finalizado PLC","links":["2ade2ba.f45b3d4","a6986a2a.897e78"],"x":1385,"y":2020,"wires":[]},{"id":"ad0f58017912ddc4","type":"function","z":"2d9b01c55fb8a47a","name":"Proceso finalizado","func":"if (msg.payload === 1){\n    return msg;\n}\nelse {\n    return null;\n}","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":1210,"y":2020,"wires":[["21d570f2e183c243"]]},{"id":"b5077f23912e5a4e","type":"function","z":"2d9b01c55fb8a47a","name":"Proceso finalizado","func":"if (msg.payload === 1){\n    return msg;\n}\nelse {\n    return null;\n}","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":1200,"y":2080,"wires":[["ad257cd409a1ff7c"]]},{"id":"ad257cd409a1ff7c","type":"link out","z":"2d9b01c55fb8a47a","name":"Proceso estandar finalizado PLC","links":["2ade2ba.f45b3d4","a6986a2a.897e78"],"x":1385,"y":2080,"wires":[]},{"id":"92e58b23b8ac4e4b","type":"comment","z":"2d9b01c55fb8a47a","name":"Obtener Subproceso actual ON_PROCESS_STANDARD","info":"","x":1310,"y":1620,"wires":[]},{"id":"ef6119dc5ae2d56a","type":"function","z":"2d9b01c55fb8a47a","name":"Obtener valor","func":"msg.payload = msg.payload;\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":1300,"y":1300,"wires":[["033e1ff597d1bd40","f43fe8f998ab4ce2"]]},{"id":"2b2dad24b05dfc9c","type":"function","z":"2d9b01c55fb8a47a","name":"Obtener valor","func":"msg.payload = msg.payload;\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":1300,"y":1040,"wires":[["632338845b89205c","0b97f292dd159c71"]]},{"id":"2ddeb43c5452037d","type":"function","z":"2d9b01c55fb8a47a","name":"Obtener valor","func":"msg.payload = msg.payload;\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":1280,"y":820,"wires":[["de9b7ba850d7daa1","a6922fd39910d7e1"]]},{"id":"d51f76787f03a229","type":"function","z":"2d9b01c55fb8a47a","name":"Obtener valor","func":"msg.payload = msg.payload;\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":2100,"y":520,"wires":[["0b31159682d3d09a","31e76db98eefebda"]]},{"id":"fe6b1b2bd0232661","type":"function","z":"2d9b01c55fb8a47a","name":"Obtener valor","func":"msg.payload = msg.payload;\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":940,"y":560,"wires":[["96e4f005f78431e0","513ae29c67475abf","b12ca9c06b68acbd"]]},{"id":"0388d19f5b27c024","type":"function","z":"2d9b01c55fb8a47a","name":"Obtener valor","func":"msg.payload = msg.payload;\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":940,"y":360,"wires":[["e99d2036d6bc758a","b8024cbfa4bf20cc"]]},{"id":"b6694f28c64e8c8b","type":"function","z":"2d9b01c55fb8a47a","name":"Obtener valor","func":"msg.payload = msg.payload;\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":2100,"y":360,"wires":[["e73187c0754b5f0d","97c7af8e8e0323f2"]]},{"id":"8d44485fbee8cb09","type":"function","z":"2d9b01c55fb8a47a","name":"Obtener valor/10","func":"if (typeof msg.payload === 'number') {\n    msg.payload = msg.payload / 10;\n} else {\n    msg.payload = \"Error: payload no es un número\";\n}\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":2070,"y":215,"wires":[["467bae76b92bc852","794c46cee93ae350"]]},{"id":"185e2020a7b2d797","type":"function","z":"2d9b01c55fb8a47a","name":"Obtener valor/10","func":"if (typeof msg.payload === 'number') {\n    msg.payload = msg.payload / 10;\n} else {\n    msg.payload = \"Error: payload no es un número\";\n}\nreturn msg;","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":930,"y":220,"wires":[["140113891b2f377f","3227b9df8936bf33"]]},{"id":"9c58b1f9689d4e5f","type":"comment","z":"2d9b01c55fb8a47a","name":"v1.0.6","info":"","x":760,"y":2320,"wires":[]},{"id":"0d68233c6e8cc039","type":"link out","z":"2d9b01c55fb8a47a","name":"PLC torre personalizado","links":["b15585b7.68f578"],"x":1615,"y":2400,"wires":[]},{"id":"965250766634fba7","type":"function","z":"2d9b01c55fb8a47a","name":"Obtener torre actual del proceso personalizado","func":"let proceso = global.get('process') || \"No-process\";\n\nif (proceso === \"Personalizado\"){\n    if (msg.payload === 0){\n        global.set('torre', \"1\");\n        msg.payload = \"Torre 1\"\n    }\n    else{\n        global.set(\"torre\", \"2\")\n        msg.payload = \"Torre 2\"\n    }\n}\nreturn msg;\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":1360,"y":2400,"wires":[["0d68233c6e8cc039"]]},{"id":"c82edb80137fcf57","type":"comment","z":"2d9b01c55fb8a47a","name":"Personalizado","info":"","x":780,"y":2360,"wires":[]},{"id":"0aa60e2c23b4d989","type":"comment","z":"2d9b01c55fb8a47a","name":"Finalización con los buzzers","info":"","x":860,"y":1980,"wires":[]},{"id":"441eae8266d1a8e7","type":"link out","z":"2d9b01c55fb8a47a","name":"Proceso personalizado finalizado PLC","links":["2ade2ba.f45b3d4","a6986a2a.897e78"],"x":1425,"y":2520,"wires":[]},{"id":"85a753d7723be44f","type":"function","z":"2d9b01c55fb8a47a","name":"Proceso finalizado","func":"if (msg.payload === 1){\n    return msg;\n}\nelse {\n    return null;\n}","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":1250,"y":2520,"wires":[["441eae8266d1a8e7"]]},{"id":"7ee02ea370e56606","type":"function","z":"2d9b01c55fb8a47a","name":"Proceso finalizado","func":"if (msg.payload === 1){\n    return msg;\n}\nelse {\n    return null;\n}","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":1240,"y":2580,"wires":[["bc7c7e3e9c13dcc8"]]},{"id":"bc7c7e3e9c13dcc8","type":"link out","z":"2d9b01c55fb8a47a","name":"Proceso personalizado finalizado PLC","links":["2ade2ba.f45b3d4","a6986a2a.897e78"],"x":1425,"y":2580,"wires":[]},{"id":"87c306cc8f1afea7","type":"comment","z":"2d9b01c55fb8a47a","name":"Finalización con los buzzers","info":"","x":840,"y":2480,"wires":[]},{"id":"6c241bf77e262c01","type":"inject","z":"2d9b01c55fb8a47a","name":"","props":[{"p":"payload"}],"repeat":"1","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"","payloadType":"str","x":2950,"y":280,"wires":[["fd9b24ba068f9cba"]]},{"id":"fd9b24ba068f9cba","type":"function","z":"2d9b01c55fb8a47a","name":"Global  Update Cronometer","func":"let currentTime = global.get('current_time') || 0;\n\nif (global.get('running')) {\n    currentTime += 1;\n    global.set('current_time', currentTime);\n    // Convertir segundos a hh:mm:ss\n    let hours = Math.floor(currentTime / 3600);\n    let minutes = Math.floor((currentTime % 3600) / 60);\n    let seconds = currentTime % 60;\n    let formattedTime = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;\n    msg.payload = formattedTime;\n    return msg;\n} else {\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":3160,"y":280,"wires":[["10218c12d0972b0c"]]},{"id":"8de2e71d650cfb26","type":"comment","z":"2d9b01c55fb8a47a","name":"Variables de proceso","info":"","x":3000,"y":220,"wires":[]},{"id":"10218c12d0972b0c","type":"link out","z":"2d9b01c55fb8a47a","name":"Actualizar cronometro","links":["47484065.e76dd","d350d70e.71eec8"],"x":3335,"y":280,"wires":[]},{"id":"26e12db0d08554a3","type":"comment","z":"2d9b01c55fb8a47a","name":"Indicador de ciclo actual","info":"","x":820,"y":2660,"wires":[]},{"id":"64d2d4d5d3ffc88a","type":"link out","z":"2d9b01c55fb8a47a","name":"PLC ciclo personalizado","links":["b15585b7.68f578","51cd60fc.7db1d"],"x":1395,"y":2700,"wires":[]},{"id":"6afa0a184e540689","type":"function","z":"2d9b01c55fb8a47a","name":"Obtener ciclo actual del proceso personalizado","func":"let proceso = global.get('process') || \"No-process\";\n\nif (proceso === \"Personalizado\"){\n    msg.payload = msg.payload\n}\nreturn msg;\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":1110,"y":2700,"wires":[["64d2d4d5d3ffc88a","a1adf28221895ae4"]]},{"id":"35e82bb474f58808","type":"comment","z":"2d9b01c55fb8a47a","name":"Obtener ciclo ON PROCESO PERSONALIZADO","info":"","x":1560,"y":2660,"wires":[]},{"id":"8a165692b01d4df8","type":"comment","z":"2d9b01c55fb8a47a","name":"ON PROCESOS X2","info":"","x":3370,"y":240,"wires":[]},{"id":"a6a0e25a8ee14995","type":"OpcUa-Item","z":"2d9b01c55fb8a47a","item":"ns=3;s=INT_TEM_T1","datatype":"Int16","value":"","name":"","x":520,"y":220,"wires":[["ca3a74c0b542e956"]]},{"id":"ca3a74c0b542e956","type":"OpcUa-Client","z":"2d9b01c55fb8a47a","endpoint":"9d8e083238bd6420","action":"read","deadbandtype":"a","deadbandvalue":1,"time":10,"timeUnit":"s","certificate":"n","localfile":"","localkeyfile":"","securitymode":"None","securitypolicy":"None","useTransport":false,"maxChunkCount":1,"maxMessageSize":8192,"receiveBufferSize":8192,"sendBufferSize":8192,"setstatusandtime":false,"keepsessionalive":false,"name":"","x":720,"y":220,"wires":[["185e2020a7b2d797"],[],[]]},{"id":"0540c1327fd75d0a","type":"inject","z":"2d9b01c55fb8a47a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"3","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":330,"y":220,"wires":[["a6a0e25a8ee14995"]]},{"id":"caaa430f99d89a7f","type":"OpcUa-Item","z":"2d9b01c55fb8a47a","item":"ns=3;s=INT_TEM_T2","datatype":"Int16","value":"","name":"","x":1660,"y":220,"wires":[["fd31365a5967c287"]]},{"id":"fd31365a5967c287","type":"OpcUa-Client","z":"2d9b01c55fb8a47a","endpoint":"9d8e083238bd6420","action":"read","deadbandtype":"a","deadbandvalue":1,"time":10,"timeUnit":"s","certificate":"n","localfile":"","localkeyfile":"","securitymode":"None","securitypolicy":"None","useTransport":false,"maxChunkCount":1,"maxMessageSize":8192,"receiveBufferSize":8192,"sendBufferSize":8192,"setstatusandtime":false,"keepsessionalive":false,"name":"","x":1860,"y":220,"wires":[["8d44485fbee8cb09"],[],[]]},{"id":"3aa21b94c619110b","type":"inject","z":"2d9b01c55fb8a47a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"3","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1490,"y":220,"wires":[["caaa430f99d89a7f"]]},{"id":"513ae29c67475abf","type":"debug","z":"2d9b01c55fb8a47a","name":"debug 1","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":1160,"y":600,"wires":[]},{"id":"5bafb7a3b15c1699","type":"inject","z":"2d9b01c55fb8a47a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"3","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":330,"y":380,"wires":[["b2f61286394f76f0"]]},{"id":"b2f61286394f76f0","type":"OpcUa-Item","z":"2d9b01c55fb8a47a","item":"ns=3;s=HUM_TOL1","datatype":"Float","value":"","name":"","x":520,"y":380,"wires":[["fc3f4445dbb7ec33"]]},{"id":"fc3f4445dbb7ec33","type":"OpcUa-Client","z":"2d9b01c55fb8a47a","endpoint":"9d8e083238bd6420","action":"read","deadbandtype":"a","deadbandvalue":1,"time":10,"timeUnit":"s","certificate":"n","localfile":"","localkeyfile":"","securitymode":"None","securitypolicy":"None","useTransport":false,"maxChunkCount":1,"maxMessageSize":8192,"receiveBufferSize":8192,"sendBufferSize":8192,"setstatusandtime":false,"keepsessionalive":false,"name":"","x":720,"y":380,"wires":[["0388d19f5b27c024"],[],[]]},{"id":"4378c43e53ae6215","type":"inject","z":"2d9b01c55fb8a47a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"3","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1490,"y":380,"wires":[["7416e3af9d813881"]]},{"id":"7416e3af9d813881","type":"OpcUa-Item","z":"2d9b01c55fb8a47a","item":"ns=3;s=HUM_TOL2","datatype":"Float","value":"","name":"","x":1660,"y":380,"wires":[["c16b00c41e95d4ba"]]},{"id":"c16b00c41e95d4ba","type":"OpcUa-Client","z":"2d9b01c55fb8a47a","endpoint":"9d8e083238bd6420","action":"read","deadbandtype":"a","deadbandvalue":1,"time":10,"timeUnit":"s","certificate":"n","localfile":"","localkeyfile":"","securitymode":"None","securitypolicy":"None","useTransport":false,"maxChunkCount":1,"maxMessageSize":8192,"receiveBufferSize":8192,"sendBufferSize":8192,"setstatusandtime":false,"keepsessionalive":false,"name":"","x":1860,"y":380,"wires":[["b6694f28c64e8c8b"],[],[]]},{"id":"2049ee7cab0196ee","type":"inject","z":"2d9b01c55fb8a47a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"3","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":330,"y":560,"wires":[["de7db8d403895dac"]]},{"id":"de7db8d403895dac","type":"OpcUa-Item","z":"2d9b01c55fb8a47a","item":"ns=3;s=PRUEBA_PESO_T1","datatype":"Float","value":"","name":"","x":520,"y":560,"wires":[["e4d876d42bce1b89"]]},{"id":"e4d876d42bce1b89","type":"OpcUa-Client","z":"2d9b01c55fb8a47a","endpoint":"9d8e083238bd6420","action":"read","deadbandtype":"a","deadbandvalue":1,"time":10,"timeUnit":"s","certificate":"n","localfile":"","localkeyfile":"","securitymode":"None","securitypolicy":"None","useTransport":false,"maxChunkCount":1,"maxMessageSize":8192,"receiveBufferSize":8192,"sendBufferSize":8192,"setstatusandtime":false,"keepsessionalive":false,"name":"","x":720,"y":560,"wires":[["fe6b1b2bd0232661"],[],[]]},{"id":"795977f5444ec533","type":"OpcUa-Item","z":"2d9b01c55fb8a47a","item":"ns=3;s=PRUEBA_PESO_T2","datatype":"Float","value":"","name":"","x":1660,"y":520,"wires":[["9702d7b8997cf00c"]]},{"id":"5147d882b512bdec","type":"inject","z":"2d9b01c55fb8a47a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"3","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1490,"y":520,"wires":[["795977f5444ec533"]]},{"id":"9702d7b8997cf00c","type":"OpcUa-Client","z":"2d9b01c55fb8a47a","endpoint":"9d8e083238bd6420","action":"read","deadbandtype":"a","deadbandvalue":1,"time":10,"timeUnit":"s","certificate":"n","localfile":"","localkeyfile":"","securitymode":"None","securitypolicy":"None","useTransport":false,"maxChunkCount":1,"maxMessageSize":8192,"receiveBufferSize":8192,"sendBufferSize":8192,"setstatusandtime":false,"keepsessionalive":false,"name":"","x":1860,"y":520,"wires":[["d51f76787f03a229"],[],[]]},{"id":"1672ce8a1b5ed086","type":"inject","z":"2d9b01c55fb8a47a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"3","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":690,"y":840,"wires":[["09d45865c3220a7c"]]},{"id":"09d45865c3220a7c","type":"OpcUa-Item","z":"2d9b01c55fb8a47a","item":"ns=3;s=TEMP_RESIS","datatype":"Float","value":"","name":"","x":880,"y":840,"wires":[["3054a983739b652c"]]},{"id":"3054a983739b652c","type":"OpcUa-Client","z":"2d9b01c55fb8a47a","endpoint":"9d8e083238bd6420","action":"read","deadbandtype":"a","deadbandvalue":1,"time":10,"timeUnit":"s","certificate":"n","localfile":"","localkeyfile":"","securitymode":"None","securitypolicy":"None","useTransport":false,"maxChunkCount":1,"maxMessageSize":8192,"receiveBufferSize":8192,"sendBufferSize":8192,"setstatusandtime":false,"keepsessionalive":false,"name":"","x":1080,"y":840,"wires":[["2ddeb43c5452037d"],[],[]]},{"id":"e299fab82927d369","type":"inject","z":"2d9b01c55fb8a47a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"3","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":690,"y":1060,"wires":[["e450d2da6372ab46"]]},{"id":"e450d2da6372ab46","type":"OpcUa-Item","z":"2d9b01c55fb8a47a","item":"ns=3;s=HUM_RES","datatype":"Float","value":"","name":"","x":880,"y":1060,"wires":[["858b3ec56e0b766f"]]},{"id":"858b3ec56e0b766f","type":"OpcUa-Client","z":"2d9b01c55fb8a47a","endpoint":"9d8e083238bd6420","action":"read","deadbandtype":"a","deadbandvalue":1,"time":10,"timeUnit":"s","certificate":"n","localfile":"","localkeyfile":"","securitymode":"None","securitypolicy":"None","useTransport":false,"maxChunkCount":1,"maxMessageSize":8192,"receiveBufferSize":8192,"sendBufferSize":8192,"setstatusandtime":false,"keepsessionalive":false,"name":"","x":1080,"y":1060,"wires":[["2b2dad24b05dfc9c"],[],[]]},{"id":"09fbe89649877414","type":"inject","z":"2d9b01c55fb8a47a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"3","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":690,"y":1300,"wires":[["8848068ff9b68938"]]},{"id":"8848068ff9b68938","type":"OpcUa-Item","z":"2d9b01c55fb8a47a","item":"ns=3;s=HUM_EXTE","datatype":"UInt16","value":"","name":"","x":880,"y":1300,"wires":[["10a71176c8a6d04f"]]},{"id":"10a71176c8a6d04f","type":"OpcUa-Client","z":"2d9b01c55fb8a47a","endpoint":"9d8e083238bd6420","action":"read","deadbandtype":"a","deadbandvalue":1,"time":10,"timeUnit":"s","certificate":"n","localfile":"","localkeyfile":"","securitymode":"None","securitypolicy":"None","useTransport":false,"maxChunkCount":1,"maxMessageSize":8192,"receiveBufferSize":8192,"sendBufferSize":8192,"setstatusandtime":false,"keepsessionalive":false,"name":"","x":1080,"y":1300,"wires":[["ef6119dc5ae2d56a"],[],[]]},{"id":"fa22bd9b54aeb031","type":"inject","z":"2d9b01c55fb8a47a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"3","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":410,"y":1700,"wires":[["7fc7f6b4361adf3d"]]},{"id":"7fc7f6b4361adf3d","type":"OpcUa-Item","z":"2d9b01c55fb8a47a","item":"ns=3;s=STR_P1","datatype":"Boolean","value":"","name":"","x":600,"y":1700,"wires":[["a833837699e1afe1"]]},{"id":"a833837699e1afe1","type":"OpcUa-Client","z":"2d9b01c55fb8a47a","endpoint":"9d8e083238bd6420","action":"read","deadbandtype":"a","deadbandvalue":1,"time":10,"timeUnit":"s","certificate":"n","localfile":"","localkeyfile":"","securitymode":"None","securitypolicy":"None","useTransport":false,"maxChunkCount":1,"maxMessageSize":8192,"receiveBufferSize":8192,"sendBufferSize":8192,"setstatusandtime":false,"keepsessionalive":false,"name":"","x":800,"y":1700,"wires":[["a1832bd7c2f9a0cd"],[],[]]},{"id":"b17c4d74f0eeec79","type":"inject","z":"2d9b01c55fb8a47a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"3","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":410,"y":1760,"wires":[["43bc0d579bb1d3ab"]]},{"id":"43bc0d579bb1d3ab","type":"OpcUa-Item","z":"2d9b01c55fb8a47a","item":"ns=3;s=STR_P2","datatype":"Boolean","value":"","name":"","x":600,"y":1760,"wires":[["12e9a03764dc552d"]]},{"id":"12e9a03764dc552d","type":"OpcUa-Client","z":"2d9b01c55fb8a47a","endpoint":"9d8e083238bd6420","action":"read","deadbandtype":"a","deadbandvalue":1,"time":10,"timeUnit":"s","certificate":"n","localfile":"","localkeyfile":"","securitymode":"None","securitypolicy":"None","useTransport":false,"maxChunkCount":1,"maxMessageSize":8192,"receiveBufferSize":8192,"sendBufferSize":8192,"setstatusandtime":false,"keepsessionalive":false,"name":"","x":800,"y":1760,"wires":[["5a17a278cada6d01"],[],[]]},{"id":"e62535d4e183397d","type":"inject","z":"2d9b01c55fb8a47a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"3","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":410,"y":1820,"wires":[["e433a9808f7f3904"]]},{"id":"e433a9808f7f3904","type":"OpcUa-Item","z":"2d9b01c55fb8a47a","item":"ns=3;s=STR_P3","datatype":"Boolean","value":"","name":"","x":600,"y":1820,"wires":[["dfea8ce50d1e1f51"]]},{"id":"dfea8ce50d1e1f51","type":"OpcUa-Client","z":"2d9b01c55fb8a47a","endpoint":"9d8e083238bd6420","action":"read","deadbandtype":"a","deadbandvalue":1,"time":10,"timeUnit":"s","certificate":"n","localfile":"","localkeyfile":"","securitymode":"None","securitypolicy":"None","useTransport":false,"maxChunkCount":1,"maxMessageSize":8192,"receiveBufferSize":8192,"sendBufferSize":8192,"setstatusandtime":false,"keepsessionalive":false,"name":"","x":800,"y":1820,"wires":[["3b3b6144de78b9da"],[],[]]},{"id":"03df171cb505dc7f","type":"inject","z":"2d9b01c55fb8a47a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"1","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":410,"y":1880,"wires":[["39a961de0e0eb98f"]]},{"id":"39a961de0e0eb98f","type":"OpcUa-Item","z":"2d9b01c55fb8a47a","item":"ns=3;s=STR_I07","datatype":"Boolean","value":"","name":"","x":600,"y":1880,"wires":[["45226862bcd17108"]]},{"id":"45226862bcd17108","type":"OpcUa-Client","z":"2d9b01c55fb8a47a","endpoint":"9d8e083238bd6420","action":"read","deadbandtype":"a","deadbandvalue":1,"time":10,"timeUnit":"s","certificate":"n","localfile":"","localkeyfile":"","securitymode":"None","securitypolicy":"None","useTransport":false,"maxChunkCount":1,"maxMessageSize":8192,"receiveBufferSize":8192,"sendBufferSize":8192,"setstatusandtime":false,"keepsessionalive":false,"name":"","x":800,"y":1880,"wires":[["442394a7f38117c4"],[],[]]},{"id":"5a17a278cada6d01","type":"function","z":"2d9b01c55fb8a47a","name":"function 2","func":"if (typeof msg.payload === 'boolean') {\n    msg.payload = msg.payload ? 1 : 0;\n} else {\n    msg.payload = \"Error: payload no es booleano\";\n}\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1020,"y":1760,"wires":[["64e187beb475b8df"]]},{"id":"3b3b6144de78b9da","type":"function","z":"2d9b01c55fb8a47a","name":"function 3","func":"if (typeof msg.payload === 'boolean') {\n    msg.payload = msg.payload ? 1 : 0;\n} else {\n    msg.payload = \"Error: payload no es booleano\";\n}\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1020,"y":1820,"wires":[["f79fb8e94350ba61"]]},{"id":"442394a7f38117c4","type":"function","z":"2d9b01c55fb8a47a","name":"function 4","func":"if (typeof msg.payload === 'boolean') {\n    msg.payload = msg.payload ? 1 : 0;\n} else {\n    msg.payload = \"Error: payload no es booleano\";\n}\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1020,"y":1880,"wires":[["f4135717f61f148d","c7d93582d98d4f0d"]]},{"id":"a1832bd7c2f9a0cd","type":"function","z":"2d9b01c55fb8a47a","name":"function 1","func":"if (typeof msg.payload === 'boolean') {\n    msg.payload = msg.payload ? 1 : 0;\n} else {\n    msg.payload = \"Error: payload no es booleano\";\n}\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1020,"y":1700,"wires":[["30c2500077f6d882"]]},{"id":"c7d93582d98d4f0d","type":"debug","z":"2d9b01c55fb8a47a","name":"debug 5","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":1220,"y":1920,"wires":[]},{"id":"606f79b447978af2","type":"inject","z":"2d9b01c55fb8a47a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"1","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":430,"y":2720,"wires":[["242ecc68bb4c9e49"]]},{"id":"242ecc68bb4c9e49","type":"OpcUa-Item","z":"2d9b01c55fb8a47a","item":"ns=3;s=USR_CUENTA2","datatype":"Int16","value":"","name":"","x":620,"y":2720,"wires":[["5ed223b3dd330c65"]]},{"id":"5ed223b3dd330c65","type":"OpcUa-Client","z":"2d9b01c55fb8a47a","endpoint":"9d8e083238bd6420","action":"read","deadbandtype":"a","deadbandvalue":1,"time":10,"timeUnit":"s","certificate":"n","localfile":"","localkeyfile":"","securitymode":"None","securitypolicy":"None","useTransport":false,"maxChunkCount":1,"maxMessageSize":8192,"receiveBufferSize":8192,"sendBufferSize":8192,"setstatusandtime":false,"keepsessionalive":false,"name":"","x":820,"y":2720,"wires":[["6afa0a184e540689"],[],[]]},{"id":"0f285865b5bd9489","type":"OpcUa-Client","z":"2d9b01c55fb8a47a","endpoint":"9d8e083238bd6420","action":"read","deadbandtype":"a","deadbandvalue":1,"time":10,"timeUnit":"s","certificate":"n","localfile":"","localkeyfile":"","securitymode":"None","securitypolicy":"None","useTransport":false,"maxChunkCount":1,"maxMessageSize":8192,"receiveBufferSize":8192,"sendBufferSize":8192,"setstatusandtime":false,"keepsessionalive":false,"name":"","x":820,"y":2420,"wires":[["2fa3c663ecf75ede"],[],[]]},{"id":"a813b40b8217e46b","type":"OpcUa-Item","z":"2d9b01c55fb8a47a","item":"ns=3;s=PRUEBA_BOOL_GENERAL","datatype":"Boolean","value":"","name":"","x":620,"y":2420,"wires":[["0f285865b5bd9489"]]},{"id":"8909403a415bda13","type":"inject","z":"2d9b01c55fb8a47a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"1","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":430,"y":2420,"wires":[["a813b40b8217e46b"]]},{"id":"2fa3c663ecf75ede","type":"function","z":"2d9b01c55fb8a47a","name":"function 5","func":"if (typeof msg.payload === 'boolean') {\n    msg.payload = msg.payload ? 1 : 0;\n} else {\n    msg.payload = \"Error: payload no es booleano\";\n}\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1060,"y":2400,"wires":[["965250766634fba7","bdcd931ee5302e84"]]},{"id":"a1adf28221895ae4","type":"debug","z":"2d9b01c55fb8a47a","name":"debug 6","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":1440,"y":2740,"wires":[]},{"id":"bdcd931ee5302e84","type":"debug","z":"2d9b01c55fb8a47a","name":"debug 7","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":1240,"y":2460,"wires":[]},{"id":"42a7e8a423bf84cd","type":"inject","z":"2d9b01c55fb8a47a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"1","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":390,"y":2020,"wires":[["5155ada0c80a74f0"]]},{"id":"5155ada0c80a74f0","type":"OpcUa-Item","z":"2d9b01c55fb8a47a","item":"ns=3;s=BUZZER_TOLVA_1","datatype":"Boolean","value":"","name":"","x":580,"y":2020,"wires":[["39690e5fbe5c2e18"]]},{"id":"39690e5fbe5c2e18","type":"OpcUa-Client","z":"2d9b01c55fb8a47a","endpoint":"9d8e083238bd6420","action":"read","deadbandtype":"a","deadbandvalue":1,"time":10,"timeUnit":"s","certificate":"n","localfile":"","localkeyfile":"","securitymode":"None","securitypolicy":"None","useTransport":false,"maxChunkCount":1,"maxMessageSize":8192,"receiveBufferSize":8192,"sendBufferSize":8192,"setstatusandtime":false,"keepsessionalive":false,"name":"","x":780,"y":2020,"wires":[["75daf6bf06ad3cd3"],[],[]]},{"id":"5b250eb5657826be","type":"inject","z":"2d9b01c55fb8a47a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"1","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":390,"y":2080,"wires":[["5a942e4387551222"]]},{"id":"5a942e4387551222","type":"OpcUa-Item","z":"2d9b01c55fb8a47a","item":"ns=3;s=BUZZER_TOLVA_2","datatype":"Boolean","value":"","name":"","x":580,"y":2080,"wires":[["6094ccf786bc703d"]]},{"id":"6094ccf786bc703d","type":"OpcUa-Client","z":"2d9b01c55fb8a47a","endpoint":"9d8e083238bd6420","action":"read","deadbandtype":"a","deadbandvalue":1,"time":10,"timeUnit":"s","certificate":"n","localfile":"","localkeyfile":"","securitymode":"None","securitypolicy":"None","useTransport":false,"maxChunkCount":1,"maxMessageSize":8192,"receiveBufferSize":8192,"sendBufferSize":8192,"setstatusandtime":false,"keepsessionalive":false,"name":"","x":780,"y":2080,"wires":[["042fc5a9d56904d7"],[],[]]},{"id":"75daf6bf06ad3cd3","type":"function","z":"2d9b01c55fb8a47a","name":"function 6","func":"if (typeof msg.payload === 'boolean') {\n    msg.payload = msg.payload ? 1 : 0;\n} else {\n    msg.payload = \"Error: payload no es booleano\";\n}\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1020,"y":2020,"wires":[["ad0f58017912ddc4"]]},{"id":"042fc5a9d56904d7","type":"function","z":"2d9b01c55fb8a47a","name":"function 7","func":"if (typeof msg.payload === 'boolean') {\n    msg.payload = msg.payload ? 1 : 0;\n} else {\n    msg.payload = \"Error: payload no es booleano\";\n}\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1020,"y":2080,"wires":[["b5077f23912e5a4e"]]},{"id":"3eebb1645b8d7701","type":"inject","z":"2d9b01c55fb8a47a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"0.5","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":430,"y":2520,"wires":[["8eac9e74ba6d26b4"]]},{"id":"8eac9e74ba6d26b4","type":"OpcUa-Item","z":"2d9b01c55fb8a47a","item":"ns=3;s=BUZZER_TOLVA_1","datatype":"Boolean","value":"","name":"","x":620,"y":2520,"wires":[["b6220a8e8ba01d78"]]},{"id":"b6220a8e8ba01d78","type":"OpcUa-Client","z":"2d9b01c55fb8a47a","endpoint":"9d8e083238bd6420","action":"read","deadbandtype":"a","deadbandvalue":1,"time":10,"timeUnit":"s","certificate":"n","localfile":"","localkeyfile":"","securitymode":"None","securitypolicy":"None","useTransport":false,"maxChunkCount":1,"maxMessageSize":8192,"receiveBufferSize":8192,"sendBufferSize":8192,"setstatusandtime":false,"keepsessionalive":false,"name":"","x":820,"y":2520,"wires":[["0925665c62db7c3f"],[],[]]},{"id":"f9b1b3ad8492a8e1","type":"inject","z":"2d9b01c55fb8a47a","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"0.5","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":430,"y":2580,"wires":[["8f1f6103631c0429"]]},{"id":"8f1f6103631c0429","type":"OpcUa-Item","z":"2d9b01c55fb8a47a","item":"ns=3;s=BUZZER_TOLVA_2","datatype":"Boolean","value":"","name":"","x":620,"y":2580,"wires":[["1d66dcdc5ac72ce4"]]},{"id":"1d66dcdc5ac72ce4","type":"OpcUa-Client","z":"2d9b01c55fb8a47a","endpoint":"9d8e083238bd6420","action":"read","deadbandtype":"a","deadbandvalue":1,"time":10,"timeUnit":"s","certificate":"n","localfile":"","localkeyfile":"","securitymode":"None","securitypolicy":"None","useTransport":false,"maxChunkCount":1,"maxMessageSize":8192,"receiveBufferSize":8192,"sendBufferSize":8192,"setstatusandtime":false,"keepsessionalive":false,"name":"","x":820,"y":2580,"wires":[["f341317bdbd6dbde"],[],[]]},{"id":"0925665c62db7c3f","type":"function","z":"2d9b01c55fb8a47a","name":"function 8","func":"if (typeof msg.payload === 'boolean') {\n    msg.payload = msg.payload ? 1 : 0;\n} else {\n    msg.payload = \"Error: payload no es booleano\";\n}\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1060,"y":2520,"wires":[["85a753d7723be44f"]]},{"id":"f341317bdbd6dbde","type":"function","z":"2d9b01c55fb8a47a","name":"function 9","func":"if (typeof msg.payload === 'boolean') {\n    msg.payload = msg.payload ? 1 : 0;\n} else {\n    msg.payload = \"Error: payload no es booleano\";\n}\nreturn msg;","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1060,"y":2580,"wires":[["7ee02ea370e56606"]]},{"id":"3227b9df8936bf33","type":"function","z":"2d9b01c55fb8a47a","name":"function 10","func":"// Extrae el número desde estructuras tipo {value: ...} de OPC UA\nlet v = msg.payload;\nwhile (v && typeof v === 'object' && 'value' in v) v = v.value;\nmsg.payload = Number(v);\nmsg.topic = 'temp';\nreturn msg;\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1130,"y":260,"wires":[["1dc62b1a9ebd9f76"]]},{"id":"b8024cbfa4bf20cc","type":"function","z":"2d9b01c55fb8a47a","name":"function 11","func":"let v = msg.payload;\nwhile (v && typeof v === 'object' && 'value' in v) v = v.value;\nmsg.payload = Number(v);\nmsg.topic = 'hum';\nreturn msg;\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1110,"y":400,"wires":[["1dc62b1a9ebd9f76"]]},{"id":"b12ca9c06b68acbd","type":"function","z":"2d9b01c55fb8a47a","name":"function 12","func":"let v = msg.payload;\nwhile (v && typeof v === 'object' && 'value' in v) v = v.value;\nmsg.payload = Number(v);\nmsg.topic = 'weight';\nreturn msg;\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1170,"y":560,"wires":[["1dc62b1a9ebd9f76"]]},{"id":"1dc62b1a9ebd9f76","type":"join","z":"2d9b01c55fb8a47a","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","useparts":false,"accumulate":true,"timeout":"1.5","count":"9","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":1970,"y":960,"wires":[["2200fe13e64c5608"]]},{"id":"f43fe8f998ab4ce2","type":"function","z":"2d9b01c55fb8a47a","name":"function 15","func":"let v = msg.payload;\nwhile (v && typeof v === 'object' && 'value' in v) v = v.value;\nmsg.payload = Number(v);\nmsg.topic = 'HUM_EXTE';\nreturn msg;\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1710,"y":1080,"wires":[["1dc62b1a9ebd9f76"]]},{"id":"0b97f292dd159c71","type":"function","z":"2d9b01c55fb8a47a","name":"function 16","func":"let v = msg.payload;\nwhile (v && typeof v === 'object' && 'value' in v) v = v.value;\nmsg.payload = Number(v);\nmsg.topic = 'HUM_RES';\nreturn msg;\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1710,"y":1040,"wires":[["1dc62b1a9ebd9f76"]]},{"id":"a6922fd39910d7e1","type":"function","z":"2d9b01c55fb8a47a","name":"function 17","func":"// Extrae el número desde estructuras tipo {value: ...} de OPC UA\nlet v = msg.payload;\nwhile (v && typeof v === 'object' && 'value' in v) v = v.value;\nmsg.payload = Number(v);\nmsg.topic = 'TEMP_RESIS';\nreturn msg;\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1710,"y":1000,"wires":[["1dc62b1a9ebd9f76"]]},{"id":"31e76db98eefebda","type":"function","z":"2d9b01c55fb8a47a","name":"function 20","func":"let v = msg.payload;\nwhile (v && typeof v === 'object' && 'value' in v) v = v.value;\nmsg.payload = Number(v);\nmsg.topic = 'PRUEBA_PESO_T2';\nreturn msg;\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1830,"y":820,"wires":[["1dc62b1a9ebd9f76"]]},{"id":"794c46cee93ae350","type":"function","z":"2d9b01c55fb8a47a","name":"function 21","func":"// Extrae el número desde estructuras tipo {value: ...} de OPC UA\nlet v = msg.payload;\nwhile (v && typeof v === 'object' && 'value' in v) v = v.value;\nmsg.payload = Number(v);\nmsg.topic = 'INT_TEM_T2';\nreturn msg;\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1830,"y":740,"wires":[["1dc62b1a9ebd9f76"]]},{"id":"97c7af8e8e0323f2","type":"function","z":"2d9b01c55fb8a47a","name":"function 22","func":"let v = msg.payload;\nwhile (v && typeof v === 'object' && 'value' in v) v = v.value;\nmsg.payload = Number(v);\nmsg.topic = 'HUM_TOL2';\nreturn msg;\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1830,"y":780,"wires":[["1dc62b1a9ebd9f76"]]},{"id":"2200fe13e64c5608","type":"function","z":"2d9b01c55fb8a47a","name":"Armar registro","func":"// 1) ¿Estamos grabando?\nlet grabando = flow.get(\"grabando\") || false;\nif (!grabando) {\n    // Si la grabación no está activa, no guardamos nada\n    return null;\n}\n\n// 2) Datos del proceso\nlet tipo    = flow.get(\"tipo_proceso\")    || \"E\";  // 'E' = estándar, 'P' = personalizado\nlet archivo = flow.get(\"filename_actual\") || null;\n\nif (!archivo) {\n    // Si aún no se ha definido archivo, tampoco escribimos\n    return null;\n}\n\n// 3) Timestamp actual\nlet ahora = new Date();\nlet iso   = ahora.toISOString();  // 2025-11-12T20:15:00.123Z\n\n// 4) msg.payload viene del JOIN con tus 9 variables:\n// { temp1, hum1, weight1, temp2, hum2, weight2, tempr, humr, humext }\nlet datos = msg.payload;\n\n// 5) Agregamos columnas extra\ndatos.timestamp = iso;\ndatos.tipo      = tipo;\n\n// 6) Preparamos el mensaje para el CSV y el File\nmsg.payload  = datos;    // Objeto con 11 campos en total\nmsg.filename = archivo;  // Lo usará el nodo File\n\nreturn msg;\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":2140,"y":960,"wires":[["2aea60c4d4053ed1"]]},{"id":"2aea60c4d4053ed1","type":"csv","z":"2d9b01c55fb8a47a","name":"","spec":"rfc","sep":",","hdrin":"","hdrout":"once","multi":"mult","ret":"\\n","temp":"","skip":"0","strings":true,"include_empty_strings":"","include_null_values":"","x":2290,"y":960,"wires":[["170aa7cbef768c6c"]]},{"id":"170aa7cbef768c6c","type":"file","z":"2d9b01c55fb8a47a","name":"","filename":"","filenameType":"str","appendNewline":true,"createDir":false,"overwriteFile":"false","encoding":"utf8","x":2420,"y":960,"wires":[[]]},{"id":"btn_goto_cal","type":"ui_button","z":"flow_nav_start","name":"Ir a Calibración","group":"","order":11,"width":5,"height":1,"passthru":false,"label":"CALIBRACIÓN","tooltip":"Ir al tab 'calibracion'","color":"#ffffff","bgcolor":"#2196f3","className":"","icon":"fa-sliders","payload":"","payloadType":"str","topic":"","topicType":"str","x":220,"y":120,"wires":[["fn_nav_cal"]]},{"id":"fn_nav_cal","type":"function","z":"flow_nav_start","name":"Cambiar a tab 'calibracion'","func":"// Cambiar a la pestaña \"calibracion\"\nconst TAB = \"calibracion\";\n\n// Enviar en varias propiedades (compatibilidad)\nmsg.payload = { tab: TAB }; // algunas versiones esperan esto\nmsg.ui_control = { tab: TAB }; // otras leen aquí\nmsg.tab = TAB; // fallback adicional\n\nreturn msg;\n","outputs":1,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":470,"y":120,"wires":[["uictrl"]]},{"id":"uictrl","type":"ui_ui_control","z":"flow_nav_start","name":"ui_control","events":"all","x":700,"y":120,"wires":[[]]},{"id":"btn_volver_inicio","type":"ui_button","z":"flow_nav_start","name":"Volver al inicio","group":"68946b218293dbf8","order":13,"width":6,"height":1,"passthru":false,"label":"⬅️ VOLVER AL INICIO","tooltip":"Ir al menú principal","color":"#ffffff","bgcolor":"#f44336","className":"","icon":"fa-home","payload":"{\"tab\":\"Inicio\"}","payloadType":"json","topic":"","topicType":"str","x":220,"y":200,"wires":[["21aa78d976101d36"]]},{"id":"ui_ctrl_tabs","type":"ui_ui_control","z":"flow_nav_start","name":"","events":"all","x":660,"y":200,"wires":[[]]},{"id":"21aa78d976101d36","type":"function","z":"flow_nav_start","name":"function 14","func":"const TAB_NAME = \"Start_tab\"; // escríbelo EXACTO como aparece en Dashboard → Layout\nmsg.payload    = { tab: TAB_NAME };\nmsg.ui_control = { tab: TAB_NAME };\nmsg.tab = TAB_NAME;\nreturn msg;\n","outputs":1,"timeout":0,"noerr":0,"initialize":"","finalize":"","libs":[],"x":430,"y":200,"wires":[["ui_ctrl_tabs"]]},{"id":"fe762f84f9d811dd","type":"inject","z":"343924631c18c3df","name":"Inicializar tabla (8 filas)","props":[{"p":"payload"}],"repeat":"","crontab":"","once":true,"onceDelay":0.5,"topic":"","payload":"[{\"x\":null,\"y\":null},{\"x\":null,\"y\":null},{\"x\":null,\"y\":null},{\"x\":null,\"y\":null},{\"x\":null,\"y\":null},{\"x\":null,\"y\":null},{\"x\":null,\"y\":null},{\"x\":null,\"y\":null}]","payloadType":"json","x":170,"y":120,"wires":[["229e3177204125af","80cf09f1f5da9ec7","60fcce93aafda762"]]},{"id":"229e3177204125af","type":"ui_table","z":"343924631c18c3df","group":"68946b218293dbf8","name":"Tabla XY (PLC vs kg)","order":1,"width":6,"height":4,"columns":[{"field":"x","title":"x (Valor PLC)","width":"220px","align":"center","formatter":"plaintext","formatterParams":{"target":"_blank"}},{"field":"y","title":"y (Peso kg)","width":"220px","align":"center","formatter":"plaintext","formatterParams":{"target":"_blank"}}],"outputs":0,"cts":false,"x":480,"y":120,"wires":[]},{"id":"80cf09f1f5da9ec7","type":"change","z":"343924631c18c3df","name":"Compactar tabla (ui_control)","rules":[{"t":"set","p":"ui_control","pt":"msg","to":"{   \"tabulator\": {     \"height\": \"220px\",     \"layout\": \"fitData\",     \"responsiveLayout\": \"collapse\",     \"columns\": [       { \"field\": \"x\", \"title\": \"x (PLC)\", \"headerSort\": false, \"hozAlign\": \"center\", \"width\": 110, \"editor\": \"input\", \"validator\": [\"numeric\"] },       { \"field\": \"y\", \"title\": \"y (kg)\",  \"headerSort\": false, \"hozAlign\": \"center\", \"width\": 110, \"editor\": \"input\", \"validator\": [\"numeric\"] }     ]   } }","tot":"json"}],"x":160,"y":180,"wires":[["229e3177204125af"]]},{"id":"f7316c310db0803d","type":"ui_button","z":"343924631c18c3df","name":"CALCULAR","group":"68946b218293dbf8","order":3,"width":2,"height":1,"passthru":false,"label":"CALCULAR","tooltip":"Calcular pendiente (m) e intercepto (b)","color":"#ffffff","bgcolor":"#2196f3","className":"","icon":"fa-calculator","payload":"","payloadType":"str","topic":"","topicType":"str","x":150,"y":220,"wires":[["232ac2405ec682bb"]]},{"id":"ef39ed08642af8f9","type":"ui_button","z":"343924631c18c3df","name":"CARGAR","group":"68946b218293dbf8","order":2,"width":2,"height":1,"passthru":false,"label":"CARGAR","tooltip":"Enviar m y b al PLC","color":"#ffffff","bgcolor":"#00a889","className":"","icon":"fa-upload","payload":"","payloadType":"str","topic":"","topicType":"str","x":620,"y":200,"wires":[["cb263a58a9427bba","6158a610fd1e6b8b"]]},{"id":"0e419138d37f3ce7","type":"ui_button","z":"343924631c18c3df","name":"LIMPIAR","group":"68946b218293dbf8","order":4,"width":2,"height":1,"passthru":false,"label":"LIMPIAR","tooltip":"Vaciar tabla y resultados","color":"#ffffff","bgcolor":"#9e9e9e","className":"","icon":"fa-trash","payload":"","payloadType":"str","topic":"","topicType":"str","x":180,"y":360,"wires":[["c0b5c39605af630a"]]},{"id":"8a81c90c03951b9b","type":"ui_text","z":"343924631c18c3df","group":"68946b218293dbf8","order":5,"width":6,"height":1,"name":"Ecuación","label":"Ecuación","format":"{{msg.payload}}","layout":"row-spread","className":"","style":false,"font":"","fontSize":"","color":"#000000","x":520,"y":160,"wires":[]},{"id":"37dd893cfff4996a","type":"ui_text","z":"343924631c18c3df","group":"68946b218293dbf8","order":6,"width":6,"height":1,"name":"R2","label":"R²","format":"{{msg.payload}}","layout":"row-spread","className":"","style":false,"font":"","fontSize":"","color":"#000000","x":570,"y":260,"wires":[]},{"id":"232ac2405ec682bb","type":"function","z":"343924631c18c3df","name":"Regresión: Y = m·X + b","func":"// Filtro que NO acepta null/undefined/cadena vacía\nconst isNum = (v) => v !== null && v !== undefined && v !== '' && Number.isFinite(Number(v));\n\n// Leer puntos guardados (desde la tabla)\nlet raw = flow.get('pts_xy');\nlet pts = Array.isArray(raw)\n  ? raw.filter(r => r && isNum(r.x) && isNum(r.y))\n        .map(r => ({ x: Number(r.x), y: Number(r.y) }))\n  : [];\n\nif (pts.length < 2) {\n  node.status({fill:\"red\", shape:\"ring\", text:\"Sin puntos válidos\"});\n  return [{payload:\"\"}, {payload:\"\"}];\n}\n\n// --- Regresión lineal y = m x + b ---\nconst n   = pts.length;\nconst sum = a => a.reduce((p,c)=>p+c,0);\nconst mx  = sum(pts.map(p=>p.x))/n;\nconst my  = sum(pts.map(p=>p.y))/n;\nconst Sxx = sum(pts.map(p => (p.x - mx)*(p.x - mx)));\nconst Sxy = sum(pts.map(p => (p.x - mx)*(p.y - my)));\nconst m   = Sxy / (Sxx || 1e-12);\nconst b   = my - m*mx;\n\n// R²\nconst yhat  = pts.map(p => m*p.x + b);\nconst SSres = sum(pts.map((p,i) => (p.y - yhat[i])**2));\nconst SStot = sum(pts.map(p => (p.y - my)**2));\nconst R2    = 1 - SSres/(SStot || 1e-12);\n\n// Guardar para CARGAR\nflow.set('m_xy', m);\nflow.set('b_xy', b);\n\n// Mostrar ecuación\nconst eqStr = `Y = ${m.toFixed(6)} · X + ${b.toFixed(6)}`;\nnode.status({fill:\"green\", shape:\"dot\", text:`${eqStr}  (pts:${pts.length})`});\nreturn [{payload:eqStr}, {payload:R2.toFixed(6)}];\n","outputs":2,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":230,"y":280,"wires":[["8a81c90c03951b9b"],["37dd893cfff4996a"]]},{"id":"cb263a58a9427bba","type":"function","z":"343924631c18c3df","name":"Armar payload para PLC","func":"let m = flow.get('m_xy');\nlet b = flow.get('b_xy');\nif (!isFinite(m) || !isFinite(b)) { node.warn('Calcula primero la ecuación'); return null; }\nmsg.payload = { m: m, b: b };\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":830,"y":180,"wires":[[]]},{"id":"6158a610fd1e6b8b","type":"debug","z":"343924631c18c3df","name":"Salida a PLC (ver)","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","statusVal":"","statusType":"auto","x":830,"y":240,"wires":[]},{"id":"c0b5c39605af630a","type":"function","z":"343924631c18c3df","name":"Limpiar","func":"flow.set('pts_xy', []);\nflow.set('m_xy', null);\nflow.set('b_xy', null);\nnode.send([\n  {payload:[{x:null,y:null},{x:null,y:null},{x:null,y:null},{x:null,y:null},{x:null,y:null},{x:null,y:null},{x:null,y:null},{x:null,y:null}]},\n  {payload:''},\n  {payload:''}\n]);\nreturn null;","outputs":3,"noerr":0,"initialize":"","finalize":"","libs":[],"x":360,"y":360,"wires":[["229e3177204125af"],["8a81c90c03951b9b"],["37dd893cfff4996a"]]},{"id":"60fcce93aafda762","type":"function","z":"343924631c18c3df","name":"Guardar puntos XY","func":"// Guardar puntos XY provenientes de la tabla.\n// Acepta array completo o fila suelta y la integra en el array existente.\nconst isNum = v => v !== null && v !== undefined && v !== '' && Number.isFinite(Number(v));\nlet arr = flow.get('pts_xy') || [];\n\nif (Array.isArray(msg.payload)) {\n  // llega la tabla completa\n  arr = msg.payload.map(r => ({ x: r?.x ?? null, y: r?.y ?? null }));\n} else if (msg && typeof msg.payload === 'object' && msg.payload !== null) {\n  // llega una fila editada\n  const x = msg.payload.x;\n  const y = msg.payload.y;\n\n  // busca un lugar vacío para reemplazar, si no, agrega\n  if (isNum(x) && isNum(y)) {\n    const idx = arr.findIndex(p => !isNum(p?.x) || !isNum(p?.y));\n    if (idx >= 0) {\n      arr[idx] = { x: Number(x), y: Number(y) };\n    } else {\n      arr.push({ x: Number(x), y: Number(y) });\n    }\n  }\n}\n\nflow.set('pts_xy', arr);\nreturn null;\n\n","outputs":0,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":770,"y":120,"wires":[]},{"id":"in_plc_vars","type":"link in","z":"flow_vars_live","name":"PLC → variables_live (conéctame)","links":[],"x":180,"y":140,"wires":[["fn_split_vars"]]},{"id":"fn_split_vars","type":"function","z":"flow_vars_live","name":"Separar temperatura / humedad / peso","func":"const t = (v) => (v !== undefined && v !== null && isFinite(Number(v))) ? Number(v) : undefined;\nlet p = msg.payload;\nlet out = [null, null, null]; // 0=temp, 1=hum, 2=peso\nif (typeof p === 'number') {\n    const topic = String(msg.topic || '').toLowerCase();\n    if (topic.includes('temp')) out[0] = { payload: p };\n    else if (topic.includes('hum')) out[1] = { payload: p };\n    else out[2] = { payload: p }; // asumimos peso\n} else if (p && typeof p === 'object') {\n    const tt = t(p.temperatura);\n    const hh = t(p.humedad);\n    const ww = t(p.peso);\n    if (tt !== undefined) out[0] = { payload: tt };\n    if (hh !== undefined) out[1] = { payload: hh };\n    if (ww !== undefined) out[2] = { payload: ww };\n}\nreturn out;","outputs":3,"timeout":"","noerr":0,"initialize":"","finalize":"","libs":[],"x":430,"y":140,"wires":[["ui_temp"],["ui_hum"],["ui_peso","chart_peso"]]},{"id":"ui_temp","type":"ui_text","z":"flow_vars_live","group":"ui_grp_live","order":1,"width":4,"height":1,"name":"Temperatura (°C)","label":"Temperatura (°C)","format":"{{msg.payload | number:2}}","layout":"row-spread","className":"","style":false,"font":"","fontSize":"","color":"#000000","x":720,"y":100,"wires":[]},{"id":"ui_hum","type":"ui_text","z":"flow_vars_live","group":"ui_grp_live","order":2,"width":4,"height":1,"name":"Humedad (%RH)","label":"Humedad (%RH)","format":"{{msg.payload | number:2}}","layout":"row-spread","className":"","style":false,"font":"","fontSize":"","color":"#000000","x":720,"y":140,"wires":[]},{"id":"ui_peso","type":"ui_text","z":"flow_vars_live","group":"ui_grp_live","order":3,"width":4,"height":1,"name":"Peso (lectura PLC)","label":"Peso (lectura PLC)","format":"{{msg.payload | number:2}}","layout":"row-spread","className":"","style":false,"font":"","fontSize":"","color":"#000000","x":730,"y":180,"wires":[]},{"id":"chart_peso","type":"ui_chart","z":"flow_vars_live","name":"Peso en tiempo real","group":"ui_grp_live","order":5,"width":5,"height":4,"label":"Peso en tiempo real","chartType":"line","legend":"false","xformat":"auto","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":0,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"className":"","x":730,"y":240,"wires":[[]]},{"id":"inj_demo_vars","type":"inject","z":"flow_vars_live","name":"Ejemplo llegada variables","props":[{"p":"payload"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"{\"temperatura\":24.6,\"humedad\":58.2,\"peso\":1234}","payloadType":"json","x":210,"y":200,"wires":[["fn_split_vars"]]}]