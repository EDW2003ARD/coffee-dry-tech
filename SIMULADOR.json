[{"id":"47a745ac.9f83dc","type":"tab","label":"PLC","disabled":false,"info":""},{"id":"1d0b3b5c.03ac95","type":"tab","label":"Menu inicio","disabled":false,"info":""},{"id":"e69d9ae9.d86958","type":"tab","label":"Proceso estandar","disabled":false,"info":""},{"id":"cf6e4dbe.06b5d","type":"tab","label":"Proceso personalizado","disabled":false,"info":""},{"id":"ff06c4a0.7e7488","type":"tab","label":"Datos estandar","disabled":false,"info":""},{"id":"acb46316.472a9","type":"tab","label":"Datos usuario","disabled":false,"info":""},{"id":"934099b7.c96bb8","type":"tab","label":"ON Proceso estandar","disabled":false,"info":""},{"id":"53774dfa.efea64","type":"tab","label":"ON Proceso personalizado","disabled":false,"info":""},{"id":"804acb1a.0445f8","type":"tab","label":"Graficas","disabled":false,"info":""},{"id":"b00549e6.aec4c8","type":"tab","label":"Curvas","disabled":false,"info":""},{"id":"34168811.ab73a8","type":"tab","label":"Configuración","disabled":false,"info":""},{"id":"93a187c.3811378","type":"tab","label":"Pruebas","disabled":false,"info":""},{"id":"1c68ae4b.6ab192","type":"ui_base","theme":{"name":"theme-light","lightTheme":{"default":"#0094CE","baseColor":"#0094CE","baseFont":"Trebuchet MS,Helvetica,sans-serif","edited":true,"reset":false},"darkTheme":{"default":"#097479","baseColor":"#097479","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":false},"customTheme":{"name":"Untitled Theme 1","default":"#4B7930","baseColor":"#4B7930","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"},"themeState":{"base-color":{"default":"#0094CE","value":"#0094CE","edited":false},"page-titlebar-backgroundColor":{"value":"#0094CE","edited":false},"page-backgroundColor":{"value":"#fafafa","edited":false},"page-sidebar-backgroundColor":{"value":"#ffffff","edited":false},"group-textColor":{"value":"#1bbfff","edited":false},"group-borderColor":{"value":"#ffffff","edited":false},"group-backgroundColor":{"value":"#ffffff","edited":false},"widget-textColor":{"value":"#111111","edited":false},"widget-backgroundColor":{"value":"#0094ce","edited":false},"widget-borderColor":{"value":"#ffffff","edited":false},"base-font":{"value":"Trebuchet MS,Helvetica,sans-serif"}},"angularTheme":{"primary":"indigo","accents":"blue","warn":"red","background":"grey","palette":"light"}},"site":{"name":"Coffee dry pro","hideToolbar":"true","allowSwipe":"false","lockMenu":"false","allowTempTheme":"true","dateFormat":"DD/MM/YYYY","sizes":{"sx":48,"sy":48,"gx":6,"gy":6,"cx":6,"cy":6,"px":0,"py":0}}},{"id":"78118908.780938","type":"ui_tab","z":"","name":"Start_tab","icon":"dashboard","order":1,"disabled":false,"hidden":true},{"id":"c34a93b.47fb57","type":"ui_group","z":"","name":"Start Menu Group","tab":"78118908.780938","order":2,"disp":false,"width":18,"collapse":false,"className":""},{"id":"21409487.50686c","type":"ui_tab","z":"","name":"Standard_process_tab","icon":"dashboard","order":2,"disabled":false,"hidden":true},{"id":"be9c39d7.f42578","type":"ui_group","z":"","name":"Standard Process Menu Group","tab":"21409487.50686c","order":2,"disp":false,"width":18,"collapse":false,"className":""},{"id":"f07889.43497778","type":"ui_tab","z":"","name":"Personalized_process_tab","icon":"dashboard","order":3,"disabled":false,"hidden":true},{"id":"5da4ffa9.3ed6c","type":"ui_group","z":"","name":"User Process Menu Group","tab":"f07889.43497778","order":1,"disp":false,"width":18,"collapse":false,"className":""},{"id":"6341c93e.8c02e8","type":"ui_tab","z":"","name":"ON_standard_process_tab","icon":"dashboard","order":6,"disabled":false,"hidden":true},{"id":"cca89ca3.f14d7","type":"ui_group","z":"","name":"Live_data","tab":"6341c93e.8c02e8","order":1,"disp":false,"width":18,"collapse":false,"className":""},{"id":"e1b66e8.9cb259","type":"ui_tab","z":"","name":"Graphics_tab","icon":"dashboard","order":8,"disabled":false,"hidden":true},{"id":"73d41b87.143354","type":"ui_group","z":"","name":"Live_graphics_data","tab":"e1b66e8.9cb259","order":2,"disp":false,"width":18,"collapse":false,"className":""},{"id":"86894366.81d26","type":"ui_tab","z":"","name":"Data_tab","icon":"dashboard","order":4,"disabled":false,"hidden":true},{"id":"78ed841d.d7023c","type":"ui_group","z":"","name":"Data Group","tab":"86894366.81d26","order":1,"disp":false,"width":18,"collapse":false,"className":""},{"id":"50338663.dd4128","type":"ui_tab","z":"","name":"Pruebas","icon":"dashboard","order":11,"disabled":false,"hidden":true},{"id":"fa43ae49.746bc","type":"ui_group","z":"","name":"Pruebas_Group","tab":"50338663.dd4128","order":1,"disp":false,"width":18,"collapse":false,"className":""},{"id":"8d9752b4.b89c3","type":"ui_tab","z":"","name":"Configuration_tab","icon":"dashboard","order":10,"disabled":false,"hidden":true},{"id":"f98bd4ef.b5b8a8","type":"ui_group","z":"","name":"Configuration Group","tab":"8d9752b4.b89c3","order":1,"disp":false,"width":"18","collapse":false,"className":""},{"id":"29bd693.72da996","type":"ui_tab","z":"","name":"Waves_tab","icon":"dashboard","order":9,"disabled":false,"hidden":true},{"id":"29d83d86.1999e2","type":"ui_group","z":"","name":"Waves Group","tab":"29bd693.72da996","order":1,"disp":false,"width":18,"collapse":false,"className":""},{"id":"f9e3dd04.518cc","type":"ui_tab","z":"","name":"ON_personalized_process_tab","icon":"dashboard","order":7,"disabled":false,"hidden":true},{"id":"9f83ddf8.9d529","type":"ui_group","z":"","name":"Live_data","tab":"f9e3dd04.518cc","order":1,"disp":false,"width":18,"collapse":false,"className":""},{"id":"8de67387.bb688","type":"ui_tab","z":"","name":"Data_personalized_tab","icon":"dashboard","order":5,"disabled":false,"hidden":true},{"id":"7bf35741.d78c68","type":"ui_group","z":"","name":"Data Group","tab":"8de67387.bb688","order":1,"disp":false,"width":"18","collapse":false,"className":""},{"id":"c17ab281.5b4a6","type":"ui_spacer","z":"ff06c4a0.7e7488","name":"spacer","group":"78ed841d.d7023c","order":4,"width":1,"height":1},{"id":"93ba62b1.6d494","type":"ui_spacer","z":"ff06c4a0.7e7488","name":"spacer","group":"78ed841d.d7023c","order":6,"width":1,"height":1},{"id":"ff8d4b5a.9bd708","type":"ui_spacer","z":"ff06c4a0.7e7488","name":"spacer","group":"78ed841d.d7023c","order":8,"width":3,"height":1},{"id":"3d8cb6a4.39c61a","type":"ui_spacer","z":"ff06c4a0.7e7488","name":"spacer","group":"78ed841d.d7023c","order":10,"width":3,"height":1},{"id":"ba70ecf1.286f1","type":"ui_spacer","z":"ff06c4a0.7e7488","name":"spacer","group":"78ed841d.d7023c","order":12,"width":1,"height":1},{"id":"5cc8bdb7.0c7fa4","type":"ui_spacer","z":"ff06c4a0.7e7488","name":"spacer","group":"78ed841d.d7023c","order":14,"width":1,"height":1},{"id":"97fd22e2.f204b","type":"ui_spacer","z":"ff06c4a0.7e7488","name":"spacer","group":"78ed841d.d7023c","order":16,"width":1,"height":1},{"id":"81e40096.2210f","type":"ui_spacer","z":"ff06c4a0.7e7488","name":"spacer","group":"78ed841d.d7023c","order":18,"width":1,"height":1},{"id":"829a0529.83bed8","type":"ui_spacer","z":"ff06c4a0.7e7488","name":"spacer","group":"78ed841d.d7023c","order":20,"width":1,"height":1},{"id":"26091a4b.c833b6","type":"ui_spacer","z":"ff06c4a0.7e7488","name":"spacer","group":"78ed841d.d7023c","order":22,"width":1,"height":1},{"id":"e5db1482.aad828","type":"ui_spacer","z":"ff06c4a0.7e7488","name":"spacer","group":"78ed841d.d7023c","order":24,"width":1,"height":1},{"id":"e445cc4f.4b00d","type":"ui_spacer","z":"ff06c4a0.7e7488","name":"spacer","group":"78ed841d.d7023c","order":26,"width":1,"height":1},{"id":"dbf855b4.f122b8","type":"ui_spacer","z":"ff06c4a0.7e7488","name":"spacer","group":"78ed841d.d7023c","order":28,"width":1,"height":1},{"id":"7af9668b.0ec7c8","type":"ui_spacer","z":"ff06c4a0.7e7488","name":"spacer","group":"78ed841d.d7023c","order":30,"width":1,"height":1},{"id":"9bca8a75.fc0918","type":"ui_spacer","z":"ff06c4a0.7e7488","name":"spacer","group":"78ed841d.d7023c","order":32,"width":1,"height":1},{"id":"c46c944a.f9a378","type":"ui_spacer","z":"ff06c4a0.7e7488","name":"spacer","group":"78ed841d.d7023c","order":34,"width":1,"height":1},{"id":"bf79f5c2.000e38","type":"ui_spacer","z":"ff06c4a0.7e7488","name":"spacer","group":"78ed841d.d7023c","order":36,"width":1,"height":1},{"id":"cbd63554.8cb498","type":"ui_spacer","z":"ff06c4a0.7e7488","name":"spacer","group":"78ed841d.d7023c","order":38,"width":1,"height":1},{"id":"b0e8a838.5f1d88","type":"ui_spacer","z":"ff06c4a0.7e7488","name":"spacer","group":"78ed841d.d7023c","order":40,"width":1,"height":1},{"id":"4aeec464.55daac","type":"ui_spacer","z":"ff06c4a0.7e7488","name":"spacer","group":"78ed841d.d7023c","order":42,"width":1,"height":1},{"id":"895dbce7.2dfd9","type":"ui_spacer","z":"ff06c4a0.7e7488","name":"spacer","group":"78ed841d.d7023c","order":43,"width":1,"height":1},{"id":"e32d7841.5994f8","type":"ui_spacer","z":"ff06c4a0.7e7488","name":"spacer","group":"78ed841d.d7023c","order":45,"width":1,"height":1},{"id":"935fbbf2.cb34e8","type":"ui_spacer","z":"ff06c4a0.7e7488","name":"spacer","group":"78ed841d.d7023c","order":47,"width":1,"height":1},{"id":"7475cc08.99f974","type":"ui_spacer","z":"ff06c4a0.7e7488","name":"spacer","group":"78ed841d.d7023c","order":49,"width":1,"height":1},{"id":"da0c0c0f.ce711","type":"ui_spacer","z":"934099b7.c96bb8","name":"spacer","group":"cca89ca3.f14d7","order":4,"width":1,"height":1},{"id":"6e78f2d6.172adc","type":"ui_spacer","z":"53774dfa.efea64","name":"spacer","group":"9f83ddf8.9d529","order":4,"width":1,"height":1},{"id":"da9ccdc7.12b94","type":"ui_spacer","z":"53774dfa.efea64","name":"spacer","group":"9f83ddf8.9d529","order":6,"width":1,"height":1},{"id":"4ce1bc.30954e44","type":"ui_spacer","z":"804acb1a.0445f8","name":"spacer","group":"73d41b87.143354","order":4,"width":1,"height":1},{"id":"c052844a.218c78","type":"ui_spacer","z":"804acb1a.0445f8","name":"spacer","group":"73d41b87.143354","order":8,"width":1,"height":1},{"id":"949678a9.7c6448","type":"ui_spacer","z":"804acb1a.0445f8","name":"spacer","group":"73d41b87.143354","order":11,"width":1,"height":1},{"id":"9b662bb.dbb1cd8","type":"ui_spacer","z":"804acb1a.0445f8","name":"spacer","group":"73d41b87.143354","order":13,"width":1,"height":1},{"id":"7cd8f1c4.74719","type":"ui_spacer","z":"804acb1a.0445f8","name":"spacer","group":"73d41b87.143354","order":15,"width":1,"height":1},{"id":"b8d2ec.ac3d9d18","type":"ui_spacer","z":"804acb1a.0445f8","name":"spacer","group":"73d41b87.143354","order":17,"width":1,"height":1},{"id":"ed085f22.e37c1","type":"ui_spacer","z":"804acb1a.0445f8","name":"spacer","group":"73d41b87.143354","order":20,"width":1,"height":1},{"id":"42f9c35f.4f771c","type":"ui_spacer","z":"804acb1a.0445f8","name":"spacer","group":"73d41b87.143354","order":23,"width":1,"height":1},{"id":"f403acb7.f0ca9","type":"ui_spacer","z":"804acb1a.0445f8","name":"spacer","group":"73d41b87.143354","order":24,"width":1,"height":1},{"id":"af247434.0d5cb8","type":"ui_spacer","z":"804acb1a.0445f8","name":"spacer","group":"73d41b87.143354","order":26,"width":1,"height":1},{"id":"d7c6d319.ea857","type":"ui_spacer","z":"804acb1a.0445f8","name":"spacer","group":"73d41b87.143354","order":27,"width":1,"height":1},{"id":"6bcca2e4.15a3fc","type":"ui_spacer","z":"acb46316.472a9","name":"spacer","group":"7bf35741.d78c68","order":2,"width":1,"height":1},{"id":"1132fd65.d994f3","type":"ui_spacer","z":"acb46316.472a9","name":"spacer","group":"7bf35741.d78c68","order":4,"width":1,"height":1},{"id":"f00eed1c.4e87e","type":"ui_group","name":"Notificación","tab":"","order":1,"disp":true,"width":"6","collapse":false},{"id":"8be4bad6.fea988","type":"ui_group","name":"Notificación","tab":"","order":1,"disp":true,"width":"6","collapse":false},{"id":"1b3ee156.4a403f","type":"ui_group","name":"Grupo de Texto","tab":"","order":1,"disp":true,"width":"6","collapse":false},{"id":"43b79257.9fe02c","type":"ui_group","name":"Grupo de Texto","tab":"","order":1,"disp":true,"width":6,"collapse":false},{"id":"379a21ec.32b61e","type":"ui_group","name":"Control","tab":"","order":1,"disp":true,"width":"6","collapse":false},{"id":"f314372d.7aa798","type":"ui_spacer","z":"e69d9ae9.d86958","name":"spacer","group":"be9c39d7.f42578","order":7,"width":1,"height":1},{"id":"c3793460.c58628","type":"ui_spacer","z":"e69d9ae9.d86958","name":"spacer","group":"be9c39d7.f42578","order":9,"width":1,"height":1},{"id":"8b498d76.bde2e","type":"ui_spacer","z":"e69d9ae9.d86958","name":"spacer","group":"be9c39d7.f42578","order":11,"width":1,"height":1},{"id":"445b0e19.92cb5","type":"ui_spacer","z":"e69d9ae9.d86958","name":"spacer","group":"be9c39d7.f42578","order":13,"width":1,"height":1},{"id":"e0e7d83.2b24628","type":"ui_spacer","z":"e69d9ae9.d86958","name":"spacer","group":"be9c39d7.f42578","order":15,"width":1,"height":1},{"id":"936b3fb2.e966c","type":"ui_spacer","z":"e69d9ae9.d86958","name":"spacer","group":"be9c39d7.f42578","order":17,"width":1,"height":1},{"id":"ccdd32a3.a39ed","type":"ui_spacer","z":"e69d9ae9.d86958","name":"spacer","group":"be9c39d7.f42578","order":19,"width":1,"height":1},{"id":"ae2e2de3.81f","type":"ui_spacer","z":"e69d9ae9.d86958","name":"spacer","group":"be9c39d7.f42578","order":21,"width":1,"height":1},{"id":"71cb9e26.ff94c","type":"ui_spacer","z":"e69d9ae9.d86958","name":"spacer","group":"be9c39d7.f42578","order":23,"width":1,"height":1},{"id":"c5bdfd70.77509","type":"ui_spacer","z":"e69d9ae9.d86958","name":"spacer","group":"be9c39d7.f42578","order":25,"width":1,"height":1},{"id":"7cad357e.fcf1ac","type":"ui_spacer","z":"e69d9ae9.d86958","name":"spacer","group":"be9c39d7.f42578","order":27,"width":1,"height":1},{"id":"9a77dc47.3419d","type":"ui_spacer","z":"e69d9ae9.d86958","name":"spacer","group":"be9c39d7.f42578","order":29,"width":1,"height":1},{"id":"a3503a8b.71f1b8","type":"ui_spacer","z":"e69d9ae9.d86958","name":"spacer","group":"be9c39d7.f42578","order":31,"width":1,"height":1},{"id":"677f88bd.496608","type":"ui_spacer","z":"e69d9ae9.d86958","name":"spacer","group":"be9c39d7.f42578","order":33,"width":1,"height":1},{"id":"787efd79.29db84","type":"ui_spacer","z":"e69d9ae9.d86958","name":"spacer","group":"be9c39d7.f42578","order":35,"width":1,"height":1},{"id":"766fecd3.66bd24","type":"ui_spacer","z":"e69d9ae9.d86958","name":"spacer","group":"be9c39d7.f42578","order":37,"width":1,"height":1},{"id":"95dfff38.07f31","type":"ui_spacer","z":"e69d9ae9.d86958","name":"spacer","group":"be9c39d7.f42578","order":39,"width":1,"height":1},{"id":"9c44a500.4d4918","type":"ui_spacer","z":"e69d9ae9.d86958","name":"spacer","group":"be9c39d7.f42578","order":41,"width":1,"height":1},{"id":"39d2ac61.5a13d4","type":"ui_spacer","z":"e69d9ae9.d86958","name":"spacer","group":"be9c39d7.f42578","order":43,"width":1,"height":1},{"id":"d8286cfb.a444d","type":"ui_spacer","z":"e69d9ae9.d86958","name":"spacer","group":"be9c39d7.f42578","order":45,"width":1,"height":1},{"id":"47f2f12.0583d1","type":"ui_spacer","z":"34168811.ab73a8","name":"spacer","group":"f98bd4ef.b5b8a8","order":4,"width":13,"height":1},{"id":"54843d0.e413fc4","type":"ui_spacer","z":"34168811.ab73a8","name":"spacer","group":"f98bd4ef.b5b8a8","order":6,"width":1,"height":1},{"id":"4cbdda9b.c8afd4","type":"ui_spacer","z":"34168811.ab73a8","name":"spacer","group":"f98bd4ef.b5b8a8","order":8,"width":1,"height":1},{"id":"e0b93152.b860a","type":"ui_spacer","z":"34168811.ab73a8","name":"spacer","group":"f98bd4ef.b5b8a8","order":10,"width":1,"height":1},{"id":"27081d16.f239a2","type":"ui_spacer","z":"34168811.ab73a8","name":"spacer","group":"f98bd4ef.b5b8a8","order":12,"width":1,"height":1},{"id":"65a80544.cced9c","type":"ui_spacer","z":"34168811.ab73a8","name":"spacer","group":"f98bd4ef.b5b8a8","order":14,"width":1,"height":1},{"id":"eaffd550.d4d8b8","type":"ui_spacer","z":"34168811.ab73a8","name":"spacer","group":"f98bd4ef.b5b8a8","order":17,"width":1,"height":1},{"id":"ea956acb.9b6528","type":"ui_spacer","z":"34168811.ab73a8","name":"spacer","group":"f98bd4ef.b5b8a8","order":19,"width":1,"height":1},{"id":"7c6be6f8.8646e8","type":"ui_spacer","z":"34168811.ab73a8","name":"spacer","group":"f98bd4ef.b5b8a8","order":21,"width":1,"height":1},{"id":"3e1d8b52.887a74","type":"ui_spacer","z":"34168811.ab73a8","name":"spacer","group":"f98bd4ef.b5b8a8","order":24,"width":1,"height":1},{"id":"a2050fc1.4481a","type":"ui_spacer","z":"34168811.ab73a8","name":"spacer","group":"f98bd4ef.b5b8a8","order":26,"width":1,"height":1},{"id":"2da9c964.345dd6","type":"ui_spacer","z":"34168811.ab73a8","name":"spacer","group":"f98bd4ef.b5b8a8","order":28,"width":1,"height":1},{"id":"3696e773.3e3528","type":"ui_spacer","z":"34168811.ab73a8","name":"spacer","group":"f98bd4ef.b5b8a8","order":31,"width":1,"height":1},{"id":"24e13a80.9752b6","type":"ui_spacer","z":"34168811.ab73a8","name":"spacer","group":"f98bd4ef.b5b8a8","order":33,"width":13,"height":1},{"id":"b1768346.51387","type":"ui_spacer","z":"34168811.ab73a8","name":"spacer","group":"f98bd4ef.b5b8a8","order":34,"width":13,"height":1},{"id":"cf639ab6.196f38","type":"ui_spacer","z":"34168811.ab73a8","name":"spacer","group":"f98bd4ef.b5b8a8","order":36,"width":13,"height":1},{"id":"ed519926.9c2e38","type":"ui_spacer","z":"34168811.ab73a8","name":"spacer","group":"f98bd4ef.b5b8a8","order":37,"width":13,"height":1},{"id":"e4dfe754.f96238","type":"inject","z":"47a745ac.9f83dc","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"15","crontab":"","once":true,"onceDelay":"1","topic":"","payload":"","payloadType":"date","x":170,"y":340,"wires":[["c79a9941.79e278"]]},{"id":"c79a9941.79e278","type":"function","z":"47a745ac.9f83dc","name":"hum1","func":"let t = context.get('time') || 0;\nlet initialHumidity = 63;\nlet rate = 0.5;\n\n// Calcular la humedad base restando el tiempo multiplicado por la tasa\nlet baseHumidity = initialHumidity - t * rate;\n\n// Añadir una pequeña variación aleatoria a la humedad base\n// Usamos Math.random() para generar un valor entre -1 y 1, lo que introduce fluctuaciones leves.\nlet randomVariation = (Math.random() * 2) - 1; \n\n// Sumar la variación aleatoria a la humedad base\nlet humidity = baseHumidity + randomVariation;\n\n// Asegurarse de que la humedad no sea menor que 0\nif (humidity < 0) humidity = 0;\n\nmsg.payload = humidity.toFixed(2);\ncontext.set('time', t + 1);\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":350,"y":340,"wires":[["d266633b.688fe","6cbd9fa4.336f1"]]},{"id":"c04a035a.aaad4","type":"inject","z":"47a745ac.9f83dc","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"15","crontab":"","once":true,"onceDelay":"1","topic":"","payload":"","payloadType":"date","x":170,"y":480,"wires":[["653683e4.80c70c"]]},{"id":"653683e4.80c70c","type":"function","z":"47a745ac.9f83dc","name":"weight1","func":"let t = context.get('time') || 0;\nlet initialLoad = 33;\nlet rate = 0.003;\n\n// Calcular la carga base restando el tiempo multiplicado por la tasa\nlet baseLoad = initialLoad - t * rate;\n\n// Añadir una pequeña variación aleatoria a la carga base\n// Genera un valor aleatorio entre -0.5 y 0.5 para mantener la variación suave\nlet randomVariation = (Math.random() * 1) - 0.5;\n\n// Sumar la variación aleatoria a la carga base\nlet load = baseLoad + randomVariation;\n\n// Asegurarse de que la carga no sea menor que 0\nif (load < 0) load = 0;\n\nmsg.payload = load.toFixed(2);\ncontext.set('time', t + 1);\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":360,"y":480,"wires":[["8c1ecafb.80b068","dbee4752.472348"]]},{"id":"f055e35.499c72","type":"inject","z":"47a745ac.9f83dc","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"15","crontab":"","once":true,"onceDelay":"1","topic":"","payload":"","payloadType":"date","x":830,"y":340,"wires":[["914ca9ed.01a3f8"]]},{"id":"914ca9ed.01a3f8","type":"function","z":"47a745ac.9f83dc","name":"hum2","func":"let t = context.get('time') || 0;\nlet initialHumidity = 67;\nlet rate = 0.5;\n\n// Calcular la humedad base restando el tiempo multiplicado por la tasa\nlet baseHumidity = initialHumidity - t * rate;\n\n// Añadir una pequeña variación aleatoria a la humedad base\n// Usamos Math.random() para generar un valor entre -1 y 1, lo que introduce fluctuaciones leves.\nlet randomVariation = (Math.random() * 2) - 1; \n\n// Sumar la variación aleatoria a la humedad base\nlet humidity = baseHumidity + randomVariation;\n\n// Asegurarse de que la humedad no sea menor que 0\nif (humidity < 0) humidity = 0;\n\nmsg.payload = humidity.toFixed(2);\ncontext.set('time', t + 1);\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1010,"y":340,"wires":[["6a896d49.894054","90474d8f.a6f5a"]]},{"id":"37bbb2a8.72129e","type":"inject","z":"47a745ac.9f83dc","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"15","crontab":"","once":true,"onceDelay":"1","topic":"","payload":"","payloadType":"date","x":510,"y":900,"wires":[["2531c7d.8473338"]]},{"id":"2531c7d.8473338","type":"function","z":"47a745ac.9f83dc","name":"humr","func":"let t = context.get('time') || 0;\nlet initialHumidity = 53;\nlet rate = 2;\n\n// Calcular la humedad base restando el tiempo multiplicado por la tasa\nlet baseHumidity = initialHumidity - t * rate;\n\n// Añadir una pequeña variación aleatoria a la humedad base\n// Usamos Math.random() para generar un valor entre -1 y 1, lo que introduce fluctuaciones leves.\nlet randomVariation = (Math.random() * 2) - 1; \n\n// Sumar la variación aleatoria a la humedad base\nlet humidity = baseHumidity + randomVariation;\n\n// Asegurarse de que la humedad no sea menor que 0\nif (humidity < 0) humidity = 0;\n\nmsg.payload = humidity.toFixed(2);\ncontext.set('time', t + 1);\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":690,"y":900,"wires":[["18cb585b.2f0d88","efdade98.7bb17"]]},{"id":"18cb585b.2f0d88","type":"debug","z":"47a745ac.9f83dc","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":890,"y":900,"wires":[]},{"id":"1ef77609.bf874a","type":"inject","z":"47a745ac.9f83dc","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"15","crontab":"","once":true,"onceDelay":"1","topic":"","payload":"","payloadType":"date","x":510,"y":1120,"wires":[["2da4c258.04396e"]]},{"id":"2da4c258.04396e","type":"function","z":"47a745ac.9f83dc","name":"humext","func":"let t = context.get('time') || 0;\nlet initialHumidity = 72;\nlet rate = 0.05;  // Reducimos la tasa de disminución para hacerla más lenta y constante\n\n// Calcular la humedad base restando el tiempo multiplicado por la tasa\nlet baseHumidity = initialHumidity - t * rate;\n\n// Añadir una variación aleatoria más pequeña para mantener mayor constancia\nlet randomVariation = (Math.random() * 0.2) - 0.1;  // Variación aleatoria entre -0.1 y 0.1\n\n// Sumar la variación aleatoria a la humedad base\nlet humidity = baseHumidity + randomVariation;\n\n// Asegurarse de que la humedad no sea menor que 0\nif (humidity < 0) humidity = 0;\n\nmsg.payload = humidity.toFixed(2);\ncontext.set('time', t + 1);\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":700,"y":1120,"wires":[["7e805a9c.296e64","b267761b.e2e728"]]},{"id":"7e805a9c.296e64","type":"debug","z":"47a745ac.9f83dc","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":890,"y":1120,"wires":[]},{"id":"d2065356.3950c","type":"inject","z":"47a745ac.9f83dc","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"15","crontab":"","once":true,"onceDelay":"1","topic":"","payload":"","payloadType":"date","x":830,"y":180,"wires":[["889b8eec.48261"]]},{"id":"889b8eec.48261","type":"function","z":"47a745ac.9f83dc","name":"temp2","func":"let t = context.get('time') || 0;\nlet maxTemperature = 90;\nlet baseTemperature = 31 + (maxTemperature - 20) * Math.sin(t / 100 * Math.PI);\n\n// Agregar una variación aleatoria pequeña\nlet randomVariation = (Math.random() * 4) - 2;  // Variación aleatoria entre -2 y 2 grados\nlet temperature = baseTemperature + randomVariation;\n\n// Limitar la temperatura a un máximo de 90\nif (temperature > maxTemperature) {\n    temperature = maxTemperature;\n}\n\nmsg.payload = temperature.toFixed(2);\ncontext.set('time', t + 1);\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1010,"y":180,"wires":[["bbe0478.68769b8","9de2a8d9.27afa8"]]},{"id":"5a0c9bb6.7824b4","type":"inject","z":"47a745ac.9f83dc","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":160,"y":300,"wires":[["c79a9941.79e278"]]},{"id":"e8000b1.c427ef8","type":"inject","z":"47a745ac.9f83dc","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":820,"y":300,"wires":[["914ca9ed.01a3f8"]]},{"id":"a664c1c7.d1aea","type":"inject","z":"47a745ac.9f83dc","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":160,"y":440,"wires":[["653683e4.80c70c"]]},{"id":"89b23312.3d931","type":"inject","z":"47a745ac.9f83dc","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":820,"y":140,"wires":[["889b8eec.48261"]]},{"id":"a3c85beb.e764c8","type":"inject","z":"47a745ac.9f83dc","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":500,"y":860,"wires":[["2531c7d.8473338"]]},{"id":"100ab277.10802e","type":"inject","z":"47a745ac.9f83dc","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":500,"y":1080,"wires":[["2da4c258.04396e"]]},{"id":"4983654b.e70d5c","type":"ui_text","z":"e69d9ae9.d86958","group":"be9c39d7.f42578","order":2,"width":7,"height":1,"name":"","label":"Usuario:","format":"{{msg.payload}}","layout":"row-center","className":"text-purple","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#46408a","x":980,"y":40,"wires":[]},{"id":"f519db25.f8fc68","type":"ui_text","z":"e69d9ae9.d86958","group":"be9c39d7.f42578","order":3,"width":6,"height":1,"name":"Role","label":"","format":"{{msg.payload}}","layout":"row-center","className":"text-blue","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#00abe5","x":1690,"y":40,"wires":[]},{"id":"b8d9f865.7599f8","type":"ui_button","z":"e69d9ae9.d86958","name":"","group":"be9c39d7.f42578","order":49,"width":7,"height":2,"passthru":false,"label":"Cancelar proceso","tooltip":"","color":"","bgcolor":"#cd6a6a","className":"red_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":270,"y":960,"wires":[["f865c697.e94b78"]]},{"id":"b4cbf9a.79aa608","type":"ui_button","z":"e69d9ae9.d86958","name":"","group":"be9c39d7.f42578","order":50,"width":6,"height":2,"passthru":false,"label":"Siguiente","tooltip":"","color":"","bgcolor":"#8adf9d","className":"green_button","icon":"","payload":"Estandar","payloadType":"str","topic":"","topicType":"str","x":240,"y":680,"wires":[["b61a8386.5dfd1","90bf9b0b.b29e28","43506c4d.ba4d24","cd9061b3.9661a"]]},{"id":"f865c697.e94b78","type":"change","z":"e69d9ae9.d86958","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"Start_tab\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":460,"y":960,"wires":[["cf1cf278.9cc8c"]]},{"id":"cf1cf278.9cc8c","type":"ui_ui_control","z":"e69d9ae9.d86958","name":"","events":"all","x":620,"y":960,"wires":[[]]},{"id":"eeecd74c.041b18","type":"ui_ui_control","z":"e69d9ae9.d86958","name":"","events":"all","x":720,"y":820,"wires":[[]]},{"id":"86f5cba0.5b7cf8","type":"ui_text","z":"e69d9ae9.d86958","group":"be9c39d7.f42578","order":4,"width":13,"height":2,"name":"","label":"Proceso estándar","format":"Configuración del proceso","layout":"col-center","className":"Label_proceso_estandar","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"30","color":"#b0b6bd","x":1110,"y":100,"wires":[]},{"id":"429203c0.ed026c","type":"ui_text","z":"e69d9ae9.d86958","group":"be9c39d7.f42578","order":8,"width":3,"height":1,"name":"","label":"Pre Secado","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"22","color":"#464080","x":910,"y":160,"wires":[]},{"id":"87e6735.6ec9c9","type":"ui_text","z":"e69d9ae9.d86958","group":"be9c39d7.f42578","order":10,"width":3,"height":1,"name":"","label":"Oreado","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"22","color":"#464080","x":1100,"y":160,"wires":[]},{"id":"886d1900.47f9f8","type":"ui_text","z":"e69d9ae9.d86958","group":"be9c39d7.f42578","order":12,"width":3,"height":1,"name":"","label":"Punto Final","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"22","color":"#464080","x":1330,"y":160,"wires":[]},{"id":"1182cb87.33b8a4","type":"ui_text","z":"e69d9ae9.d86958","group":"be9c39d7.f42578","order":16,"width":3,"height":1,"name":"","label":"Temperatura","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#46408a","x":910,"y":200,"wires":[]},{"id":"faf65dc1.bbe65","type":"ui_text","z":"e69d9ae9.d86958","group":"be9c39d7.f42578","order":20,"width":3,"height":1,"name":"","label":"Temperatura","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#46408a","x":1110,"y":200,"wires":[]},{"id":"e76f8f40.453d","type":"ui_text","z":"e69d9ae9.d86958","group":"be9c39d7.f42578","order":18,"width":3,"height":1,"name":"","label":"Temperatura","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#46408a","x":1330,"y":200,"wires":[]},{"id":"14f4141d.249d4c","type":"ui_text_input","z":"e69d9ae9.d86958","name":"text1","label":"","tooltip":"Ingresar en °C","group":"be9c39d7.f42578","order":24,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"val1","sendOnBlur":true,"className":"input_text","topicType":"str","x":890,"y":240,"wires":[["4fe448c4.af75b8"]]},{"id":"4e0e99a6.a16968","type":"ui_text_input","z":"e69d9ae9.d86958","name":"text3","label":"","tooltip":"Ingresar en °C","group":"be9c39d7.f42578","order":26,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"val3","sendOnBlur":true,"className":"input_text","topicType":"msg","x":1090,"y":240,"wires":[["6874e60b.62a418"]]},{"id":"163be880.2c6fa8","type":"ui_text_input","z":"e69d9ae9.d86958","name":"text5","label":"","tooltip":"Ingresar en °C","group":"be9c39d7.f42578","order":28,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"val5","sendOnBlur":true,"className":"input_text","topicType":"msg","x":1310,"y":240,"wires":[["f21a31d4.dd1ca"]]},{"id":"ecf2db81.2c2888","type":"ui_text","z":"e69d9ae9.d86958","group":"be9c39d7.f42578","order":32,"width":3,"height":1,"name":"","label":"Tiempo","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#46408a","x":900,"y":300,"wires":[]},{"id":"f087e4e5.a95428","type":"ui_text","z":"e69d9ae9.d86958","group":"be9c39d7.f42578","order":34,"width":3,"height":1,"name":"","label":"Tiempo","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#46408a","x":1100,"y":300,"wires":[]},{"id":"78bb36ca.235418","type":"ui_text","z":"e69d9ae9.d86958","group":"be9c39d7.f42578","order":36,"width":3,"height":1,"name":"","label":"Peso","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#46408a","x":1310,"y":300,"wires":[]},{"id":"ac1f9248.99e93","type":"ui_text_input","z":"e69d9ae9.d86958","name":"text4","label":"","tooltip":"Ingresar en minutos","group":"be9c39d7.f42578","order":42,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"val4","sendOnBlur":true,"className":"input_text","topicType":"msg","x":1090,"y":340,"wires":[["7cfc04fa.4928fc"]]},{"id":"7cefc151.192f9","type":"ui_text_input","z":"e69d9ae9.d86958","name":"text6","label":"","tooltip":"Ingresar en kilogramos","group":"be9c39d7.f42578","order":44,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"val6","sendOnBlur":true,"className":"input_text","topicType":"msg","x":1310,"y":340,"wires":[["7b010b8a.746e84"]]},{"id":"62cc1765.158c18","type":"ui_text_input","z":"e69d9ae9.d86958","name":"text2","label":"","tooltip":"Ingresar en minutos","group":"be9c39d7.f42578","order":40,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"val2","sendOnBlur":true,"className":"input_text","topicType":"msg","x":890,"y":340,"wires":[["7e70a3b8.bbf0dc"]]},{"id":"89b010dc.25b7a","type":"ui_button","z":"e69d9ae9.d86958","name":"","group":"be9c39d7.f42578","order":46,"width":7,"height":1,"passthru":false,"label":"Torre 1","tooltip":"","color":"{{msg.color}}","bgcolor":"{{msg.bgcolor}}","className":"button1","icon":"","payload":"true","payloadType":"bool","topic":"topic","topicType":"msg","x":980,"y":500,"wires":[["1211bb99.102874","7707b4c9.de0b9c"]]},{"id":"212e94f.bc60e6c","type":"ui_button","z":"e69d9ae9.d86958","name":"","group":"be9c39d7.f42578","order":47,"width":6,"height":1,"passthru":false,"label":"Torre 2","tooltip":"","color":"{{msg.bgcolor}}","bgcolor":"{{msg.color}}","className":"button2","icon":"","payload":"false","payloadType":"bool","topic":"topic","topicType":"msg","x":980,"y":540,"wires":[["a962a215.99b52","7707b4c9.de0b9c"]]},{"id":"4fe448c4.af75b8","type":"change","z":"e69d9ae9.d86958","name":"","rules":[{"t":"set","p":"temp_pre_secado","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1620,"y":140,"wires":[[]]},{"id":"7e70a3b8.bbf0dc","type":"change","z":"e69d9ae9.d86958","name":"","rules":[{"t":"set","p":"time_pre_secado","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1620,"y":180,"wires":[[]]},{"id":"f21a31d4.dd1ca","type":"change","z":"e69d9ae9.d86958","name":"","rules":[{"t":"set","p":"temp_final","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1600,"y":300,"wires":[[]]},{"id":"7b010b8a.746e84","type":"change","z":"e69d9ae9.d86958","name":"","rules":[{"t":"set","p":"time_final","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1600,"y":340,"wires":[[]]},{"id":"6874e60b.62a418","type":"change","z":"e69d9ae9.d86958","name":"","rules":[{"t":"set","p":"temp_oreado","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1610,"y":220,"wires":[[]]},{"id":"7cfc04fa.4928fc","type":"change","z":"e69d9ae9.d86958","name":"","rules":[{"t":"set","p":"time_oreado","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1600,"y":260,"wires":[[]]},{"id":"1211bb99.102874","type":"change","z":"e69d9ae9.d86958","name":"","rules":[{"t":"set","p":"torre","pt":"global","to":"1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1200,"y":500,"wires":[[]]},{"id":"b61a8386.5dfd1","type":"change","z":"e69d9ae9.d86958","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"ON_standard_process_tab\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":560,"y":820,"wires":[["eeecd74c.041b18"]]},{"id":"4c31a54b.34552c","type":"ui_button","z":"e69d9ae9.d86958","name":"","group":"be9c39d7.f42578","order":5,"width":5,"height":1,"passthru":false,"label":"Principal","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":220,"y":220,"wires":[["a9f10d47.6904"]]},{"id":"81303c71.949d9","type":"ui_button","z":"e69d9ae9.d86958","name":"","group":"be9c39d7.f42578","order":6,"width":5,"height":1,"passthru":false,"label":"Graficas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":220,"y":280,"wires":[["60276072.0d242"]]},{"id":"68db0aed.b792a4","type":"ui_button","z":"e69d9ae9.d86958","name":"","group":"be9c39d7.f42578","order":14,"width":5,"height":1,"passthru":false,"label":"Recetas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":220,"y":340,"wires":[["4af850f1.fa451"]]},{"id":"870c5475.859808","type":"ui_button","z":"e69d9ae9.d86958","name":"","group":"be9c39d7.f42578","order":30,"width":5,"height":1,"passthru":false,"label":"Configuración","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":240,"y":460,"wires":[["6ab152b1.45c88c"]]},{"id":"a6c25e34.f14ce","type":"ui_media","z":"e69d9ae9.d86958","group":"be9c39d7.f42578","name":"logo_penagos","width":5,"height":2,"order":1,"category":"logos","file":"logo_penagos.png","layout":"center","showcontrols":true,"loop":true,"onstart":false,"scope":"local","tooltip":"","x":240,"y":100,"wires":[[]]},{"id":"edb530e1.fd32b","type":"ui_media","z":"e69d9ae9.d86958","group":"be9c39d7.f42578","name":"logo_aciv","width":5,"height":2,"order":48,"category":"logo_aciv","file":"logo_aciv.png","layout":"center","showcontrols":true,"loop":true,"onstart":false,"scope":"local","tooltip":"","x":220,"y":520,"wires":[[]]},{"id":"72a88c74.4ce5b4","type":"ui_button","z":"e69d9ae9.d86958","name":"","group":"be9c39d7.f42578","order":38,"width":5,"height":2,"passthru":false,"label":"Parada de emergencia","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":260,"y":580,"wires":[["35f21ae4.e6fc36"]]},{"id":"c21135f0.270568","type":"ui_text","z":"1d0b3b5c.03ac95","group":"c34a93b.47fb57","order":3,"width":6,"height":1,"name":"","label":"Usuario","format":"{{msg.payload}}","layout":"row-center","className":"text-purple","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#46408a","x":1200,"y":220,"wires":[]},{"id":"4b85991.3922268","type":"ui_text","z":"1d0b3b5c.03ac95","group":"c34a93b.47fb57","order":4,"width":6,"height":1,"name":"Role","label":"","format":"{{msg.payload}}","layout":"row-center","className":"text-blue","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#00abe5","x":1870,"y":220,"wires":[]},{"id":"8c786896.165708","type":"ui_media","z":"1d0b3b5c.03ac95","group":"c34a93b.47fb57","name":"logo_inicio","width":13,"height":8,"order":5,"category":"logo_inicio","file":"logo_inicio2.png","layout":"center","showcontrols":true,"loop":true,"onstart":false,"scope":"local","tooltip":"","x":1470,"y":360,"wires":[[]]},{"id":"b346308.dcf81d","type":"ui_button","z":"1d0b3b5c.03ac95","name":"","group":"c34a93b.47fb57","order":13,"width":7,"height":2,"passthru":false,"label":"Proceso Estándar","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":1210,"y":460,"wires":[["ac8e9842.1a7c08","f89b85ec.870248"]]},{"id":"87593800.a38728","type":"ui_button","z":"1d0b3b5c.03ac95","name":"","group":"c34a93b.47fb57","order":14,"width":6,"height":2,"passthru":false,"label":"Definido por el usuario","tooltip":"","color":"","bgcolor":"#46408A","className":"left_menu_button_purple","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":1780,"y":480,"wires":[["68502476.60fdcc"]]},{"id":"ac8e9842.1a7c08","type":"change","z":"1d0b3b5c.03ac95","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"Standard_process_tab\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":1200,"y":520,"wires":[["fe3a33ab.dcd22"]]},{"id":"fe3a33ab.dcd22","type":"ui_ui_control","z":"1d0b3b5c.03ac95","name":"","events":"all","x":1200,"y":580,"wires":[[]]},{"id":"68502476.60fdcc","type":"change","z":"1d0b3b5c.03ac95","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"Personalized_process_tab\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":1770,"y":540,"wires":[["e4ce44e5.6361d8"]]},{"id":"e4ce44e5.6361d8","type":"ui_ui_control","z":"1d0b3b5c.03ac95","name":"","events":"all","x":1770,"y":600,"wires":[[]]},{"id":"1294e93d.030ac7","type":"ui_button","z":"1d0b3b5c.03ac95","name":"","group":"c34a93b.47fb57","order":6,"width":5,"height":1,"passthru":false,"label":"Principal","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":340,"y":280,"wires":[["26d0d9b7.7c13e6"]]},{"id":"e8c5e03d.55a7b","type":"ui_button","z":"1d0b3b5c.03ac95","name":"","group":"c34a93b.47fb57","order":7,"width":5,"height":1,"passthru":false,"label":"Graficas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":340,"y":360,"wires":[["b85c7e03.e66dd"]]},{"id":"fce75ec.2e357a","type":"ui_button","z":"1d0b3b5c.03ac95","name":"","group":"c34a93b.47fb57","order":8,"width":5,"height":1,"passthru":false,"label":"Recetas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":340,"y":480,"wires":[["7bc8ecdc.52f344"]]},{"id":"b3a8bd9.57a084","type":"ui_button","z":"1d0b3b5c.03ac95","name":"","group":"c34a93b.47fb57","order":10,"width":5,"height":1,"passthru":false,"label":"Configuración","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":360,"y":700,"wires":[["b9a33bbe.0fb0a8"]]},{"id":"616d88dc.a40a88","type":"ui_media","z":"1d0b3b5c.03ac95","group":"c34a93b.47fb57","name":"logo_penagos","width":5,"height":2,"order":1,"category":"logos","file":"logo_penagos.png","layout":"center","showcontrols":true,"loop":true,"onstart":false,"scope":"local","tooltip":"","x":360,"y":160,"wires":[[]]},{"id":"172ce23.2139c1e","type":"ui_media","z":"1d0b3b5c.03ac95","group":"c34a93b.47fb57","name":"logo_aciv","width":5,"height":2,"order":12,"category":"logo_aciv","file":"logo_aciv.png","layout":"center","showcontrols":true,"loop":true,"onstart":false,"scope":"local","tooltip":"","x":340,"y":900,"wires":[[]]},{"id":"e208f904.4d16e8","type":"ui_button","z":"1d0b3b5c.03ac95","name":"","group":"c34a93b.47fb57","order":11,"width":5,"height":2,"passthru":false,"label":"Parada de emergencia","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":380,"y":800,"wires":[["c5d10038.d6d92","a6084bff.c423c8"]]},{"id":"f72d1663.e69fd8","type":"ui_button","z":"934099b7.c96bb8","name":"","group":"cca89ca3.f14d7","order":8,"width":5,"height":1,"passthru":false,"label":"Principal","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":280,"y":360,"wires":[["95d44688.a48288"]]},{"id":"bda7e00b.92749","type":"ui_button","z":"934099b7.c96bb8","name":"","group":"cca89ca3.f14d7","order":9,"width":5,"height":1,"passthru":false,"label":"Graficas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":280,"y":420,"wires":[["819f2115.a48c7"]]},{"id":"ba3a07e1.a76fb8","type":"ui_button","z":"934099b7.c96bb8","name":"","group":"cca89ca3.f14d7","order":11,"width":5,"height":1,"passthru":false,"label":"Recetas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":280,"y":480,"wires":[["529e3ce.f495bc4"]]},{"id":"59077cbd.dc29e4","type":"ui_button","z":"934099b7.c96bb8","name":"","group":"cca89ca3.f14d7","order":15,"width":5,"height":1,"passthru":false,"label":"Configuración","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":300,"y":600,"wires":[["c75434eb.e70498"]]},{"id":"e4d0463d.721498","type":"ui_media","z":"934099b7.c96bb8","group":"cca89ca3.f14d7","name":"logo_aciv","width":5,"height":2,"order":23,"category":"logo_aciv","file":"logo_aciv.png","layout":"center","showcontrols":true,"loop":true,"onstart":false,"scope":"local","tooltip":"","x":280,"y":660,"wires":[[]]},{"id":"752ce723.675f98","type":"ui_button","z":"934099b7.c96bb8","name":"","group":"cca89ca3.f14d7","order":18,"width":5,"height":2,"passthru":false,"label":"Parada de emergencia","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":320,"y":720,"wires":[["b0bdd605.06c9f8"]]},{"id":"929547.f8356ab8","type":"ui_media","z":"934099b7.c96bb8","group":"cca89ca3.f14d7","name":"logo_penagos","width":5,"height":2,"order":1,"category":"logos","file":"logo_penagos.png","layout":"center","showcontrols":true,"loop":true,"onstart":false,"scope":"local","tooltip":"","x":300,"y":240,"wires":[[]]},{"id":"cdf9e155.24fb1","type":"ui_text","z":"934099b7.c96bb8","group":"cca89ca3.f14d7","order":7,"width":13,"height":2,"name":"","label":"Proceso estándar","format":"Ventana de operación","layout":"col-center","className":"Label_proceso_estandar","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"30","color":"#b0b6bd","x":1250,"y":240,"wires":[]},{"id":"788d116d.5b37b","type":"ui_text","z":"934099b7.c96bb8","group":"cca89ca3.f14d7","order":5,"width":7,"height":1,"name":"","label":"Sub-proceso actual: ","format":"{{msg.payload}}","layout":"row-left","className":"subprocesos","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#00abe5","x":1980,"y":80,"wires":[]},{"id":"90a341bf.15378","type":"ui_text","z":"934099b7.c96bb8","group":"cca89ca3.f14d7","order":24,"width":6,"height":1,"name":"","label":"Peso","format":"{{msg.payload}}","layout":"col-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#00abe5","x":1090,"y":640,"wires":[]},{"id":"9008a0bf.3dc68","type":"ui_text","z":"934099b7.c96bb8","group":"cca89ca3.f14d7","order":13,"width":6,"height":1,"name":"","label":"Temperatura de la masa","format":"{{msg.payload}}","layout":"col-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#00abe5","x":1110,"y":360,"wires":[]},{"id":"c44d70.e1cbb29","type":"ui_text","z":"934099b7.c96bb8","group":"cca89ca3.f14d7","order":14,"width":7,"height":1,"name":"","label":"Temperatura de la resistencia","format":"{{msg.payload}}","layout":"col-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#00abe5","x":1650,"y":360,"wires":[]},{"id":"e730bd7.d26554","type":"ui_text","z":"934099b7.c96bb8","group":"cca89ca3.f14d7","order":19,"width":6,"height":1,"name":"","label":"Humedad del cafe","format":"{{msg.payload}}","layout":"col-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#00abe5","x":1110,"y":500,"wires":[]},{"id":"77493db3.382914","type":"ui_text","z":"934099b7.c96bb8","group":"cca89ca3.f14d7","order":25,"width":7,"height":1,"name":"","label":"Humedad exterior","format":"{{msg.payload}}","layout":"col-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#00abe5","x":1610,"y":640,"wires":[]},{"id":"6b58aa5d.3da594","type":"ui_text","z":"934099b7.c96bb8","group":"cca89ca3.f14d7","order":20,"width":7,"height":1,"name":"","label":"Humedad de la resistencia","format":"{{msg.payload}}","layout":"col-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#00abe5","x":1640,"y":500,"wires":[]},{"id":"b85c7e03.e66dd","type":"change","z":"1d0b3b5c.03ac95","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"Graphics_tab\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":580,"y":360,"wires":[["cb0a2ff3.f9a58"]]},{"id":"cb0a2ff3.f9a58","type":"ui_ui_control","z":"1d0b3b5c.03ac95","name":"","events":"all","x":760,"y":360,"wires":[[]]},{"id":"fe812913.de8988","type":"ui_button","z":"804acb1a.0445f8","name":"","group":"73d41b87.143354","order":10,"width":5,"height":1,"passthru":false,"label":"Principal","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":240,"y":320,"wires":[["74dd129c.fddd3c"]]},{"id":"146771b2.478c7e","type":"ui_button","z":"804acb1a.0445f8","name":"","group":"73d41b87.143354","order":12,"width":5,"height":1,"passthru":false,"label":"Graficas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":240,"y":380,"wires":[["3c2cab71.e64254"]]},{"id":"da6b8a61.40e3d8","type":"ui_button","z":"804acb1a.0445f8","name":"","group":"73d41b87.143354","order":14,"width":5,"height":1,"passthru":false,"label":"Recetas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":240,"y":440,"wires":[["37cc59a4.8c53e6"]]},{"id":"2df3cbc8.d0ba74","type":"ui_button","z":"804acb1a.0445f8","name":"","group":"73d41b87.143354","order":18,"width":5,"height":1,"passthru":false,"label":"Configuración","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":260,"y":560,"wires":[["c0da2056.20b2b"]]},{"id":"45efead6.3d4ae4","type":"ui_media","z":"804acb1a.0445f8","group":"73d41b87.143354","name":"logo_penagos","width":5,"height":2,"order":1,"category":"logos","file":"logo_penagos.png","layout":"center","showcontrols":true,"loop":true,"onstart":false,"scope":"local","tooltip":"","x":260,"y":200,"wires":[[]]},{"id":"2ba6bed9.fe1212","type":"ui_media","z":"804acb1a.0445f8","group":"73d41b87.143354","name":"logo_aciv","width":5,"height":2,"order":25,"category":"logo_aciv","file":"logo_aciv.png","layout":"center","showcontrols":true,"loop":true,"onstart":false,"scope":"local","tooltip":"","x":240,"y":620,"wires":[[]]},{"id":"cc7dbd44.9d3f","type":"ui_button","z":"804acb1a.0445f8","name":"","group":"73d41b87.143354","order":22,"width":5,"height":2,"passthru":false,"label":"Parada de emergencia","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":280,"y":680,"wires":[["6699cef0.823b8"]]},{"id":"6dea9b98.9629c4","type":"file","z":"804acb1a.0445f8","name":"CSV sensor_temp1","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"false","encoding":"none","x":1050,"y":1120,"wires":[[]]},{"id":"c0cd1df1.20e79","type":"link in","z":"804acb1a.0445f8","name":"","links":["e3738fb3.afef3"],"x":215,"y":1120,"wires":[["b19161a7.aa06d"]]},{"id":"b19161a7.aa06d","type":"function","z":"804acb1a.0445f8","name":"Formato de CSV y de filename","func":"var filename = global.get('filename') || 'No value';\nfilename = filename.slice(0, -4) + \"_temp1.csv\";\nlet value =  msg.payload;\nlet timestamp = new Date().toISOString();\n\nvar csvLine = value + \", \" + timestamp + \"\\n\";\n\nmsg.filename = filename\n// msg.payload = csvLine;\n\nmsg.payload = {\n    value: msg.payload,\n    timestamp: new Date().toISOString(),\n};\n\n\n//Que solo guarde cuando este running en true\nvar running = global.get('running') || false;\n\nif (running === true) {\n    return msg;\n} else {\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":490,"y":1120,"wires":[["646239fa.5dcab8","dbdaf0c9.59cee"]]},{"id":"d266633b.688fe","type":"link out","z":"47a745ac.9f83dc","name":"sensor_hum1","links":["3f3d1786.c1afc8","6dce3167.1bc51","a83ef322.ae1ca"],"x":495,"y":380,"wires":[]},{"id":"72eabf75.d7acb","type":"inject","z":"804acb1a.0445f8","name":"Delete","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":250,"y":1240,"wires":[["856846eb.d99558"]]},{"id":"856846eb.d99558","type":"file","z":"804acb1a.0445f8","name":"Borrar ingresando el nombre","filename":"Estandar_20241001_101134_temp1.csv","appendNewline":true,"createDir":true,"overwriteFile":"delete","encoding":"none","x":480,"y":1240,"wires":[[]]},{"id":"6dce3167.1bc51","type":"link in","z":"804acb1a.0445f8","name":"","links":["d266633b.688fe"],"x":215,"y":1560,"wires":[["bfdd19b5.1c4158"]]},{"id":"957b3991.830058","type":"link in","z":"804acb1a.0445f8","name":"","links":["6a896d49.894054"],"x":1415,"y":1540,"wires":[["29463ec7.cad192"]]},{"id":"5f4c7329.47f1dc","type":"link in","z":"804acb1a.0445f8","name":"","links":["8c1ecafb.80b068"],"x":215,"y":1840,"wires":[["baf0b603.be3d48"]]},{"id":"6a896d49.894054","type":"link out","z":"47a745ac.9f83dc","name":"sensor_hum2","links":["957b3991.830058","a11a027f.e5bff","9005f08b.79644"],"x":1155,"y":380,"wires":[]},{"id":"8c1ecafb.80b068","type":"link out","z":"47a745ac.9f83dc","name":"sensor_weight1","links":["5f4c7329.47f1dc","cfed962.95a1e68","b1246c14.b7929"],"x":495,"y":520,"wires":[]},{"id":"f0b88114.e840a","type":"ui_dropdown","z":"804acb1a.0445f8","name":"","label":"","tooltip":"","place":"Gráfica 1","group":"73d41b87.143354","order":2,"width":3,"height":1,"passthru":true,"multiple":false,"options":[{"label":"Temperatura torre 1","value":"temp1","type":"str"},{"label":"Temperatura torre 2","value":"temp2","type":"str"},{"label":"Temperatura resistencia","value":"tempr","type":"str"},{"label":"Humedad torre 1","value":"hum1","type":"str"},{"label":"Humedad torre 2","value":"hum2","type":"str"},{"label":"Humedad resistencia","value":"humr","type":"str"},{"label":"Humedad exterior","value":"humext","type":"str"},{"label":"Peso torre 1","value":"weight1","type":"str"},{"label":"Peso torre 2","value":"weight2","type":"str"}],"payload":"","topic":"","topicType":"str","className":"","x":1440,"y":60,"wires":[["12c2652e.d7922b"]]},{"id":"ca668633.1e1678","type":"file in","z":"804acb1a.0445f8","name":"Read CSV","filename":"","format":"utf8","chunk":false,"sendError":true,"encoding":"none","x":1410,"y":320,"wires":[["93e73c03.7525b"]]},{"id":"19e55647.5cb31a","type":"change","z":"804acb1a.0445f8","name":"Set filename","rules":[{"t":"set","p":"filename","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1430,"y":200,"wires":[["88f0999a.d77ff8"]]},{"id":"871bf682.e34d48","type":"csv","z":"804acb1a.0445f8","name":"Convertir a CSV","sep":",","hdrin":false,"hdrout":"none","multi":"one","ret":"\\n","temp":"value,timestamp","skip":"0","strings":true,"include_empty_strings":false,"include_null_values":false,"x":2000,"y":1140,"wires":[["20ab1572.76704a"]]},{"id":"2cf1d136.c5b00e","type":"link in","z":"804acb1a.0445f8","name":"","links":["bbe0478.68769b8"],"x":1415,"y":1140,"wires":[["8b84afa5.6fb59"]]},{"id":"51820a13.915d44","type":"link in","z":"804acb1a.0445f8","name":"","links":["efdade98.7bb17"],"x":835,"y":2500,"wires":[["f7588c78.af7e2"]]},{"id":"ff96b86.3b2b448","type":"link in","z":"804acb1a.0445f8","name":"","links":["b267761b.e2e728"],"x":835,"y":2760,"wires":[["236fbf82.5e9b"]]},{"id":"41de1196.2c3a3","type":"link in","z":"804acb1a.0445f8","name":"","links":["77e315b7.8812cc"],"x":1415,"y":1840,"wires":[["a136635b.6d859"]]},{"id":"bbe0478.68769b8","type":"link out","z":"47a745ac.9f83dc","name":"sensor_temp2","links":["2cf1d136.c5b00e","47fd1dc3.7b9804","8702ba03.23dab8"],"x":1155,"y":220,"wires":[]},{"id":"efdade98.7bb17","type":"link out","z":"47a745ac.9f83dc","name":"sensor_humr","links":["51820a13.915d44","f286517f.120b3","d75b17dc.913988"],"x":835,"y":960,"wires":[]},{"id":"b267761b.e2e728","type":"link out","z":"47a745ac.9f83dc","name":"sensor_humext","links":["a9dd0ae7.e63b18","ff96b86.3b2b448","66e4e11e.11f96"],"x":835,"y":1200,"wires":[]},{"id":"97660e1.cd3bbf","type":"inject","z":"47a745ac.9f83dc","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"15","crontab":"","once":true,"onceDelay":"1","topic":"","payload":"","payloadType":"date","x":510,"y":680,"wires":[["dd32a6a8.f60178"]]},{"id":"dd32a6a8.f60178","type":"function","z":"47a745ac.9f83dc","name":"tempr","func":"let t = context.get('time') || 0;\nlet maxTemperature = 90;\nlet baseTemperature = 28 + (maxTemperature - 20) * Math.sin(t / 100 * Math.PI);\n\n// Agregar una variación aleatoria pequeña\nlet randomVariation = (Math.random() * 20) - 2;  // Variación aleatoria entre -2 y 2 grados\nlet temperature = baseTemperature + randomVariation;\n\n// Limitar la temperatura a un máximo de 90\nif (temperature > maxTemperature) {\n    temperature = maxTemperature;\n}\n\nmsg.payload = temperature.toFixed(2);\ncontext.set('time', t + 1);\nreturn msg;\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":690,"y":680,"wires":[["b3bf2cd0.4341f","19b34ae0.3285a5"]]},{"id":"b3bf2cd0.4341f","type":"debug","z":"47a745ac.9f83dc","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":890,"y":680,"wires":[]},{"id":"c5aa4156.8a4e7","type":"inject","z":"47a745ac.9f83dc","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":500,"y":640,"wires":[["dd32a6a8.f60178"]]},{"id":"19b34ae0.3285a5","type":"link out","z":"47a745ac.9f83dc","name":"sensor_tempr","links":["13605ea8.3a0d01","669fb8a2.a49d28","597c9611.68d6f8"],"x":835,"y":720,"wires":[]},{"id":"669fb8a2.a49d28","type":"link in","z":"804acb1a.0445f8","name":"","links":["19b34ae0.3285a5"],"x":835,"y":2240,"wires":[["1db130e5.99bc3f"]]},{"id":"e8c3c2b.9c99e4","type":"inject","z":"47a745ac.9f83dc","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"15","crontab":"","once":true,"onceDelay":"1","topic":"","payload":"","payloadType":"date","x":170,"y":180,"wires":[["61dee02e.6e8d4"]]},{"id":"61dee02e.6e8d4","type":"function","z":"47a745ac.9f83dc","name":"temp1","func":"let t = context.get('time') || 0;\nlet maxTemperature = 90;\nlet baseTemperature = 28 + (maxTemperature - 20) * Math.sin(t / 100 * Math.PI);\n\n// Agregar una variación aleatoria pequeña\nlet randomVariation = (Math.random() * 4) - 2;  // Variación aleatoria entre -2 y 2 grados\nlet temperature = baseTemperature + randomVariation;\n\n// Limitar la temperatura a un máximo de 90\nif (temperature > maxTemperature) {\n    temperature = maxTemperature;\n}\n\nmsg.payload = temperature.toFixed(2);\ncontext.set('time', t + 1);\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":350,"y":180,"wires":[["fab67f2b.ce72b","e3738fb3.afef3"]]},{"id":"fab67f2b.ce72b","type":"debug","z":"47a745ac.9f83dc","name":"temp1_sim","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":550,"y":180,"wires":[]},{"id":"492a54d3.3493cc","type":"inject","z":"47a745ac.9f83dc","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":160,"y":120,"wires":[["61dee02e.6e8d4"]]},{"id":"e3738fb3.afef3","type":"link out","z":"47a745ac.9f83dc","name":"sensor_temp1","links":["723928b2.cf2b18","c0cd1df1.20e79","33d74419.6a823c"],"x":495,"y":220,"wires":[]},{"id":"70935705.89fbe8","type":"ui_chart","z":"804acb1a.0445f8","name":"Dropdown1","group":"73d41b87.143354","order":7,"width":6,"height":5,"label":"{{msg.label}}","chartType":"line","legend":"false","xformat":"HH:mm","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"86400","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd"],"outputs":1,"useDifferentColor":false,"className":"","x":1410,"y":460,"wires":[[]]},{"id":"abaeac59.89825","type":"comment","z":"804acb1a.0445f8","name":"Temp1","info":"","x":250,"y":1080,"wires":[]},{"id":"f97a9b56.cdfaa8","type":"comment","z":"804acb1a.0445f8","name":"Hum1","info":"","x":250,"y":1520,"wires":[]},{"id":"46172db1.399874","type":"comment","z":"804acb1a.0445f8","name":"Hum2","info":"","x":1450,"y":1500,"wires":[]},{"id":"6ef4f7ac.289598","type":"comment","z":"804acb1a.0445f8","name":"Weight1","info":"","x":260,"y":1800,"wires":[]},{"id":"7f0a5f29.4a623","type":"function","z":"804acb1a.0445f8","name":"Procesar CSV","func":"let lines = msg.payload.split('\\n');\nlet data = [];\n\nlines.forEach(line => {\n    let parts = line.split(',');\n    if(parts.length === 2) {\n        let value = parseFloat(parts[0]);\n        let timestamp = new Date(parts[1]).getTime();\n        data.push({x: timestamp, y: value});\n    }\n});\n\nmsg.payload = [{\n    \"series\": [\"Sensor\"],\n    \"data\": [data],\n    \"labels\": data.map(d => new Date(d.x).toLocaleTimeString())\n}];\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1420,"y":880,"wires":[["997335a9.bc35e8"]]},{"id":"fe05b14d.69136","type":"ui_dropdown","z":"804acb1a.0445f8","name":"","label":"","tooltip":"","place":"Gráfica 3","group":"73d41b87.143354","order":3,"width":3,"height":1,"passthru":true,"multiple":false,"options":[{"label":"Temperatura torre 1","value":"temp1","type":"str"},{"label":"Temperatura torre 2","value":"temp2","type":"str"},{"label":"Temperatura resistencia","value":"tempr","type":"str"},{"label":"Humedad torre 1","value":"hum1","type":"str"},{"label":"Humedad torre 2","value":"hum2","type":"str"},{"label":"Humedad resistencia","value":"humr","type":"str"},{"label":"Humedad exterior","value":"humext","type":"str"},{"label":"Peso torre 1","value":"weight1","type":"str"},{"label":"Peso torre 2","value":"weight2","type":"str"}],"payload":"","topic":"","topicType":"str","className":"","x":1400,"y":580,"wires":[["fbb68d89.9f53f"]]},{"id":"2464d54b.b2924a","type":"file in","z":"804acb1a.0445f8","name":"Read CSV","filename":"","format":"utf8","chunk":false,"sendError":true,"encoding":"none","x":1510,"y":820,"wires":[["7f0a5f29.4a623"]]},{"id":"997335a9.bc35e8","type":"ui_chart","z":"804acb1a.0445f8","name":"Dropdown3","group":"73d41b87.143354","order":19,"width":6,"height":5,"label":"{{msg.label}}","chartType":"line","legend":"false","xformat":"HH:mm","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"86400","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd"],"outputs":1,"useDifferentColor":false,"className":"","x":1410,"y":940,"wires":[[]]},{"id":"16138136.46a8df","type":"function","z":"804acb1a.0445f8","name":"Nombre grafica","func":"sensor = msg.filename\n\n// Remover \"sensor_\" del inicio\nsensor = sensor.replace(\"sensor_\", \"\");\n\n// Remover \".csv\" del final\nsensor = sensor.replace(\".csv\", \"\");\n\n// Agregar \" vs tiempo\"\nsensor += \" vs tiempo\";\n\nmsg.sensor = sensor\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1280,"y":820,"wires":[["2464d54b.b2924a"]]},{"id":"660303d3.61deec","type":"inject","z":"804acb1a.0445f8","name":"","props":[{"p":"payload"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":1240,"y":580,"wires":[["fe05b14d.69136"]]},{"id":"19ecf9cf.902c66","type":"function","z":"804acb1a.0445f8","name":"Procesar CSV","func":"let lines = msg.payload.split('\\n');\nlet data = [];\n\nlines.forEach(line => {\n    let parts = line.split(',');\n    if(parts.length === 2) {\n        let value = parseFloat(parts[0]);\n        let timestamp = new Date(parts[1]).getTime();\n        data.push({x: timestamp, y: value});\n    }\n});\n\nmsg.payload = [{\n    \"series\": [\"Sensor\"],\n    \"data\": [data],\n    \"labels\": data.map(d => new Date(d.x).toLocaleTimeString())\n}];\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2240,"y":860,"wires":[["30141a64.76c1b6"]]},{"id":"df2ebcbd.11e95","type":"ui_dropdown","z":"804acb1a.0445f8","name":"","label":"","tooltip":"","place":"Gráfica 4","group":"73d41b87.143354","order":6,"width":3,"height":1,"passthru":true,"multiple":false,"options":[{"label":"Temperatura torre 1","value":"temp1","type":"str"},{"label":"Temperatura torre 2","value":"temp2","type":"str"},{"label":"Temperatura resistencia","value":"tempr","type":"str"},{"label":"Humedad torre 1","value":"hum1","type":"str"},{"label":"Humedad torre 2","value":"hum2","type":"str"},{"label":"Humedad resistencia","value":"humr","type":"str"},{"label":"Humedad exterior","value":"humext","type":"str"},{"label":"Peso torre 1","value":"weight1","type":"str"},{"label":"Peso torre 2","value":"weight2","type":"str"}],"payload":"","topic":"","topicType":"str","className":"","x":2220,"y":560,"wires":[["a5fb46eb.938bc8"]]},{"id":"d3fbb82a.9f4058","type":"file in","z":"804acb1a.0445f8","name":"Read CSV","filename":"","format":"utf8","chunk":false,"sendError":true,"encoding":"none","x":2330,"y":800,"wires":[["19ecf9cf.902c66"]]},{"id":"f5f755f2.4eb718","type":"change","z":"804acb1a.0445f8","name":"Set filename","rules":[{"t":"set","p":"filename","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2230,"y":680,"wires":[["e8933115.ba8e1"]]},{"id":"30141a64.76c1b6","type":"ui_chart","z":"804acb1a.0445f8","name":"Dropdown4","group":"73d41b87.143354","order":21,"width":6,"height":5,"label":"{{msg.label}}","chartType":"line","legend":"false","xformat":"HH:mm","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"86400","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd"],"outputs":1,"useDifferentColor":false,"className":"","x":2230,"y":920,"wires":[[]]},{"id":"6644d945.5ac458","type":"function","z":"804acb1a.0445f8","name":"Nombre grafica","func":"sensor = msg.filename\n\n// Remover \"sensor_\" del inicio\nsensor = sensor.replace(\"sensor_\", \"\");\n\n// Remover \".csv\" del final\nsensor = sensor.replace(\".csv\", \"\");\n\n// Agregar \" vs tiempo\"\nsensor += \" vs tiempo\";\n\nmsg.sensor = sensor\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2100,"y":800,"wires":[["d3fbb82a.9f4058"]]},{"id":"220c98e9.96d558","type":"inject","z":"804acb1a.0445f8","name":"","props":[{"p":"payload"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":2070,"y":560,"wires":[["df2ebcbd.11e95"]]},{"id":"d30f012f.31968","type":"comment","z":"804acb1a.0445f8","name":"Temp2","info":"","x":1450,"y":1080,"wires":[]},{"id":"1fd5cabc.6acc25","type":"comment","z":"804acb1a.0445f8","name":"Tempr","info":"","x":870,"y":2180,"wires":[]},{"id":"65d89142.da9d5","type":"comment","z":"804acb1a.0445f8","name":"Humr","info":"","x":870,"y":2460,"wires":[]},{"id":"155e197d.ef2af7","type":"comment","z":"804acb1a.0445f8","name":"Humext","info":"","x":870,"y":2720,"wires":[]},{"id":"65596454.254f6c","type":"comment","z":"804acb1a.0445f8","name":"Weight2","info":"","x":1460,"y":1780,"wires":[]},{"id":"9dc40ecd.fae8b","type":"ui_button","z":"cf6e4dbe.06b5d","name":"","group":"5da4ffa9.3ed6c","order":12,"width":5,"height":1,"passthru":false,"label":"Principal","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":80,"y":160,"wires":[["d49f745c.c2db28"]]},{"id":"d35ab2f0.2c367","type":"ui_button","z":"cf6e4dbe.06b5d","name":"","group":"5da4ffa9.3ed6c","order":18,"width":5,"height":1,"passthru":false,"label":"Graficas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":80,"y":220,"wires":[["5788e238.1d011c"]]},{"id":"8a53458a.116a58","type":"ui_button","z":"cf6e4dbe.06b5d","name":"","group":"5da4ffa9.3ed6c","order":24,"width":5,"height":1,"passthru":false,"label":"Recetas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":80,"y":280,"wires":[["97a4b076.4fce7"]]},{"id":"c3905535.6f8d88","type":"ui_button","z":"cf6e4dbe.06b5d","name":"","group":"5da4ffa9.3ed6c","order":35,"width":5,"height":1,"passthru":false,"label":"Configuración","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":100,"y":420,"wires":[["e7a9ec60.72339"]]},{"id":"32baa2eb.1788ae","type":"ui_media","z":"cf6e4dbe.06b5d","group":"5da4ffa9.3ed6c","name":"logo_penagos","width":5,"height":2,"order":1,"category":"logos","file":"logo_penagos.png","layout":"center","showcontrols":true,"loop":true,"onstart":false,"scope":"local","tooltip":"","x":100,"y":40,"wires":[[]]},{"id":"5ab5b1d8.a6c64","type":"ui_media","z":"cf6e4dbe.06b5d","group":"5da4ffa9.3ed6c","name":"logo_aciv","width":5,"height":2,"order":50,"category":"logo_aciv","file":"logo_aciv.png","layout":"center","showcontrols":true,"loop":true,"onstart":false,"scope":"local","tooltip":"","x":80,"y":480,"wires":[[]]},{"id":"a0610591.3be458","type":"ui_button","z":"cf6e4dbe.06b5d","name":"","group":"5da4ffa9.3ed6c","order":40,"width":5,"height":2,"passthru":false,"label":"Parada de emergencia","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":120,"y":540,"wires":[["8b518f64.d8c24"]]},{"id":"d49f745c.c2db28","type":"change","z":"cf6e4dbe.06b5d","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"Start_tab\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":160,"wires":[["c9f81b7a.42a9d8"]]},{"id":"c9f81b7a.42a9d8","type":"ui_ui_control","z":"cf6e4dbe.06b5d","name":"","events":"all","x":260,"y":120,"wires":[[]]},{"id":"aac8a70e.5b60c8","type":"ui_text","z":"cf6e4dbe.06b5d","group":"5da4ffa9.3ed6c","order":2,"width":1,"height":1,"name":"","label":"#","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":510,"y":60,"wires":[]},{"id":"3e671d10.e93bb2","type":"ui_button","z":"cf6e4dbe.06b5d","name":"","group":"5da4ffa9.3ed6c","order":29,"width":3,"height":3,"passthru":false,"label":"Recetas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":2200,"y":280,"wires":[["88ee6229.f3ff"]]},{"id":"a6f32447.07de48","type":"ui_text","z":"cf6e4dbe.06b5d","group":"5da4ffa9.3ed6c","order":7,"width":1,"height":1,"name":"","label":"1","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":510,"y":100,"wires":[]},{"id":"84146732.d834b8","type":"ui_text","z":"cf6e4dbe.06b5d","group":"5da4ffa9.3ed6c","order":13,"width":1,"height":1,"name":"","label":"2","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":510,"y":140,"wires":[]},{"id":"9c001b7e.329298","type":"ui_text","z":"cf6e4dbe.06b5d","group":"5da4ffa9.3ed6c","order":19,"width":1,"height":1,"name":"","label":"3","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":510,"y":180,"wires":[]},{"id":"2cf6866a.98f58a","type":"ui_text","z":"cf6e4dbe.06b5d","group":"5da4ffa9.3ed6c","order":25,"width":1,"height":1,"name":"","label":"4","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":510,"y":220,"wires":[]},{"id":"46b2b3ed.423a5c","type":"ui_text","z":"cf6e4dbe.06b5d","group":"5da4ffa9.3ed6c","order":31,"width":1,"height":1,"name":"","label":"5","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":510,"y":260,"wires":[]},{"id":"921b7bf1.2cdb08","type":"ui_text","z":"cf6e4dbe.06b5d","group":"5da4ffa9.3ed6c","order":36,"width":1,"height":1,"name":"","label":"6","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":510,"y":300,"wires":[]},{"id":"36ed1bc5.528634","type":"ui_text","z":"cf6e4dbe.06b5d","group":"5da4ffa9.3ed6c","order":41,"width":1,"height":1,"name":"","label":"7","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":510,"y":340,"wires":[]},{"id":"1c13c372.afce9d","type":"ui_text","z":"cf6e4dbe.06b5d","group":"5da4ffa9.3ed6c","order":46,"width":1,"height":1,"name":"","label":"8","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":510,"y":380,"wires":[]},{"id":"12b98e71.7bcde2","type":"ui_text","z":"cf6e4dbe.06b5d","group":"5da4ffa9.3ed6c","order":51,"width":1,"height":1,"name":"","label":"9","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":510,"y":420,"wires":[]},{"id":"30658132.44bffe","type":"ui_text","z":"cf6e4dbe.06b5d","group":"5da4ffa9.3ed6c","order":3,"width":3,"height":1,"name":"","label":"Temperatura","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":690,"y":60,"wires":[]},{"id":"1e38f36.4dfa30d","type":"ui_text_input","z":"cf6e4dbe.06b5d","name":"1temp","label":"","tooltip":"Ingresar en °C","group":"5da4ffa9.3ed6c","order":8,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"1temp","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":670,"y":100,"wires":[["9b95ad7f.3a98d"]]},{"id":"e70cfbf.ac26308","type":"ui_text_input","z":"cf6e4dbe.06b5d","name":"2temp","label":"","tooltip":"Ingresar en °C","group":"5da4ffa9.3ed6c","order":14,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"2temp","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":670,"y":140,"wires":[["75fa7036.a26db"]]},{"id":"c37907cb.df1ec8","type":"ui_text_input","z":"cf6e4dbe.06b5d","name":"3temp","label":"","tooltip":"Ingresar en °C","group":"5da4ffa9.3ed6c","order":20,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"3temp","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":670,"y":180,"wires":[["38cadfae.1220b"]]},{"id":"c5107e10.6e912","type":"ui_text_input","z":"cf6e4dbe.06b5d","name":"4temp","label":"","tooltip":"Ingresar en °C","group":"5da4ffa9.3ed6c","order":26,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"4temp","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":670,"y":220,"wires":[["7a41106f.68f1b"]]},{"id":"dab799b9.e30f28","type":"ui_text_input","z":"cf6e4dbe.06b5d","name":"5temp","label":"","tooltip":"Ingresar en °C","group":"5da4ffa9.3ed6c","order":32,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"5temp","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":670,"y":260,"wires":[["47acc60b.06a458"]]},{"id":"67381b7e.bb0ce4","type":"ui_text_input","z":"cf6e4dbe.06b5d","name":"6temp","label":"","tooltip":"Ingresar en °C","group":"5da4ffa9.3ed6c","order":37,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"6temp","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":670,"y":300,"wires":[["9079c15b.9799f"]]},{"id":"41762911.c6df98","type":"ui_text_input","z":"cf6e4dbe.06b5d","name":"7temp","label":"","tooltip":"Ingresar en °C","group":"5da4ffa9.3ed6c","order":42,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"7temp","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":670,"y":340,"wires":[["d14a120d.6db31"]]},{"id":"27647a03.2d5236","type":"ui_text_input","z":"cf6e4dbe.06b5d","name":"8temp","label":"","tooltip":"Ingresar en °C","group":"5da4ffa9.3ed6c","order":47,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"8temp","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":670,"y":380,"wires":[["4eb1781f.b66648"]]},{"id":"662dda01.194644","type":"ui_text_input","z":"cf6e4dbe.06b5d","name":"9temp","label":"","tooltip":"Ingresar en °C","group":"5da4ffa9.3ed6c","order":52,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"9temp","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":670,"y":420,"wires":[["db848089.23c66"]]},{"id":"ce10c4bc.773718","type":"ui_text","z":"cf6e4dbe.06b5d","group":"5da4ffa9.3ed6c","order":4,"width":3,"height":1,"name":"","label":"Tiempo","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1100,"y":60,"wires":[]},{"id":"5a9cae96.024ad","type":"ui_text","z":"cf6e4dbe.06b5d","group":"5da4ffa9.3ed6c","order":5,"width":3,"height":1,"name":"","label":"Shaker","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1560,"y":60,"wires":[]},{"id":"dceac4.99cbc54","type":"ui_text_input","z":"cf6e4dbe.06b5d","name":"1time","label":"","tooltip":"Ingresar en minutos","group":"5da4ffa9.3ed6c","order":9,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"1time","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":1090,"y":100,"wires":[["cdd3d24b.c3327"]]},{"id":"580d1a4.1d1dae4","type":"ui_text_input","z":"cf6e4dbe.06b5d","name":"2time","label":"","tooltip":"Ingresar en minutos","group":"5da4ffa9.3ed6c","order":15,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"2time","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":1090,"y":140,"wires":[["cc3f38e4.b3fd78"]]},{"id":"ff8b60b9.d03f","type":"ui_text_input","z":"cf6e4dbe.06b5d","name":"3time","label":"","tooltip":"Ingresar en minutos","group":"5da4ffa9.3ed6c","order":21,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"3time","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":1090,"y":180,"wires":[["4a260a98.4b9be4"]]},{"id":"15693913.bcd077","type":"ui_text_input","z":"cf6e4dbe.06b5d","name":"4time","label":"","tooltip":"Ingresar en minutos","group":"5da4ffa9.3ed6c","order":27,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"4time","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":1090,"y":220,"wires":[["6c5d55d5.1bec1c"]]},{"id":"83105c6.9e212a","type":"ui_text_input","z":"cf6e4dbe.06b5d","name":"5time","label":"","tooltip":"Ingresar en minutos","group":"5da4ffa9.3ed6c","order":33,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"5time","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":1090,"y":260,"wires":[["de513bf0.769de8"]]},{"id":"b071795a.a224c8","type":"ui_text_input","z":"cf6e4dbe.06b5d","name":"6time","label":"","tooltip":"Ingresar en minutos","group":"5da4ffa9.3ed6c","order":38,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"6time","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":1090,"y":300,"wires":[["bbe6c614.19fb38"]]},{"id":"7e10980.3a72c68","type":"ui_text_input","z":"cf6e4dbe.06b5d","name":"7time","label":"","tooltip":"Ingresar en minutos","group":"5da4ffa9.3ed6c","order":43,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"7time","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":1090,"y":340,"wires":[["159c94e1.411b4b"]]},{"id":"2e701334.92019c","type":"ui_text_input","z":"cf6e4dbe.06b5d","name":"8time","label":"","tooltip":"Ingresar en minutos","group":"5da4ffa9.3ed6c","order":48,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"8time","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":1090,"y":380,"wires":[["1790f5f.049c10a"]]},{"id":"378e7e3d.0752e2","type":"ui_text_input","z":"cf6e4dbe.06b5d","name":"9time","label":"","tooltip":"Ingresar en minutos","group":"5da4ffa9.3ed6c","order":53,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"9time","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":1090,"y":420,"wires":[["2e329276.7fd4de"]]},{"id":"415053ce.7685ec","type":"ui_text_input","z":"cf6e4dbe.06b5d","name":"1shak","label":"","tooltip":"Ingresar en segundos","group":"5da4ffa9.3ed6c","order":10,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"1shak","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":1550,"y":100,"wires":[["9cddbba5.4c1e48"]]},{"id":"3770f3e.3c0ee0c","type":"ui_text_input","z":"cf6e4dbe.06b5d","name":"2shak","label":"","tooltip":"Ingresar en segundos","group":"5da4ffa9.3ed6c","order":16,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"2shak","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":1550,"y":140,"wires":[["3134c99b.b3c476"]]},{"id":"4c440631.5281c8","type":"ui_text_input","z":"cf6e4dbe.06b5d","name":"3shak","label":"","tooltip":"Ingresar en segundos","group":"5da4ffa9.3ed6c","order":22,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"3shak","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":1550,"y":180,"wires":[["deb5cee6.db1e7"]]},{"id":"82506f9b.4431c","type":"ui_text_input","z":"cf6e4dbe.06b5d","name":"4shak","label":"","tooltip":"Ingresar en segundos","group":"5da4ffa9.3ed6c","order":28,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"4shak","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":1550,"y":220,"wires":[["6f98fd00.c38214"]]},{"id":"94bac0b5.c8e1a","type":"ui_text_input","z":"cf6e4dbe.06b5d","name":"5shak","label":"","tooltip":"Ingresar en segundos","group":"5da4ffa9.3ed6c","order":34,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"5shak","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":1550,"y":260,"wires":[["7a628997.256368"]]},{"id":"4a852cb9.948c54","type":"ui_text_input","z":"cf6e4dbe.06b5d","name":"6shak","label":"","tooltip":"Ingresar en segundos","group":"5da4ffa9.3ed6c","order":39,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"6shak","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":1550,"y":300,"wires":[["ac601d73.8865e"]]},{"id":"f0dca05d.d56a1","type":"ui_text_input","z":"cf6e4dbe.06b5d","name":"7shak","label":"","tooltip":"Ingresar en segundos","group":"5da4ffa9.3ed6c","order":44,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"7shak","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":1550,"y":340,"wires":[["e2f70e6a.08ec3"]]},{"id":"30b81316.92cdac","type":"ui_text_input","z":"cf6e4dbe.06b5d","name":"8shak","label":"","tooltip":"Ingresar en segundos","group":"5da4ffa9.3ed6c","order":49,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"8shak","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":1550,"y":380,"wires":[["f3e3dd7a.f5ee4"]]},{"id":"5cc6ed39.e7b5a4","type":"ui_text_input","z":"cf6e4dbe.06b5d","name":"9shak","label":"","tooltip":"Ingresar en segundos","group":"5da4ffa9.3ed6c","order":54,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"9shak","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":1550,"y":420,"wires":[["fc0851da.3d0ca"]]},{"id":"8b7e32ad.ea065","type":"ui_button","z":"cf6e4dbe.06b5d","name":"","group":"5da4ffa9.3ed6c","order":55,"width":7,"height":1,"passthru":false,"label":"Cancelar","tooltip":"","color":"","bgcolor":"#cd6a6a","className":"red_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":2180,"y":680,"wires":[["857b860c.3a70a8"]]},{"id":"857b860c.3a70a8","type":"change","z":"cf6e4dbe.06b5d","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"Start_tab\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2200,"y":740,"wires":[["2a285649.31a33a"]]},{"id":"2a285649.31a33a","type":"ui_ui_control","z":"cf6e4dbe.06b5d","name":"","events":"all","x":2200,"y":800,"wires":[[]]},{"id":"df891bbb.47b2e8","type":"ui_button","z":"cf6e4dbe.06b5d","name":"","group":"5da4ffa9.3ed6c","order":56,"width":6,"height":1,"passthru":false,"label":"Siguiente","tooltip":"","color":"","bgcolor":"#8adf9d","className":"green_button","icon":"","payload":"Personalizado","payloadType":"str","topic":"","topicType":"str","x":80,"y":900,"wires":[["e3c583f6.3aa71","c5c16a2.a706698","d7ce2dee.d6f96","a4d76574.8849e8","6689ba73.607174"]]},{"id":"e3c583f6.3aa71","type":"change","z":"cf6e4dbe.06b5d","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"ON_personalized_process_tab\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":460,"y":1020,"wires":[["7d9b0a84.317e94"]]},{"id":"7d9b0a84.317e94","type":"ui_ui_control","z":"cf6e4dbe.06b5d","name":"","events":"all","x":640,"y":1020,"wires":[[]]},{"id":"9b95ad7f.3a98d","type":"change","z":"cf6e4dbe.06b5d","name":"Set 1temp","rules":[{"t":"set","p":"1temp","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":830,"y":100,"wires":[[]]},{"id":"75fa7036.a26db","type":"change","z":"cf6e4dbe.06b5d","name":"Set 2temp","rules":[{"t":"set","p":"2temp","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":830,"y":140,"wires":[[]]},{"id":"38cadfae.1220b","type":"change","z":"cf6e4dbe.06b5d","name":"Set 3temp","rules":[{"t":"set","p":"3temp","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":830,"y":180,"wires":[[]]},{"id":"7a41106f.68f1b","type":"change","z":"cf6e4dbe.06b5d","name":"Set 4temp","rules":[{"t":"set","p":"4temp","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":830,"y":220,"wires":[[]]},{"id":"47acc60b.06a458","type":"change","z":"cf6e4dbe.06b5d","name":"Set 5temp","rules":[{"t":"set","p":"5temp","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":830,"y":260,"wires":[[]]},{"id":"9079c15b.9799f","type":"change","z":"cf6e4dbe.06b5d","name":"Set 6temp","rules":[{"t":"set","p":"6temp","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":830,"y":300,"wires":[[]]},{"id":"d14a120d.6db31","type":"change","z":"cf6e4dbe.06b5d","name":"Set 7temp","rules":[{"t":"set","p":"7temp","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":830,"y":340,"wires":[[]]},{"id":"4eb1781f.b66648","type":"change","z":"cf6e4dbe.06b5d","name":"Set 8temp","rules":[{"t":"set","p":"8temp","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":830,"y":380,"wires":[[]]},{"id":"db848089.23c66","type":"change","z":"cf6e4dbe.06b5d","name":"Set 9temp","rules":[{"t":"set","p":"9temp","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":830,"y":420,"wires":[[]]},{"id":"cdd3d24b.c3327","type":"change","z":"cf6e4dbe.06b5d","name":"Set 1time","rules":[{"t":"set","p":"1time","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1240,"y":100,"wires":[[]]},{"id":"cc3f38e4.b3fd78","type":"change","z":"cf6e4dbe.06b5d","name":"Set 2time","rules":[{"t":"set","p":"2time","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1240,"y":140,"wires":[[]]},{"id":"4a260a98.4b9be4","type":"change","z":"cf6e4dbe.06b5d","name":"Set 3time","rules":[{"t":"set","p":"3time","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1240,"y":180,"wires":[[]]},{"id":"6c5d55d5.1bec1c","type":"change","z":"cf6e4dbe.06b5d","name":"Set 4time","rules":[{"t":"set","p":"4time","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1240,"y":220,"wires":[[]]},{"id":"de513bf0.769de8","type":"change","z":"cf6e4dbe.06b5d","name":"Set 5time","rules":[{"t":"set","p":"5time","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1240,"y":260,"wires":[[]]},{"id":"bbe6c614.19fb38","type":"change","z":"cf6e4dbe.06b5d","name":"Set 6time","rules":[{"t":"set","p":"6time","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1240,"y":300,"wires":[[]]},{"id":"159c94e1.411b4b","type":"change","z":"cf6e4dbe.06b5d","name":"Set 7time","rules":[{"t":"set","p":"7time","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1240,"y":340,"wires":[[]]},{"id":"1790f5f.049c10a","type":"change","z":"cf6e4dbe.06b5d","name":"Set 8time","rules":[{"t":"set","p":"8time","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1240,"y":380,"wires":[[]]},{"id":"2e329276.7fd4de","type":"change","z":"cf6e4dbe.06b5d","name":"Set 9time","rules":[{"t":"set","p":"9time","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1240,"y":420,"wires":[[]]},{"id":"9cddbba5.4c1e48","type":"change","z":"cf6e4dbe.06b5d","name":"Set 1shak","rules":[{"t":"set","p":"1shak","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1720,"y":100,"wires":[[]]},{"id":"3134c99b.b3c476","type":"change","z":"cf6e4dbe.06b5d","name":"Set 2shak","rules":[{"t":"set","p":"2shak","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1720,"y":140,"wires":[[]]},{"id":"deb5cee6.db1e7","type":"change","z":"cf6e4dbe.06b5d","name":"Set 3shak","rules":[{"t":"set","p":"3shak","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1720,"y":180,"wires":[[]]},{"id":"6f98fd00.c38214","type":"change","z":"cf6e4dbe.06b5d","name":"Set 4shak","rules":[{"t":"set","p":"4shak","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1720,"y":220,"wires":[[]]},{"id":"7a628997.256368","type":"change","z":"cf6e4dbe.06b5d","name":"Set 5shak","rules":[{"t":"set","p":"5shak","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1720,"y":260,"wires":[[]]},{"id":"ac601d73.8865e","type":"change","z":"cf6e4dbe.06b5d","name":"Set 6shak","rules":[{"t":"set","p":"6shak","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1720,"y":300,"wires":[[]]},{"id":"e2f70e6a.08ec3","type":"change","z":"cf6e4dbe.06b5d","name":"Set 7shak","rules":[{"t":"set","p":"7shak","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1720,"y":340,"wires":[[]]},{"id":"f3e3dd7a.f5ee4","type":"change","z":"cf6e4dbe.06b5d","name":"Set 8shak","rules":[{"t":"set","p":"8shak","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1720,"y":380,"wires":[[]]},{"id":"fc0851da.3d0ca","type":"change","z":"cf6e4dbe.06b5d","name":"Set 9shak","rules":[{"t":"set","p":"9shak","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1720,"y":420,"wires":[[]]},{"id":"3c1cfe20.8ac412","type":"ui_text","z":"cf6e4dbe.06b5d","group":"5da4ffa9.3ed6c","order":6,"width":3,"height":1,"name":"","label":"Ciclos","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":2190,"y":40,"wires":[]},{"id":"b3764609.0de978","type":"ui_text_input","z":"cf6e4dbe.06b5d","name":"ciclos","label":"","tooltip":"Ingresar el número de ciclos","group":"5da4ffa9.3ed6c","order":11,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"ciclos","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":2190,"y":80,"wires":[["76475f28.741bd"]]},{"id":"76475f28.741bd","type":"change","z":"cf6e4dbe.06b5d","name":"Set ciclos","rules":[{"t":"set","p":"ciclos","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2380,"y":80,"wires":[[]]},{"id":"bafd7f2f.a1275","type":"ui_text","z":"cf6e4dbe.06b5d","group":"5da4ffa9.3ed6c","order":17,"width":3,"height":1,"name":"","label":"Flujo","format":"{{msg.payload}}","layout":"row-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":2190,"y":140,"wires":[]},{"id":"547120ea.8601d","type":"ui_text_input","z":"cf6e4dbe.06b5d","name":"Flujo","label":"","tooltip":"Ingresar en cual ciclo se reduce el flujo de aire","group":"5da4ffa9.3ed6c","order":23,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"flujo","sendOnBlur":true,"className":"input_text_user","topicType":"str","x":2190,"y":180,"wires":[["c578795c.bb3bc8"]]},{"id":"c578795c.bb3bc8","type":"change","z":"cf6e4dbe.06b5d","name":"Set flujo","rules":[{"t":"set","p":"flujo","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2380,"y":180,"wires":[[]]},{"id":"cd9061b3.9661a","type":"function","z":"e69d9ae9.d86958","name":"Formato del CSV y nombre del archivo","func":"// OBTENER VARIABLES GLOBALES DE LA RECETA Y COLOCARLOS EN \n// UN FORMATO DE UNA LINEA PARA CSV\nvar timestamp = new Date().toISOString();\nvar process = global.get('process') || 'No value';\nvar temp_pre_secado = global.get('temp_pre_secado') || 'No value';\nvar time_pre_secado = global.get('time_pre_secado') || 'No value';\nvar temp_oreado = global.get('temp_oreado') || 'No value';\nvar time_oreado = global.get('time_oreado') || 'No value';\nvar temp_final = global.get('temp_final') || 'No value';\nvar time_final = global.get('time_final') || 'No value';\nvar torre = global.get('torre') || 'No value';\n\nvar csvLine = process + \", \" + timestamp + \",\" + temp_pre_secado + \",\" + time_pre_secado + \",\" + temp_oreado + \",\" + time_oreado + \",\" + temp_final + \",\" + time_final + \",\" + torre + \"\\n\";\nmsg.payload = csvLine;\n\n//----------------------------------------------------\n\n// DAR FORMATO AL NOMBRE DEL ARCHIVO HORA DE BOGOTA\nlet date = new Date();\n// Convertir a la zona horaria de Bogotá (UTC-5)\nlet options = { timeZone: 'America/Bogota', year: 'numeric', month: '2-digit', day: '2-digit', \n                hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false };\nlet formatter = new Intl.DateTimeFormat('en-GB', options);\nlet parts = formatter.formatToParts(date);\nlet year = parts.find(p => p.type === 'year').value;\nlet month = parts.find(p => p.type === 'month').value;\nlet day = parts.find(p => p.type === 'day').value;\nlet hours = parts.find(p => p.type === 'hour').value;\nlet minutes = parts.find(p => p.type === 'minute').value;\nlet seconds = parts.find(p => p.type === 'second').value;\n// Formato: YYYYMMDD_HHMMSS\nlet formattedDate = `${year}${month}${day}_${hours}${minutes}${seconds}`;\n\n//----------------------------------------------------\n\n//CAMBIAR RUTA DE ALMACENAMIENTO DE LOS CSV\nvar ruta_sd = global.get('ruta_sd') || '';\nlet filename = `${ruta_sd}Estandar_${formattedDate}.csv`;\nglobal.set('filename', filename); // Guardar en flow.filename\nflow.set('csvline', csvLine);\n\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":630,"y":860,"wires":[["5fa6f8be.fdd738","939a9ceb.47d3f","c5aa2543.8dea08"]]},{"id":"5fa6f8be.fdd738","type":"function","z":"e69d9ae9.d86958","name":"Obtener nombre del archivo","func":"msg.filename = global.get('filename'); // Obtener el nombre del archivo de flow\nmsg.payload = flow.get('csvline');\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":940,"y":860,"wires":[["6b8f79f2.f84d48"]]},{"id":"6b8f79f2.f84d48","type":"file","z":"e69d9ae9.d86958","name":"Guardar datos en CSV","filename":"","appendNewline":true,"createDir":false,"overwriteFile":"false","encoding":"none","x":1260,"y":860,"wires":[[]]},{"id":"f77fb586.b4ddc8","type":"file","z":"e69d9ae9.d86958","name":"Guardar proceso en historial","filename":"","appendNewline":true,"createDir":false,"overwriteFile":"false","encoding":"none","x":1280,"y":920,"wires":[[]]},{"id":"7bc8ecdc.52f344","type":"change","z":"1d0b3b5c.03ac95","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"Data_personalized_tab\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":580,"y":480,"wires":[["3c313c6a.8218a4"]]},{"id":"3c313c6a.8218a4","type":"ui_ui_control","z":"1d0b3b5c.03ac95","name":"","events":"all","x":760,"y":480,"wires":[[]]},{"id":"6372da24.9b1184","type":"inject","z":"ff06c4a0.7e7488","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":770,"y":100,"wires":[["b415d346.18c55"]]},{"id":"f7fac291.61ae7","type":"file in","z":"ff06c4a0.7e7488","name":"Leer historial_procesos.csv","filename":"","format":"utf8","chunk":false,"sendError":true,"encoding":"none","x":880,"y":260,"wires":[["40e86f4a.d4103"]]},{"id":"eb32831c.e198c","type":"ui_dropdown","z":"ff06c4a0.7e7488","name":"Dropdown seleccionar archivo","label":"Seleccionar","tooltip":"","place":"Proceso...","group":"78ed841d.d7023c","order":5,"width":11,"height":1,"passthru":true,"multiple":false,"options":[],"payload":"","topic":"","topicType":"str","className":"Dropdown","x":890,"y":400,"wires":[["8215cc9e.4eb61","e6d5caae.8d42b8"]]},{"id":"57fda91a.8e2c88","type":"file in","z":"ff06c4a0.7e7488","name":"Leer archivo seleccionado","filename":"","format":"utf8","chunk":false,"sendError":true,"encoding":"none","x":870,"y":540,"wires":[["4780cc63.fe1ea4"]]},{"id":"4780cc63.fe1ea4","type":"function","z":"ff06c4a0.7e7488","name":"Cargar valores en inputs","func":"let data = msg.payload.split(',');\n\n// Asignamos los valores a cada input (valores después de la fecha)\nmsg.payload1 = data[2] || '';\nmsg.payload2 = data[3] || '';\nmsg.payload3 = data[4] || '';\nmsg.payload4 = data[5] || '';\nmsg.payload5 = data[6] || '';\nmsg.payload6 = data[7] || '';\nmsg.payload7 = data[8] || '';\n\nreturn [\n    { payload: msg.payload1 },\n    { payload: msg.payload2 },\n    { payload: msg.payload3 },\n    { payload: msg.payload4 },\n    { payload: msg.payload5 },\n    { payload: msg.payload6 },\n    { payload: msg.payload7 },\n];","outputs":7,"noerr":0,"initialize":"","finalize":"","x":870,"y":660,"wires":[["62633f4a.8cee","97e32728.d506d8"],["c7e4b679.ad4548","aa959eaf.ecfcf"],["4a5a56e6.d6d948","bf340caf.672ab"],["5f2edc54.3d8404","8daf52c1.09751"],["b104081a.1821e8","ba77ed0e.481c4"],["4c6067aa.082378","52d0ba85.12b234"],["1ca638ab.09e047","57b1346f.84bd2c"]]},{"id":"a17ae84c.793cf8","type":"ui_button","z":"ff06c4a0.7e7488","name":"","group":"78ed841d.d7023c","order":3,"width":5,"height":1,"passthru":false,"label":"Principal","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":240,"y":280,"wires":[["d3597978.502b88"]]},{"id":"907b18f2.668c78","type":"ui_button","z":"ff06c4a0.7e7488","name":"","group":"78ed841d.d7023c","order":7,"width":5,"height":1,"passthru":false,"label":"Graficas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":240,"y":340,"wires":[["9aec228e.be17e"]]},{"id":"8dd3157a.1827a8","type":"ui_button","z":"ff06c4a0.7e7488","name":"","group":"78ed841d.d7023c","order":11,"width":5,"height":1,"passthru":false,"label":"Recetas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":240,"y":400,"wires":[["72373d7f.625d74","b415d346.18c55"]]},{"id":"467600b8.75919","type":"ui_button","z":"ff06c4a0.7e7488","name":"","group":"78ed841d.d7023c","order":27,"width":5,"height":1,"passthru":false,"label":"Configuración","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":260,"y":520,"wires":[["a893e799.4a4e18"]]},{"id":"695d8636.8887b8","type":"ui_media","z":"ff06c4a0.7e7488","group":"78ed841d.d7023c","name":"logo_aciv","width":5,"height":2,"order":50,"category":"logo_aciv","file":"logo_aciv.png","layout":"center","showcontrols":true,"loop":true,"onstart":false,"scope":"local","tooltip":"","x":240,"y":580,"wires":[[]]},{"id":"da94ff0c.59a03","type":"ui_button","z":"ff06c4a0.7e7488","name":"","group":"78ed841d.d7023c","order":35,"width":5,"height":2,"passthru":false,"label":"Parada de emergencia","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":280,"y":640,"wires":[["6b8aed87.965a04"]]},{"id":"5450edcf.df4954","type":"ui_media","z":"ff06c4a0.7e7488","group":"78ed841d.d7023c","name":"logo_penagos","width":5,"height":2,"order":1,"category":"logos","file":"logo_penagos.png","layout":"center","showcontrols":true,"loop":true,"onstart":false,"scope":"local","tooltip":"","x":260,"y":220,"wires":[[]]},{"id":"e6d5caae.8d42b8","type":"ui_text","z":"ff06c4a0.7e7488","group":"78ed841d.d7023c","order":2,"width":13,"height":2,"name":"","label":"Historial del proceso","format":"{{msg.payload}}","layout":"col-center","className":"Label_proceso_estandar","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"30","color":"#b0b6bd","x":1580,"y":200,"wires":[]},{"id":"9f51f6af.55cc88","type":"ui_text","z":"ff06c4a0.7e7488","group":"78ed841d.d7023c","order":13,"width":3,"height":1,"name":"","label":"Pre Secado","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo_up","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#464080","x":1370,"y":320,"wires":[]},{"id":"4b2e4466.095abc","type":"ui_text","z":"ff06c4a0.7e7488","group":"78ed841d.d7023c","order":15,"width":3,"height":1,"name":"","label":"Oreado","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo_up","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#464080","x":1560,"y":320,"wires":[]},{"id":"d3c2620f.a7b37","type":"ui_text","z":"ff06c4a0.7e7488","group":"78ed841d.d7023c","order":17,"width":3,"height":1,"name":"","label":"Punto Final","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo_up","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#464080","x":1790,"y":320,"wires":[]},{"id":"85de923a.e0119","type":"ui_text","z":"ff06c4a0.7e7488","group":"78ed841d.d7023c","order":21,"width":3,"height":1,"name":"","label":"Temperatura","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#46408a","x":1370,"y":360,"wires":[]},{"id":"c5940d27.4c186","type":"ui_text","z":"ff06c4a0.7e7488","group":"78ed841d.d7023c","order":25,"width":3,"height":1,"name":"","label":"Temperatura","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#46408a","x":1570,"y":360,"wires":[]},{"id":"288ad2d2.5850de","type":"ui_text","z":"ff06c4a0.7e7488","group":"78ed841d.d7023c","order":23,"width":3,"height":1,"name":"","label":"Temperatura","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#46408a","x":1790,"y":360,"wires":[]},{"id":"927249c4.f75e58","type":"ui_text","z":"ff06c4a0.7e7488","group":"78ed841d.d7023c","order":39,"width":3,"height":1,"name":"","label":"Tiempo","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#46408a","x":1360,"y":460,"wires":[]},{"id":"6cef681a.c1b4a8","type":"ui_text","z":"ff06c4a0.7e7488","group":"78ed841d.d7023c","order":37,"width":3,"height":1,"name":"","label":"Tiempo","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#46408a","x":1560,"y":460,"wires":[]},{"id":"72942b18.a056f4","type":"ui_text","z":"ff06c4a0.7e7488","group":"78ed841d.d7023c","order":41,"width":3,"height":1,"name":"","label":"Peso","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#46408a","x":1770,"y":460,"wires":[]},{"id":"62633f4a.8cee","type":"ui_text","z":"ff06c4a0.7e7488","group":"78ed841d.d7023c","order":29,"width":3,"height":1,"name":"text1","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"22","color":"#464080","x":1350,"y":400,"wires":[]},{"id":"4a5a56e6.d6d948","type":"ui_text","z":"ff06c4a0.7e7488","group":"78ed841d.d7023c","order":31,"width":3,"height":1,"name":"text3","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"22","color":"#464080","x":1550,"y":400,"wires":[]},{"id":"b104081a.1821e8","type":"ui_text","z":"ff06c4a0.7e7488","group":"78ed841d.d7023c","order":33,"width":3,"height":1,"name":"text5","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"22","color":"#464080","x":1770,"y":400,"wires":[]},{"id":"c7e4b679.ad4548","type":"ui_text","z":"ff06c4a0.7e7488","group":"78ed841d.d7023c","order":44,"width":3,"height":1,"name":"text2","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"22","color":"#464080","x":1350,"y":500,"wires":[]},{"id":"5f2edc54.3d8404","type":"ui_text","z":"ff06c4a0.7e7488","group":"78ed841d.d7023c","order":46,"width":3,"height":1,"name":"text4","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"22","color":"#464080","x":1550,"y":500,"wires":[]},{"id":"4c6067aa.082378","type":"ui_text","z":"ff06c4a0.7e7488","group":"78ed841d.d7023c","order":48,"width":3,"height":1,"name":"text6","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"22","color":"#464080","x":1770,"y":500,"wires":[]},{"id":"e6a0abe8.19afb8","type":"ui_button","z":"ff06c4a0.7e7488","name":"","group":"78ed841d.d7023c","order":51,"width":7,"height":2,"passthru":false,"label":"Recetas personalizadas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":1330,"y":720,"wires":[["f3f4b8a6.12fd38","5de61ad5.9da954"]]},{"id":"46573bdd.50e8d4","type":"ui_button","z":"ff06c4a0.7e7488","name":"","group":"78ed841d.d7023c","order":52,"width":6,"height":2,"passthru":false,"label":"Usar receta","tooltip":"","color":"","bgcolor":"#46408A","className":"left_menu_button_purple","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":1750,"y":720,"wires":[["4c1dcf83.2166a","11146eb5.052061","6834a30f.517d5c"]]},{"id":"f3f4b8a6.12fd38","type":"change","z":"ff06c4a0.7e7488","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"Data_personalized_tab\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":1300,"y":780,"wires":[["7edff397.79740c"]]},{"id":"7edff397.79740c","type":"ui_ui_control","z":"ff06c4a0.7e7488","name":"","events":"all","x":1300,"y":840,"wires":[[]]},{"id":"4c1dcf83.2166a","type":"change","z":"ff06c4a0.7e7488","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"Standard_process_tab\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":1760,"y":780,"wires":[["b54bed0f.5e44e"]]},{"id":"b54bed0f.5e44e","type":"ui_ui_control","z":"ff06c4a0.7e7488","name":"","events":"all","x":1760,"y":840,"wires":[[]]},{"id":"a6084bff.c423c8","type":"change","z":"1d0b3b5c.03ac95","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"Start_tab\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":680,"y":840,"wires":[["1ffbd25b.55d5fe"]]},{"id":"1ffbd25b.55d5fe","type":"ui_ui_control","z":"1d0b3b5c.03ac95","name":"","events":"all","x":880,"y":840,"wires":[[]]},{"id":"90bf9b0b.b29e28","type":"change","z":"e69d9ae9.d86958","name":"","rules":[{"t":"set","p":"process","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":570,"y":740,"wires":[[]]},{"id":"cfed962.95a1e68","type":"link in","z":"934099b7.c96bb8","name":"","links":["8c1ecafb.80b068"],"x":715,"y":640,"wires":[["4b6524fe.d4689c"]]},{"id":"13605ea8.3a0d01","type":"link in","z":"934099b7.c96bb8","name":"","links":["19b34ae0.3285a5"],"x":1475,"y":360,"wires":[["c44d70.e1cbb29"]]},{"id":"a9dd0ae7.e63b18","type":"link in","z":"934099b7.c96bb8","name":"","links":["b267761b.e2e728"],"x":1475,"y":640,"wires":[["77493db3.382914"]]},{"id":"723928b2.cf2b18","type":"link in","z":"934099b7.c96bb8","name":"","links":["e3738fb3.afef3"],"x":715,"y":360,"wires":[["bbb9d6e7.6ed6b8"]]},{"id":"3f3d1786.c1afc8","type":"link in","z":"934099b7.c96bb8","name":"","links":["d266633b.688fe"],"x":715,"y":500,"wires":[["91e202cb.9c197"]]},{"id":"f286517f.120b3","type":"link in","z":"934099b7.c96bb8","name":"","links":["efdade98.7bb17"],"x":1475,"y":500,"wires":[["6b58aa5d.3da594"]]},{"id":"43506c4d.ba4d24","type":"link out","z":"e69d9ae9.d86958","name":"Inicio proceso estandar (siguiente is pressed)","links":["7204d62e.d9ffd8","a63e6486.898d38"],"x":495,"y":780,"wires":[]},{"id":"7204d62e.d9ffd8","type":"link in","z":"934099b7.c96bb8","name":"Inicio cronometro","links":["43506c4d.ba4d24"],"x":715,"y":240,"wires":[["c93330e3.eca9a"]]},{"id":"c93330e3.eca9a","type":"function","z":"934099b7.c96bb8","name":"Global Start Cronometer","func":"global.set('current_time', 0);\nglobal.set('running', true);\nmsg.payload = 'start';\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":890,"y":240,"wires":[[]]},{"id":"c5d10038.d6d92","type":"function","z":"1d0b3b5c.03ac95","name":"Stop Cronometer","func":"global.set('running', false);\nmsg.payload = 'stopped';\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":690,"y":800,"wires":[[]]},{"id":"867dc6b2.2d11f8","type":"ui_button","z":"34168811.ab73a8","name":"","group":"f98bd4ef.b5b8a8","order":15,"width":3,"height":1,"passthru":false,"label":"Shaker 1","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":680,"y":280,"wires":[["4393308c.a6464"]]},{"id":"4393308c.a6464","type":"debug","z":"34168811.ab73a8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":890,"y":280,"wires":[]},{"id":"b1073497.4fc468","type":"ui_button","z":"34168811.ab73a8","name":"","group":"f98bd4ef.b5b8a8","order":22,"width":3,"height":1,"passthru":false,"label":"Shaker 2","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":680,"y":360,"wires":[["d091d6da.9b0ac8"]]},{"id":"af9ae8ee.6ea9d8","type":"ui_button","z":"34168811.ab73a8","name":"","group":"f98bd4ef.b5b8a8","order":29,"width":3,"height":1,"passthru":false,"label":"Ventilador","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":680,"y":440,"wires":[["f6724486.0474b8"]]},{"id":"472b8eb4.258fc","type":"ui_button","z":"34168811.ab73a8","name":"","group":"f98bd4ef.b5b8a8","order":30,"width":3,"height":1,"passthru":false,"label":"Posicionador","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":690,"y":480,"wires":[["75b8b0a7.40aab"]]},{"id":"d091d6da.9b0ac8","type":"debug","z":"34168811.ab73a8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":910,"y":360,"wires":[]},{"id":"f6724486.0474b8","type":"debug","z":"34168811.ab73a8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":930,"y":440,"wires":[]},{"id":"75b8b0a7.40aab","type":"debug","z":"34168811.ab73a8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":970,"y":480,"wires":[]},{"id":"b9a33bbe.0fb0a8","type":"change","z":"1d0b3b5c.03ac95","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"Configuration_tab\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":580,"y":700,"wires":[["875fb1ec.013b2"]]},{"id":"875fb1ec.013b2","type":"ui_ui_control","z":"1d0b3b5c.03ac95","name":"","events":"all","x":760,"y":700,"wires":[[]]},{"id":"26d0d9b7.7c13e6","type":"function","z":"1d0b3b5c.03ac95","name":"Consulta global.running","func":"var running = global.get('running') || false;\nvar process = global.get('process') || false;\n\nif (running === true) {\n    if (process === \"Estandar\"){\n        return { payload: { tab: 'ON_standard_process_tab' } };\n    }\n    else if (process === \"Personalizado\"){\n        return { payload: { tab: 'ON_personalized_process_tab' } };    \n    }\n} else {\n    return { payload: { tab: 'Start_tab' } };\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":610,"y":280,"wires":[["b69ba5cb.ffef58"]]},{"id":"b69ba5cb.ffef58","type":"ui_ui_control","z":"1d0b3b5c.03ac95","name":"Redirigir a pestaña","events":"all","x":850,"y":280,"wires":[[]]},{"id":"f1bd1219.33033","type":"ui_button","z":"93a187c.3811378","name":"","group":"fa43ae49.746bc","order":6,"width":5,"height":1,"passthru":false,"label":"Principal","tooltip":"","color":"","bgcolor":"","className":"","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":200,"y":500,"wires":[["e44acab5.aee728"]]},{"id":"9ac07bc5.8a0d38","type":"function","z":"804acb1a.0445f8","name":"Leer global.filename","func":"var filename = global.get('filename') || 'No value';\n\nmsg.payload = filename\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":480,"y":940,"wires":[["b46b1b02.947c18"]]},{"id":"93648e61.02e64","type":"inject","z":"804acb1a.0445f8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":270,"y":940,"wires":[["9ac07bc5.8a0d38"]]},{"id":"646239fa.5dcab8","type":"debug","z":"804acb1a.0445f8","name":"Nombre y datos del archivo guardado","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":850,"y":1080,"wires":[]},{"id":"8a48472c.c19218","type":"inject","z":"804acb1a.0445f8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":260,"y":1200,"wires":[["a14a5d48.6a17"]]},{"id":"a14a5d48.6a17","type":"file in","z":"804acb1a.0445f8","name":"Cargar archivo del historial con el nombre","filename":"Estandar_20240930_111940_temp1.csv","format":"utf8","chunk":false,"sendError":false,"encoding":"none","x":540,"y":1200,"wires":[["29404bc4.cec814"]]},{"id":"29404bc4.cec814","type":"debug","z":"804acb1a.0445f8","name":"cargar archivo donde se guarda temp1 para validar datos","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":950,"y":1200,"wires":[]},{"id":"dbdaf0c9.59cee","type":"csv","z":"804acb1a.0445f8","name":"Convertir a CSV","sep":",","hdrin":false,"hdrout":"none","multi":"one","ret":"\\n","temp":"value,timestamp","skip":"0","strings":true,"include_empty_strings":false,"include_null_values":false,"x":780,"y":1120,"wires":[["6dea9b98.9629c4"]]},{"id":"8b84afa5.6fb59","type":"function","z":"804acb1a.0445f8","name":"Formato de CSV y de filename","func":"var filename = global.get('filename') || 'No value';\nfilename = filename.slice(0, -4) + \"_temp2.csv\";\nlet value =  msg.payload;\nlet timestamp = new Date().toISOString();\n\nvar csvLine = value + \", \" + timestamp + \"\\n\";\n\nmsg.filename = filename\n// msg.payload = csvLine;\n\nmsg.payload = {\n    value: msg.payload,\n    timestamp: new Date().toISOString(),\n};\n\n\nreturn msg","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1690,"y":1140,"wires":[["871bf682.e34d48"]]},{"id":"20ab1572.76704a","type":"file","z":"804acb1a.0445f8","name":"CSV sensor_temp2","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"false","encoding":"none","x":2250,"y":1140,"wires":[[]]},{"id":"b46b1b02.947c18","type":"debug","z":"804acb1a.0445f8","name":"global.filename","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":700,"y":940,"wires":[]},{"id":"cd6d2c81.4192e","type":"debug","z":"804acb1a.0445f8","name":"cargar archivo donde se guarda temp1 para validar datos","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2190,"y":1200,"wires":[]},{"id":"9a4b387c.0b99e8","type":"file in","z":"804acb1a.0445f8","name":"Cargar archivo del historial con el nombre","filename":"Estandar_20240930_111940_temp1.csv","format":"utf8","chunk":false,"sendError":false,"encoding":"none","x":1740,"y":1200,"wires":[["cd6d2c81.4192e"]]},{"id":"de0e7912.727e38","type":"inject","z":"804acb1a.0445f8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1460,"y":1200,"wires":[["9a4b387c.0b99e8"]]},{"id":"94f9c7a1.e44fe8","type":"file","z":"804acb1a.0445f8","name":"Borrar ingresando el nombre","filename":"nombre.csv","appendNewline":true,"createDir":true,"overwriteFile":"delete","encoding":"none","x":1680,"y":1240,"wires":[[]]},{"id":"3d21faf0.6fa006","type":"inject","z":"804acb1a.0445f8","name":"Delete","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1450,"y":1240,"wires":[["94f9c7a1.e44fe8"]]},{"id":"4e6dfcca.daf064","type":"function","z":"804acb1a.0445f8","name":"Procesar CSV","func":"let lines = msg.payload.split('\\n');\nlet data = [];\n\nlines.forEach(line => {\n    let parts = line.split(',');\n    if(parts.length === 2) {\n        let value = parseFloat(parts[0]);\n        let timestamp = new Date(parts[1]).getTime();\n        data.push({x: timestamp, y: value});\n    }\n});\n\nmsg.payload = [{\n    \"series\": [\"Sensor\"],\n    \"data\": [data],\n    \"labels\": data.map(d => new Date(d.x).toLocaleTimeString())\n}];\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2220,"y":380,"wires":[["bc056514.ff6038"]]},{"id":"34874039.3e2fe","type":"ui_dropdown","z":"804acb1a.0445f8","name":"","label":"","tooltip":"","place":"Gráfica 2","group":"73d41b87.143354","order":5,"width":3,"height":1,"passthru":true,"multiple":false,"options":[{"label":"Temperatura torre 1","value":"temp1","type":"str"},{"label":"Temperatura torre 2","value":"temp2","type":"str"},{"label":"Temperatura resistencia","value":"tempr","type":"str"},{"label":"Humedad torre 1","value":"hum1","type":"str"},{"label":"Humedad torre 2","value":"hum2","type":"str"},{"label":"Humedad resistencia","value":"humr","type":"str"},{"label":"Humedad exterior","value":"humext","type":"str"},{"label":"Peso torre 1","value":"weight1","type":"str"},{"label":"Peso torre 2","value":"weight2","type":"str"}],"payload":"","topic":"","topicType":"str","className":"","x":2220,"y":80,"wires":[["f665b942.e7fdf8"]]},{"id":"aa8affa1.16715","type":"file in","z":"804acb1a.0445f8","name":"Read CSV","filename":"","format":"utf8","chunk":false,"sendError":true,"encoding":"none","x":2310,"y":320,"wires":[["4e6dfcca.daf064"]]},{"id":"7d50a7c7.3d5e38","type":"change","z":"804acb1a.0445f8","name":"Set filename","rules":[{"t":"set","p":"filename","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2210,"y":200,"wires":[["4a1310fc.a67cd"]]},{"id":"bc056514.ff6038","type":"ui_chart","z":"804acb1a.0445f8","name":"Dropdown2","group":"73d41b87.143354","order":9,"width":6,"height":5,"label":"{{msg.label}}","chartType":"line","legend":"false","xformat":"HH:mm","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"86400","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd"],"outputs":1,"useDifferentColor":false,"className":"","x":2210,"y":440,"wires":[[]]},{"id":"ccd2d277.f27d1","type":"function","z":"804acb1a.0445f8","name":"Nombre grafica","func":"sensor = msg.filename\n\n// Remover \"sensor_\" del inicio\nsensor = sensor.replace(\"sensor_\", \"\");\n\n// Remover \".csv\" del final\nsensor = sensor.replace(\".csv\", \"\");\n\n// Agregar \" vs tiempo\"\nsensor += \" vs tiempo\";\n\nmsg.sensor = sensor\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2080,"y":320,"wires":[["aa8affa1.16715"]]},{"id":"27bc4eaf.afc6d2","type":"inject","z":"804acb1a.0445f8","name":"","props":[{"p":"payload"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":2060,"y":80,"wires":[["34874039.3e2fe"]]},{"id":"34e74942.d0c956","type":"comment","z":"ff06c4a0.7e7488","name":"Actualización del historial en datos","info":"Para que cuando se presione el botón datos se actulice la lista del historial","x":880,"y":40,"wires":[]},{"id":"a63e6486.898d38","type":"link in","z":"934099b7.c96bb8","name":"","links":["43506c4d.ba4d24"],"x":715,"y":60,"wires":[["733b26ae.1f40c8","2a63b0b3.4d71"]]},{"id":"f89b85ec.870248","type":"link out","z":"1d0b3b5c.03ac95","name":"Proceso estandar is pressed","links":["1b2c3cd2.1ced73"],"x":1395,"y":460,"wires":[]},{"id":"1b2c3cd2.1ced73","type":"link in","z":"e69d9ae9.d86958","name":"","links":["6834a30f.517d5c","f89b85ec.870248"],"x":1475,"y":540,"wires":[["74967fd6.ec618"]]},{"id":"a962a215.99b52","type":"change","z":"e69d9ae9.d86958","name":"","rules":[{"t":"set","p":"torre","pt":"global","to":"2","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":1200,"y":540,"wires":[[]]},{"id":"7707b4c9.de0b9c","type":"function","z":"e69d9ae9.d86958","name":"Intercambiar botones","func":"if (msg.payload === true) {\n    context.set('color', '#46408A');\n    msg.bgcolor = '#46408A';\n    msg.color = 'white';\n    \n} else {\n    context.set('color', 'white');\n    msg.bgcolor = 'white';\n    msg.color = '#46408A';\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1100,"y":440,"wires":[["212e94f.bc60e6c","89b010dc.25b7a"]]},{"id":"74967fd6.ec618","type":"function","z":"e69d9ae9.d86958","name":"Activar torre 1 por defecto","func":"let torre = global.get('torre') || 'Error';\n\n\nif (torre === \"2\"){\n    msg.payload = null;\n}\nelse {\n    msg.payload = true\n}\n\nreturn msg","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1550,"y":460,"wires":[["1211bb99.102874","7707b4c9.de0b9c"]]},{"id":"6675cdf3.8c2974","type":"ui_text","z":"934099b7.c96bb8","group":"cca89ca3.f14d7","order":6,"width":1,"height":1,"name":"","label":"","format":"","layout":"col-center","className":"","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#00abe5","x":270,"y":40,"wires":[]},{"id":"190abb5a.f981c5","type":"function","z":"934099b7.c96bb8","name":"Obtener subproceso actual","func":"// Inicializar la variable global si no existe\nvar sub1 = global.get('subproceso_estandar1') || \"0\"; // Cambiado a \"0\"\nvar sub2 = global.get('subproceso_estandar2') || \"0\"; // Cambiado a \"0\"\nvar sub3 = global.get('subproceso_estandar3') || \"0\"; // Cambiado a \"0\"\n\nvar subproceso = \"Pre secado\";\n\n// Si el contador supera 3, reiniciarlo a 1\nif (sub1 === \"1\" && sub2 === \"0\" && sub3 === \"0\") {\n   subproceso = \"Pre secado\";\n}\nelse if (sub1 === \"1\" && sub2 === \"1\" && sub3 === \"0\") {\n    subproceso = \"Oreado\";\n}\nelse if (sub1 === \"1\" && sub2 === \"1\" && sub3 === \"1\") {\n    subproceso = \"Punto final\";\n}\nelse {\n    subproceso = \"Cargando...\";\n}\n\n// Establecer el valor del contador en msg.payload para enviarlo\nmsg.payload = subproceso;\n\n// Devolver el mensaje modificado\nreturn msg;\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1700,"y":80,"wires":[["788d116d.5b37b"]]},{"id":"e658d12b.53b46","type":"comment","z":"804acb1a.0445f8","name":"Faltan editar de aqui para abajo","info":"","x":1270,"y":1380,"wires":[]},{"id":"77105b8d.a140b4","type":"comment","z":"47a745ac.9f83dc","name":"Sensores","info":"","x":140,"y":80,"wires":[]},{"id":"3bac73e7.22cf9c","type":"comment","z":"47a745ac.9f83dc","name":"Actuadores","info":"","x":170,"y":1460,"wires":[]},{"id":"c8193a8c.1a56a8","type":"comment","z":"47a745ac.9f83dc","name":"Variables de proceso","info":"","x":190,"y":1320,"wires":[]},{"id":"3f84f412.4251ec","type":"function","z":"47a745ac.9f83dc","name":"Simulador variable de subproceso","func":"// Inicializar la variable global si no existe\nvar contador = context.get('contador') || 0;\n\n// Incrementar el valor del contador\ncontador += 1;\n\n// Si el contador supera 3, reiniciarlo a 1\nif (contador > 3) {\n    contador = 1;\n}\n\n// Guardar el valor actualizado en el contexto\ncontext.set('contador', contador);\n\n// Establecer el valor del contador en msg.payload para enviarlo\nmsg.payload = contador;\n\n// Devolver el mensaje modificado\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":440,"y":1380,"wires":[["86826d10.0d086","fc4d0508.7299b8"]]},{"id":"31ab2314.dc3c7c","type":"inject","z":"47a745ac.9f83dc","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":190,"y":1380,"wires":[["3f84f412.4251ec"]]},{"id":"86826d10.0d086","type":"debug","z":"47a745ac.9f83dc","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":710,"y":1380,"wires":[]},{"id":"fc4d0508.7299b8","type":"link out","z":"47a745ac.9f83dc","name":"process_subproceso","links":["3465e9fa.a94c56","a5d3e0c3.b0da6"],"x":655,"y":1420,"wires":[]},{"id":"3465e9fa.a94c56","type":"link in","z":"934099b7.c96bb8","name":"","links":["fc4d0508.7299b8"],"x":1475,"y":80,"wires":[["190abb5a.f981c5"]]},{"id":"bbb9d6e7.6ed6b8","type":"function","z":"934099b7.c96bb8","name":"Torre 1 ON","func":"let torre = global.get('torre') || 'Error';\n\nif (torre === \"1\") {\n    return msg;\n}\nelse {\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":890,"y":360,"wires":[["9008a0bf.3dc68"]]},{"id":"47fd1dc3.7b9804","type":"link in","z":"934099b7.c96bb8","name":"","links":["bbe0478.68769b8"],"x":715,"y":400,"wires":[["ebb29e.b9010d6"]]},{"id":"ebb29e.b9010d6","type":"function","z":"934099b7.c96bb8","name":"Torre 2 ON","func":"let torre = global.get('torre') || 'Error';\n\nif (torre === \"2\") {\n    return msg;\n}\nelse {\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":890,"y":400,"wires":[["9008a0bf.3dc68"]]},{"id":"9de2a8d9.27afa8","type":"debug","z":"47a745ac.9f83dc","name":"temp2_sim","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1210,"y":180,"wires":[]},{"id":"91e202cb.9c197","type":"function","z":"934099b7.c96bb8","name":"Torre 1 ON","func":"let torre = global.get('torre') || 'Error';\n\nif (torre === \"1\") {\n    return msg;\n}\nelse {\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":890,"y":500,"wires":[["e730bd7.d26554"]]},{"id":"490136c.31c2ec8","type":"function","z":"934099b7.c96bb8","name":"Torre 2 ON","func":"let torre = global.get('torre') || 'Error';\n\nif (torre === \"2\") {\n    return msg;\n}\nelse {\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":890,"y":540,"wires":[["e730bd7.d26554"]]},{"id":"4b6524fe.d4689c","type":"function","z":"934099b7.c96bb8","name":"Torre 1 ON","func":"let torre = global.get('torre') || 'Error';\n\nif (torre === \"1\") {\n    return msg;\n}\nelse {\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":890,"y":640,"wires":[["90a341bf.15378"]]},{"id":"5d815a4c.df8ee4","type":"function","z":"934099b7.c96bb8","name":"Torre 2 ON","func":"let torre = global.get('torre') || 'Error';\n\nif (torre === \"2\") {\n    return msg;\n}\nelse {\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":890,"y":680,"wires":[["90a341bf.15378"]]},{"id":"a11a027f.e5bff","type":"link in","z":"934099b7.c96bb8","name":"","links":["6a896d49.894054"],"x":715,"y":540,"wires":[["490136c.31c2ec8"]]},{"id":"f497924.760ac7","type":"link in","z":"934099b7.c96bb8","name":"","links":["77e315b7.8812cc"],"x":715,"y":680,"wires":[["5d815a4c.df8ee4"]]},{"id":"6cbd9fa4.336f1","type":"debug","z":"47a745ac.9f83dc","name":"hum1_sim","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":550,"y":340,"wires":[]},{"id":"90474d8f.a6f5a","type":"debug","z":"47a745ac.9f83dc","name":"hum2_sim","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1210,"y":340,"wires":[]},{"id":"dbee4752.472348","type":"debug","z":"47a745ac.9f83dc","name":"weight1_sim","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":550,"y":480,"wires":[]},{"id":"df4c8cd2.c46c","type":"ui_template","z":"1d0b3b5c.03ac95","group":"c34a93b.47fb57","name":"CSS","order":2,"width":1,"height":1,"format":"<style>\n.Label_tipo{\n    padding-top: 0px !important;\n    font-weight: bold !important;\n    font-family: \"Trebuchet MS\", sans-serif  !important; \n    font-size: 20px !important;\n    color: #46408A !important;\n}\n.Label_tipo_up{\n    font-size: 22px !important;\n    font-weight: bold !important;\n}\n.subprocesos{\n    font-family: \"Trebuchet MS\", sans-serif;\n    font-weight: bold;\n    font-size: 22px !important;\n    color: #00ABE5 !important;\n}\n.subprocesos .label{\n    color: #46408A !important;\n    font-size: 18px !important;\n}\n.green_button button {\n    background-color: #8adf9d !important;\n    color: white !important;\n    font-size: 17px; \n    font-weight: bold;\n    font-family: \"Trebuchet MS\", sans-serif;\n}\n.red_button button{\n    background-color: #cd6a6a !important;\n    color: white !important;\n    font-size: 17px; \n    font-weight: bold;\n    font-family: \"Trebuchet MS\", sans-serif;\n}\n.left_menu_button button {\n    background-color: #00ABE5 !important;\n    color: white !important;\n    font-size: 17px; \n    font-weight: bold;\n    font-family: \"Trebuchet MS\", sans-serif;\n}\n.left_menu_button_purple button {\n    background-color: #46408A !important;\n    color: white !important;\n    font-size: 17px; \n    font-weight: bold;\n    font-family: \"Trebuchet MS\", sans-serif;\n}\n.Dropdown{\n    font-family: \"Trebuchet MS\", sans-serif;\n    font-weight: bold;\n    font-size: 22px !important;\n    color: #46408A !important;\n}\nmd-select-value {\n\n}\n.unidades{\n    color: #B0B6BD !important;\n    font-family: \"Trebuchet MS\", sans-serif;\n    font-weight: bold;\n    font-size: 15px !important;\n}\n.unidades .label{\n    margin-top: -28px !important;\n}\n.sensor_value{\n    font-family: \"Trebuchet MS\", sans-serif  !important;\n    font-weight: bold;\n    font-size: 28px !important;\n    color: #00ABE5 !important;\n}\n.sensor_value .label{\n    color: #46408A !important;\n    font-size: 20px !important;\n}\n.Label_proceso_estandar {\n    background-color: #00ABE5 !important;\n    color: white !important;\n}\n.input_text input {\n    background-color: #46408A !important;\n    border-radius: 20px;\n    color: white !important;\n    height: 35px;\n    margin-bottom: 40px;\n}\n.input_text_user input {\n    background-color: #46408A !important;\n    border-radius: 20px;\n    color: white !important;\n    height: 35px;\n}\n.menu_gris{\n    color: #B0B6BD !important;\n    font-size: 25px; \n    font-family: \"Trebuchet MS\", sans-serif;\n}\n.text-purple{\n    color: #46408A !important;\n    font-size: 25px; \n    font-family: \"Trebuchet MS\", sans-serif;\n}\n.text-blue{\n    color: #00ABE5 !important;\n    font-size: 25px; \n    font-family: \"Trebuchet MS\", sans-serif;\n}\n</style>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"global","className":"","x":330,"y":100,"wires":[[]]},{"id":"b954644e.18d378","type":"ui_text","z":"934099b7.c96bb8","group":"cca89ca3.f14d7","order":16,"width":6,"height":1,"name":"","label":"[ °C ]","format":"","layout":"col-center","className":"unidades","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":16,"color":"#000000","x":1090,"y":400,"wires":[]},{"id":"a2b9ea5f.28d778","type":"ui_text","z":"934099b7.c96bb8","group":"cca89ca3.f14d7","order":17,"width":7,"height":1,"name":"","label":"[ °C ]","format":"","layout":"row-center","className":"unidades","style":true,"font":"","fontSize":16,"color":"#000000","x":1570,"y":400,"wires":[]},{"id":"1ac704e4.11b10b","type":"ui_text","z":"934099b7.c96bb8","group":"cca89ca3.f14d7","order":21,"width":6,"height":1,"name":"","label":"[ % ]","format":"","layout":"row-center","className":"unidades","style":true,"font":"","fontSize":16,"color":"#000000","x":1090,"y":540,"wires":[]},{"id":"8963acce.691d1","type":"ui_text","z":"934099b7.c96bb8","group":"cca89ca3.f14d7","order":22,"width":7,"height":1,"name":"","label":"[ % ]","format":"","layout":"row-center","className":"unidades","style":true,"font":"","fontSize":16,"color":"#000000","x":1570,"y":540,"wires":[]},{"id":"7c082b9d.15afb4","type":"ui_text","z":"934099b7.c96bb8","group":"cca89ca3.f14d7","order":26,"width":6,"height":1,"name":"","label":"[ Kg ]","format":"","layout":"row-center","className":"unidades","style":true,"font":"","fontSize":16,"color":"#000000","x":1090,"y":680,"wires":[]},{"id":"add3d7fd.e721f8","type":"ui_text","z":"934099b7.c96bb8","group":"cca89ca3.f14d7","order":27,"width":7,"height":1,"name":"","label":"[ % ]","format":"","layout":"row-center","className":"unidades","style":true,"font":"","fontSize":16,"color":"#000000","x":1570,"y":680,"wires":[]},{"id":"e51c95c7.1c2878","type":"ui_template","z":"934099b7.c96bb8","group":"cca89ca3.f14d7","name":"","order":2,"width":2,"height":1,"format":"<div style=\"{{msg.payload.style}};\">\n    <h3 style=\"{{msg.payload.style}}\">Torre 1</h3>\n    <p style=\"{{msg.payload.style}}\">{{msg.payload.value}}</p>\n</div>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","className":"","x":1060,"y":60,"wires":[[]]},{"id":"a33dfd1f.5e728","type":"ui_template","z":"934099b7.c96bb8","group":"cca89ca3.f14d7","name":"","order":3,"width":2,"height":1,"format":"<div style=\"{{msg.payload.style}};\">\n    <h3 style=\"{{msg.payload.style}}\">Torre 2</h3>\n    <p style=\"{{msg.payload.style}}\">{{msg.payload.value}}</p>\n</div>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","className":"","x":1060,"y":100,"wires":[[]]},{"id":"733b26ae.1f40c8","type":"function","z":"934099b7.c96bb8","name":"Evaluar torre 1","func":"let torre = global.get('torre') || 'Error';\n\nif (torre === \"1\") {\n    msg.payload = {\n        style: 'background-color: #00ABE5 !important; font-size: 14px;text-align: center;color: white !important',\n        value: 'ON'\n    };\n} else {\n    msg.payload = {\n        style: 'background-color: #B0B6BD !important;font-size: 14px;text-align: center;color: white !important;',\n        value: 'OFF'\n    };\n}\nreturn msg;\n\n\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":860,"y":60,"wires":[["e51c95c7.1c2878"]]},{"id":"2a63b0b3.4d71","type":"function","z":"934099b7.c96bb8","name":"Evaluar torre 2","func":"let torre = global.get('torre') || 'Error';\n\nif (torre === \"2\") {\n    msg.payload = {\n        style: 'background-color: #00ABE5 !important; font-size: 14px;text-align: center;color: white !important;',\n        value: 'ON'\n    };\n} else {\n    msg.payload = {\n        style: 'background-color: #B0B6BD !important;font-size: 14px;text-align: center;color: white !important;',\n        value: 'OFF'\n    };\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":860,"y":100,"wires":[["a33dfd1f.5e728"]]},{"id":"58176b05.94ad04","type":"change","z":"804acb1a.0445f8","name":"Set filename","rules":[{"t":"set","p":"filename","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1410,"y":700,"wires":[["17de3b32.ea0eb5"]]},{"id":"873abf25.9bef9","type":"file","z":"804acb1a.0445f8","name":"CSV sensor_hum1","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"false","encoding":"none","x":1050,"y":1560,"wires":[[]]},{"id":"bfdd19b5.1c4158","type":"function","z":"804acb1a.0445f8","name":"Formato de CSV y de filename","func":"var filename = global.get('filename') || 'No value';\nfilename = filename.slice(0, -4) + \"_hum1.csv\";\nlet value =  msg.payload;\nlet timestamp = new Date().toISOString();\n\nvar csvLine = value + \", \" + timestamp + \"\\n\";\n\nmsg.filename = filename\n// msg.payload = csvLine;\n\nmsg.payload = {\n    value: msg.payload,\n    timestamp: new Date().toISOString(),\n};\n\n\n//Que solo guarde cuando este running en true\nvar running = global.get('running') || false;\n\nif (running === true) {\n    return msg;\n} else {\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":490,"y":1560,"wires":[["378559f9.f82526","9d5ad14c.fa85b"]]},{"id":"74cff098.dbc4b","type":"file","z":"804acb1a.0445f8","name":"Borrar ingresando el nombre","filename":"Estandar_20241001_101134_temp1.csv","appendNewline":true,"createDir":true,"overwriteFile":"delete","encoding":"none","x":480,"y":1680,"wires":[[]]},{"id":"378559f9.f82526","type":"debug","z":"804acb1a.0445f8","name":"Nombre y datos del archivo guardado","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":850,"y":1520,"wires":[]},{"id":"95d4e95.262f618","type":"file in","z":"804acb1a.0445f8","name":"Cargar archivo del historial con el nombre","filename":"Estandar_20240930_111940_temp1.csv","format":"utf8","chunk":false,"sendError":false,"encoding":"none","x":540,"y":1640,"wires":[["324c7219.f6a7be"]]},{"id":"324c7219.f6a7be","type":"debug","z":"804acb1a.0445f8","name":"cargar archivo donde se guarda temp1 para validar datos","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":950,"y":1640,"wires":[]},{"id":"9d5ad14c.fa85b","type":"csv","z":"804acb1a.0445f8","name":"Convertir a CSV","sep":",","hdrin":false,"hdrout":"none","multi":"one","ret":"\\n","temp":"value,timestamp","skip":"0","strings":true,"include_empty_strings":false,"include_null_values":false,"x":780,"y":1560,"wires":[["873abf25.9bef9"]]},{"id":"da999aeb.444288","type":"inject","z":"804acb1a.0445f8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":260,"y":1640,"wires":[["95d4e95.262f618"]]},{"id":"e9dc595c.5485f8","type":"inject","z":"804acb1a.0445f8","name":"Delete","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":250,"y":1680,"wires":[["74cff098.dbc4b"]]},{"id":"9275584a.b20188","type":"file","z":"804acb1a.0445f8","name":"CSV sensor_hum2","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"false","encoding":"none","x":2250,"y":1540,"wires":[[]]},{"id":"29463ec7.cad192","type":"function","z":"804acb1a.0445f8","name":"Formato de CSV y de filename","func":"var filename = global.get('filename') || 'No value';\nfilename = filename.slice(0, -4) + \"_hum2.csv\";\nlet value =  msg.payload;\nlet timestamp = new Date().toISOString();\n\nvar csvLine = value + \", \" + timestamp + \"\\n\";\n\nmsg.filename = filename\n// msg.payload = csvLine;\n\nmsg.payload = {\n    value: msg.payload,\n    timestamp: new Date().toISOString(),\n};\n\n\n//Que solo guarde cuando este running en true\nvar running = global.get('running') || false;\n\nif (running === true) {\n    return msg;\n} else {\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1690,"y":1540,"wires":[["96690789.964e48","986313d0.3b082"]]},{"id":"7bb94b81.9927e4","type":"file","z":"804acb1a.0445f8","name":"Borrar ingresando el nombre","filename":"Estandar_20241001_101134_temp1.csv","appendNewline":true,"createDir":true,"overwriteFile":"delete","encoding":"none","x":1680,"y":1660,"wires":[[]]},{"id":"96690789.964e48","type":"debug","z":"804acb1a.0445f8","name":"Nombre y datos del archivo guardado","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2050,"y":1500,"wires":[]},{"id":"d881806a.caf3d","type":"file in","z":"804acb1a.0445f8","name":"Cargar archivo del historial con el nombre","filename":"Estandar_20240930_111940_temp1.csv","format":"utf8","chunk":false,"sendError":false,"encoding":"none","x":1740,"y":1620,"wires":[["a70b19d4.2067c8"]]},{"id":"a70b19d4.2067c8","type":"debug","z":"804acb1a.0445f8","name":"cargar archivo donde se guarda temp1 para validar datos","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2150,"y":1620,"wires":[]},{"id":"986313d0.3b082","type":"csv","z":"804acb1a.0445f8","name":"Convertir a CSV","sep":",","hdrin":false,"hdrout":"none","multi":"one","ret":"\\n","temp":"value,timestamp","skip":"0","strings":true,"include_empty_strings":false,"include_null_values":false,"x":1980,"y":1540,"wires":[["9275584a.b20188"]]},{"id":"705a589e.f43fc8","type":"inject","z":"804acb1a.0445f8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1460,"y":1620,"wires":[["d881806a.caf3d"]]},{"id":"abbbd887.5a13c8","type":"inject","z":"804acb1a.0445f8","name":"Delete","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1450,"y":1660,"wires":[["7bb94b81.9927e4"]]},{"id":"4457b5af.c468fc","type":"file","z":"804acb1a.0445f8","name":"CSV sensor_weight1","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"false","encoding":"none","x":1080,"y":1840,"wires":[[]]},{"id":"baf0b603.be3d48","type":"function","z":"804acb1a.0445f8","name":"Formato de CSV y de filename","func":"var filename = global.get('filename') || 'No value';\nfilename = filename.slice(0, -4) + \"_weight1.csv\";\nlet value =  msg.payload;\nlet timestamp = new Date().toISOString();\n\nvar csvLine = value + \", \" + timestamp + \"\\n\";\n\nmsg.filename = filename\n// msg.payload = csvLine;\n\nmsg.payload = {\n    value: msg.payload,\n    timestamp: new Date().toISOString(),\n};\n\n\n//Que solo guarde cuando este running en true\nvar running = global.get('running') || false;\n\nif (running === true) {\n    return msg;\n} else {\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":510,"y":1840,"wires":[["295f3577.4c858a","a77e59e5.158a78"]]},{"id":"a149bd06.35362","type":"file","z":"804acb1a.0445f8","name":"Borrar ingresando el nombre","filename":"Estandar_20241001_101134_temp1.csv","appendNewline":true,"createDir":true,"overwriteFile":"delete","encoding":"none","x":500,"y":1960,"wires":[[]]},{"id":"295f3577.4c858a","type":"debug","z":"804acb1a.0445f8","name":"Nombre y datos del archivo guardado","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":870,"y":1800,"wires":[]},{"id":"7c0f3be8.b7dff4","type":"file in","z":"804acb1a.0445f8","name":"Cargar archivo del historial con el nombre","filename":"Estandar_20240930_111940_temp1.csv","format":"utf8","chunk":false,"sendError":false,"encoding":"none","x":560,"y":1920,"wires":[["292fccf9.d6a1d4"]]},{"id":"292fccf9.d6a1d4","type":"debug","z":"804acb1a.0445f8","name":"cargar archivo donde se guarda temp1 para validar datos","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":970,"y":1920,"wires":[]},{"id":"a77e59e5.158a78","type":"csv","z":"804acb1a.0445f8","name":"Convertir a CSV","sep":",","hdrin":false,"hdrout":"none","multi":"one","ret":"\\n","temp":"value,timestamp","skip":"0","strings":true,"include_empty_strings":false,"include_null_values":false,"x":800,"y":1840,"wires":[["4457b5af.c468fc"]]},{"id":"efd632c3.1feb8","type":"inject","z":"804acb1a.0445f8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":280,"y":1920,"wires":[["7c0f3be8.b7dff4"]]},{"id":"94a33fb8.823ea","type":"inject","z":"804acb1a.0445f8","name":"Delete","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":270,"y":1960,"wires":[["a149bd06.35362"]]},{"id":"166df62a.77f9ba","type":"file","z":"804acb1a.0445f8","name":"Borrar ingresando el nombre","filename":"Estandar_20241001_101134_temp1.csv","appendNewline":true,"createDir":true,"overwriteFile":"delete","encoding":"none","x":1680,"y":1960,"wires":[[]]},{"id":"581cfac6.6c0f04","type":"file in","z":"804acb1a.0445f8","name":"Cargar archivo del historial con el nombre","filename":"Estandar_20240930_111940_temp1.csv","format":"utf8","chunk":false,"sendError":false,"encoding":"none","x":1740,"y":1920,"wires":[["f4a03900.6b5bd8"]]},{"id":"f4a03900.6b5bd8","type":"debug","z":"804acb1a.0445f8","name":"cargar archivo donde se guarda temp1 para validar datos","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2150,"y":1920,"wires":[]},{"id":"667fc148.a994d","type":"inject","z":"804acb1a.0445f8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1460,"y":1920,"wires":[["581cfac6.6c0f04"]]},{"id":"1c76429a.9ffb0d","type":"inject","z":"804acb1a.0445f8","name":"Delete","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1450,"y":1960,"wires":[["166df62a.77f9ba"]]},{"id":"a14e48bd.2a68c8","type":"file","z":"804acb1a.0445f8","name":"CSV sensor_tempr","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"false","encoding":"none","x":1670,"y":2240,"wires":[[]]},{"id":"1db130e5.99bc3f","type":"function","z":"804acb1a.0445f8","name":"Formato de CSV y de filename","func":"var filename = global.get('filename') || 'No value';\nfilename = filename.slice(0, -4) + \"_tempr.csv\";\nlet value =  msg.payload;\nlet timestamp = new Date().toISOString();\n\nvar csvLine = value + \", \" + timestamp + \"\\n\";\n\nmsg.filename = filename\n// msg.payload = csvLine;\n\nmsg.payload = {\n    value: msg.payload,\n    timestamp: new Date().toISOString(),\n};\n\n\n//Que solo guarde cuando este running en true\nvar running = global.get('running') || false;\n\nif (running === true) {\n    return msg;\n} else {\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1110,"y":2240,"wires":[["44fd26e3.a4d698","b6af1c3e.cf8e4"]]},{"id":"2838e52a.674d2a","type":"file","z":"804acb1a.0445f8","name":"Borrar ingresando el nombre","filename":"Estandar_20241001_101134_temp1.csv","appendNewline":true,"createDir":true,"overwriteFile":"delete","encoding":"none","x":1100,"y":2360,"wires":[[]]},{"id":"44fd26e3.a4d698","type":"debug","z":"804acb1a.0445f8","name":"Nombre y datos del archivo guardado","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1470,"y":2200,"wires":[]},{"id":"bed8d5a4.7b6758","type":"file in","z":"804acb1a.0445f8","name":"Cargar archivo del historial con el nombre","filename":"Estandar_20240930_111940_temp1.csv","format":"utf8","chunk":false,"sendError":false,"encoding":"none","x":1160,"y":2320,"wires":[["173483db.0ae6bc"]]},{"id":"173483db.0ae6bc","type":"debug","z":"804acb1a.0445f8","name":"cargar archivo donde se guarda temp1 para validar datos","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1570,"y":2320,"wires":[]},{"id":"b6af1c3e.cf8e4","type":"csv","z":"804acb1a.0445f8","name":"Convertir a CSV","sep":",","hdrin":false,"hdrout":"none","multi":"one","ret":"\\n","temp":"value,timestamp","skip":"0","strings":true,"include_empty_strings":false,"include_null_values":false,"x":1400,"y":2240,"wires":[["a14e48bd.2a68c8"]]},{"id":"f462beab.fe809","type":"inject","z":"804acb1a.0445f8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":880,"y":2320,"wires":[["bed8d5a4.7b6758"]]},{"id":"14b2c8ad.e9e3f7","type":"inject","z":"804acb1a.0445f8","name":"Delete","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":870,"y":2360,"wires":[["2838e52a.674d2a"]]},{"id":"96618179.1dda5","type":"file","z":"804acb1a.0445f8","name":"CSV sensor_humr","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"false","encoding":"none","x":1690,"y":2500,"wires":[[]]},{"id":"f7588c78.af7e2","type":"function","z":"804acb1a.0445f8","name":"Formato de CSV y de filename","func":"var filename = global.get('filename') || 'No value';\nfilename = filename.slice(0, -4) + \"_humr.csv\";\nlet value =  msg.payload;\nlet timestamp = new Date().toISOString();\n\nvar csvLine = value + \", \" + timestamp + \"\\n\";\n\nmsg.filename = filename\n// msg.payload = csvLine;\n\nmsg.payload = {\n    value: msg.payload,\n    timestamp: new Date().toISOString(),\n};\n\n\n//Que solo guarde cuando este running en true\nvar running = global.get('running') || false;\n\nif (running === true) {\n    return msg;\n} else {\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1130,"y":2500,"wires":[["798bd711.8296d8","261b2029.b1f82"]]},{"id":"6ad32d0.21719d4","type":"file","z":"804acb1a.0445f8","name":"Borrar ingresando el nombre","filename":"Estandar_20241001_101134_temp1.csv","appendNewline":true,"createDir":true,"overwriteFile":"delete","encoding":"none","x":1120,"y":2620,"wires":[[]]},{"id":"798bd711.8296d8","type":"debug","z":"804acb1a.0445f8","name":"Nombre y datos del archivo guardado","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1490,"y":2460,"wires":[]},{"id":"651caa35.0fc414","type":"file in","z":"804acb1a.0445f8","name":"Cargar archivo del historial con el nombre","filename":"Estandar_20240930_111940_temp1.csv","format":"utf8","chunk":false,"sendError":false,"encoding":"none","x":1180,"y":2580,"wires":[["576b9a98.a26824"]]},{"id":"576b9a98.a26824","type":"debug","z":"804acb1a.0445f8","name":"cargar archivo donde se guarda temp1 para validar datos","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1590,"y":2580,"wires":[]},{"id":"261b2029.b1f82","type":"csv","z":"804acb1a.0445f8","name":"Convertir a CSV","sep":",","hdrin":false,"hdrout":"none","multi":"one","ret":"\\n","temp":"value,timestamp","skip":"0","strings":true,"include_empty_strings":false,"include_null_values":false,"x":1420,"y":2500,"wires":[["96618179.1dda5"]]},{"id":"8a0585f7.600a68","type":"inject","z":"804acb1a.0445f8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":900,"y":2580,"wires":[["651caa35.0fc414"]]},{"id":"5d4e31e3.4435f","type":"inject","z":"804acb1a.0445f8","name":"Delete","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":890,"y":2620,"wires":[["6ad32d0.21719d4"]]},{"id":"3b666083.18a4b","type":"file","z":"804acb1a.0445f8","name":"CSV sensor_humext","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"false","encoding":"none","x":1700,"y":2760,"wires":[[]]},{"id":"236fbf82.5e9b","type":"function","z":"804acb1a.0445f8","name":"Formato de CSV y de filename","func":"var filename = global.get('filename') || 'No value';\nfilename = filename.slice(0, -4) + \"_humext.csv\";\nlet value =  msg.payload;\nlet timestamp = new Date().toISOString();\n\nvar csvLine = value + \", \" + timestamp + \"\\n\";\n\nmsg.filename = filename\n// msg.payload = csvLine;\n\nmsg.payload = {\n    value: msg.payload,\n    timestamp: new Date().toISOString(),\n};\n\n\n//Que solo guarde cuando este running en true\nvar running = global.get('running') || false;\n\nif (running === true) {\n    return msg;\n} else {\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1130,"y":2760,"wires":[["92f31cbd.ba526","4626cf2c.c917f"]]},{"id":"ef3a67ee.782f58","type":"file","z":"804acb1a.0445f8","name":"Borrar ingresando el nombre","filename":"Estandar_20241001_101134_temp1.csv","appendNewline":true,"createDir":true,"overwriteFile":"delete","encoding":"none","x":1120,"y":2880,"wires":[[]]},{"id":"92f31cbd.ba526","type":"debug","z":"804acb1a.0445f8","name":"Nombre y datos del archivo guardado","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1490,"y":2720,"wires":[]},{"id":"81e94ec.a7845b","type":"file in","z":"804acb1a.0445f8","name":"Cargar archivo del historial con el nombre","filename":"Estandar_20240930_111940_temp1.csv","format":"utf8","chunk":false,"sendError":false,"encoding":"none","x":1180,"y":2840,"wires":[["d83fac85.cc939"]]},{"id":"d83fac85.cc939","type":"debug","z":"804acb1a.0445f8","name":"cargar archivo donde se guarda temp1 para validar datos","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1590,"y":2840,"wires":[]},{"id":"4626cf2c.c917f","type":"csv","z":"804acb1a.0445f8","name":"Convertir a CSV","sep":",","hdrin":false,"hdrout":"none","multi":"one","ret":"\\n","temp":"value,timestamp","skip":"0","strings":true,"include_empty_strings":false,"include_null_values":false,"x":1420,"y":2760,"wires":[["3b666083.18a4b"]]},{"id":"c1832ebf.7280e","type":"inject","z":"804acb1a.0445f8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":900,"y":2840,"wires":[["81e94ec.a7845b"]]},{"id":"d25b46ac.2b6e68","type":"inject","z":"804acb1a.0445f8","name":"Delete","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":890,"y":2880,"wires":[["ef3a67ee.782f58"]]},{"id":"9bd8a2aa.c8f56","type":"ui_button","z":"34168811.ab73a8","name":"","group":"f98bd4ef.b5b8a8","order":3,"width":5,"height":1,"passthru":false,"label":"Principal","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":140,"y":260,"wires":[["6242cad6.0213b4"]]},{"id":"938ef4f8.ea8818","type":"ui_button","z":"34168811.ab73a8","name":"","group":"f98bd4ef.b5b8a8","order":5,"width":5,"height":1,"passthru":false,"label":"Graficas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":140,"y":320,"wires":[["314c4345.f043dc"]]},{"id":"9779373e.c75188","type":"ui_button","z":"34168811.ab73a8","name":"","group":"f98bd4ef.b5b8a8","order":11,"width":5,"height":1,"passthru":false,"label":"Recetas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":140,"y":380,"wires":[["4afaf7de.f48f88"]]},{"id":"cfaf2f96.e22ce","type":"ui_button","z":"34168811.ab73a8","name":"","group":"f98bd4ef.b5b8a8","order":25,"width":5,"height":1,"passthru":false,"label":"Configuración","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":160,"y":500,"wires":[["4686df20.3e5b7"]]},{"id":"821d3a43.0626d8","type":"ui_media","z":"34168811.ab73a8","group":"f98bd4ef.b5b8a8","name":"logo_penagos","width":5,"height":2,"order":1,"category":"logos","file":"logo_penagos.png","layout":"center","showcontrols":true,"loop":true,"onstart":false,"scope":"local","tooltip":"","x":160,"y":200,"wires":[[]]},{"id":"47a7e353.51e86c","type":"ui_media","z":"34168811.ab73a8","group":"f98bd4ef.b5b8a8","name":"logo_aciv","width":5,"height":2,"order":35,"category":"logo_aciv","file":"logo_aciv.png","layout":"center","showcontrols":true,"loop":true,"onstart":false,"scope":"local","tooltip":"","x":140,"y":560,"wires":[[]]},{"id":"993c1ab9.7406a8","type":"ui_button","z":"34168811.ab73a8","name":"","group":"f98bd4ef.b5b8a8","order":32,"width":5,"height":2,"passthru":false,"label":"Parada de emergencia","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":180,"y":620,"wires":[["d9004061.f757d"]]},{"id":"78c5e765.b9cd78","type":"ui_text_input","z":"34168811.ab73a8","name":"Tiempo de prueba 2","label":"Tiempo de prueba","tooltip":"ingresar en segundos","group":"f98bd4ef.b5b8a8","order":16,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"topic","sendOnBlur":true,"className":"","topicType":"msg","x":720,"y":400,"wires":[[]]},{"id":"da598bdc.40b6b8","type":"ui_text_input","z":"34168811.ab73a8","name":"Tiempo de prueba 1","label":"Tiempo de prueba","tooltip":"ingresar en segundos","group":"f98bd4ef.b5b8a8","order":23,"width":3,"height":1,"passthru":true,"mode":"text","delay":300,"topic":"topic","sendOnBlur":true,"className":"","topicType":"msg","x":720,"y":320,"wires":[[]]},{"id":"8f8fe4cd.272e98","type":"comment","z":"47a745ac.9f83dc","name":"Ruta SD","info":"","x":160,"y":1540,"wires":[]},{"id":"5b595c73.418114","type":"function","z":"47a745ac.9f83dc","name":"Global Actualizaar a ruta de la SD del plc","func":"ruta_sd_ok = \"run/media/mmcblk0p1/\"\nglobal.set('ruta_sd', ruta_sd_ok);\nreturn null;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":430,"y":1580,"wires":[[]]},{"id":"e0100f16.594bd","type":"inject","z":"47a745ac.9f83dc","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":180,"y":1580,"wires":[["5b595c73.418114"]]},{"id":"9a02069b.5c2528","type":"comment","z":"47a745ac.9f83dc","name":"MODIFICADO PENAGOS","info":"1. Pestaña PLC Ruta SD\n2. Pestaña estandar en format del csv...\n3. Pestaña Datos en formato del csv...","x":210,"y":1500,"wires":[]},{"id":"788c600a.f184e","type":"function","z":"47a745ac.9f83dc","name":"Obtener variable global","func":"let torre1 = global.get('torre') || 'Error';\nmsg.payload = torre1\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":370,"y":1620,"wires":[["c35fc934.0dddf8"]]},{"id":"c35fc934.0dddf8","type":"debug","z":"47a745ac.9f83dc","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":590,"y":1620,"wires":[]},{"id":"6a6363a3.f6cb1c","type":"inject","z":"47a745ac.9f83dc","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":170,"y":1620,"wires":[["788c600a.f184e"]]},{"id":"939a9ceb.47d3f","type":"function","z":"e69d9ae9.d86958","name":"Formatear para el historial","func":"let filename_proceso_a_guardar = global.get('filename'); // Obtener el nombre del archivo de flow\nmsg.payload = filename_proceso_a_guardar\n\nlet ruta_sd = global.get('ruta_sd');\nruta_sd = `${ruta_sd}historial_procesos.csv`;\nmsg.filename = ruta_sd\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":930,"y":920,"wires":[["f77fb586.b4ddc8"]]},{"id":"e5c4acb5.94f3b","type":"comment","z":"ff06c4a0.7e7488","name":"MODIFICADO PENAGOS","info":"","x":870,"y":160,"wires":[]},{"id":"b415d346.18c55","type":"function","z":"ff06c4a0.7e7488","name":"Formatear para el historial","func":"let ruta_sd = global.get('ruta_sd');\nruta_sd = `${ruta_sd}historial_procesos_estandar.csv`;\nmsg.filename = ruta_sd\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":870,"y":200,"wires":[["f7fac291.61ae7"]]},{"id":"a9f10d47.6904","type":"link out","z":"e69d9ae9.d86958","name":"Button principal","links":["d3164bb5.dc7108"],"x":415,"y":220,"wires":[]},{"id":"d3164bb5.dc7108","type":"link in","z":"1d0b3b5c.03ac95","name":"Button principal","links":["95d44688.a48288","a9f10d47.6904","74dd129c.fddd3c","d3597978.502b88","21fefe5.c97ac02","6242cad6.0213b4","e44acab5.aee728","8b27ca73.59bcd8","a8f56c94.6f49f"],"x":295,"y":320,"wires":[["26d0d9b7.7c13e6"]]},{"id":"95d44688.a48288","type":"link out","z":"934099b7.c96bb8","name":"Button principal","links":["d3164bb5.dc7108"],"x":475,"y":360,"wires":[]},{"id":"74dd129c.fddd3c","type":"link out","z":"804acb1a.0445f8","name":"Button principal","links":["d3164bb5.dc7108"],"x":435,"y":320,"wires":[]},{"id":"d3597978.502b88","type":"link out","z":"ff06c4a0.7e7488","name":"Button principal","links":["d3164bb5.dc7108"],"x":455,"y":280,"wires":[]},{"id":"6242cad6.0213b4","type":"link out","z":"34168811.ab73a8","name":"Button principal","links":["d3164bb5.dc7108"],"x":375,"y":260,"wires":[]},{"id":"e44acab5.aee728","type":"link out","z":"93a187c.3811378","name":"Button principal","links":["d3164bb5.dc7108"],"x":315,"y":500,"wires":[]},{"id":"33d4c9f5.adb4f6","type":"link in","z":"1d0b3b5c.03ac95","name":"Button estadisticas","links":["2bd0b403.3cacac","314c4345.f043dc","3c2cab71.e64254","5788e238.1d011c","60276072.0d242","819f2115.a48c7","9aec228e.be17e","2f13f17f.a10aae","29e8bb1c.ba6244","7a673e7e.0f11f"],"x":295,"y":400,"wires":[["b85c7e03.e66dd","617c66f2.4a60f8"]]},{"id":"60276072.0d242","type":"link out","z":"e69d9ae9.d86958","name":"Button estadisticas","links":["33d4c9f5.adb4f6"],"x":415,"y":280,"wires":[]},{"id":"819f2115.a48c7","type":"link out","z":"934099b7.c96bb8","name":"Button estadisticas","links":["33d4c9f5.adb4f6"],"x":475,"y":420,"wires":[]},{"id":"3c2cab71.e64254","type":"link out","z":"804acb1a.0445f8","name":"Button estadisticas","links":["33d4c9f5.adb4f6"],"x":435,"y":380,"wires":[]},{"id":"5788e238.1d011c","type":"link out","z":"cf6e4dbe.06b5d","name":"Button estadisticas","links":["33d4c9f5.adb4f6"],"x":275,"y":220,"wires":[]},{"id":"9aec228e.be17e","type":"link out","z":"ff06c4a0.7e7488","name":"Button estadisticas","links":["33d4c9f5.adb4f6"],"x":455,"y":340,"wires":[]},{"id":"314c4345.f043dc","type":"link out","z":"34168811.ab73a8","name":"Button estadisticas","links":["33d4c9f5.adb4f6"],"x":375,"y":320,"wires":[]},{"id":"dab5ee12.f38","type":"link in","z":"1d0b3b5c.03ac95","name":"Button datos","links":["4af850f1.fa451","529e3ce.f495bc4","37cc59a4.8c53e6","97a4b076.4fce7","72373d7f.625d74","a04f9ded.f8497","4afaf7de.f48f88","729ad47.345f02c","c6c3788f.f71b88","849d2267.2f744","6b8d47c5.e109d8","7a5cac53.b1db34","6372c0a3.2dadd","a1dda215.8f912","a71c64d5.aa5608"],"x":295,"y":520,"wires":[["7bc8ecdc.52f344"]]},{"id":"4af850f1.fa451","type":"link out","z":"e69d9ae9.d86958","name":"Button datos","links":["dab5ee12.f38","1b53150c.dee5bb","3b0829d3.a227c6","1d88f23.8ead40e","387f3ab9.b7b4b6"],"x":415,"y":340,"wires":[]},{"id":"529e3ce.f495bc4","type":"link out","z":"934099b7.c96bb8","name":"Button datos","links":["dab5ee12.f38","1b53150c.dee5bb","3b0829d3.a227c6","1d88f23.8ead40e","387f3ab9.b7b4b6"],"x":475,"y":480,"wires":[]},{"id":"37cc59a4.8c53e6","type":"link out","z":"804acb1a.0445f8","name":"Button datos","links":["dab5ee12.f38","1b53150c.dee5bb","3b0829d3.a227c6","1d88f23.8ead40e","387f3ab9.b7b4b6"],"x":435,"y":440,"wires":[]},{"id":"97a4b076.4fce7","type":"link out","z":"cf6e4dbe.06b5d","name":"Button datos","links":["dab5ee12.f38","1b53150c.dee5bb","3b0829d3.a227c6","1d88f23.8ead40e","387f3ab9.b7b4b6"],"x":275,"y":280,"wires":[]},{"id":"72373d7f.625d74","type":"link out","z":"ff06c4a0.7e7488","name":"Button datos","links":["dab5ee12.f38","1d88f23.8ead40e","387f3ab9.b7b4b6"],"x":455,"y":400,"wires":[]},{"id":"4afaf7de.f48f88","type":"link out","z":"34168811.ab73a8","name":"Button datos","links":["dab5ee12.f38","1b53150c.dee5bb","3b0829d3.a227c6","1d88f23.8ead40e","387f3ab9.b7b4b6"],"x":375,"y":380,"wires":[]},{"id":"1b53150c.dee5bb","type":"link in","z":"ff06c4a0.7e7488","name":"Button datos","links":["37cc59a4.8c53e6","4af850f1.fa451","4afaf7de.f48f88","529e3ce.f495bc4","729ad47.345f02c","97a4b076.4fce7","a04f9ded.f8497","c6c3788f.f71b88","521f92ee.fe5e2c"],"x":655,"y":200,"wires":[["b415d346.18c55"]]},{"id":"771e4305.4ae1ec","type":"link in","z":"1d0b3b5c.03ac95","name":"Button configuracion","links":["6ab152b1.45c88c","c75434eb.e70498","c0da2056.20b2b","e7a9ec60.72339","a893e799.4a4e18","fccea8ff.1ce958","4686df20.3e5b7","e9ee7f83.be80c","79f2dd2e.38df54"],"x":295,"y":740,"wires":[["b9a33bbe.0fb0a8"]]},{"id":"c75434eb.e70498","type":"link out","z":"934099b7.c96bb8","name":"Button configuracion","links":["771e4305.4ae1ec"],"x":475,"y":600,"wires":[]},{"id":"c0da2056.20b2b","type":"link out","z":"804acb1a.0445f8","name":"Button configuracion","links":["771e4305.4ae1ec"],"x":435,"y":560,"wires":[]},{"id":"e7a9ec60.72339","type":"link out","z":"cf6e4dbe.06b5d","name":"Button configuracion","links":["771e4305.4ae1ec"],"x":275,"y":420,"wires":[]},{"id":"a893e799.4a4e18","type":"link out","z":"ff06c4a0.7e7488","name":"Button configuracion","links":["771e4305.4ae1ec"],"x":455,"y":520,"wires":[]},{"id":"4686df20.3e5b7","type":"link out","z":"34168811.ab73a8","name":"Button configuracion","links":["771e4305.4ae1ec"],"x":375,"y":500,"wires":[]},{"id":"a521d39a.e8ad6","type":"link in","z":"1d0b3b5c.03ac95","name":"Button parada de emergencia","links":["35f21ae4.e6fc36","b0bdd605.06c9f8","6699cef0.823b8","8b518f64.d8c24","6b8aed87.965a04","7074215d.8438e","d9004061.f757d","a19ffe9f.0f16","a2c06e3c.4067c"],"x":295,"y":840,"wires":[["c5d10038.d6d92","a6084bff.c423c8"]]},{"id":"35f21ae4.e6fc36","type":"link out","z":"e69d9ae9.d86958","name":"Button parada de emergencia","links":["a521d39a.e8ad6"],"x":415,"y":580,"wires":[]},{"id":"b0bdd605.06c9f8","type":"link out","z":"934099b7.c96bb8","name":"Button parada de emergencia","links":["a521d39a.e8ad6"],"x":475,"y":720,"wires":[]},{"id":"6699cef0.823b8","type":"link out","z":"804acb1a.0445f8","name":"Button parada de emergencia","links":["a521d39a.e8ad6"],"x":435,"y":680,"wires":[]},{"id":"8b518f64.d8c24","type":"link out","z":"cf6e4dbe.06b5d","name":"Button parada de emergencia","links":["a521d39a.e8ad6"],"x":275,"y":540,"wires":[]},{"id":"6b8aed87.965a04","type":"link out","z":"ff06c4a0.7e7488","name":"Button parada de emergencia","links":["a521d39a.e8ad6"],"x":455,"y":640,"wires":[]},{"id":"d9004061.f757d","type":"link out","z":"34168811.ab73a8","name":"Button parada de emergencia","links":["a521d39a.e8ad6"],"x":375,"y":620,"wires":[]},{"id":"e48197c8.09b118","type":"change","z":"1d0b3b5c.03ac95","name":"Pruebas","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"Pruebas\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":660,"y":880,"wires":[["eba4845.1081378"]]},{"id":"eba4845.1081378","type":"ui_ui_control","z":"1d0b3b5c.03ac95","name":"","events":"all","x":880,"y":880,"wires":[[]]},{"id":"40e86f4a.d4103","type":"function","z":"ff06c4a0.7e7488","name":"Global Obtener nombres de archivos","func":"//formato correcto\nlet lines = msg.payload.split('\\n');\nlet filenamesMap = {};\nlet filenames = lines.map(line => {\n    let trimmedName = line.trim();\n    \n// Extraer la parte del nombre que contiene \"Estandar_\"\nlet index = trimmedName.indexOf('/Estandar_');\nif (index !== -1) {\n    let filename = trimmedName.substring(index + 1);  // Solo toma desde \"/Estandar_\" en adelante\n    \n    // Remover la extensión .csv\n    let filenameWithoutExt = filename.replace('.csv', '');\n    \n    // Separar el nombre para darle el formato adecuado\n    let parts = filenameWithoutExt.split('_');  // Separar en \"Estandar\", fecha y hora\n    \n    if (parts.length === 3) {\n        let date = parts[1];  // Fecha en formato AAAAMMDD\n        let time = parts[2];  // Hora en formato HHMMSS\n        \n        // Formatear hora y fecha\n        let formattedTime = `${time.slice(0, 2)}:${time.slice(2, 4)}:${time.slice(4, 6)}`; // HH:MM:SS\n        let formattedDate = `${date.slice(6, 8)}/${date.slice(4, 6)}/${date.slice(0, 4)}`; // DD/MM/YYYY\n        \n        let formattedName = `${formattedTime} - ${formattedDate} - ${parts[0]}`;  // Ejemplo: \"12:25:36 09/10/2024 Estandar\"\n        \n        filenamesMap[formattedName] = filename;  // Mapear el nombre formateado con el nombre original\n        return formattedName;\n    }\n}\nreturn '';  // Si no contiene \"Estandar_\", retorna una cadena vacía\n}).filter(name => name !== '');  // Filtrar nombres vacíos\n\n// Invertir el orden de los nombres\nfilenames.reverse();\n\n// Guardar el mapeo en el contexto global\nglobal.set('filenamesMap', filenamesMap);\n\nmsg.options = filenames;  // Solo un arreglo de strings\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":890,"y":340,"wires":[["eb32831c.e198c"]]},{"id":"8215cc9e.4eb61","type":"function","z":"ff06c4a0.7e7488","name":"Recuperar nombre original","func":"let filenamesMap = global.get('filenamesMap');\nlet selectedFormattedName = msg.payload;  // El nombre formateado seleccionado\n\n// Recuperar el nombre original del archivo\nlet originalFilename = filenamesMap[selectedFormattedName];\nif (originalFilename) {\n    let ruta_sd = global.get('ruta_sd');  // Obtener la ruta base\n    msg.filename = `${ruta_sd}${originalFilename}`;  // Construir la ruta completa\n    return msg;\n} else {\n    node.error('No se encontró el archivo original para la selección: ' + selectedFormattedName);\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":860,"y":480,"wires":[["57fda91a.8e2c88"]]},{"id":"12c2652e.d7922b","type":"function","z":"804acb1a.0445f8","name":"Agregar _variable.csv","func":"let dropdownValue = msg.payload; // El valor que proviene del dropdown\nlet label = \"\"; // Para almacenar el label\n\n// Mapear el valor seleccionado a su correspondiente label\nswitch (dropdownValue) {\n    case \"temp1\":\n        label = \"Temperatura torre 1\";\n        break;\n    case \"temp2\":\n        label = \"Temperatura torre 2\";\n        break;\n    case \"tempr\":\n        label = \"Temperatura resistencia\";\n        break;\n    case \"hum1\":\n        label = \"Humedad torre 1\";\n        break;\n    case \"hum2\":\n        label = \"Humedad torre 2\";\n        break;\n    case \"humr\":\n        label = \"Humedad resistencia\";\n        break;\n    case \"humext\":\n        label = \"Humedad exterior\";\n        break;\n    case \"weight1\":\n        label = \"Peso torre 1\";\n        break;\n    case \"weight2\":\n        label = \"Peso torre 2\";\n        break;\n    default:\n        label = \"Dato desconocido\";\n}\n\nlet filename = global.get('filename') || 'No value';\nmsg.payload = filename.slice(0, -4) + \"_\" + msg.payload + \".csv\";\n\n// Formatear el label como \"label seleccionado vs tiempo\"\nmsg.label = label + \" vs tiempo\";\n\n// Devolver el mensaje con el label agregado\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1440,"y":140,"wires":[["19e55647.5cb31a"]]},{"id":"88f0999a.d77ff8","type":"function","z":"804acb1a.0445f8","name":"Temporizador 10 segundos","func":"let interval = context.get('interval');\nlet filename = msg.filename;\nlet label = msg.label; // Agregar label al mensaje\n\n// Si ya existe un intervalo, lo limpiamos\nif (interval) {\n    clearInterval(interval);\n}\n\n// Iniciamos un nuevo intervalo para leer el archivo cada 10 segundos\ninterval = setInterval(() => {\n    node.send({ filename: filename, label: label }); // Enviar el label junto con el filename\n}, 10000); // 10 segundos\n\n// Guardamos el nuevo intervalo en el contexto\ncontext.set('interval', interval);\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1420,"y":260,"wires":[["ca668633.1e1678"]]},{"id":"93e73c03.7525b","type":"function","z":"804acb1a.0445f8","name":"Procesar CSV","func":"let lines = msg.payload.split('\\n');\nlet data = [];\nlet label = msg.label; // Obtener el label actual\n\nlines.forEach(line => {\n    let parts = line.split(',');\n    if(parts.length === 2) {\n        let value = parseFloat(parts[0]);\n        let timestamp = new Date(parts[1]).getTime();\n        data.push({x: timestamp, y: value});\n    }\n});\n\nmsg.payload = [{\n    \"series\": [\"Sensor\"],\n    \"data\": [data],\n    \"labels\": data.map(d => new Date(d.x).toLocaleTimeString())\n}];\n\nmsg.label = label; // Asegurarse de devolver el label\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1400,"y":400,"wires":[["70935705.89fbe8"]]},{"id":"f665b942.e7fdf8","type":"function","z":"804acb1a.0445f8","name":"Agregar _variable.csv","func":"let dropdownValue = msg.payload; // El valor que proviene del dropdown\nlet label = \"\"; // Para almacenar el label\n\n// Mapear el valor seleccionado a su correspondiente label\nswitch (dropdownValue) {\n    case \"temp1\":\n        label = \"Temperatura torre 1\";\n        break;\n    case \"temp2\":\n        label = \"Temperatura torre 2\";\n        break;\n    case \"tempr\":\n        label = \"Temperatura resistencia\";\n        break;\n    case \"hum1\":\n        label = \"Humedad torre 1\";\n        break;\n    case \"hum2\":\n        label = \"Humedad torre 2\";\n        break;\n    case \"humr\":\n        label = \"Humedad resistencia\";\n        break;\n    case \"humext\":\n        label = \"Humedad exterior\";\n        break;\n    case \"weight1\":\n        label = \"Peso torre 1\";\n        break;\n    case \"weight2\":\n        label = \"Peso torre 2\";\n        break;\n    default:\n        label = \"Dato desconocido\";\n}\n\nlet filename = global.get('filename') || 'No value';\nmsg.payload = filename.slice(0, -4) + \"_\" + msg.payload + \".csv\";\n\n// Formatear el label como \"label seleccionado vs tiempo\"\nmsg.label = label + \" vs tiempo\";\n\n// Devolver el mensaje con el label agregado\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2220,"y":140,"wires":[["7d50a7c7.3d5e38"]]},{"id":"4a1310fc.a67cd","type":"function","z":"804acb1a.0445f8","name":"Temporizador 10 segundos","func":"let interval = context.get('interval');\nlet filename = msg.filename;\nlet label = msg.label; // Agregar label al mensaje\n\n// Si ya existe un intervalo, lo limpiamos\nif (interval) {\n    clearInterval(interval);\n}\n\n// Iniciamos un nuevo intervalo para leer el archivo cada 10 segundos\ninterval = setInterval(() => {\n    node.send({ filename: filename, label: label }); // Enviar el label junto con el filename\n}, 10000); // 10 segundos\n\n// Guardamos el nuevo intervalo en el contexto\ncontext.set('interval', interval);\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2200,"y":260,"wires":[["ccd2d277.f27d1"]]},{"id":"fbb68d89.9f53f","type":"function","z":"804acb1a.0445f8","name":"Agregar _variable.csv","func":"let dropdownValue = msg.payload; // El valor que proviene del dropdown\nlet label = \"\"; // Para almacenar el label\n\n// Mapear el valor seleccionado a su correspondiente label\nswitch (dropdownValue) {\n    case \"temp1\":\n        label = \"Temperatura torre 1\";\n        break;\n    case \"temp2\":\n        label = \"Temperatura torre 2\";\n        break;\n    case \"tempr\":\n        label = \"Temperatura resistencia\";\n        break;\n    case \"hum1\":\n        label = \"Humedad torre 1\";\n        break;\n    case \"hum2\":\n        label = \"Humedad torre 2\";\n        break;\n    case \"humr\":\n        label = \"Humedad resistencia\";\n        break;\n    case \"humext\":\n        label = \"Humedad exterior\";\n        break;\n    case \"weight1\":\n        label = \"Peso torre 1\";\n        break;\n    case \"weight2\":\n        label = \"Peso torre 2\";\n        break;\n    default:\n        label = \"Dato desconocido\";\n}\n\nlet filename = global.get('filename') || 'No value';\nmsg.payload = filename.slice(0, -4) + \"_\" + msg.payload + \".csv\";\n\n// Formatear el label como \"label seleccionado vs tiempo\"\nmsg.label = label + \" vs tiempo\";\n\n// Devolver el mensaje con el label agregado\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1420,"y":640,"wires":[["58176b05.94ad04"]]},{"id":"17de3b32.ea0eb5","type":"function","z":"804acb1a.0445f8","name":"Temporizador 10 segundos","func":"let interval = context.get('interval');\nlet filename = msg.filename;\nlet label = msg.label; // Agregar label al mensaje\n\n// Si ya existe un intervalo, lo limpiamos\nif (interval) {\n    clearInterval(interval);\n}\n\n// Iniciamos un nuevo intervalo para leer el archivo cada 10 segundos\ninterval = setInterval(() => {\n    node.send({ filename: filename, label: label }); // Enviar el label junto con el filename\n}, 10000); // 10 segundos\n\n// Guardamos el nuevo intervalo en el contexto\ncontext.set('interval', interval);\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1400,"y":760,"wires":[["16138136.46a8df"]]},{"id":"a5fb46eb.938bc8","type":"function","z":"804acb1a.0445f8","name":"Agregar _variable.csv","func":"let dropdownValue = msg.payload; // El valor que proviene del dropdown\nlet label = \"\"; // Para almacenar el label\n\n// Mapear el valor seleccionado a su correspondiente label\nswitch (dropdownValue) {\n    case \"temp1\":\n        label = \"Temperatura torre 1\";\n        break;\n    case \"temp2\":\n        label = \"Temperatura torre 2\";\n        break;\n    case \"tempr\":\n        label = \"Temperatura resistencia\";\n        break;\n    case \"hum1\":\n        label = \"Humedad torre 1\";\n        break;\n    case \"hum2\":\n        label = \"Humedad torre 2\";\n        break;\n    case \"humr\":\n        label = \"Humedad resistencia\";\n        break;\n    case \"humext\":\n        label = \"Humedad exterior\";\n        break;\n    case \"weight1\":\n        label = \"Peso torre 1\";\n        break;\n    case \"weight2\":\n        label = \"Peso torre 2\";\n        break;\n    default:\n        label = \"Dato desconocido\";\n}\n\nlet filename = global.get('filename') || 'No value';\nmsg.payload = filename.slice(0, -4) + \"_\" + msg.payload + \".csv\";\n\n// Formatear el label como \"label seleccionado vs tiempo\"\nmsg.label = label + \" vs tiempo\";\n\n// Devolver el mensaje con el label agregado\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2240,"y":620,"wires":[["f5f755f2.4eb718"]]},{"id":"e8933115.ba8e1","type":"function","z":"804acb1a.0445f8","name":"Temporizador 10 segundos","func":"let interval = context.get('interval');\nlet filename = msg.filename;\nlet label = msg.label; // Agregar label al mensaje\n\n// Si ya existe un intervalo, lo limpiamos\nif (interval) {\n    clearInterval(interval);\n}\n\n// Iniciamos un nuevo intervalo para leer el archivo cada 10 segundos\ninterval = setInterval(() => {\n    node.send({ filename: filename, label: label }); // Enviar el label junto con el filename\n}, 10000); // 10 segundos\n\n// Guardamos el nuevo intervalo en el contexto\ncontext.set('interval', interval);\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2220,"y":740,"wires":[["6644d945.5ac458"]]},{"id":"1ca638ab.09e047","type":"ui_text","z":"ff06c4a0.7e7488","group":"78ed841d.d7023c","order":9,"width":7,"height":1,"name":"","label":"Proceso realizado en torre: ","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"","fontSize":"26","color":"#464080","x":1580,"y":260,"wires":[]},{"id":"6ff2cb9c.db50d4","type":"file","z":"804acb1a.0445f8","name":"CSV sensor_weight2","filename":"","appendNewline":true,"createDir":true,"overwriteFile":"false","encoding":"none","x":2260,"y":1840,"wires":[[]]},{"id":"a136635b.6d859","type":"function","z":"804acb1a.0445f8","name":"Formato de CSV y de filename","func":"var filename = global.get('filename') || 'No value';\nfilename = filename.slice(0, -4) + \"_weight2.csv\";\nlet value =  msg.payload;\nlet timestamp = new Date().toISOString();\n\nvar csvLine = value + \", \" + timestamp + \"\\n\";\n\nmsg.filename = filename\n// msg.payload = csvLine;\n\nmsg.payload = {\n    value: msg.payload,\n    timestamp: new Date().toISOString(),\n};\n\n\n//Que solo guarde cuando este running en true\nvar running = global.get('running') || false;\n\nif (running === true) {\n    return msg;\n} else {\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1690,"y":1840,"wires":[["879b5c93.378ad","1a3ca67a.08d8da"]]},{"id":"879b5c93.378ad","type":"debug","z":"804acb1a.0445f8","name":"Nombre y datos del archivo guardado","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":2050,"y":1800,"wires":[]},{"id":"1a3ca67a.08d8da","type":"csv","z":"804acb1a.0445f8","name":"Convertir a CSV","sep":",","hdrin":false,"hdrout":"none","multi":"one","ret":"\\n","temp":"value,timestamp","skip":"0","strings":true,"include_empty_strings":false,"include_null_values":false,"x":1980,"y":1840,"wires":[["6ff2cb9c.db50d4"]]},{"id":"6e26c8ed.376bc8","type":"inject","z":"47a745ac.9f83dc","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"15","crontab":"","once":true,"onceDelay":"1","topic":"","payload":"","payloadType":"date","x":830,"y":500,"wires":[["571b14b5.1849cc"]]},{"id":"571b14b5.1849cc","type":"function","z":"47a745ac.9f83dc","name":"weight2","func":"let t = context.get('time') || 0;\nlet initialLoad = 30;\nlet rate = 0.003;\n\n// Calcular la carga base restando el tiempo multiplicado por la tasa\nlet baseLoad = initialLoad - t * rate;\n\n// Añadir una pequeña variación aleatoria a la carga base\n// Genera un valor aleatorio entre -0.5 y 0.5 para mantener la variación suave\nlet randomVariation = (Math.random() * 1) - 0.5;\n\n// Sumar la variación aleatoria a la carga base\nlet load = baseLoad + randomVariation;\n\n// Asegurarse de que la carga no sea menor que 0\nif (load < 0) load = 0;\n\nmsg.payload = load.toFixed(2);\ncontext.set('time', t + 1);\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1020,"y":500,"wires":[["77e315b7.8812cc","88648c08.787f9"]]},{"id":"fb87ad85.7952f","type":"inject","z":"47a745ac.9f83dc","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":820,"y":460,"wires":[["571b14b5.1849cc"]]},{"id":"77e315b7.8812cc","type":"link out","z":"47a745ac.9f83dc","name":"sensor_weight2","links":["f497924.760ac7","41de1196.2c3a3","e3bbe777.a428f8"],"x":1155,"y":540,"wires":[]},{"id":"88648c08.787f9","type":"debug","z":"47a745ac.9f83dc","name":"weight1_sim","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1210,"y":500,"wires":[]},{"id":"933ca84a.6c74b8","type":"comment","z":"934099b7.c96bb8","name":"Obtener subproceso actual PLC","info":"","x":1710,"y":120,"wires":[]},{"id":"617c66f2.4a60f8","type":"link out","z":"1d0b3b5c.03ac95","name":"Boton estadisicas is pressed","links":["91306353.28e6d"],"x":515,"y":400,"wires":[]},{"id":"1c11f375.d334cd","type":"inject","z":"804acb1a.0445f8","name":"","props":[{"p":"payload"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":1250,"y":60,"wires":[["f0b88114.e840a"]]},{"id":"8e2b570c.73e028","type":"function","z":"53774dfa.efea64","name":"Global Start Cronometer","func":"global.set('current_time', 0);\nglobal.set('running', true);\nmsg.payload = 'start';\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":790,"y":240,"wires":[[]]},{"id":"d4680a28.90d978","type":"link in","z":"53774dfa.efea64","name":"Inicio cronometro","links":["d7ce2dee.d6f96"],"x":635,"y":240,"wires":[["8e2b570c.73e028"]]},{"id":"1e1fcb4d.435f95","type":"ui_button","z":"53774dfa.efea64","name":"","group":"9f83ddf8.9d529","order":8,"width":5,"height":1,"passthru":false,"label":"Principal","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":200,"y":340,"wires":[["8b27ca73.59bcd8"]]},{"id":"96ee95fd.e24708","type":"ui_button","z":"53774dfa.efea64","name":"","group":"9f83ddf8.9d529","order":9,"width":5,"height":1,"passthru":false,"label":"Graficas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":200,"y":400,"wires":[["2f13f17f.a10aae"]]},{"id":"9783963f.4d9608","type":"ui_button","z":"53774dfa.efea64","name":"","group":"9f83ddf8.9d529","order":11,"width":5,"height":1,"passthru":false,"label":"Recetas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":200,"y":460,"wires":[["729ad47.345f02c"]]},{"id":"d7ac33ad.aab5c","type":"ui_button","z":"53774dfa.efea64","name":"","group":"9f83ddf8.9d529","order":15,"width":5,"height":1,"passthru":false,"label":"Configuración","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":220,"y":580,"wires":[["e9ee7f83.be80c"]]},{"id":"9123f3b6.10c9","type":"ui_media","z":"53774dfa.efea64","group":"9f83ddf8.9d529","name":"logo_aciv","width":5,"height":2,"order":23,"category":"logo_aciv","file":"logo_aciv.png","layout":"center","showcontrols":true,"loop":true,"onstart":false,"scope":"local","tooltip":"","x":200,"y":640,"wires":[[]]},{"id":"a9099d49.41ee1","type":"ui_button","z":"53774dfa.efea64","name":"","group":"9f83ddf8.9d529","order":18,"width":5,"height":2,"passthru":false,"label":"Parada de emergencia","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":240,"y":700,"wires":[["a19ffe9f.0f16"]]},{"id":"1b5c7c47.d0c084","type":"ui_media","z":"53774dfa.efea64","group":"9f83ddf8.9d529","name":"logo_penagos","width":5,"height":2,"order":1,"category":"logos","file":"logo_penagos.png","layout":"center","showcontrols":true,"loop":true,"onstart":false,"scope":"local","tooltip":"","x":220,"y":220,"wires":[[]]},{"id":"8b27ca73.59bcd8","type":"link out","z":"53774dfa.efea64","name":"Button principal","links":["d3164bb5.dc7108"],"x":395,"y":340,"wires":[]},{"id":"2f13f17f.a10aae","type":"link out","z":"53774dfa.efea64","name":"Button estadisticas","links":["33d4c9f5.adb4f6"],"x":395,"y":400,"wires":[]},{"id":"729ad47.345f02c","type":"link out","z":"53774dfa.efea64","name":"Button datos","links":["dab5ee12.f38","1b53150c.dee5bb","3b0829d3.a227c6","1d88f23.8ead40e","387f3ab9.b7b4b6"],"x":395,"y":460,"wires":[]},{"id":"e9ee7f83.be80c","type":"link out","z":"53774dfa.efea64","name":"Button configuracion","links":["771e4305.4ae1ec"],"x":395,"y":580,"wires":[]},{"id":"a19ffe9f.0f16","type":"link out","z":"53774dfa.efea64","name":"Button parada de emergencia","links":["a521d39a.e8ad6"],"x":395,"y":700,"wires":[]},{"id":"a0ade472.e70298","type":"ui_text","z":"53774dfa.efea64","group":"9f83ddf8.9d529","order":7,"width":13,"height":2,"name":"","label":"Proceso definido por el usuario","format":"Ventana de operación","layout":"col-center","className":"Label_proceso_estandar","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"30","color":"#b0b6bd","x":1170,"y":240,"wires":[]},{"id":"9d119ce6.52574","type":"ui_template","z":"53774dfa.efea64","group":"9f83ddf8.9d529","name":"","order":2,"width":2,"height":1,"format":"<div style=\"{{msg.payload.style}};\">\n    <h3 style=\"{{msg.payload.style}}\">Torre 1</h3>\n    <p style=\"{{msg.payload.style}}\">{{msg.payload.value}}</p>\n</div>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","className":"","x":860,"y":80,"wires":[[]]},{"id":"6a68e7cc.d23f68","type":"ui_template","z":"53774dfa.efea64","group":"9f83ddf8.9d529","name":"","order":3,"width":2,"height":1,"format":"<div style=\"{{msg.payload.style}};\">\n    <h3 style=\"{{msg.payload.style}}\">Torre 2</h3>\n    <p style=\"{{msg.payload.style}}\">{{msg.payload.value}}</p>\n</div>","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":true,"templateScope":"local","className":"","x":860,"y":120,"wires":[[]]},{"id":"1ace1fdc.53708","type":"function","z":"53774dfa.efea64","name":"Evaluar torre 1","func":"let torre = global.get('torre') || 'Error';\n\nif (torre === \"1\") {\n    msg.payload = {\n        style: 'background-color: #00ABE5 !important; font-size: 14px;text-align: center;color: white !important',\n        value: 'ON'\n    };\n} else {\n    msg.payload = {\n        style: 'background-color: #B0B6BD !important;font-size: 14px;text-align: center;color: white !important;',\n        value: 'OFF'\n    };\n}\nreturn msg;\n\n\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":660,"y":80,"wires":[["9d119ce6.52574"]]},{"id":"42651866.454b28","type":"function","z":"53774dfa.efea64","name":"Evaluar torre 2","func":"let torre = global.get('torre') || 'Error';\n\nif (torre === \"2\") {\n    msg.payload = {\n        style: 'background-color: #00ABE5 !important; font-size: 14px;text-align: center;color: white !important;',\n        value: 'ON'\n    };\n} else {\n    msg.payload = {\n        style: 'background-color: #B0B6BD !important;font-size: 14px;text-align: center;color: white !important;',\n        value: 'OFF'\n    };\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":660,"y":120,"wires":[["6a68e7cc.d23f68"]]},{"id":"f9a733b.5cc59d","type":"ui_text","z":"53774dfa.efea64","group":"9f83ddf8.9d529","order":5,"width":7,"height":1,"name":"","label":"Ciclo actual: ","format":"{{msg.payload}}","layout":"row-left","className":"subprocesos","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#00abe5","x":1530,"y":80,"wires":[]},{"id":"2da5eccf.ef36c4","type":"function","z":"53774dfa.efea64","name":"Obtener ciclo actual","func":"// Inicializar la variable global si no existe\nvar sub1 = global.get('subproceso_estandar1') || \"0\"; // Cambiado a \"0\"\nvar sub2 = global.get('subproceso_estandar2') || \"0\"; // Cambiado a \"0\"\nvar sub3 = global.get('subproceso_estandar3') || \"0\"; // Cambiado a \"0\"\n\nvar subproceso = \"Pre secado\";\n\n// Si el contador supera 3, reiniciarlo a 1\nif (sub1 === \"1\" && sub2 === \"0\" && sub3 === \"0\") {\n   subproceso = \"Pre secado\";\n}\nelse if (sub1 === \"1\" && sub2 === \"1\" && sub3 === \"0\") {\n    subproceso = \"Oreado\";\n}\nelse if (sub1 === \"1\" && sub2 === \"1\" && sub3 === \"1\") {\n    subproceso = \"Punto final\";\n}\nelse {\n    subproceso = \"Cargando...\";\n}\n\n// Establecer el valor del contador en msg.payload para enviarlo\nmsg.payload = subproceso;\n\n// Devolver el mensaje modificado\nreturn msg;\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1260,"y":80,"wires":[["f9a733b.5cc59d"]]},{"id":"dbab790.860a988","type":"inject","z":"47a745ac.9f83dc","name":"","props":[{"p":"payload"}],"repeat":"1","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"","payloadType":"str","x":1550,"y":180,"wires":[["296c49c1.f31336"]]},{"id":"296c49c1.f31336","type":"function","z":"47a745ac.9f83dc","name":"Global  Update Cronometer","func":"let currentTime = global.get('current_time') || 0;\n\nif (global.get('running')) {\n    currentTime += 1;\n    global.set('current_time', currentTime);\n    // Convertir segundos a hh:mm:ss\n    let hours = Math.floor(currentTime / 3600);\n    let minutes = Math.floor((currentTime % 3600) / 60);\n    let seconds = currentTime % 60;\n    let formattedTime = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;\n    msg.payload = formattedTime;\n    return msg;\n} else {\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1760,"y":180,"wires":[["1a8c1618.812cca"]]},{"id":"f35fb93.030fc48","type":"comment","z":"47a745ac.9f83dc","name":"Variables de proceso","info":"","x":1600,"y":120,"wires":[]},{"id":"2ea249c3.f89336","type":"ui_text","z":"53774dfa.efea64","group":"9f83ddf8.9d529","order":24,"width":6,"height":1,"name":"","label":"Peso","format":"{{msg.payload}}","layout":"col-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#00abe5","x":1010,"y":660,"wires":[]},{"id":"d38d73d1.c8d76","type":"ui_text","z":"53774dfa.efea64","group":"9f83ddf8.9d529","order":13,"width":6,"height":1,"name":"","label":"Temperatura de la masa","format":"{{msg.payload}}","layout":"col-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#00abe5","x":1030,"y":380,"wires":[]},{"id":"f228ae1e.1daca","type":"ui_text","z":"53774dfa.efea64","group":"9f83ddf8.9d529","order":14,"width":7,"height":1,"name":"","label":"Temperatura de la resistencia","format":"{{msg.payload}}","layout":"col-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#00abe5","x":1570,"y":380,"wires":[]},{"id":"e93085f.5ef7e78","type":"ui_text","z":"53774dfa.efea64","group":"9f83ddf8.9d529","order":19,"width":6,"height":1,"name":"","label":"Humedad del cafe","format":"{{msg.payload}}","layout":"col-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#00abe5","x":1030,"y":520,"wires":[]},{"id":"5b29914f.c9691","type":"ui_text","z":"53774dfa.efea64","group":"9f83ddf8.9d529","order":20,"width":7,"height":1,"name":"","label":"Humedad exterior","format":"{{msg.payload}}","layout":"col-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#00abe5","x":1530,"y":660,"wires":[]},{"id":"e039fb6b.265768","type":"ui_text","z":"53774dfa.efea64","group":"9f83ddf8.9d529","order":25,"width":7,"height":1,"name":"","label":"Humedad de la resistencia","format":"{{msg.payload}}","layout":"col-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#00abe5","x":1560,"y":520,"wires":[]},{"id":"b1246c14.b7929","type":"link in","z":"53774dfa.efea64","name":"","links":["8c1ecafb.80b068"],"x":635,"y":660,"wires":[["1dfce6f5.1d2379"]]},{"id":"597c9611.68d6f8","type":"link in","z":"53774dfa.efea64","name":"","links":["19b34ae0.3285a5"],"x":1395,"y":380,"wires":[["f228ae1e.1daca"]]},{"id":"66e4e11e.11f96","type":"link in","z":"53774dfa.efea64","name":"","links":["b267761b.e2e728"],"x":1395,"y":660,"wires":[["5b29914f.c9691"]]},{"id":"33d74419.6a823c","type":"link in","z":"53774dfa.efea64","name":"","links":["e3738fb3.afef3"],"x":635,"y":380,"wires":[["510c805d.81a9c"]]},{"id":"a83ef322.ae1ca","type":"link in","z":"53774dfa.efea64","name":"","links":["d266633b.688fe"],"x":635,"y":520,"wires":[["7b62d3d0.edb91c"]]},{"id":"d75b17dc.913988","type":"link in","z":"53774dfa.efea64","name":"","links":["efdade98.7bb17"],"x":1395,"y":520,"wires":[["e039fb6b.265768"]]},{"id":"510c805d.81a9c","type":"function","z":"53774dfa.efea64","name":"Torre 1 ON","func":"let torre = global.get('torre') || 'Error';\n\nif (torre === \"1\") {\n    return msg;\n}\nelse {\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":810,"y":380,"wires":[["d38d73d1.c8d76"]]},{"id":"8702ba03.23dab8","type":"link in","z":"53774dfa.efea64","name":"","links":["bbe0478.68769b8"],"x":635,"y":420,"wires":[["1454ad85.a1a542"]]},{"id":"1454ad85.a1a542","type":"function","z":"53774dfa.efea64","name":"Torre 2 ON","func":"let torre = global.get('torre') || 'Error';\n\nif (torre === \"2\") {\n    return msg;\n}\nelse {\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":810,"y":420,"wires":[["d38d73d1.c8d76"]]},{"id":"7b62d3d0.edb91c","type":"function","z":"53774dfa.efea64","name":"Torre 1 ON","func":"let torre = global.get('torre') || 'Error';\n\nif (torre === \"1\") {\n    return msg;\n}\nelse {\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":810,"y":520,"wires":[["e93085f.5ef7e78"]]},{"id":"1c8396e8.4f3ac9","type":"function","z":"53774dfa.efea64","name":"Torre 2 ON","func":"let torre = global.get('torre') || 'Error';\n\nif (torre === \"2\") {\n    return msg;\n}\nelse {\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":810,"y":560,"wires":[["e93085f.5ef7e78"]]},{"id":"1dfce6f5.1d2379","type":"function","z":"53774dfa.efea64","name":"Torre 1 ON","func":"let torre = global.get('torre') || 'Error';\n\nif (torre === \"1\") {\n    return msg;\n}\nelse {\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":810,"y":660,"wires":[["2ea249c3.f89336"]]},{"id":"c87dc992.3cf4a8","type":"function","z":"53774dfa.efea64","name":"Torre 2 ON","func":"let torre = global.get('torre') || 'Error';\n\nif (torre === \"2\") {\n    return msg;\n}\nelse {\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":810,"y":700,"wires":[["2ea249c3.f89336"]]},{"id":"9005f08b.79644","type":"link in","z":"53774dfa.efea64","name":"","links":["6a896d49.894054"],"x":635,"y":560,"wires":[["1c8396e8.4f3ac9"]]},{"id":"e3bbe777.a428f8","type":"link in","z":"53774dfa.efea64","name":"","links":["77e315b7.8812cc"],"x":635,"y":700,"wires":[["c87dc992.3cf4a8"]]},{"id":"d317d341.80e2e","type":"ui_text","z":"53774dfa.efea64","group":"9f83ddf8.9d529","order":16,"width":6,"height":1,"name":"","label":"[ °C ]","format":"","layout":"col-center","className":"unidades","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":16,"color":"#000000","x":1010,"y":420,"wires":[]},{"id":"38108c12.412ff4","type":"ui_text","z":"53774dfa.efea64","group":"9f83ddf8.9d529","order":17,"width":7,"height":1,"name":"","label":"[ °C ]","format":"","layout":"row-center","className":"unidades","style":true,"font":"","fontSize":16,"color":"#000000","x":1490,"y":420,"wires":[]},{"id":"7c1e912e.b7595","type":"ui_text","z":"53774dfa.efea64","group":"9f83ddf8.9d529","order":21,"width":6,"height":1,"name":"","label":"[ % ]","format":"","layout":"row-center","className":"unidades","style":true,"font":"","fontSize":16,"color":"#000000","x":1010,"y":560,"wires":[]},{"id":"f47f3f60.ed814","type":"ui_text","z":"53774dfa.efea64","group":"9f83ddf8.9d529","order":27,"width":7,"height":1,"name":"","label":"[ % ]","format":"","layout":"row-center","className":"unidades","style":true,"font":"","fontSize":16,"color":"#000000","x":1490,"y":560,"wires":[]},{"id":"e29d66d6.167bb8","type":"ui_text","z":"53774dfa.efea64","group":"9f83ddf8.9d529","order":26,"width":6,"height":1,"name":"","label":"[ Kg ]","format":"","layout":"row-center","className":"unidades","style":true,"font":"","fontSize":16,"color":"#000000","x":1010,"y":700,"wires":[]},{"id":"ffe9cdd2.17548","type":"ui_text","z":"53774dfa.efea64","group":"9f83ddf8.9d529","order":22,"width":7,"height":1,"name":"","label":"[ % ]","format":"","layout":"row-center","className":"unidades","style":true,"font":"","fontSize":16,"color":"#000000","x":1490,"y":700,"wires":[]},{"id":"c54e27d8.751d68","type":"ui_text","z":"934099b7.c96bb8","group":"cca89ca3.f14d7","order":10,"width":13,"height":2,"name":"","label":"Tiempo transcurrido: ","format":"{{msg.payload}}","layout":"col-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#00abe5","x":1300,"y":300,"wires":[]},{"id":"1a8c1618.812cca","type":"link out","z":"47a745ac.9f83dc","name":"Actualizar cronometro","links":["3cfe7bb8.f74b94","943c5d2d.ca99f"],"x":1935,"y":180,"wires":[]},{"id":"3cfe7bb8.f74b94","type":"link in","z":"934099b7.c96bb8","name":"Actualizar cronometro","links":["1a8c1618.812cca"],"x":1135,"y":300,"wires":[["c54e27d8.751d68"]]},{"id":"b39f6edc.27fe5","type":"ui_text","z":"53774dfa.efea64","group":"9f83ddf8.9d529","order":10,"width":13,"height":2,"name":"","label":"Tiempo transcurrido: ","format":"{{msg.payload}}","layout":"col-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"20","color":"#00abe5","x":1180,"y":300,"wires":[]},{"id":"943c5d2d.ca99f","type":"link in","z":"53774dfa.efea64","name":"Actualizar cronometro","links":["1a8c1618.812cca"],"x":1015,"y":300,"wires":[["b39f6edc.27fe5"]]},{"id":"c5c16a2.a706698","type":"change","z":"cf6e4dbe.06b5d","name":"","rules":[{"t":"set","p":"torre","pt":"global","to":"1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":460,"y":1060,"wires":[[]]},{"id":"d7ce2dee.d6f96","type":"link out","z":"cf6e4dbe.06b5d","name":"Inicio proceso usuario (siguiente is pressed)","links":["80b863c4.7e08a","d4680a28.90d978"],"x":395,"y":980,"wires":[]},{"id":"ff5a3996.1ab438","type":"comment","z":"cf6e4dbe.06b5d","name":"Iniciar cronometro","info":"","x":110,"y":980,"wires":[]},{"id":"1cb9ce4a.c11d62","type":"comment","z":"cf6e4dbe.06b5d","name":"Configurar torre 1 al inicio del proceso","info":"","x":170,"y":1060,"wires":[]},{"id":"80b863c4.7e08a","type":"link in","z":"53774dfa.efea64","name":"","links":["d7ce2dee.d6f96","8a6693ce.c8a98"],"x":495,"y":80,"wires":[["1ace1fdc.53708","42651866.454b28"]]},{"id":"ea15a86a.478158","type":"comment","z":"e69d9ae9.d86958","name":"Iniciar cronometro","info":"","x":270,"y":780,"wires":[]},{"id":"8a6a3491.89a4a8","type":"comment","z":"1d0b3b5c.03ac95","name":"Seleccionar torre 1 por defecto","info":"","x":1510,"y":420,"wires":[]},{"id":"a4d76574.8849e8","type":"change","z":"cf6e4dbe.06b5d","name":"","rules":[{"t":"set","p":"process","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":470,"y":940,"wires":[[]]},{"id":"3b26df88.97c4b","type":"comment","z":"e69d9ae9.d86958","name":"Cambiar tab","info":"","x":250,"y":820,"wires":[]},{"id":"63e360e3.9e2f3","type":"comment","z":"e69d9ae9.d86958","name":"Guardado de historial y de receta","info":"","x":310,"y":860,"wires":[]},{"id":"dd8bef7e.58415","type":"comment","z":"e69d9ae9.d86958","name":"Global.process = Estandar","info":"","x":290,"y":740,"wires":[]},{"id":"6126fdce.fbc0c4","type":"comment","z":"cf6e4dbe.06b5d","name":"Global.process = Personalizado","info":"","x":150,"y":940,"wires":[]},{"id":"4e8fc2fe.379c0c","type":"comment","z":"cf6e4dbe.06b5d","name":"Cambiar tab","info":"","x":90,"y":1020,"wires":[]},{"id":"6689ba73.607174","type":"function","z":"cf6e4dbe.06b5d","name":"Formato del CSV y nombre del archivo","func":"// OBTENER VARIABLES GLOBALES DE LA RECETA Y COLOCARLOS EN \n// UN FORMATO DE UNA LINEA PARA CSV\n\nvar timestamp = new Date().toISOString();\nvar process = global.get('process') || 'No value';\n// Obtener las variables globales o asignar valor por defecto 0\nvar temp1 = global.get('1temp') || 0;\nvar temp2 = global.get('2temp') || 0;\nvar temp3 = global.get('3temp') || 0;\nvar temp4 = global.get('4temp') || 0;\nvar temp5 = global.get('5temp') || 0;\nvar temp6 = global.get('6temp') || 0;\nvar temp7 = global.get('7temp') || 0;\nvar temp8 = global.get('8temp') || 0;\nvar temp9 = global.get('9temp') || 0;\n\nvar time1 = global.get('1time') || 0;\nvar time2 = global.get('2time') || 0;\nvar time3 = global.get('3time') || 0;\nvar time4 = global.get('4time') || 0;\nvar time5 = global.get('5time') || 0;\nvar time6 = global.get('6time') || 0;\nvar time7 = global.get('7time') || 0;\nvar time8 = global.get('8time') || 0;\nvar time9 = global.get('9time') || 0;\n\nvar shak1 = global.get('1shak') || 0;\nvar shak2 = global.get('2shak') || 0;\nvar shak3 = global.get('3shak') || 0;\nvar shak4 = global.get('4shak') || 0;\nvar shak5 = global.get('5shak') || 0;\nvar shak6 = global.get('6shak') || 0;\nvar shak7 = global.get('7shak') || 0;\nvar shak8 = global.get('8shak') || 0;\nvar shak9 = global.get('9shak') || 0;\n\nvar ciclos = global.get('ciclos') || 0;\nvar flujo = global.get('flujo') || 0;\n\n// Crear línea CSV con los valores obtenidos\nvar csvLine = process + \",\" + timestamp + \",\" + temp1 + \",\" + temp2 + \",\" + temp3 + \",\" + temp4 + \",\" + temp5 + \",\" +\n              temp6 + \",\" + temp7 + \",\" + temp8 + \",\" + temp9 + \",\" +\n              time1 + \",\" + time2 + \",\" + time3 + \",\" + time4 + \",\" + time5 + \",\" +\n              time6 + \",\" + time7 + \",\" + time8 + \",\" + time9 + \",\" +\n              shak1 + \",\" + shak2 + \",\" + shak3 + \",\" + shak4 + \",\" + shak5 + \",\" +\n              shak6 + \",\" + shak7 + \",\" + shak8 + \",\" + shak9 + \",\" + ciclos + \",\" + flujo + \"\\n\";\n\nmsg.payload = csvLine;\n\n//----------------------------------------------------\n\n// DAR FORMATO AL NOMBRE DEL ARCHIVO HORA DE BOGOTA\nlet date = new Date();\n// Convertir a la zona horaria de Bogotá (UTC-5)\nlet options = { timeZone: 'America/Bogota', year: 'numeric', month: '2-digit', day: '2-digit', \n                hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false };\nlet formatter = new Intl.DateTimeFormat('en-GB', options);\nlet parts = formatter.formatToParts(date);\nlet year = parts.find(p => p.type === 'year').value;\nlet month = parts.find(p => p.type === 'month').value;\nlet day = parts.find(p => p.type === 'day').value;\nlet hours = parts.find(p => p.type === 'hour').value;\nlet minutes = parts.find(p => p.type === 'minute').value;\nlet seconds = parts.find(p => p.type === 'second').value;\n// Formato: YYYYMMDD_HHMMSS\nlet formattedDate = `${year}${month}${day}_${hours}${minutes}${seconds}`;\n\n//----------------------------------------------------\n\n//CAMBIAR RUTA DE ALMACENAMIENTO DE LOS CSV\nvar ruta_sd = global.get('ruta_sd') || '';\nlet filename = `${ruta_sd}Personalizado_${formattedDate}.csv`;\nglobal.set('filename', filename); // Guardar en flow.filename\nflow.set('csvline', csvLine);\n\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":530,"y":1100,"wires":[["5df75f27.76743","1f1ce449.a51c7c","30bb8b58.fd8344"]]},{"id":"5df75f27.76743","type":"function","z":"cf6e4dbe.06b5d","name":"Obtener nombre del archivo","func":"msg.filename = global.get('filename'); // Obtener el nombre del archivo de flow\nmsg.payload = flow.get('csvline');\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":900,"y":900,"wires":[["360ca8ea.985938"]]},{"id":"1f1ce449.a51c7c","type":"function","z":"cf6e4dbe.06b5d","name":"Formatear para el historial","func":"let filename_proceso_a_guardar = global.get('filename'); // Obtener el nombre del archivo de flow\nmsg.payload = filename_proceso_a_guardar\n\nlet ruta_sd = global.get('ruta_sd');\nruta_sd = `${ruta_sd}historial_procesos.csv`;\nmsg.filename = ruta_sd\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":890,"y":980,"wires":[["1f32a52.c4f1b5b"]]},{"id":"360ca8ea.985938","type":"file","z":"cf6e4dbe.06b5d","name":"Guardar datos en CSV","filename":"","appendNewline":true,"createDir":false,"overwriteFile":"false","encoding":"none","x":1280,"y":900,"wires":[[]]},{"id":"1f32a52.c4f1b5b","type":"file","z":"cf6e4dbe.06b5d","name":"Guardar proceso en historial","filename":"","appendNewline":true,"createDir":false,"overwriteFile":"false","encoding":"none","x":1300,"y":980,"wires":[[]]},{"id":"d89d9abe.569f38","type":"comment","z":"cf6e4dbe.06b5d","name":"Guardado de historial y de receta","info":"","x":150,"y":1100,"wires":[]},{"id":"63cb418a.8a71f","type":"ui_button","z":"acb46316.472a9","name":"","group":"7bf35741.d78c68","order":10,"width":5,"height":1,"passthru":false,"label":"Principal","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":100,"y":160,"wires":[["a8f56c94.6f49f"]]},{"id":"4eca8783.72fbd8","type":"ui_button","z":"acb46316.472a9","name":"","group":"7bf35741.d78c68","order":16,"width":5,"height":1,"passthru":false,"label":"Graficas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":100,"y":220,"wires":[["29e8bb1c.ba6244"]]},{"id":"c0f5dbdc.2720a8","type":"ui_button","z":"acb46316.472a9","name":"","group":"7bf35741.d78c68","order":22,"width":5,"height":1,"passthru":false,"label":"Recetas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":100,"y":280,"wires":[["c6c3788f.f71b88"]]},{"id":"602b15dc.c7f23c","type":"ui_button","z":"acb46316.472a9","name":"","group":"7bf35741.d78c68","order":34,"width":5,"height":1,"passthru":false,"label":"Configuración","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":120,"y":400,"wires":[["79f2dd2e.38df54"]]},{"id":"f4977f6b.a046a","type":"ui_media","z":"acb46316.472a9","group":"7bf35741.d78c68","name":"logo_aciv","width":5,"height":2,"order":49,"category":"logo_aciv","file":"logo_aciv.png","layout":"center","showcontrols":true,"loop":true,"onstart":false,"scope":"local","tooltip":"","x":100,"y":460,"wires":[[]]},{"id":"ee16a278.010f","type":"ui_button","z":"acb46316.472a9","name":"","group":"7bf35741.d78c68","order":39,"width":5,"height":2,"passthru":false,"label":"Parada de emergencia","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":140,"y":520,"wires":[["a2c06e3c.4067c"]]},{"id":"cefa02d.cff0f","type":"ui_media","z":"acb46316.472a9","group":"7bf35741.d78c68","name":"logo_penagos","width":5,"height":2,"order":1,"category":"logos","file":"logo_penagos.png","layout":"center","showcontrols":true,"loop":true,"onstart":false,"scope":"local","tooltip":"","x":120,"y":40,"wires":[[]]},{"id":"a8f56c94.6f49f","type":"link out","z":"acb46316.472a9","name":"Button principal","links":["d3164bb5.dc7108"],"x":315,"y":160,"wires":[]},{"id":"29e8bb1c.ba6244","type":"link out","z":"acb46316.472a9","name":"Button estadisticas","links":["33d4c9f5.adb4f6"],"x":315,"y":220,"wires":[]},{"id":"c6c3788f.f71b88","type":"link out","z":"acb46316.472a9","name":"Button datos","links":["dab5ee12.f38","1b53150c.dee5bb","3b0829d3.a227c6","1d88f23.8ead40e","387f3ab9.b7b4b6"],"x":315,"y":280,"wires":[]},{"id":"79f2dd2e.38df54","type":"link out","z":"acb46316.472a9","name":"Button configuracion","links":["771e4305.4ae1ec"],"x":315,"y":400,"wires":[]},{"id":"a2c06e3c.4067c","type":"link out","z":"acb46316.472a9","name":"Button parada de emergencia","links":["a521d39a.e8ad6"],"x":315,"y":520,"wires":[]},{"id":"59aeea6.9ffef14","type":"ui_dropdown","z":"acb46316.472a9","name":"Dropdown seleccionar archivo","label":"Seleccionar","tooltip":"","place":"Proceso...","group":"7bf35741.d78c68","order":3,"width":11,"height":1,"passthru":true,"multiple":false,"options":[],"payload":"","topic":"","topicType":"str","className":"Dropdown","x":810,"y":340,"wires":[["1fe8f762.512dc9"]]},{"id":"64827d65.5dcb24","type":"comment","z":"acb46316.472a9","name":"Actualización del historial en datos","info":"Para que cuando se presione el botón datos se actulice la lista del historial","x":820,"y":60,"wires":[]},{"id":"5ec6af8a.4d688","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":5,"width":1,"height":1,"name":"","label":"#","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1130,"y":280,"wires":[]},{"id":"1ef97df5.db5112","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":11,"width":1,"height":1,"name":"","label":"1","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1130,"y":320,"wires":[]},{"id":"64f5764a.3012d8","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":17,"width":1,"height":1,"name":"","label":"2","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1130,"y":360,"wires":[]},{"id":"b7f4d19c.39d9a","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":23,"width":1,"height":1,"name":"","label":"3","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1130,"y":400,"wires":[]},{"id":"90466886.ff0788","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":29,"width":1,"height":1,"name":"","label":"4","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1130,"y":440,"wires":[]},{"id":"38aede3f.003ad2","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":35,"width":1,"height":1,"name":"","label":"5","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1130,"y":480,"wires":[]},{"id":"642a1b9a.21c894","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":40,"width":1,"height":1,"name":"","label":"6","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1130,"y":520,"wires":[]},{"id":"4184da3a.bedea4","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":44,"width":1,"height":1,"name":"","label":"7","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1130,"y":560,"wires":[]},{"id":"eb3f999d.375658","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":50,"width":1,"height":1,"name":"","label":"8","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1130,"y":600,"wires":[]},{"id":"c022eed5.73cd3","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":54,"width":1,"height":1,"name":"","label":"9","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1130,"y":640,"wires":[]},{"id":"4957892e.c419e8","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":6,"width":3,"height":1,"name":"","label":"Temperatura","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1350,"y":280,"wires":[]},{"id":"f0bedc3b.eea07","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":7,"width":3,"height":1,"name":"","label":"Tiempo","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1340,"y":680,"wires":[]},{"id":"193e7069.5901b","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":8,"width":3,"height":1,"name":"","label":"Shaker","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1340,"y":1080,"wires":[]},{"id":"9147dcd.0d1322","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":9,"width":3,"height":1,"name":"","label":"Ciclos","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":710,"y":1040,"wires":[]},{"id":"b3e57df9.c7803","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":21,"width":3,"height":1,"name":"","label":"Flujo","format":"{{msg.payload}}","layout":"row-center","className":"Label_tipo","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":710,"y":1140,"wires":[]},{"id":"d38997d.eb6c568","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":12,"width":3,"height":1,"name":"1temp","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":320,"wires":[]},{"id":"5ff6a7d4.74b0a8","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":18,"width":3,"height":1,"name":"2temp","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":360,"wires":[]},{"id":"1d06fa6a.eabc06","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":24,"width":3,"height":1,"name":"3temp","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":400,"wires":[]},{"id":"457c600f.d2bd3","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":30,"width":3,"height":1,"name":"4temp","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":440,"wires":[]},{"id":"bec3c202.4a0d6","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":36,"width":3,"height":1,"name":"5temp","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":480,"wires":[]},{"id":"82f9538d.7f546","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":41,"width":3,"height":1,"name":"6temp","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":520,"wires":[]},{"id":"a584c733.d70c38","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":45,"width":3,"height":1,"name":"7temp","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":560,"wires":[]},{"id":"d76dfbe0.498b98","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":51,"width":3,"height":1,"name":"8temp","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":600,"wires":[]},{"id":"616baa27.a3f3b4","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":55,"width":3,"height":1,"name":"9temp","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":640,"wires":[]},{"id":"69b3596b.1b1b58","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":13,"width":3,"height":1,"name":"1time","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":720,"wires":[]},{"id":"a5f6fb98.d6e2d8","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":19,"width":3,"height":1,"name":"2time","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":760,"wires":[]},{"id":"fd35ee62.e31f4","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":25,"width":3,"height":1,"name":"3time","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":800,"wires":[]},{"id":"df092b0f.b51c28","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":31,"width":3,"height":1,"name":"4time","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":840,"wires":[]},{"id":"3307d823.4310e8","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":37,"width":3,"height":1,"name":"5time","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":880,"wires":[]},{"id":"e369a1f3.6ba54","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":42,"width":3,"height":1,"name":"6time","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":920,"wires":[]},{"id":"af2b84fb.99d8c8","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":46,"width":3,"height":1,"name":"7time","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":960,"wires":[]},{"id":"757e3673.02eca8","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":52,"width":3,"height":1,"name":"8time","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":1000,"wires":[]},{"id":"1c7f018d.393d5e","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":56,"width":3,"height":1,"name":"9time","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":1040,"wires":[]},{"id":"9c4e0ee3.d1d66","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":14,"width":3,"height":1,"name":"1shak","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":1120,"wires":[]},{"id":"7ff71f7a.c8f25","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":20,"width":3,"height":1,"name":"2shak","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":1160,"wires":[]},{"id":"3752f3aa.9fd4ec","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":26,"width":3,"height":1,"name":"3shak","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":1200,"wires":[]},{"id":"7b2929f.27018d8","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":32,"width":3,"height":1,"name":"4shak","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":1240,"wires":[]},{"id":"8fba337f.24da4","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":38,"width":3,"height":1,"name":"5shak","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":1280,"wires":[]},{"id":"a9a70243.b628","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":43,"width":3,"height":1,"name":"6shak","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":1320,"wires":[]},{"id":"f2b1a9a9.6665b8","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":47,"width":3,"height":1,"name":"7shak","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":1360,"wires":[]},{"id":"484dc827.6e4f28","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":53,"width":3,"height":1,"name":"8shak","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":1400,"wires":[]},{"id":"d0bdf8d4.b2ca68","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":57,"width":3,"height":1,"name":"9shak","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":1330,"y":1440,"wires":[]},{"id":"265d1e50.53f5c2","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":15,"width":3,"height":1,"name":"ciclos_text","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":730,"y":1080,"wires":[]},{"id":"f42d3465.c3d678","type":"ui_text","z":"acb46316.472a9","group":"7bf35741.d78c68","order":27,"width":3,"height":1,"name":"flujo_text","label":"","format":"{{msg.payload}}","layout":"row-center","className":"sensor_value","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"25","color":"#b0b6bd","x":720,"y":1180,"wires":[]},{"id":"49f2527e.6129ac","type":"file","z":"e69d9ae9.d86958","name":"Guardar proceso en historial","filename":"","appendNewline":true,"createDir":false,"overwriteFile":"false","encoding":"none","x":1280,"y":980,"wires":[[]]},{"id":"c5aa2543.8dea08","type":"function","z":"e69d9ae9.d86958","name":"Formatear para el historial de estandar","func":"let filename_proceso_a_guardar = global.get('filename'); // Obtener el nombre del archivo de flow\nmsg.payload = filename_proceso_a_guardar\n\nlet ruta_sd = global.get('ruta_sd');\nruta_sd = `${ruta_sd}historial_procesos_estandar.csv`;\nmsg.filename = ruta_sd\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":970,"y":980,"wires":[["49f2527e.6129ac"]]},{"id":"30bb8b58.fd8344","type":"function","z":"cf6e4dbe.06b5d","name":"Formatear para el historial de personalizado","func":"let filename_proceso_a_guardar = global.get('filename'); // Obtener el nombre del archivo de flow\nmsg.payload = filename_proceso_a_guardar\n\nlet ruta_sd = global.get('ruta_sd');\nruta_sd = `${ruta_sd}historial_procesos_personalizado.csv`;\nmsg.filename = ruta_sd\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":950,"y":1060,"wires":[["bad3eb6e.a1a178"]]},{"id":"bad3eb6e.a1a178","type":"file","z":"cf6e4dbe.06b5d","name":"Guardar proceso en historial personalizado","filename":"","appendNewline":true,"createDir":false,"overwriteFile":"false","encoding":"none","x":1350,"y":1060,"wires":[[]]},{"id":"3b73c817.8b9c08","type":"file in","z":"34168811.ab73a8","name":"Leer historial_procesos","filename":"run/media/mmcblk0p1/historial_procesos.csv","format":"utf8","chunk":false,"sendError":false,"encoding":"none","x":1470,"y":360,"wires":[["73b7de9.3d9572"]]},{"id":"73b7de9.3d9572","type":"debug","z":"34168811.ab73a8","name":"Historial","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1760,"y":360,"wires":[]},{"id":"a7ec9d37.a0813","type":"inject","z":"34168811.ab73a8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1260,"y":360,"wires":[["3b73c817.8b9c08"]]},{"id":"d17f5ae3.805598","type":"inject","z":"34168811.ab73a8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1260,"y":520,"wires":[["f26ae109.ffd06"]]},{"id":"f26ae109.ffd06","type":"file","z":"34168811.ab73a8","name":"Eliminar proceso en historial","filename":"run/media/mmcblk0p1/historial_procesos.csv","appendNewline":true,"createDir":false,"overwriteFile":"delete","encoding":"none","x":1480,"y":520,"wires":[[]]},{"id":"6f699699.890fe8","type":"inject","z":"34168811.ab73a8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1260,"y":240,"wires":[["aa91a86f.7a9118"]]},{"id":"aa91a86f.7a9118","type":"file in","z":"34168811.ab73a8","name":"Cargar grafica del historial","filename":"run/media/mmcblk0p1/Estandar_20241028_200809_temp1.csv","format":"utf8","chunk":false,"sendError":false,"encoding":"none","x":1470,"y":240,"wires":[["a97b4cd9.5ca6a"]]},{"id":"a97b4cd9.5ca6a","type":"debug","z":"34168811.ab73a8","name":"Cargado del historial","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1760,"y":240,"wires":[]},{"id":"950dd72e.3956a8","type":"file","z":"34168811.ab73a8","name":"Eliminar proceso en historial estandar","filename":"run/media/mmcblk0p1/historial_procesos_estandar.csv","appendNewline":true,"createDir":false,"overwriteFile":"delete","encoding":"none","x":1510,"y":560,"wires":[[]]},{"id":"bcbe2701.d487a8","type":"inject","z":"34168811.ab73a8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1260,"y":560,"wires":[["950dd72e.3956a8"]]},{"id":"337fc636.64c60a","type":"file in","z":"34168811.ab73a8","name":"Leer historial_procesos_estandar","filename":"run/media/mmcblk0p1/historial_procesos_estandar.csv","format":"utf8","chunk":false,"sendError":false,"encoding":"none","x":1500,"y":400,"wires":[["8208681c.119518"]]},{"id":"8208681c.119518","type":"debug","z":"34168811.ab73a8","name":"Estandar","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1760,"y":400,"wires":[]},{"id":"d262fac6.57b5e8","type":"inject","z":"34168811.ab73a8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1260,"y":400,"wires":[["337fc636.64c60a"]]},{"id":"45dbd02c.1cfa1","type":"file","z":"34168811.ab73a8","name":"Eliminar proceso en historial personalizado","filename":"run/media/mmcblk0p1/historial_procesos_personalizado.csv","appendNewline":true,"createDir":false,"overwriteFile":"delete","encoding":"none","x":1530,"y":600,"wires":[[]]},{"id":"56be3582.b7eb0c","type":"inject","z":"34168811.ab73a8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1260,"y":600,"wires":[["45dbd02c.1cfa1"]]},{"id":"34765d86.9811a2","type":"file in","z":"34168811.ab73a8","name":"Leer historial_procesos_personalizado","filename":"run/media/mmcblk0p1/historial_procesos_personalizado.csv","format":"utf8","chunk":false,"sendError":false,"encoding":"none","x":1510,"y":440,"wires":[["c54d1b4d.4ee128"]]},{"id":"c54d1b4d.4ee128","type":"debug","z":"34168811.ab73a8","name":"Personalizado","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1780,"y":440,"wires":[]},{"id":"7536925a.cfc58c","type":"inject","z":"34168811.ab73a8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1260,"y":440,"wires":[["34765d86.9811a2"]]},{"id":"3002201f.15dd6","type":"file in","z":"acb46316.472a9","name":"Leer historial procesos personalizado","filename":"","format":"utf8","chunk":false,"sendError":true,"encoding":"none","x":790,"y":200,"wires":[["972f1132.54b3f"]]},{"id":"90fdce02.76cfe","type":"file in","z":"acb46316.472a9","name":"Leer archivo seleccionado","filename":"","format":"utf8","chunk":false,"sendError":true,"encoding":"none","x":790,"y":480,"wires":[["91329340.d4d95"]]},{"id":"91329340.d4d95","type":"function","z":"acb46316.472a9","name":"Cargar valores en inputs","func":"let data = msg.payload.split(',');\n\n// Asignamos los valores a cada input (valores después de la fecha)\nmsg.payload1 = data[2] || '';\nmsg.payload2 = data[3] || '';\nmsg.payload3 = data[4] || '';\nmsg.payload4 = data[5] || '';\nmsg.payload5 = data[6] || '';\nmsg.payload6 = data[7] || '';\nmsg.payload7 = data[8] || '';\nmsg.payload8 = data[9] || '';\nmsg.payload9 = data[10] || '';\nmsg.payload10 = data[11] || '';\nmsg.payload11 = data[12] || '';\nmsg.payload12 = data[13] || '';\nmsg.payload13 = data[14] || '';\nmsg.payload14 = data[15] || '';\nmsg.payload15 = data[16] || '';\nmsg.payload16 = data[17] || '';\nmsg.payload17 = data[18] || '';\nmsg.payload18 = data[19] || '';\nmsg.payload19 = data[20] || '';\nmsg.payload20 = data[21] || '';\nmsg.payload21 = data[22] || '';\nmsg.payload22 = data[23] || '';\nmsg.payload23 = data[24] || '';\nmsg.payload24 = data[25] || '';\nmsg.payload25 = data[26] || '';\nmsg.payload26 = data[27] || '';\nmsg.payload27 = data[28] || '';\nmsg.payload28 = data[29] || '';\nmsg.payload29 = data[30] || '';\n\nreturn [\n    { payload: msg.payload1 },\n    { payload: msg.payload2 },\n    { payload: msg.payload3 },\n    { payload: msg.payload4 },\n    { payload: msg.payload5 },\n    { payload: msg.payload6 },\n    { payload: msg.payload7 },\n    { payload: msg.payload8 },\n    { payload: msg.payload9 },\n    { payload: msg.payload10 },\n    { payload: msg.payload11 },\n    { payload: msg.payload12 },\n    { payload: msg.payload13 },\n    { payload: msg.payload14 },\n    { payload: msg.payload15 },\n    { payload: msg.payload16 },\n    { payload: msg.payload17 },\n    { payload: msg.payload18 },\n    { payload: msg.payload19 },\n    { payload: msg.payload20 },\n    { payload: msg.payload21 },\n    { payload: msg.payload22 },\n    { payload: msg.payload23 },\n    { payload: msg.payload24 },\n    { payload: msg.payload25 },\n    { payload: msg.payload26 },\n    { payload: msg.payload27 },\n    { payload: msg.payload28 },\n    { payload: msg.payload29 },\n];\n","outputs":29,"noerr":0,"initialize":"","finalize":"","x":790,"y":780,"wires":[["d38997d.eb6c568","842f51dd.bfd94"],["5ff6a7d4.74b0a8","c4a851da.33c5f"],["1d06fa6a.eabc06","111d04a4.232c9b"],["457c600f.d2bd3","360665c8.30ae5a"],["bec3c202.4a0d6","df3af9f0.63db28"],["82f9538d.7f546","51308170.c7a35"],["a584c733.d70c38","ddd6908.a0cfb7"],["d76dfbe0.498b98","35d214d3.49d38c"],["616baa27.a3f3b4","5b73d0c7.9dee6"],["69b3596b.1b1b58","49d2e226.1ad7fc"],["a5f6fb98.d6e2d8","ed7877a8.ad6ad8"],["fd35ee62.e31f4","383b1539.eb6a9a"],["df092b0f.b51c28","e7e50665.6437a8"],["3307d823.4310e8","e906a26d.c8b72"],["e369a1f3.6ba54","ba08376a.1d2018"],["af2b84fb.99d8c8","3071aa35.c11786"],["757e3673.02eca8","d2e4cde.872f23"],["1c7f018d.393d5e","7a41ca8e.c223c4"],["9c4e0ee3.d1d66","4cff2afb.c825f4"],["7ff71f7a.c8f25","be35a5c2.e92738"],["3752f3aa.9fd4ec","8c4822fd.7960f"],["7b2929f.27018d8","3c8fa81e.a7dcc8"],["8fba337f.24da4","aa8c2634.ed5d48"],["a9a70243.b628","718183cf.930c0c"],["f2b1a9a9.6665b8","cf559228.e15f"],["484dc827.6e4f28","49f48fee.f78e1"],["d0bdf8d4.b2ca68","32ee3569.6be99a"],["265d1e50.53f5c2","5ca325c3.fdb7cc"],["f42d3465.c3d678","55e9662c.e46628"]]},{"id":"53a2cca5.877f74","type":"comment","z":"acb46316.472a9","name":"MODIFICADO PENAGOS","info":"","x":790,"y":100,"wires":[]},{"id":"37a5ddeb.3420c2","type":"function","z":"acb46316.472a9","name":"Formatear para el historial","func":"let ruta_sd = global.get('ruta_sd');\nruta_sd = `${ruta_sd}historial_procesos_personalizado.csv`;\nmsg.filename = ruta_sd\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":790,"y":140,"wires":[["3002201f.15dd6"]]},{"id":"387f3ab9.b7b4b6","type":"link in","z":"acb46316.472a9","name":"Recetas personalizadas is pressed","links":["37cc59a4.8c53e6","4af850f1.fa451","4afaf7de.f48f88","529e3ce.f495bc4","5de61ad5.9da954","72373d7f.625d74","729ad47.345f02c","97a4b076.4fce7","a04f9ded.f8497","c6c3788f.f71b88"],"x":575,"y":140,"wires":[["37a5ddeb.3420c2"]]},{"id":"972f1132.54b3f","type":"function","z":"acb46316.472a9","name":"Global Obtener nombres de archivos","func":"//formato correcto\nlet lines = msg.payload.split('\\n');\nlet filenamesMap = {};\nlet filenames = lines.map(line => {\n    let trimmedName = line.trim();\n    \n// Extraer la parte del nombre que contiene \"Estandar_\"\nlet index = trimmedName.indexOf('/Personalizado_');\nif (index !== -1) {\n    let filename = trimmedName.substring(index + 1);  // Solo toma desde \"/Estandar_\" en adelante\n    \n    // Remover la extensión .csv\n    let filenameWithoutExt = filename.replace('.csv', '');\n    \n    // Separar el nombre para darle el formato adecuado\n    let parts = filenameWithoutExt.split('_');  // Separar en \"Estandar\", fecha y hora\n    \n    if (parts.length === 3) {\n        let date = parts[1];  // Fecha en formato AAAAMMDD\n        let time = parts[2];  // Hora en formato HHMMSS\n        \n        // Formatear hora y fecha\n        let formattedTime = `${time.slice(0, 2)}:${time.slice(2, 4)}:${time.slice(4, 6)}`; // HH:MM:SS\n        let formattedDate = `${date.slice(6, 8)}/${date.slice(4, 6)}/${date.slice(0, 4)}`; // DD/MM/YYYY\n        \n        let formattedName = `${formattedTime} - ${formattedDate} - ${parts[0]}`;  // Ejemplo: \"12:25:36 09/10/2024 Estandar\"\n        \n        filenamesMap[formattedName] = filename;  // Mapear el nombre formateado con el nombre original\n        return formattedName;\n    }\n}\nreturn '';  // Si no contiene \"Estandar_\", retorna una cadena vacía\n}).filter(name => name !== '');  // Filtrar nombres vacíos\n\n// Invertir el orden de los nombres\nfilenames.reverse();\n\n// Guardar el mapeo en el contexto global\nglobal.set('filenamesMap', filenamesMap);\n\nmsg.options = filenames;  // Solo un arreglo de strings\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":810,"y":280,"wires":[["59aeea6.9ffef14"]]},{"id":"1fe8f762.512dc9","type":"function","z":"acb46316.472a9","name":"Recuperar nombre original","func":"let filenamesMap = global.get('filenamesMap');\nlet selectedFormattedName = msg.payload;  // El nombre formateado seleccionado\n\n// Recuperar el nombre original del archivo\nlet originalFilename = filenamesMap[selectedFormattedName];\nif (originalFilename) {\n    let ruta_sd = global.get('ruta_sd');  // Obtener la ruta base\n    msg.filename = `${ruta_sd}${originalFilename}`;  // Construir la ruta completa\n    return msg;\n} else {\n    node.error('No se encontró el archivo original para la selección: ' + selectedFormattedName);\n    return null;\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":800,"y":400,"wires":[["90fdce02.76cfe"]]},{"id":"5de61ad5.9da954","type":"link out","z":"ff06c4a0.7e7488","name":"Recetas personalizadas is pressed","links":["387f3ab9.b7b4b6"],"x":1515,"y":720,"wires":[]},{"id":"5cb4f684.ac1cd8","type":"ui_button","z":"cf6e4dbe.06b5d","name":"","group":"5da4ffa9.3ed6c","order":45,"width":3,"height":3,"passthru":false,"label":"Curvas","tooltip":"","color":"","bgcolor":"#8adf9d","className":"left_menu_button_purple","icon":"","payload":"","payloadType":"str","topic":"","topicType":"str","x":2200,"y":480,"wires":[["91e4d3ff.42d3"]]},{"id":"91e4d3ff.42d3","type":"change","z":"cf6e4dbe.06b5d","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"Waves_tab\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2200,"y":540,"wires":[["59609729.084918"]]},{"id":"59609729.084918","type":"ui_ui_control","z":"cf6e4dbe.06b5d","name":"","events":"all","x":2200,"y":600,"wires":[[]]},{"id":"88ee6229.f3ff","type":"change","z":"cf6e4dbe.06b5d","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"Data_personalized_tab\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":2220,"y":340,"wires":[["6a92d0dd.2b585"]]},{"id":"6a92d0dd.2b585","type":"ui_ui_control","z":"cf6e4dbe.06b5d","name":"","events":"all","x":2200,"y":400,"wires":[[]]},{"id":"803b6d32.b1d3e","type":"ui_button","z":"1d0b3b5c.03ac95","name":"","group":"c34a93b.47fb57","order":9,"width":5,"height":1,"passthru":false,"label":"Curvas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":340,"y":600,"wires":[["76139957.015b48"]]},{"id":"76139957.015b48","type":"change","z":"1d0b3b5c.03ac95","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"Waves_tab\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":580,"y":600,"wires":[["82317fd.0f0e08"]]},{"id":"82317fd.0f0e08","type":"ui_ui_control","z":"1d0b3b5c.03ac95","name":"","events":"all","x":760,"y":600,"wires":[[]]},{"id":"2ffd50a4.6bc4d","type":"link in","z":"1d0b3b5c.03ac95","name":"Button curvas","links":["16734c62.703c54","42b7cb6e.dd25f4","addade71.c9c3d","4ffa43a3.78b52c","389b38d2.d85458","705a0eeb.7e7b9","9dea760b.bf34a8","2844d2dc.b6d98e","d0d314ac.24a008","8d2ccbbe.28cd08"],"x":295,"y":640,"wires":[["76139957.015b48"]]},{"id":"6ab152b1.45c88c","type":"link out","z":"e69d9ae9.d86958","name":"Button configuracion","links":["771e4305.4ae1ec"],"x":415,"y":460,"wires":[]},{"id":"addade71.c9c3d","type":"link out","z":"e69d9ae9.d86958","name":"Button curvas","links":["2ffd50a4.6bc4d","c9352d07.34daf"],"x":415,"y":400,"wires":[]},{"id":"42b7cb6e.dd25f4","type":"link out","z":"cf6e4dbe.06b5d","name":"Button curvas","links":["2ffd50a4.6bc4d","c9352d07.34daf"],"x":275,"y":340,"wires":[]},{"id":"a33a7bab.3439d8","type":"ui_button","z":"e69d9ae9.d86958","name":"","group":"be9c39d7.f42578","order":22,"width":5,"height":1,"passthru":false,"label":"Curvas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":220,"y":400,"wires":[["addade71.c9c3d"]]},{"id":"64a2b6a3.8a3918","type":"ui_button","z":"cf6e4dbe.06b5d","name":"","group":"5da4ffa9.3ed6c","order":30,"width":5,"height":1,"passthru":false,"label":"Curvas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":80,"y":340,"wires":[["42b7cb6e.dd25f4"]]},{"id":"4bf57ffc.2107f","type":"ui_button","z":"ff06c4a0.7e7488","name":"","group":"78ed841d.d7023c","order":19,"width":5,"height":1,"passthru":false,"label":"Curvas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":240,"y":460,"wires":[["16734c62.703c54"]]},{"id":"16734c62.703c54","type":"link out","z":"ff06c4a0.7e7488","name":"Button curvas","links":["2ffd50a4.6bc4d","c9352d07.34daf"],"x":455,"y":460,"wires":[]},{"id":"4ffa43a3.78b52c","type":"link out","z":"acb46316.472a9","name":"Button curvas","links":["2ffd50a4.6bc4d","c9352d07.34daf"],"x":315,"y":340,"wires":[]},{"id":"a69d267a.f6a4e8","type":"ui_button","z":"acb46316.472a9","name":"","group":"7bf35741.d78c68","order":28,"width":5,"height":1,"passthru":false,"label":"Curvas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":100,"y":340,"wires":[["4ffa43a3.78b52c"]]},{"id":"889dc80b.a24e38","type":"ui_button","z":"934099b7.c96bb8","name":"","group":"cca89ca3.f14d7","order":12,"width":5,"height":1,"passthru":false,"label":"Curvas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":280,"y":540,"wires":[["705a0eeb.7e7b9"]]},{"id":"705a0eeb.7e7b9","type":"link out","z":"934099b7.c96bb8","name":"Button curvas","links":["2ffd50a4.6bc4d","c9352d07.34daf"],"x":475,"y":540,"wires":[]},{"id":"6c1a03fd.04e76c","type":"ui_button","z":"53774dfa.efea64","name":"","group":"9f83ddf8.9d529","order":12,"width":5,"height":1,"passthru":false,"label":"Curvas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":200,"y":520,"wires":[["9dea760b.bf34a8"]]},{"id":"9dea760b.bf34a8","type":"link out","z":"53774dfa.efea64","name":"Button curvas","links":["2ffd50a4.6bc4d","c9352d07.34daf"],"x":395,"y":520,"wires":[]},{"id":"d72ed8fb.592e78","type":"ui_button","z":"804acb1a.0445f8","name":"","group":"73d41b87.143354","order":16,"width":5,"height":1,"passthru":false,"label":"Curvas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":240,"y":500,"wires":[["2844d2dc.b6d98e"]]},{"id":"2844d2dc.b6d98e","type":"link out","z":"804acb1a.0445f8","name":"Button curvas","links":["2ffd50a4.6bc4d","c9352d07.34daf"],"x":435,"y":500,"wires":[]},{"id":"45d2467a.ba88c8","type":"ui_button","z":"34168811.ab73a8","name":"","group":"f98bd4ef.b5b8a8","order":18,"width":5,"height":1,"passthru":false,"label":"Curvas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":140,"y":440,"wires":[["8d2ccbbe.28cd08"]]},{"id":"8d2ccbbe.28cd08","type":"link out","z":"34168811.ab73a8","name":"Button curvas","links":["2ffd50a4.6bc4d","c9352d07.34daf"],"x":375,"y":440,"wires":[]},{"id":"d4127f9f.a006f","type":"ui_button","z":"acb46316.472a9","name":"","group":"7bf35741.d78c68","order":33,"width":3,"height":3,"passthru":false,"label":"Estandar","tooltip":"Recetas","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":1740,"y":100,"wires":[["3a6aac23.5322d4","521f92ee.fe5e2c"]]},{"id":"3a6aac23.5322d4","type":"change","z":"acb46316.472a9","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"Data_tab\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":1760,"y":140,"wires":[["9161e96f.ea8af8"]]},{"id":"9161e96f.ea8af8","type":"ui_ui_control","z":"acb46316.472a9","name":"","events":"all","x":1760,"y":180,"wires":[[]]},{"id":"84bc5235.c8927","type":"ui_button","z":"acb46316.472a9","name":"","group":"7bf35741.d78c68","order":48,"width":3,"height":3,"passthru":false,"label":"Usar receta","tooltip":"","color":"","bgcolor":"","className":"left_menu_button_purple","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":1750,"y":240,"wires":[["d85aaf80.cd0fb","85aae11.4612e2"]]},{"id":"d85aaf80.cd0fb","type":"change","z":"acb46316.472a9","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"tab\":\"Personalized_process_tab\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":1760,"y":280,"wires":[["648c6871.70ea98"]]},{"id":"648c6871.70ea98","type":"ui_ui_control","z":"acb46316.472a9","name":"","events":"all","x":1760,"y":320,"wires":[[]]},{"id":"521f92ee.fe5e2c","type":"link out","z":"acb46316.472a9","name":"Button datos","links":["1b53150c.dee5bb"],"x":1885,"y":100,"wires":[]},{"id":"d43c4452.743b88","type":"ui_button","z":"b00549e6.aec4c8","name":"","group":"29d83d86.1999e2","order":4,"width":5,"height":1,"passthru":false,"label":"Principal","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":200,"y":260,"wires":[["21fefe5.c97ac02"]]},{"id":"2642b230.59fc9e","type":"ui_button","z":"b00549e6.aec4c8","name":"","group":"29d83d86.1999e2","order":6,"width":5,"height":1,"passthru":false,"label":"Graficas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":200,"y":320,"wires":[["2bd0b403.3cacac"]]},{"id":"3561af8f.08dfd","type":"ui_button","z":"b00549e6.aec4c8","name":"","group":"29d83d86.1999e2","order":7,"width":5,"height":1,"passthru":false,"label":"Recetas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":200,"y":380,"wires":[["a04f9ded.f8497"]]},{"id":"ed9991fd.8771f","type":"ui_button","z":"b00549e6.aec4c8","name":"","group":"29d83d86.1999e2","order":9,"width":5,"height":1,"passthru":false,"label":"Configuración","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":220,"y":500,"wires":[["fccea8ff.1ce958"]]},{"id":"42678ae2.50ad54","type":"ui_media","z":"b00549e6.aec4c8","group":"29d83d86.1999e2","name":"logo_penagos","width":5,"height":2,"order":1,"category":"logos","file":"logo_penagos.png","layout":"center","showcontrols":true,"loop":true,"onstart":false,"scope":"local","tooltip":"","x":220,"y":200,"wires":[[]]},{"id":"ea6a38ee.8a7f38","type":"ui_media","z":"b00549e6.aec4c8","group":"29d83d86.1999e2","name":"logo_aciv","width":5,"height":2,"order":11,"category":"logo_aciv","file":"logo_aciv.png","layout":"center","showcontrols":true,"loop":true,"onstart":false,"scope":"local","tooltip":"","x":200,"y":560,"wires":[[]]},{"id":"2b591307.7e914c","type":"ui_button","z":"b00549e6.aec4c8","name":"","group":"29d83d86.1999e2","order":10,"width":5,"height":2,"passthru":false,"label":"Parada de emergencia","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":240,"y":620,"wires":[["7074215d.8438e"]]},{"id":"90d06a72.cd43e8","type":"inject","z":"b00549e6.aec4c8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":830,"y":160,"wires":[["22ca91d9.d540be"]]},{"id":"f194ba9.4ef5148","type":"file in","z":"b00549e6.aec4c8","name":"Leer historial_procesos.csv","filename":"","format":"utf8","chunk":false,"sendError":true,"encoding":"none","x":880,"y":300,"wires":[["60b7d9ff.7ec078"]]},{"id":"7a7862a4.5f14ac","type":"debug","z":"b00549e6.aec4c8","name":"Mostrar en debug","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","statusVal":"","statusType":"auto","x":1190,"y":520,"wires":[]},{"id":"e6ee14e.cdd4ee8","type":"ui_dropdown","z":"b00549e6.aec4c8","name":"Dropdown seleccionar archivo","label":"Seleccionar proceso","tooltip":"","place":"Seleccione...","group":"29d83d86.1999e2","order":2,"width":13,"height":1,"passthru":true,"multiple":false,"options":[],"payload":"","topic":"","topicType":"str","className":"Dropdown","x":890,"y":420,"wires":[["eb0aaf58.37a91"]]},{"id":"66603f6d.7a28e","type":"function","z":"b00549e6.aec4c8","name":"Procesar CSV","func":"let lines = msg.payload.split('\\n');\nlet data = [];\n\nlines.forEach(line => {\n    let parts = line.split(',');\n    if(parts.length === 2) {\n        let value = parseFloat(parts[0]);\n        let timestamp = new Date(parts[1]).getTime();\n        data.push({x: timestamp, y: value});\n    }\n});\n\nmsg.payload = [{\n    \"series\": [\"Sensor\"],\n    \"data\": [data],\n    \"labels\": data.map(d => new Date(d.x).toLocaleTimeString())\n}];\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":940,"y":860,"wires":[["2c886456.e8564c"]]},{"id":"f30d964e.cea0a8","type":"file in","z":"b00549e6.aec4c8","name":"Read CSV","filename":"","format":"utf8","chunk":false,"sendError":true,"encoding":"none","x":1050,"y":780,"wires":[["66603f6d.7a28e"]]},{"id":"ca08d716.46e318","type":"change","z":"b00549e6.aec4c8","name":"Set filename","rules":[{"t":"set","p":"filename","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":970,"y":700,"wires":[["3a01e7b6.cc5718"]]},{"id":"2c886456.e8564c","type":"ui_chart","z":"b00549e6.aec4c8","name":"Dropdown1","group":"29d83d86.1999e2","order":5,"width":13,"height":9,"label":"{{msg.label}}","chartType":"line","legend":"false","xformat":"HH:mm","interpolate":"linear","nodata":"","dot":false,"ymin":"","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"86400","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd"],"outputs":1,"useDifferentColor":false,"className":"","x":950,"y":920,"wires":[[]]},{"id":"3a01e7b6.cc5718","type":"function","z":"b00549e6.aec4c8","name":"Nombre grafica","func":"sensor = msg.filename\n\n// Remover \"sensor_\" del inicio\nsensor = sensor.replace(\"sensor_\", \"\");\n\n// Remover \".csv\" del final\nsensor = sensor.replace(\".csv\", \"\");\n\n// Agregar \" vs tiempo\"\nsensor += \" vs tiempo\";\n\nmsg.sensor = sensor\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":860,"y":780,"wires":[["f30d964e.cea0a8"]]},{"id":"9e0cdd11.6c9e9","type":"inject","z":"b00549e6.aec4c8","name":"","props":[{"p":"payload"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":810,"y":580,"wires":[["b20d141a.17c8c8"]]},{"id":"d36132aa.e1647","type":"function","z":"b00549e6.aec4c8","name":"Global Set variables global.filename_historial","func":"global.set('filename_historial', msg.filename);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1250,"y":480,"wires":[[]]},{"id":"c9352d07.34daf","type":"link in","z":"b00549e6.aec4c8","name":"Actualizar historial en curvas","links":["16734c62.703c54","2844d2dc.b6d98e","42b7cb6e.dd25f4","4ffa43a3.78b52c","705a0eeb.7e7b9","8d2ccbbe.28cd08","9dea760b.bf34a8","addade71.c9c3d","c44f9cc3.c95b7","d0d314ac.24a008"],"x":675,"y":240,"wires":[["22ca91d9.d540be"]]},{"id":"b20d141a.17c8c8","type":"ui_dropdown","z":"b00549e6.aec4c8","name":"","label":"Seleccionar variable","tooltip":"","place":"Gráfica 1","group":"29d83d86.1999e2","order":3,"width":13,"height":1,"passthru":true,"multiple":false,"options":[{"label":"Temperatura torre 1","value":"temp1","type":"str"},{"label":"Temperatura torre 2","value":"temp2","type":"str"},{"label":"Temperatura resistencia","value":"tempr","type":"str"},{"label":"Humedad torre 1","value":"hum1","type":"str"},{"label":"Humedad torre 2","value":"hum2","type":"str"},{"label":"Humedad resistencia","value":"humr","type":"str"},{"label":"Humedad exterior","value":"humext","type":"str"},{"label":"Peso torre 1","value":"weight1","type":"str"},{"label":"Peso torre 2","value":"weight2","type":"str"}],"payload":"","topic":"","topicType":"str","className":"Dropdown","x":1000,"y":580,"wires":[["2572aa39.e85596"]]},{"id":"22ca91d9.d540be","type":"function","z":"b00549e6.aec4c8","name":"Formatear para el historial","func":"let ruta_sd = global.get('ruta_sd');\nruta_sd = `${ruta_sd}historial_procesos.csv`;\nmsg.filename = ruta_sd\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":870,"y":240,"wires":[["f194ba9.4ef5148"]]},{"id":"21fefe5.c97ac02","type":"link out","z":"b00549e6.aec4c8","name":"Button principal","links":["d3164bb5.dc7108"],"x":415,"y":260,"wires":[]},{"id":"2bd0b403.3cacac","type":"link out","z":"b00549e6.aec4c8","name":"Button estadisticas","links":["33d4c9f5.adb4f6"],"x":415,"y":320,"wires":[]},{"id":"a04f9ded.f8497","type":"link out","z":"b00549e6.aec4c8","name":"Button datos","links":["dab5ee12.f38","1b53150c.dee5bb","3b0829d3.a227c6","1d88f23.8ead40e","387f3ab9.b7b4b6"],"x":415,"y":380,"wires":[]},{"id":"7074215d.8438e","type":"link out","z":"b00549e6.aec4c8","name":"Button parada de emergencia","links":["a521d39a.e8ad6"],"x":415,"y":620,"wires":[]},{"id":"2572aa39.e85596","type":"function","z":"b00549e6.aec4c8","name":"Agregar _variable.csv","func":"let dropdownValue = msg.payload; // El valor que proviene del dropdown\nlet label = \"\"; // Para almacenar el label\n\n// Mapear el valor seleccionado a su correspondiente label\nswitch (dropdownValue) {\n    case \"temp1\":\n        label = \"Temperatura torre 1\";\n        break;\n    case \"temp2\":\n        label = \"Temperatura torre 2\";\n        break;\n    case \"tempr\":\n        label = \"Temperatura resistencia\";\n        break;\n    case \"hum1\":\n        label = \"Humedad torre 1\";\n        break;\n    case \"hum2\":\n        label = \"Humedad torre 2\";\n        break;\n    case \"humr\":\n        label = \"Humedad resistencia\";\n        break;\n    case \"humext\":\n        label = \"Humedad exterior\";\n        break;\n    case \"weight1\":\n        label = \"Peso torre 1\";\n        break;\n    case \"weight2\":\n        label = \"Peso torre 2\";\n        break;\n    default:\n        label = \"Dato desconocido\";\n}\n\nlet filename = global.get('filename_historial') || 'No value';\nmsg.payload = filename.slice(0, -4) + \"_\" + msg.payload + \".csv\";\n\n// Formatear el label como \"label seleccionado vs tiempo\"\nmsg.label = label + \" vs tiempo\";\n\n// Devolver el mensaje con el label agregado\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":980,"y":640,"wires":[["ca08d716.46e318"]]},{"id":"eb0aaf58.37a91","type":"function","z":"b00549e6.aec4c8","name":"Recuperar nombre original","func":"let filenamesMap = global.get('filenamesMap');\nlet selectedFormattedName = msg.payload;  // El nombre formateado seleccionado\n\n// Recuperar el nombre original del archivo\nlet originalFilename = filenamesMap[selectedFormattedName];\nif (originalFilename) {\n    let ruta_sd = global.get('ruta_sd');  // Obtener la ruta base\n    msg.filename = `${ruta_sd}${originalFilename}`;  // Construir la ruta completa\n    return msg;\n} else {\n    node.error('No se encontró el archivo original para la selección: ' + selectedFormattedName);\n    return null;\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":880,"y":480,"wires":[["7a7862a4.5f14ac","d36132aa.e1647"]]},{"id":"60b7d9ff.7ec078","type":"function","z":"b00549e6.aec4c8","name":"Global Obtener nombres de archivos","func":"// Procesar cada línea del historial de archivos\nlet lines = msg.payload.split('\\n');\nlet filenamesMap = {};\nlet filenames = lines.map(line => {\n    let trimmedName = line.trim();\n    \n    // Verificar si el nombre contiene \"Estandar_\" o \"Personalizado_\"\n    let indexEstandar = trimmedName.indexOf('/Estandar_');\n    let indexPersonalizado = trimmedName.indexOf('/Personalizado_');\n    \n    // Determinar el prefijo (Estandar o Personalizado)\n    let prefix = '';\n    let filename = '';\n    if (indexEstandar !== -1) {\n        prefix = 'Estandar';\n        filename = trimmedName.substring(indexEstandar + 1);  // Solo toma desde \"/Estandar_\" en adelante\n    } else if (indexPersonalizado !== -1) {\n        prefix = 'Personalizado';\n        filename = trimmedName.substring(indexPersonalizado + 1);  // Solo toma desde \"/Personalizado_\" en adelante\n    }\n\n    if (filename) {\n        // Remover la extensión .csv\n        let filenameWithoutExt = filename.replace('.csv', '');\n        \n        // Separar el nombre para darle el formato adecuado\n        let parts = filenameWithoutExt.split('_');  // Separar en prefijo, fecha y hora\n        \n        if (parts.length === 3) {\n            let date = parts[1];  // Fecha en formato AAAAMMDD\n            let time = parts[2];  // Hora en formato HHMMSS\n            \n            // Formatear hora y fecha\n            let formattedTime = `${time.slice(0, 2)}:${time.slice(2, 4)}:${time.slice(4, 6)}`; // HH:MM:SS\n            let formattedDate = `${date.slice(6, 8)}/${date.slice(4, 6)}/${date.slice(0, 4)}`; // DD/MM/YYYY\n            \n            let formattedName = `${formattedTime} - ${formattedDate} - ${prefix}`;  // Ejemplo: \"12:25:36 09/10/2024 Estandar\"\n            \n            filenamesMap[formattedName] = filename;  // Mapear el nombre formateado con el nombre original\n            return formattedName;\n        }\n    }\n    return '';  // Si no contiene \"Estandar_\" o \"Personalizado_\", retorna una cadena vacía\n}).filter(name => name !== '');  // Filtrar nombres vacíos\n\n// Invertir el orden de los nombres\nfilenames.reverse();\n\n// Guardar el mapeo en el contexto global\nglobal.set('filenamesMap', filenamesMap);\n\nmsg.options = filenames;  // Solo un arreglo de strings\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":910,"y":360,"wires":[["e6ee14e.cdd4ee8"]]},{"id":"d611bd45.a3233","type":"ui_button","z":"b00549e6.aec4c8","name":"","group":"29d83d86.1999e2","order":8,"width":5,"height":1,"passthru":false,"label":"Curvas","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":200,"y":440,"wires":[["d0d314ac.24a008"]]},{"id":"fccea8ff.1ce958","type":"link out","z":"b00549e6.aec4c8","name":"Button configuracion","links":["771e4305.4ae1ec"],"x":415,"y":500,"wires":[]},{"id":"d0d314ac.24a008","type":"link out","z":"b00549e6.aec4c8","name":"Button curvas","links":["2ffd50a4.6bc4d","c9352d07.34daf"],"x":415,"y":440,"wires":[]},{"id":"97e32728.d506d8","type":"change","z":"ff06c4a0.7e7488","name":"","rules":[{"t":"set","p":"temp_pre_secado","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2160,"y":260,"wires":[[]]},{"id":"aa959eaf.ecfcf","type":"change","z":"ff06c4a0.7e7488","name":"","rules":[{"t":"set","p":"time_pre_secado","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2160,"y":300,"wires":[[]]},{"id":"ba77ed0e.481c4","type":"change","z":"ff06c4a0.7e7488","name":"","rules":[{"t":"set","p":"temp_final","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2140,"y":420,"wires":[[]]},{"id":"52d0ba85.12b234","type":"change","z":"ff06c4a0.7e7488","name":"","rules":[{"t":"set","p":"time_final","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2140,"y":460,"wires":[[]]},{"id":"bf340caf.672ab","type":"change","z":"ff06c4a0.7e7488","name":"","rules":[{"t":"set","p":"temp_oreado","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2150,"y":340,"wires":[[]]},{"id":"8daf52c1.09751","type":"change","z":"ff06c4a0.7e7488","name":"","rules":[{"t":"set","p":"time_oreado","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2140,"y":380,"wires":[[]]},{"id":"57b1346f.84bd2c","type":"change","z":"ff06c4a0.7e7488","name":"","rules":[{"t":"set","p":"torre","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2120,"y":500,"wires":[[]]},{"id":"9c96c24.618bb4","type":"comment","z":"ff06c4a0.7e7488","name":"Actualizar variables globales para usar la receta","info":"","x":2220,"y":220,"wires":[]},{"id":"11146eb5.052061","type":"function","z":"ff06c4a0.7e7488","name":"Obtener Variables Globales","func":"// Lista de nombres de variables globales\nlet globalVariables = [\n    \"temp_pre_secado\",\n    \"time_pre_secado\",\n    \"temp_oreado\",\n    \"time_oreado\",\n    \"temp_final\",\n    \"time_final\",\n    \"torre\"\n];\n\n// Crear un mensaje para cada variable en su propia salida\nlet messages = globalVariables.map(varName => {\n    let value = global.get(varName);\n    return { payload: value };  // Asignar solo el valor\n});\n\n// Enviar cada mensaje en una salida específica\nreturn messages;\n","outputs":7,"noerr":0,"initialize":"","finalize":"","x":2140,"y":720,"wires":[["3aac3e76.63e732"],["4c37f48f.338f5c"],["6d2eb10f.85c05"],["a965e765.95c068"],["2ff92626.d3947a"],["c0912baf.d0e258"],[]]},{"id":"3aac3e76.63e732","type":"link out","z":"ff06c4a0.7e7488","name":"temp_pre_secado","links":["9948d7c9.08d6c8"],"x":2355,"y":680,"wires":[]},{"id":"4c37f48f.338f5c","type":"link out","z":"ff06c4a0.7e7488","name":"time_pre_secado","links":["9260f1ea.8e607"],"x":2355,"y":720,"wires":[]},{"id":"6d2eb10f.85c05","type":"link out","z":"ff06c4a0.7e7488","name":"temp_oreado","links":["b023701d.99ae7"],"x":2355,"y":760,"wires":[]},{"id":"a965e765.95c068","type":"link out","z":"ff06c4a0.7e7488","name":"time_oreado","links":["9ed3dc04.90d45"],"x":2355,"y":800,"wires":[]},{"id":"2ff92626.d3947a","type":"link out","z":"ff06c4a0.7e7488","name":"temp_final","links":["e86b6d8d.4f422"],"x":2355,"y":840,"wires":[]},{"id":"c0912baf.d0e258","type":"link out","z":"ff06c4a0.7e7488","name":"time_final","links":["589b1e5c.ee8e4"],"x":2355,"y":880,"wires":[]},{"id":"6834a30f.517d5c","type":"link out","z":"ff06c4a0.7e7488","name":"torre","links":["1b2c3cd2.1ced73"],"x":2355,"y":920,"wires":[]},{"id":"9948d7c9.08d6c8","type":"link in","z":"e69d9ae9.d86958","name":"","links":["3aac3e76.63e732"],"x":655,"y":140,"wires":[["14f4141d.249d4c"]]},{"id":"9260f1ea.8e607","type":"link in","z":"e69d9ae9.d86958","name":"","links":["4c37f48f.338f5c"],"x":655,"y":180,"wires":[["62cc1765.158c18"]]},{"id":"b023701d.99ae7","type":"link in","z":"e69d9ae9.d86958","name":"","links":["6d2eb10f.85c05"],"x":655,"y":220,"wires":[["4e0e99a6.a16968"]]},{"id":"9ed3dc04.90d45","type":"link in","z":"e69d9ae9.d86958","name":"","links":["a965e765.95c068"],"x":655,"y":260,"wires":[["ac1f9248.99e93"]]},{"id":"e86b6d8d.4f422","type":"link in","z":"e69d9ae9.d86958","name":"","links":["2ff92626.d3947a"],"x":655,"y":300,"wires":[["163be880.2c6fa8"]]},{"id":"589b1e5c.ee8e4","type":"link in","z":"e69d9ae9.d86958","name":"","links":["c0912baf.d0e258"],"x":655,"y":340,"wires":[["7cefc151.192f9"]]},{"id":"842f51dd.bfd94","type":"change","z":"acb46316.472a9","name":"Set 1temp","rules":[{"t":"set","p":"1temp","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1490,"y":320,"wires":[[]]},{"id":"c4a851da.33c5f","type":"change","z":"acb46316.472a9","name":"Set 2temp","rules":[{"t":"set","p":"2temp","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1490,"y":360,"wires":[[]]},{"id":"111d04a4.232c9b","type":"change","z":"acb46316.472a9","name":"Set 3temp","rules":[{"t":"set","p":"3temp","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1490,"y":400,"wires":[[]]},{"id":"360665c8.30ae5a","type":"change","z":"acb46316.472a9","name":"Set 4temp","rules":[{"t":"set","p":"4temp","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1490,"y":440,"wires":[[]]},{"id":"df3af9f0.63db28","type":"change","z":"acb46316.472a9","name":"Set 5temp","rules":[{"t":"set","p":"5temp","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1490,"y":480,"wires":[[]]},{"id":"51308170.c7a35","type":"change","z":"acb46316.472a9","name":"Set 6temp","rules":[{"t":"set","p":"6temp","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1490,"y":520,"wires":[[]]},{"id":"ddd6908.a0cfb7","type":"change","z":"acb46316.472a9","name":"Set 7temp","rules":[{"t":"set","p":"7temp","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1490,"y":560,"wires":[[]]},{"id":"35d214d3.49d38c","type":"change","z":"acb46316.472a9","name":"Set 8temp","rules":[{"t":"set","p":"8temp","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1490,"y":600,"wires":[[]]},{"id":"5b73d0c7.9dee6","type":"change","z":"acb46316.472a9","name":"Set 9temp","rules":[{"t":"set","p":"9temp","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1490,"y":640,"wires":[[]]},{"id":"49d2e226.1ad7fc","type":"change","z":"acb46316.472a9","name":"Set 1time","rules":[{"t":"set","p":"1time","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1480,"y":720,"wires":[[]]},{"id":"ed7877a8.ad6ad8","type":"change","z":"acb46316.472a9","name":"Set 2time","rules":[{"t":"set","p":"2time","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1480,"y":760,"wires":[[]]},{"id":"383b1539.eb6a9a","type":"change","z":"acb46316.472a9","name":"Set 3time","rules":[{"t":"set","p":"3time","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1480,"y":800,"wires":[[]]},{"id":"e7e50665.6437a8","type":"change","z":"acb46316.472a9","name":"Set 4time","rules":[{"t":"set","p":"4time","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1480,"y":840,"wires":[[]]},{"id":"e906a26d.c8b72","type":"change","z":"acb46316.472a9","name":"Set 5time","rules":[{"t":"set","p":"5time","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1480,"y":880,"wires":[[]]},{"id":"ba08376a.1d2018","type":"change","z":"acb46316.472a9","name":"Set 6time","rules":[{"t":"set","p":"6time","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1480,"y":920,"wires":[[]]},{"id":"3071aa35.c11786","type":"change","z":"acb46316.472a9","name":"Set 7time","rules":[{"t":"set","p":"7time","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1480,"y":960,"wires":[[]]},{"id":"d2e4cde.872f23","type":"change","z":"acb46316.472a9","name":"Set 8time","rules":[{"t":"set","p":"8time","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1480,"y":1000,"wires":[[]]},{"id":"7a41ca8e.c223c4","type":"change","z":"acb46316.472a9","name":"Set 9time","rules":[{"t":"set","p":"9time","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1480,"y":1040,"wires":[[]]},{"id":"4cff2afb.c825f4","type":"change","z":"acb46316.472a9","name":"Set 1shak","rules":[{"t":"set","p":"1shak","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1480,"y":1120,"wires":[[]]},{"id":"be35a5c2.e92738","type":"change","z":"acb46316.472a9","name":"Set 2shak","rules":[{"t":"set","p":"2shak","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1480,"y":1160,"wires":[[]]},{"id":"8c4822fd.7960f","type":"change","z":"acb46316.472a9","name":"Set 3shak","rules":[{"t":"set","p":"3shak","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1480,"y":1200,"wires":[[]]},{"id":"3c8fa81e.a7dcc8","type":"change","z":"acb46316.472a9","name":"Set 4shak","rules":[{"t":"set","p":"4shak","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1480,"y":1240,"wires":[[]]},{"id":"aa8c2634.ed5d48","type":"change","z":"acb46316.472a9","name":"Set 5shak","rules":[{"t":"set","p":"5shak","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1480,"y":1280,"wires":[[]]},{"id":"718183cf.930c0c","type":"change","z":"acb46316.472a9","name":"Set 6shak","rules":[{"t":"set","p":"6shak","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1480,"y":1320,"wires":[[]]},{"id":"cf559228.e15f","type":"change","z":"acb46316.472a9","name":"Set 7shak","rules":[{"t":"set","p":"7shak","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1480,"y":1360,"wires":[[]]},{"id":"49f48fee.f78e1","type":"change","z":"acb46316.472a9","name":"Set 8shak","rules":[{"t":"set","p":"8shak","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1480,"y":1400,"wires":[[]]},{"id":"32ee3569.6be99a","type":"change","z":"acb46316.472a9","name":"Set 9shak","rules":[{"t":"set","p":"9shak","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1480,"y":1440,"wires":[[]]},{"id":"5ca325c3.fdb7cc","type":"change","z":"acb46316.472a9","name":"Set ciclos","rules":[{"t":"set","p":"ciclos","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":900,"y":1080,"wires":[[]]},{"id":"55e9662c.e46628","type":"change","z":"acb46316.472a9","name":"Set flujo","rules":[{"t":"set","p":"flujo","pt":"global","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":900,"y":1180,"wires":[[]]},{"id":"85aae11.4612e2","type":"function","z":"acb46316.472a9","name":"Obtener Variables Globales","func":"// Lista de nombres de variables globales en el orden especificado\nlet globalVariables = [\n    \"1temp\", \"2temp\", \"3temp\", \"4temp\", \"5temp\", \"6temp\", \"7temp\", \"8temp\", \"9temp\",\n    \"1time\", \"2time\", \"3time\", \"4time\", \"5time\", \"6time\", \"7time\", \"8time\", \"9time\",\n    \"1shak\", \"2shak\", \"3shak\", \"4shak\", \"5shak\", \"6shak\", \"7shak\", \"8shak\", \"9shak\",\n    \"ciclos\", \"flujo\"\n];\n\n// Crear un mensaje para cada variable\nlet messages = globalVariables.map(varName => {\n    let value = global.get(varName);\n    return { payload: `${value}` };\n});\n\n// Enviar cada mensaje a su propia salida\nreturn messages;\n","outputs":29,"noerr":0,"initialize":"","finalize":"","x":1800,"y":640,"wires":[["d124fe24.b4388"],["b0e767a.aa6d898"],["dde31420.2e0988"],["e61963fa.3ef7e"],["a148bf35.c4619"],["294ee6dd.14e43a"],["49093582.d5478c"],["85392fcb.78601"],["599a612b.faa05"],["a90014eb.9d6878"],["cfbcff9.b688e"],["a727d60.0976e28"],["67cf70c3.25b2d"],["5a547670.7845e8"],["a39f473c.651f48"],["a99710a1.0f236"],["3cd81e6e.63c192"],["6e4f2b.41a840d4"],["13e6465f.8c2c3a"],["a9ce6774.e30118"],["a0d1b61.40c1c48"],["1aca2b11.c30685"],["3c816f73.e0f89"],["f3a13dab.e1348"],["d8fb582f.dddf58"],["96009b7b.1fd628"],["4ee3f200.e1481c"],["d706801f.f4038"],["65eccbf8.adfd74"]]},{"id":"d124fe24.b4388","type":"link out","z":"acb46316.472a9","name":"1temp","links":["d7e11478.5c0598"],"x":2075,"y":120,"wires":[]},{"id":"b0e767a.aa6d898","type":"link out","z":"acb46316.472a9","name":"2temp","links":["c92972e1.0541e"],"x":2075,"y":160,"wires":[]},{"id":"dde31420.2e0988","type":"link out","z":"acb46316.472a9","name":"3temp","links":["f730a91b.9184d8"],"x":2075,"y":200,"wires":[]},{"id":"e61963fa.3ef7e","type":"link out","z":"acb46316.472a9","name":"4temp","links":["334eac9c.9f7824"],"x":2075,"y":240,"wires":[]},{"id":"a148bf35.c4619","type":"link out","z":"acb46316.472a9","name":"5temp","links":["80cba874.a33478"],"x":2075,"y":280,"wires":[]},{"id":"294ee6dd.14e43a","type":"link out","z":"acb46316.472a9","name":"6temp","links":["a0338827.cd76c8"],"x":2075,"y":320,"wires":[]},{"id":"49093582.d5478c","type":"link out","z":"acb46316.472a9","name":"7temp","links":["9e36fa9d.2c1608"],"x":2075,"y":360,"wires":[]},{"id":"85392fcb.78601","type":"link out","z":"acb46316.472a9","name":"8temp","links":["e49dbf40.5a569"],"x":2075,"y":400,"wires":[]},{"id":"599a612b.faa05","type":"link out","z":"acb46316.472a9","name":"9temp","links":["56871386.b4202c"],"x":2075,"y":440,"wires":[]},{"id":"a90014eb.9d6878","type":"link out","z":"acb46316.472a9","name":"1time","links":["8d7333f3.15ff7"],"x":2095,"y":480,"wires":[]},{"id":"cfbcff9.b688e","type":"link out","z":"acb46316.472a9","name":"2time","links":["7a0ae3f6.c0d8ac"],"x":2095,"y":520,"wires":[]},{"id":"a727d60.0976e28","type":"link out","z":"acb46316.472a9","name":"3time","links":["8e4796f2.ee3308"],"x":2095,"y":560,"wires":[]},{"id":"67cf70c3.25b2d","type":"link out","z":"acb46316.472a9","name":"4time","links":["c85ae756.118138"],"x":2095,"y":600,"wires":[]},{"id":"5a547670.7845e8","type":"link out","z":"acb46316.472a9","name":"5time","links":["6257154e.384a8c"],"x":2095,"y":640,"wires":[]},{"id":"a39f473c.651f48","type":"link out","z":"acb46316.472a9","name":"6time","links":["dcb43aed.968798"],"x":2095,"y":680,"wires":[]},{"id":"a99710a1.0f236","type":"link out","z":"acb46316.472a9","name":"7time","links":["3317831c.b6d06c"],"x":2095,"y":720,"wires":[]},{"id":"3cd81e6e.63c192","type":"link out","z":"acb46316.472a9","name":"8time","links":["b7b5dab0.747358"],"x":2095,"y":760,"wires":[]},{"id":"6e4f2b.41a840d4","type":"link out","z":"acb46316.472a9","name":"9time","links":["9398b22e.e1bb4"],"x":2095,"y":800,"wires":[]},{"id":"13e6465f.8c2c3a","type":"link out","z":"acb46316.472a9","name":"1shak","links":["bcc07a47.712168"],"x":2075,"y":840,"wires":[]},{"id":"a9ce6774.e30118","type":"link out","z":"acb46316.472a9","name":"2shak","links":["11859873.251628"],"x":2075,"y":880,"wires":[]},{"id":"a0d1b61.40c1c48","type":"link out","z":"acb46316.472a9","name":"3shak","links":["9cf31e63.d062c"],"x":2075,"y":920,"wires":[]},{"id":"1aca2b11.c30685","type":"link out","z":"acb46316.472a9","name":"4shak","links":["5496711.7a05c9"],"x":2075,"y":960,"wires":[]},{"id":"3c816f73.e0f89","type":"link out","z":"acb46316.472a9","name":"5shak","links":["6298bff6.e27bf"],"x":2075,"y":1000,"wires":[]},{"id":"f3a13dab.e1348","type":"link out","z":"acb46316.472a9","name":"6shak","links":["3c8d54b7.7cf1ec"],"x":2075,"y":1040,"wires":[]},{"id":"d8fb582f.dddf58","type":"link out","z":"acb46316.472a9","name":"7shak","links":["6ca4ca65.f57774"],"x":2075,"y":1080,"wires":[]},{"id":"96009b7b.1fd628","type":"link out","z":"acb46316.472a9","name":"8shak","links":["dd0b291a.683458"],"x":2075,"y":1120,"wires":[]},{"id":"4ee3f200.e1481c","type":"link out","z":"acb46316.472a9","name":"9shak","links":["ebcaa8b4.de5ba8"],"x":2075,"y":1160,"wires":[]},{"id":"d706801f.f4038","type":"link out","z":"acb46316.472a9","name":"ciclos","links":["e8c81155.f0682"],"x":2095,"y":1200,"wires":[]},{"id":"65eccbf8.adfd74","type":"link out","z":"acb46316.472a9","name":"flujo","links":["e2c44609.c48d18"],"x":2095,"y":1240,"wires":[]},{"id":"d7e11478.5c0598","type":"link in","z":"cf6e4dbe.06b5d","name":"","links":["d124fe24.b4388"],"x":475,"y":480,"wires":[["1e38f36.4dfa30d","9a9ed52f.6a84e8"]]},{"id":"c92972e1.0541e","type":"link in","z":"cf6e4dbe.06b5d","name":"","links":["b0e767a.aa6d898"],"x":475,"y":520,"wires":[["e70cfbf.ac26308"]]},{"id":"f730a91b.9184d8","type":"link in","z":"cf6e4dbe.06b5d","name":"","links":["dde31420.2e0988"],"x":475,"y":560,"wires":[["c37907cb.df1ec8"]]},{"id":"334eac9c.9f7824","type":"link in","z":"cf6e4dbe.06b5d","name":"","links":["e61963fa.3ef7e"],"x":475,"y":600,"wires":[["c5107e10.6e912"]]},{"id":"80cba874.a33478","type":"link in","z":"cf6e4dbe.06b5d","name":"","links":["a148bf35.c4619"],"x":475,"y":640,"wires":[["dab799b9.e30f28"]]},{"id":"a0338827.cd76c8","type":"link in","z":"cf6e4dbe.06b5d","name":"","links":["294ee6dd.14e43a"],"x":475,"y":680,"wires":[["67381b7e.bb0ce4"]]},{"id":"9e36fa9d.2c1608","type":"link in","z":"cf6e4dbe.06b5d","name":"","links":["49093582.d5478c"],"x":475,"y":720,"wires":[["41762911.c6df98"]]},{"id":"e49dbf40.5a569","type":"link in","z":"cf6e4dbe.06b5d","name":"","links":["85392fcb.78601"],"x":475,"y":760,"wires":[["27647a03.2d5236"]]},{"id":"56871386.b4202c","type":"link in","z":"cf6e4dbe.06b5d","name":"","links":["599a612b.faa05"],"x":475,"y":800,"wires":[["662dda01.194644"]]},{"id":"8d7333f3.15ff7","type":"link in","z":"cf6e4dbe.06b5d","name":"","links":["a90014eb.9d6878"],"x":875,"y":480,"wires":[["dceac4.99cbc54","61bc48c7.735578"]]},{"id":"7a0ae3f6.c0d8ac","type":"link in","z":"cf6e4dbe.06b5d","name":"","links":["cfbcff9.b688e"],"x":875,"y":520,"wires":[["580d1a4.1d1dae4"]]},{"id":"8e4796f2.ee3308","type":"link in","z":"cf6e4dbe.06b5d","name":"","links":["a727d60.0976e28"],"x":875,"y":560,"wires":[["ff8b60b9.d03f"]]},{"id":"c85ae756.118138","type":"link in","z":"cf6e4dbe.06b5d","name":"","links":["67cf70c3.25b2d"],"x":875,"y":600,"wires":[["15693913.bcd077"]]},{"id":"6257154e.384a8c","type":"link in","z":"cf6e4dbe.06b5d","name":"","links":["5a547670.7845e8"],"x":875,"y":640,"wires":[["83105c6.9e212a"]]},{"id":"dcb43aed.968798","type":"link in","z":"cf6e4dbe.06b5d","name":"","links":["a39f473c.651f48"],"x":875,"y":680,"wires":[["b071795a.a224c8"]]},{"id":"3317831c.b6d06c","type":"link in","z":"cf6e4dbe.06b5d","name":"","links":["a99710a1.0f236"],"x":875,"y":720,"wires":[["7e10980.3a72c68"]]},{"id":"b7b5dab0.747358","type":"link in","z":"cf6e4dbe.06b5d","name":"","links":["3cd81e6e.63c192"],"x":875,"y":760,"wires":[["2e701334.92019c"]]},{"id":"9398b22e.e1bb4","type":"link in","z":"cf6e4dbe.06b5d","name":"","links":["6e4f2b.41a840d4"],"x":875,"y":800,"wires":[["378e7e3d.0752e2"]]},{"id":"bcc07a47.712168","type":"link in","z":"cf6e4dbe.06b5d","name":"","links":["13e6465f.8c2c3a"],"x":1415,"y":480,"wires":[["415053ce.7685ec"]]},{"id":"11859873.251628","type":"link in","z":"cf6e4dbe.06b5d","name":"","links":["a9ce6774.e30118"],"x":1415,"y":520,"wires":[["3770f3e.3c0ee0c"]]},{"id":"9cf31e63.d062c","type":"link in","z":"cf6e4dbe.06b5d","name":"","links":["a0d1b61.40c1c48"],"x":1415,"y":560,"wires":[["4c440631.5281c8"]]},{"id":"5496711.7a05c9","type":"link in","z":"cf6e4dbe.06b5d","name":"","links":["1aca2b11.c30685"],"x":1415,"y":600,"wires":[["82506f9b.4431c"]]},{"id":"6298bff6.e27bf","type":"link in","z":"cf6e4dbe.06b5d","name":"","links":["3c816f73.e0f89"],"x":1415,"y":640,"wires":[["94bac0b5.c8e1a"]]},{"id":"3c8d54b7.7cf1ec","type":"link in","z":"cf6e4dbe.06b5d","name":"","links":["f3a13dab.e1348"],"x":1415,"y":680,"wires":[["4a852cb9.948c54"]]},{"id":"6ca4ca65.f57774","type":"link in","z":"cf6e4dbe.06b5d","name":"","links":["d8fb582f.dddf58"],"x":1415,"y":720,"wires":[["f0dca05d.d56a1"]]},{"id":"dd0b291a.683458","type":"link in","z":"cf6e4dbe.06b5d","name":"","links":["96009b7b.1fd628"],"x":1415,"y":760,"wires":[["30b81316.92cdac"]]},{"id":"ebcaa8b4.de5ba8","type":"link in","z":"cf6e4dbe.06b5d","name":"","links":["4ee3f200.e1481c"],"x":1415,"y":800,"wires":[["5cc6ed39.e7b5a4"]]},{"id":"e8c81155.f0682","type":"link in","z":"cf6e4dbe.06b5d","name":"","links":["d706801f.f4038"],"x":2055,"y":80,"wires":[["b3764609.0de978"]]},{"id":"e2c44609.c48d18","type":"link in","z":"cf6e4dbe.06b5d","name":"","links":["65eccbf8.adfd74"],"x":2055,"y":180,"wires":[["547120ea.8601d"]]},{"id":"9a9ed52f.6a84e8","type":"debug","z":"cf6e4dbe.06b5d","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":670,"y":520,"wires":[]},{"id":"61bc48c7.735578","type":"debug","z":"cf6e4dbe.06b5d","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":1180,"y":540,"wires":[]},{"id":"e01e4d23.ee5dc","type":"inject","z":"34168811.ab73a8","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1260,"y":200,"wires":[["b9d5bd61.dbc3c"]]},{"id":"b9d5bd61.dbc3c","type":"file in","z":"34168811.ab73a8","name":"Cargar archivo del historial","filename":"run/media/mmcblk0p1/Estandar_20241028_200809.csv","format":"utf8","chunk":false,"sendError":false,"encoding":"none","x":1480,"y":200,"wires":[["94ec7b9a.ba61a8"]]},{"id":"94ec7b9a.ba61a8","type":"debug","z":"34168811.ab73a8","name":"Cargado del historial","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1760,"y":200,"wires":[]},{"id":"ef0fb09f.6d7d9","type":"ui_text","z":"34168811.ab73a8","group":"f98bd4ef.b5b8a8","order":2,"width":13,"height":2,"name":"","label":"Panel de control","format":"Configuración","layout":"col-center","className":"Label_proceso_estandar","style":true,"font":"Trebuchet MS,Helvetica,sans-serif","fontSize":"30","color":"#b0b6bd","x":840,"y":120,"wires":[]},{"id":"91bcf423.f36f88","type":"function","z":"34168811.ab73a8","name":"Check userRole","func":"let role = global.get(\"userRole\");\n\nif (role === \"admin\") {\n    msg.payload = \"funciona\"\n    return msg;  // Allow access for admin\n} else {\n    return null; // Block access for others\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1080,"y":900,"wires":[["853c3d80.9fbdf"]]},{"id":"786865f0.e203cc","type":"ui_button","z":"34168811.ab73a8","name":"Admin Only Button","group":"f98bd4ef.b5b8a8","order":13,"width":4,"height":1,"passthru":false,"label":"{{msg.Label}}","tooltip":"Solo usuario admin","color":"{{msg.color}}","bgcolor":"{{msg.bgcolor}}","className":"","icon":"{{msg.icon}}","payload":"","payloadType":"str","topic":"","topicType":"str","x":810,"y":900,"wires":[["91bcf423.f36f88"]]},{"id":"fd104029.8c39d","type":"inject","z":"34168811.ab73a8","name":"Set userRole to Operador","props":[],"repeat":"60","crontab":"","once":true,"onceDelay":0.1,"topic":"","x":220,"y":920,"wires":[["f77a2ae4.0d2148"]]},{"id":"f77a2ae4.0d2148","type":"function","z":"34168811.ab73a8","name":"Role operador","func":"global.set('userRole', \"operador\");\ncontext.set('color', 'white');\nmsg.bgcolor = '#cd6a6a';\nmsg.color = 'white';\nmsg.icon = 'fa-lock';\nmsg.Label = 'Exportar'\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":500,"y":920,"wires":[["786865f0.e203cc"]]},{"id":"b2403370.a2793","type":"ui_text_input","z":"34168811.ab73a8","name":"","label":"Contraseña","tooltip":"","group":"f98bd4ef.b5b8a8","order":20,"width":4,"height":1,"passthru":true,"mode":"password","delay":300,"topic":"topic","sendOnBlur":true,"className":"","topicType":"msg","x":150,"y":760,"wires":[["977c27f7.8c93b8"]]},{"id":"deae2537.498df8","type":"ui_button","z":"34168811.ab73a8","name":"","group":"f98bd4ef.b5b8a8","order":27,"width":4,"height":1,"passthru":false,"label":"Desbloquear","tooltip":"","color":"","bgcolor":"","className":"left_menu_button","icon":"","payload":"","payloadType":"str","topic":"topic","topicType":"msg","x":150,"y":880,"wires":[["59ccb820.e36f98"]]},{"id":"977c27f7.8c93b8","type":"function","z":"34168811.ab73a8","name":"Global.contrasena","func":"global.set('contrasena', msg.payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":490,"y":760,"wires":[[]]},{"id":"59ccb820.e36f98","type":"function","z":"34168811.ab73a8","name":"Role admin","func":"let contrasena = global.get(\"contrasena\");\n\nif (contrasena === \"penagosadmin24\"){\n    \n    global.set('userRole', \"admin\");\n    \n    //Efectos del botón\n    context.set('color', 'white');\n    msg.bgcolor = '#8adf9d';\n    msg.color = 'white';\n    msg.icon = 'fa-unlock'\n    msg.Label = 'Exportar'\n    \n    return msg;\n}\nelse {\n    return null;\n}\n","outputs":1,"noerr":0,"initialize":"","finalize":"","x":490,"y":880,"wires":[["786865f0.e203cc"]]},{"id":"ccfd1004.ced42","type":"comment","z":"34168811.ab73a8","name":"Cambio de rol y validación","info":"","x":190,"y":840,"wires":[]},{"id":"cd4e560e.5a0808","type":"comment","z":"34168811.ab73a8","name":"Exportar datos","info":"","x":800,"y":860,"wires":[]},{"id":"88603422.268bc8","type":"debug","z":"34168811.ab73a8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1650,"y":900,"wires":[]},{"id":"853c3d80.9fbdf","type":"function","z":"34168811.ab73a8","name":"Función para exportar archivos","func":"//función para exportar archivos ordenados\n\n\n//Efectos del botón\ncontext.set('color', 'white');\nmsg.bgcolor = '#8adf9d';\nmsg.color = 'white';\nmsg.icon = 'fa-thumbs-up'\nmsg.Label = \"Exportado\"\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1370,"y":900,"wires":[["88603422.268bc8","786865f0.e203cc"]]},{"id":"27f3f2cb.4b94ce","type":"function","z":"1d0b3b5c.03ac95","name":"Check userRole","func":"let role = global.get(\"userRole\");\n\nif (role === \"admin\") {\n    msg.payload = \"Administrador\"\n    return msg;  // Allow access for admin\n} else {\n    msg.payload = \"Operador\"\n    return msg;  // Allow access for admin\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1680,"y":220,"wires":[["4b85991.3922268"]]},{"id":"40c0ccff.d652a4","type":"inject","z":"1d0b3b5c.03ac95","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1490,"y":220,"wires":[["27f3f2cb.4b94ce"]]},{"id":"5e511f5c.6325f","type":"link in","z":"1d0b3b5c.03ac95","name":"Validar role","links":[],"x":1535,"y":260,"wires":[["27f3f2cb.4b94ce"]]},{"id":"b06169fd.4cdc88","type":"function","z":"e69d9ae9.d86958","name":"Check userRole","func":"let role = global.get(\"userRole\");\n\nif (role === \"admin\") {\n    msg.payload = \"Administrador\"\n    return msg;  // Allow access for admin\n} else {\n    msg.payload = \"Operador\"\n    return msg;  // Allow access for admin\n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1520,"y":40,"wires":[["f519db25.f8fc68"]]},{"id":"d6c24a85.e07e78","type":"inject","z":"e69d9ae9.d86958","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":1330,"y":40,"wires":[["b06169fd.4cdc88"]]},{"id":"2031608e.04afc","type":"link in","z":"e69d9ae9.d86958","name":"Validar role","links":[],"x":1375,"y":80,"wires":[["b06169fd.4cdc88"]]},{"id":"a223032d.281a1","type":"ui_text","z":"34168811.ab73a8","group":"f98bd4ef.b5b8a8","order":9,"width":6,"height":1,"name":"","label":"Prueba de actuadores","format":"","layout":"row-center","className":"text-blue","style":false,"font":"","fontSize":16,"color":"#000000","x":720,"y":240,"wires":[]},{"id":"608d12ae.a5f78c","type":"ui_text","z":"34168811.ab73a8","group":"f98bd4ef.b5b8a8","order":7,"width":4,"height":1,"name":"","label":"Usuarios","format":"","layout":"row-center","className":"text-blue","style":false,"font":"","fontSize":16,"color":"#000000","x":140,"y":720,"wires":[]}]